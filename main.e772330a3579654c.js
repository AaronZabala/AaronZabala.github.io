(self.webpackChunkmsc_app=self.webpackChunkmsc_app||[]).push([[179],{296:(ni,In,on)=>{"use strict";function ht(n){return"function"==typeof n}function se(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const dt=se(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Oe(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class Mt{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const c of e)c.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(ht(i))try{i()}catch(c){t=c instanceof dt?c.errors:[c]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const c of r)try{gt(c)}catch(g){t=t??[],g instanceof dt?t=[...t,...g.errors]:t.push(g)}}if(t)throw new dt(t)}}add(t){var e;if(t&&t!==this)if(this.closed)gt(t);else{if(t instanceof Mt){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Oe(e,t)}remove(t){const{_finalizers:e}=this;e&&Oe(e,t),t instanceof Mt&&t._removeParent(this)}}Mt.EMPTY=(()=>{const n=new Mt;return n.closed=!0,n})();const Wt=Mt.EMPTY;function yt(n){return n instanceof Mt||n&&"closed"in n&&ht(n.remove)&&ht(n.add)&&ht(n.unsubscribe)}function gt(n){ht(n)?n():n.unsubscribe()}const Nt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ze={setTimeout(n,t,...e){const{delegate:i}=ze;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=ze;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Yi(n){ze.setTimeout(()=>{const{onUnhandledError:t}=Nt;if(!t)throw n;t(n)})}function Bt(){}const ui=cs("C",void 0,void 0);function cs(n,t,e){return{kind:n,value:t,error:e}}let zt=null;function Xn(n){if(Nt.useDeprecatedSynchronousErrorHandling){const t=!zt;if(t&&(zt={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=zt;if(zt=null,e)throw i}}else n()}class Hn extends Mt{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,yt(t)&&t.add(this)):this.destination=it}static create(t,e,i){return new Yn(t,e,i)}next(t){this.isStopped?Te(function Ir(n){return cs("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Te(function wi(n){return cs("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Te(ui,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Bi=Function.prototype.bind;function Pn(n,t){return Bi.call(n,t)}class Zn{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){oi(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){oi(i)}else oi(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){oi(e)}}}class Yn extends Hn{constructor(t,e,i){let r;if(super(),ht(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let c;this&&Nt.useDeprecatedNextContext?(c=Object.create(t),c.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&Pn(t.next,c),error:t.error&&Pn(t.error,c),complete:t.complete&&Pn(t.complete,c)}):r=t}this.destination=new Zn(r)}}function oi(n){Nt.useDeprecatedSynchronousErrorHandling?function yn(n){Nt.useDeprecatedSynchronousErrorHandling&&zt&&(zt.errorThrown=!0,zt.error=n)}(n):Yi(n)}function Te(n,t){const{onStoppedNotification:e}=Nt;e&&ze.setTimeout(()=>e(n,t))}const it={closed:!0,next:Bt,error:function ge(n){throw n},complete:Bt},Ot="function"==typeof Symbol&&Symbol.observable||"@@observable";function Tt(n){return n}function Lt(n){return 0===n.length?Tt:1===n.length?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}let jt=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const c=function Ht(n){return n&&n instanceof Hn||function Qt(n){return n&&ht(n.next)&&ht(n.error)&&ht(n.complete)}(n)&&yt(n)}(e)?e:new Yn(e,i,r);return Xn(()=>{const{operator:g,source:_}=this;c.add(g?g.call(c,_):_?this._subscribe(c):this._trySubscribe(c))}),c}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=kt(i))((r,c)=>{const g=new Yn({next:_=>{try{e(_)}catch(w){c(w),g.unsubscribe()}},error:c,complete:r});this.subscribe(g)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[Ot](){return this}pipe(...e){return Lt(e)(this)}toPromise(e){return new(e=kt(e))((i,r)=>{let c;this.subscribe(g=>c=g,g=>r(g),()=>i(c))})}}return n.create=t=>new n(t),n})();function kt(n){var t;return null!==(t=n??Nt.Promise)&&void 0!==t?t:Promise}const Jt=se(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Yt=(()=>{class n extends jt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Ui(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Jt}next(e){Xn(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Xn(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Xn(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:c}=this;return i||r?Wt:(this.currentObservers=null,c.push(e),new Mt(()=>{this.currentObservers=null,Oe(c,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:c}=this;i?e.error(r):c&&e.complete()}asObservable(){const e=new jt;return e.source=this,e}}return n.create=(t,e)=>new Ui(t,e),n})();class Ui extends Yt{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:Wt}}function Oi(n){return ht(n?.lift)}function Dn(n){return t=>{if(Oi(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function gn(n,t,e,i,r){return new Ra(n,t,e,i,r)}class Ra extends Hn{constructor(t,e,i,r,c,g){super(t),this.onFinalize=c,this.shouldUnsubscribe=g,this._next=e?function(_){try{e(_)}catch(w){t.error(w)}}:super._next,this._error=r?function(_){try{r(_)}catch(w){t.error(w)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(_){t.error(_)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function hn(n,t){return Dn((e,i)=>{let r=0;e.subscribe(gn(i,c=>{i.next(n.call(t,c,r++))}))})}function ya(n){return this instanceof ya?(this.v=n,this):new ya(n)}function Df(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(n,t||[]),c=[];return r={},g("next"),g("throw"),g("return"),r[Symbol.asyncIterator]=function(){return this},r;function g(J){i[J]&&(r[J]=function(ae){return new Promise(function(we,Ee){c.push([J,ae,we,Ee])>1||_(J,ae)})})}function _(J,ae){try{!function w(J){J.value instanceof ya?Promise.resolve(J.value.v).then(C,L):z(c[0][2],J)}(i[J](ae))}catch(we){z(c[0][3],we)}}function C(J){_("next",J)}function L(J){_("throw",J)}function z(J,ae){J(ae),c.shift(),c.length&&_(c[0][0],c[0][1])}}function Xp(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function au(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(c){e[c]=n[c]&&function(g){return new Promise(function(_,w){!function r(c,g,_,w){Promise.resolve(w).then(function(C){c({value:C,done:_})},g)}(_,w,(g=n[c](g)).done,g.value)})}}}const xc=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function rd(n){return ht(n?.then)}function Fu(n){return ht(n[Ot])}function Hs(n){return Symbol.asyncIterator&&ht(n?.[Symbol.asyncIterator])}function Sr(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Mf=function ba(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function kg(n){return ht(n?.[Mf])}function oe(n){return Df(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:r}=yield ya(e.read());if(r)return yield ya(void 0);yield yield ya(i)}}finally{e.releaseLock()}})}function pe(n){return ht(n?.getReader)}function Re(n){if(n instanceof jt)return n;if(null!=n){if(Fu(n))return function Je(n){return new jt(t=>{const e=n[Ot]();if(ht(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(xc(n))return function an(n){return new jt(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(rd(n))return function nr(n){return new jt(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Yi)})}(n);if(Hs(n))return ko(n);if(kg(n))return function rs(n){return new jt(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(pe(n))return function Dl(n){return ko(oe(n))}(n)}throw Sr(n)}function ko(n){return new jt(t=>{(function oa(n,t){var e,i,r,c;return function ul(n,t,e,i){return new(e||(e=Promise))(function(c,g){function _(L){try{C(i.next(L))}catch(z){g(z)}}function w(L){try{C(i.throw(L))}catch(z){g(z)}}function C(L){L.done?c(L.value):function r(c){return c instanceof e?c:new e(function(g){g(c)})}(L.value).then(_,w)}C((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Xp(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(g){r={error:g}}finally{try{i&&!i.done&&(c=e.return)&&(yield c.call(e))}finally{if(r)throw r.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Ps(n,t,e,i=0,r=!1){const c=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(c),!r)return c}function vr(n,t,e=1/0){return ht(t)?vr((i,r)=>hn((c,g)=>t(i,c,r,g))(Re(n(i,r))),e):("number"==typeof t&&(e=t),Dn((i,r)=>function yo(n,t,e,i,r,c,g,_){const w=[];let C=0,L=0,z=!1;const J=()=>{z&&!w.length&&!C&&t.complete()},ae=Ee=>C<i?we(Ee):w.push(Ee),we=Ee=>{c&&t.next(Ee),C++;let He=!1;Re(e(Ee,L++)).subscribe(gn(t,Ye=>{r?.(Ye),c?ae(Ye):t.next(Ye)},()=>{He=!0},void 0,()=>{if(He)try{for(C--;w.length&&C<i;){const Ye=w.shift();g?Ps(t,g,()=>we(Ye)):we(Ye)}J()}catch(Ye){t.error(Ye)}}))};return n.subscribe(gn(t,ae,()=>{z=!0,J()})),()=>{_?.()}}(i,r,n,e)))}function bo(n=1/0){return vr(Tt,n)}const Qr=new jt(n=>n.complete());function _r(n){return n&&ht(n.schedule)}function sd(n){return n[n.length-1]}function Fo(n){return ht(sd(n))?n.pop():void 0}function Bo(n){return _r(sd(n))?n.pop():void 0}function Fg(n,t=0){return Dn((e,i)=>{e.subscribe(gn(i,r=>Ps(i,n,()=>i.next(r),t),()=>Ps(i,n,()=>i.complete(),t),r=>Ps(i,n,()=>i.error(r),t)))})}function P_(n,t=0){return Dn((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function ah(n,t){if(!n)throw new Error("Iterable cannot be null");return new jt(e=>{Ps(e,t,()=>{const i=n[Symbol.asyncIterator]();Ps(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Gs(n,t){return t?function Jp(n,t){if(null!=n){if(Fu(n))return function O_(n,t){return Re(n).pipe(P_(t),Fg(t))}(n,t);if(xc(n))return function Iy(n,t){return new jt(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(rd(n))return function L_(n,t){return Re(n).pipe(P_(t),Fg(t))}(n,t);if(Hs(n))return ah(n,t);if(kg(n))return function Ry(n,t){return new jt(e=>{let i;return Ps(e,t,()=>{i=n[Mf](),Ps(e,t,()=>{let r,c;try{({value:r,done:c}=i.next())}catch(g){return void e.error(g)}c?e.complete():e.next(r)},0,!0)}),()=>ht(i?.return)&&i.return()})}(n,t);if(pe(n))return function Zp(n,t){return ah(oe(n),t)}(n,t)}throw Sr(n)}(n,t):Re(n)}function em(n,t,...e){if(!0===t)return void n();if(!1===t)return;const i=new Yn({next:()=>{i.unsubscribe(),n()}});return t(...e).subscribe(i)}function Ur(n){for(let t in n)if(n[t]===Ur)return t;throw Error("Could not find renamed property on target object.")}function Ug(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Vr(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Vr).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function tm(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Ny=Ur({__forward_ref__:Ur});function yr(n){return n.__forward_ref__=yr,n.toString=function(){return Vr(this())},n}function Ti(n){return function nm(n){return"function"==typeof n&&n.hasOwnProperty(Ny)&&n.__forward_ref__===yr}(n)?n():n}class wt extends Error{constructor(t,e){super(function Rf(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function Mi(n){return"string"==typeof n?n:null==n?"":String(n)}function im(n,t){throw new wt(-201,!1)}function Vo(n,t){null==n&&function Er(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function kn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Wi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Pf(n){return ad(n,am)||ad(n,B_)}function ad(n,t){return n.hasOwnProperty(t)?n[t]:null}function jg(n){return n&&(n.hasOwnProperty(Il)||n.hasOwnProperty(nT))?n[Il]:null}const am=Ur({\u0275prov:Ur}),Il=Ur({\u0275inj:Ur}),B_=Ur({ngInjectableDef:Ur}),nT=Ur({ngInjectorDef:Ur});var gi=(()=>((gi=gi||{})[gi.Default=0]="Default",gi[gi.Host=1]="Host",gi[gi.Self=2]="Self",gi[gi.SkipSelf=4]="SkipSelf",gi[gi.Optional=8]="Optional",gi))();let U_;function Rl(n){const t=U_;return U_=n,t}function om(n,t,e){const i=Pf(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&gi.Optional?null:void 0!==t?t:void im(Vr(n))}function ou(n){return{toString:n}.toString()}var Ta=(()=>((Ta=Ta||{})[Ta.OnPush=0]="OnPush",Ta[Ta.Default=1]="Default",Ta))(),no=(()=>{return(n=no||(no={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",no;var n})();const Cr=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Go={},xn=[],Bu=Ur({\u0275cmp:Ur}),pi=Ur({\u0275dir:Ur}),qe=Ur({\u0275pipe:Ur}),la=Ur({\u0275mod:Ur}),wo=Ur({\u0275fac:Ur}),lu=Ur({__NG_ELEMENT_ID__:Ur});let xs=0;function Li(n){return ou(()=>{const e=!0===n.standalone,i={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ta.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||xn,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||no.Emulated,id:"c"+xs++,styles:n.styles||xn,_:null,setInput:null,schemas:n.schemas||null,tView:null},c=n.dependencies,g=n.features;return r.inputs=um(n.inputs,i),r.outputs=um(n.outputs),g&&g.forEach(_=>_(r)),r.directiveDefs=c?()=>("function"==typeof c?c():c).map(Hr).filter(Of):null,r.pipeDefs=c?()=>("function"==typeof c?c():c).map(lr).filter(Of):null,r})}function Hr(n){return Tr(n)||Ss(n)}function Of(n){return null!==n}function ci(n){return ou(()=>({type:n.type,bootstrap:n.bootstrap||xn,declarations:n.declarations||xn,imports:n.imports||xn,exports:n.exports||xn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function um(n,t){if(null==n)return Go;const e={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],c=r;Array.isArray(r)&&(c=r[1],r=r[0]),e[r]=i,t&&(t[r]=c)}return e}const Tn=Li;function js(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Tr(n){return n[Bu]||null}function Ss(n){return n[pi]||null}function lr(n){return n[qe]||null}function Js(n,t){const e=n[la]||null;if(!e&&!0===t)throw new Error(`Type ${Vr(n)} does not have '\u0275mod' property.`);return e}function Ga(n){return Array.isArray(n)&&"object"==typeof n[1]}function ja(n){return Array.isArray(n)&&!0===n[1]}function ca(n){return 0!=(8&n.flags)}function Vu(n){return 2==(2&n.flags)}function Hu(n){return 1==(1&n.flags)}function fl(n){return null!==n.template}function kf(n){return 0!=(256&n[2])}function hs(n,t){return n.hasOwnProperty(wo)?n[wo]:null}class Mc{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Aa(){return Bf}function Bf(n){return n.type.prototype.ngOnChanges&&(n.setInput=ei),Ol}function Ol(){const n=Uf(this),t=n?.current;if(t){const e=n.previous;if(e===Go)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function ei(n,t,e,i){const r=Uf(n)||function _i(n,t){return n[dd]=t}(n,{previous:Go,current:null}),c=r.current||(r.current={}),g=r.previous,_=this.declaredInputs[e],w=g[_];c[_]=new Mc(w&&w.currentValue,t,g===Go),n[i]=t}Aa.ngInherit=!0;const dd="__ngSimpleChanges__";function Uf(n){return n[dd]||null}function fs(n){for(;Array.isArray(n);)n=n[0];return n}function Ic(n,t){return fs(t[n])}function zi(n,t){return fs(t[n.index])}function ch(n,t){return n.data[t]}function xa(n,t){const e=t[n];return Ga(e)?e:e[0]}function mm(n){return 4==(4&n[2])}function xo(n){return 64==(64&n[2])}function $o(n,t){return null==t?null:n[t]}function So(n){n[18]=0}function ro(n,t){n[5]+=t;let e=n,i=n[3];for(;null!==i&&(1===t&&1===e[5]||-1===t&&0===e[5]);)i[5]+=t,e=i,i=i[3]}const Fn={lFrame:Gf(null),bindingsEnabled:!0};function zu(){return Fn.bindingsEnabled}function ft(){return Fn.lFrame.lView}function Vi(){return Fn.lFrame.tView}function Os(){let n=ao();for(;null!==n&&64===n.type;)n=n.parent;return n}function ao(){return Fn.lFrame.currentTNode}function zs(n,t){const e=Fn.lFrame;e.currentTNode=n,e.isParent=t}function Vf(){return Fn.lFrame.isParent}function Cs(){Fn.lFrame.isParent=!1}function pd(){return Fn.lFrame.bindingIndex++}function Bl(n){const t=Fn.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function ks(n,t){const e=Fn.lFrame;e.bindingIndex=e.bindingRootIndex=n,$u(t)}function $u(n){Fn.lFrame.currentDirectiveIndex=n}function Rr(){return Fn.lFrame.currentQueryIndex}function Xg(n){Fn.lFrame.currentQueryIndex=n}function Dr(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function md(n,t,e){if(e&gi.SkipSelf){let r=t,c=n;for(;!(r=r.parent,null!==r||e&gi.Host||(r=Dr(c),null===r||(c=c[15],10&r.type))););if(null===r)return!1;t=r,n=c}const i=Fn.lFrame=Hf();return i.currentTNode=t,i.lView=n,!0}function ph(n){const t=Hf(),e=n[1];Fn.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Hf(){const n=Fn.lFrame,t=null===n?null:n.child;return null===t?Gf(n):t}function Gf(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function Rt(){const n=Fn.lFrame;return Fn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const W_=Rt;function _m(){const n=Rt();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function $a(){return Fn.lFrame.selectedIndex}function Fs(n){Fn.lFrame.selectedIndex=n}function mh(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const c=n.data[e].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:_,ngAfterViewInit:w,ngAfterViewChecked:C,ngOnDestroy:L}=c;g&&(n.contentHooks||(n.contentHooks=[])).push(-e,g),_&&((n.contentHooks||(n.contentHooks=[])).push(e,_),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,_)),w&&(n.viewHooks||(n.viewHooks=[])).push(-e,w),C&&((n.viewHooks||(n.viewHooks=[])).push(e,C),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,C)),null!=L&&(n.destroyHooks||(n.destroyHooks=[])).push(e,L)}}function qu(n,t,e){ym(n,t,3,e)}function Xu(n,t,e,i){(3&n[2])===e&&ym(n,t,e,i)}function Kg(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function ym(n,t,e,i){const c=i??-1,g=t.length-1;let _=0;for(let w=void 0!==i?65535&n[18]:0;w<g;w++)if("number"==typeof t[w+1]){if(_=t[w],null!=i&&_>=i)break}else t[w]<0&&(n[18]+=65536),(_<c||-1==c)&&(Vy(n,e,t,w),n[18]=(4294901760&n[18])+w+2),w++}function Vy(n,t,e,i){const r=e[i]<0,c=e[i+1],_=n[r?-e[i]:e[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{c.call(_)}finally{}}}else try{c.call(_)}finally{}}class zf{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function vh(n,t,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const c=e[i++],g=e[i++],_=e[i++];n.setAttribute(t,g,_,c)}else{const c=r,g=e[++i];bm(c)?n.setProperty(t,c,g):n.setAttribute(t,c,g),i++}}return i}function Jg(n){return 3===n||4===n||6===n}function bm(n){return 64===n.charCodeAt(0)}function vd(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||Y_(n,e,r,null,-1===e||2===e?t[++i]:null)}}return n}function Y_(n,t,e,i,r){let c=0,g=n.length;if(-1===t)g=-1;else for(;c<n.length;){const _=n[c++];if("number"==typeof _){if(_===t){g=-1;break}if(_>t){g=c-1;break}}}for(;c<n.length;){const _=n[c];if("number"==typeof _)break;if(_===e){if(null===i)return void(null!==r&&(n[c+1]=r));if(i===n[c+1])return void(n[c+2]=r)}c++,null!==i&&c++,null!==r&&c++}-1!==g&&(n.splice(g,0,t),c=g+1),n.splice(c++,0,e),null!==i&&n.splice(c++,0,i),null!==r&&n.splice(c++,0,r)}function ev(n){return-1!==n}function _d(n){return 32767&n}function yd(n,t){let e=function Wf(n){return n>>16}(n),i=t;for(;e>0;)i=i[15],e--;return i}let Tm=!0;function $f(n){const t=Tm;return Tm=n,t}let _h=0;const $s={};function ha(n,t){const e=Nr(n,t);if(-1!==e)return e;const i=t[1];i.firstCreatePass&&(n.injectorIndex=t.length,nv(i.data,n),nv(t,null),nv(i.blueprint,null));const r=gu(n,t),c=n.injectorIndex;if(ev(r)){const g=_d(r),_=yd(r,t),w=_[1].data;for(let C=0;C<8;C++)t[c+C]=_[g+C]|w[g+C]}return t[c+8]=r,c}function nv(n,t){n.push(0,0,0,0,0,0,0,0,t)}function Nr(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function gu(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){if(i=Yf(r),null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function bh(n,t,e){!function yh(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(lu)&&(i=e[lu]),null==i&&(i=e[lu]=_h++);const r=255&i;t.data[n+(r>>5)]|=1<<r}(n,t,e)}function K_(n,t,e){if(e&gi.Optional)return n;im()}function Z_(n,t,e,i){if(e&gi.Optional&&void 0===i&&(i=null),0==(e&(gi.Self|gi.Host))){const r=n[9],c=Rl(void 0);try{return r?r.get(t,i,e&gi.Optional):om(t,i,e&gi.Optional)}finally{Rl(c)}}return K_(i,0,e)}function J_(n,t,e,i=gi.Default,r){if(null!==n){if(1024&t[2]){const g=function Xy(n,t,e,i,r){let c=n,g=t;for(;null!==c&&null!==g&&1024&g[2]&&!(256&g[2]);){const _=e0(c,g,e,i|gi.Self,$s);if(_!==$s)return _;let w=c.parent;if(!w){const C=g[21];if(C){const L=C.get(e,$s,i);if(L!==$s)return L}w=Yf(g),g=g[15]}c=w}return r}(n,t,e,i,$s);if(g!==$s)return g}const c=e0(n,t,e,i,$s);if(c!==$s)return c}return Z_(t,e,i,r)}function e0(n,t,e,i,r){const c=function $y(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(lu)?n[lu]:void 0;return"number"==typeof t?t>=0?255&t:qy:t}(e);if("function"==typeof c){if(!md(t,n,i))return i&gi.Host?K_(r,0,i):Z_(t,e,i,r);try{const g=c(i);if(null!=g||i&gi.Optional)return g;im()}finally{W_()}}else if("number"==typeof c){let g=null,_=Nr(n,t),w=-1,C=i&gi.Host?t[16][6]:null;for((-1===_||i&gi.SkipSelf)&&(w=-1===_?gu(n,t):t[_+8],-1!==w&&Am(i,!1)?(g=t[1],_=_d(w),t=yd(w,t)):_=-1);-1!==_;){const L=t[1];if(iv(c,_,L.data)){const z=Wy(_,t,e,g,i,C);if(z!==$s)return z}w=t[_+8],-1!==w&&Am(i,t[1].data[_+8]===C)&&iv(c,_,t)?(g=L,_=_d(w),t=yd(w,t)):_=-1}}return r}function Wy(n,t,e,i,r,c){const g=t[1],_=g.data[n+8],L=qf(_,g,e,null==i?Vu(_)&&Tm:i!=g&&0!=(3&_.type),r&gi.Host&&c===_);return null!==L?Xf(t,g,L,_):$s}function qf(n,t,e,i,r){const c=n.providerIndexes,g=t.data,_=1048575&c,w=n.directiveStart,L=c>>20,J=r?_+L:n.directiveEnd;for(let ae=i?_:_+L;ae<J;ae++){const we=g[ae];if(ae<w&&e===we||ae>=w&&we.type===e)return ae}if(r){const ae=g[w];if(ae&&fl(ae)&&ae.type===e)return w}return null}function Xf(n,t,e,i){let r=n[e];const c=t.data;if(function q_(n){return n instanceof zf}(r)){const g=r;g.resolving&&function F_(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new wt(-200,`Circular dependency in DI detected for ${n}${e}`)}(function br(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Mi(n)}(c[e]));const _=$f(g.canSeeViewProviders);g.resolving=!0;const w=g.injectImpl?Rl(g.injectImpl):null;md(n,i,gi.Default);try{r=n[e]=g.factory(void 0,c,n,i),t.firstCreatePass&&e>=i.directiveStart&&function $_(n,t,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:c}=t.type.prototype;if(i){const g=Bf(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,g),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,g)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,r),c&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,c),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,c))}(e,c[e],t)}finally{null!==w&&Rl(w),$f(_),g.resolving=!1,W_()}}return r}function iv(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function Am(n,t){return!(n&gi.Self||n&gi.Host&&t)}class Th{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return J_(this._tNode,this._lView,t,i,e)}}function qy(){return new Th(Os(),ft())}function Yf(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}const Td="__parameters__";function Oa(n,t,e){return ou(()=>{const i=function rv(n){return function(...e){if(n){const i=n(...e);for(const r in i)this[r]=i[r]}}}(t);function r(...c){if(this instanceof r)return i.apply(this,c),this;const g=new r(...c);return _.annotation=g,_;function _(w,C,L){const z=w.hasOwnProperty(Td)?w[Td]:Object.defineProperty(w,Td,{value:[]})[Td];for(;z.length<=L;)z.push(null);return(z[L]=z[L]||[]).push(g),w}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class En{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=kn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function qo(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let i=n[e];Array.isArray(i)?(t===n&&(t=n.slice(0,e)),qo(i,t)):t!==n&&t.push(i)}return t}function Vl(n,t){n.forEach(e=>Array.isArray(e)?Vl(e,t):t(e))}function s0(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function Kf(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Lc(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function Xa(n,t,e){let i=kc(n,t);return i>=0?n[1|i]=e:(i=~i,function Jy(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(1===r)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;)n[r]=n[r-2],r--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function Sm(n,t){const e=kc(n,t);if(e>=0)return n[1|e]}function kc(n,t){return function lv(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){const c=i+(r-i>>1),g=n[c<<e];if(t===g)return c<<e;g>t?r=c:i=c+1}return~(r<<e)}(n,t,1)}const Sh={},Mm="__NG_DI_FLAG__",Eh="ngTempTokenPath",sb=/\n/gm,Ch="__source";let Dh;function Hl(n){const t=Dh;return Dh=n,t}function u0(n,t=gi.Default){if(void 0===Dh)throw new wt(-203,!1);return null===Dh?om(n,void 0,t):Dh.get(n,t&gi.Optional?null:void 0,t)}function $t(n,t=gi.Default){return(function iT(){return U_}()||u0)(Ti(n),t)}function Bn(n,t=gi.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),$t(n,t)}function fn(n){const t=[];for(let e=0;e<n.length;e++){const i=Ti(n[e]);if(Array.isArray(i)){if(0===i.length)throw new wt(900,!1);let r,c=gi.Default;for(let g=0;g<i.length;g++){const _=i[g],w=c0(_);"number"==typeof w?-1===w?r=_.token:c|=w:r=_}t.push($t(r,c))}else t.push($t(i))}return t}function Ya(n,t){return n[Mm]=t,n.prototype[Mm]=t,n}function c0(n){return n[Mm]}const yu=Ya(Oa("Optional"),8),wd=Ya(Oa("SkipSelf"),4);let _v;class Sd{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Qa(n){return n instanceof Sd?n.changingThisBreaksApplicationSecurity:n}const Yo=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var er=(()=>((er=er||{})[er.NONE=0]="NONE",er[er.HTML=1]="HTML",er[er.STYLE=2]="STYLE",er[er.SCRIPT=3]="SCRIPT",er[er.URL=4]="URL",er[er.RESOURCE_URL=5]="RESOURCE_URL",er))();function Mv(n){const t=function Cd(){const n=ft();return n&&n[12]}();return t?t.sanitize(er.URL,n)||"":function Xo(n,t){const e=function _0(n){return n instanceof Sd&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}(n,"URL")?Qa(n):function Qu(n){return(n=String(n)).match(Yo)?n:"unsafe:"+n}(Mi(n))}const $m=new En("ENVIRONMENT_INITIALIZER"),kh=new En("INJECTOR",-1),lo=new En("INJECTOR_DEF_TYPES");class Nv{get(t,e=Sh){if(e===Sh){const i=new Error(`NullInjectorError: No provider for ${Vr(t)}!`);throw i.name="NullInjectorError",i}return e}}function qm(...n){return{\u0275providers:x0(0,n)}}function x0(n,...t){const e=[],i=new Set;let r;return Vl(t,c=>{const g=c;wu(g,e,[],i)&&(r||(r=[]),r.push(g))}),void 0!==r&&gl(r,e),e}function gl(n,t){for(let e=0;e<n.length;e++){const{providers:r}=n[e];Vl(r,c=>{t.push(c)})}}function wu(n,t,e,i){if(!(n=Ti(n)))return!1;let r=null,c=jg(n);const g=!c&&Tr(n);if(c||g){if(g&&!g.standalone)return!1;r=n}else{const w=n.ngModule;if(c=jg(w),!c)return!1;r=w}const _=i.has(r);if(g){if(_)return!1;if(i.add(r),g.dependencies){const w="function"==typeof g.dependencies?g.dependencies():g.dependencies;for(const C of w)wu(C,t,e,i)}}else{if(!c)return!1;{if(null!=c.imports&&!_){let C;i.add(r);try{Vl(c.imports,L=>{wu(L,t,e,i)&&(C||(C=[]),C.push(L))})}finally{}void 0!==C&&gl(C,t)}if(!_){const C=hs(r)||(()=>new r);t.push({provide:r,useFactory:C,deps:xn},{provide:lo,useValue:r,multi:!0},{provide:$m,useValue:()=>$t(r),multi:!0})}const w=c.providers;null==w||_||Vl(w,L=>{t.push(L)})}}return r!==n&&void 0!==n.providers}const yb=Ur({provide:String,useValue:Ur});function Xm(n){return null!==n&&"object"==typeof n&&yb in n}function Dd(n){return"function"==typeof n}const Bc=new En("Set Injector scope."),Uc={},Lv={};let Ym;function ap(){return void 0===Ym&&(Ym=new Nv),Ym}class Do{}class op extends Do{constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Vc(t,g=>this.processProvider(g)),this.records.set(kh,Qo(void 0,this)),r.has("environment")&&this.records.set(Do,Qo(void 0,this));const c=this.records.get(Bc);null!=c&&"string"==typeof c.value&&this.scopes.add(c.value),this.injectorDefTypes=new Set(this.get(lo.multi,xn,gi.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=Hl(this),i=Rl(void 0);try{return t()}finally{Hl(e),Rl(i)}}get(t,e=Sh,i=gi.Default){this.assertNotDestroyed();const r=Hl(this),c=Rl(void 0);try{if(!(i&gi.SkipSelf)){let _=this.records.get(t);if(void 0===_){const w=function Bh(n){return"function"==typeof n||"object"==typeof n&&n instanceof En}(t)&&Pf(t);_=w&&this.injectableDefInScope(w)?Qo(Zu(t),Uc):null,this.records.set(t,_)}if(null!=_)return this.hydrate(t,_)}return(i&gi.Self?ap():this.parent).get(t,e=i&gi.Optional&&e===Sh?null:e)}catch(g){if("NullInjectorError"===g.name){if((g[Eh]=g[Eh]||[]).unshift(Vr(t)),r)throw g;return function cv(n,t,e,i){const r=n[Eh];throw t[Ch]&&r.unshift(t[Ch]),n.message=function d0(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Vr(t);if(Array.isArray(t))r=t.map(Vr).join(" -> ");else if("object"==typeof t){let c=[];for(let g in t)if(t.hasOwnProperty(g)){let _=t[g];c.push(g+":"+("string"==typeof _?JSON.stringify(_):Vr(_)))}r=`{${c.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(sb,"\n  ")}`}("\n"+n.message,r,e,i),n.ngTokenPath=r,n[Eh]=null,n}(g,t,"R3InjectorError",this.source)}throw g}finally{Rl(c),Hl(r)}}resolveInjectorInitializers(){const t=Hl(this),e=Rl(void 0);try{const i=this.get($m.multi,xn,gi.Self);for(const r of i)r()}finally{Hl(t),Rl(e)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(Vr(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new wt(205,!1)}processProvider(t){let e=Dd(t=Ti(t))?t:Ti(t&&t.provide);const i=function Md(n){return Xm(n)?Qo(void 0,n.useValue):Qo(function Au(n,t,e){let i;if(Dd(n)){const r=Ti(n);return hs(r)||Zu(r)}if(Xm(n))i=()=>Ti(n.useValue);else if(function sp(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...fn(n.deps||[]));else if(function Pv(n){return!(!n||!n.useExisting)}(n))i=()=>$t(Ti(n.useExisting));else{const r=Ti(n&&(n.useClass||n.provide));if(!function Fh(n){return!!n.deps}(n))return hs(r)||Zu(r);i=()=>new r(...fn(n.deps))}return i}(n),Uc)}(t);if(Dd(t)||!0!==t.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=Qo(void 0,Uc,!0),r.factory=()=>fn(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e){return e.value===Uc&&(e.value=Lv,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Id(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Ti(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Zu(n){const t=Pf(n),e=null!==t?t.factory:hs(n);if(null!==e)return e;if(n instanceof En)throw new wt(204,!1);if(n instanceof Function)return function vl(n){const t=n.length;if(t>0)throw Lc(t,"?"),new wt(204,!1);const e=function sm(n){const t=n&&(n[am]||n[B_]);if(t){const e=function Gg(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new wt(204,!1)}function Qo(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Uh(n){return!!n.\u0275providers}function Vc(n,t){for(const e of n)Array.isArray(e)?Vc(e,t):Uh(e)?Vc(e.\u0275providers,t):t(e)}class Hh{}class S0{resolveComponentFactory(t){throw function lp(n){const t=Error(`No component factory found for ${Vr(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let Nd=(()=>{class n{}return n.NULL=new S0,n})();function Fv(){return Pd(Os(),ft())}function Pd(n,t){return new Pr(zi(n,t))}let Pr=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=Fv,n})();function Qm(n){return n instanceof Pr?n.nativeElement:n}class Hc{}let C0=(()=>{class n{}return n.\u0275prov=kn({token:n,providedIn:"root",factory:()=>null}),n})();class Ju{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const D0=new Ju("14.2.1"),up={};function tg(n){return n.ngOriginalError}class uo{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&tg(t);for(;e&&tg(e);)e=tg(e);return e||null}}const ec=new Map;let Ko=0;const Wv="__ngContext__";function ka(n,t){Ga(t)?(n[Wv]=t[20],function fT(n){ec.set(n[20],n)}(t)):n[Wv]=t}function $h(n){const t=n[Wv];return"number"==typeof t?function wb(n){return ec.get(n)||null}(t):t||null}function $v(n){const t=$h(n);return t?Ga(t)?t:t.lView:null}function tc(n){return n.ownerDocument.defaultView}function Zo(n){return n instanceof Function?n():n}var co=(()=>((co=co||{})[co.Important=1]="Important",co[co.DashCase=2]="DashCase",co))();function mp(n,t){return undefined(n,t)}function Xh(n){const t=n[3];return ja(t)?t[3]:t}function Qv(n){return V0(n[13])}function vp(n){return V0(n[4])}function V0(n){for(;null!==n&&!ja(n);)n=n[4];return n}function Eu(n,t,e,i,r){if(null!=i){let c,g=!1;ja(i)?c=i:Ga(i)&&(g=!0,i=i[0]);const _=fs(i);0===n&&null!==e?null==r?jc(t,e,_):oc(t,e,_,r||null,!0):1===n&&null!==e?oc(t,e,_,r||null,!0):2===n?function lg(n,t,e){const i=Fa(n,t);i&&function Jh(n,t,e,i){n.removeChild(t,e,i)}(n,i,t,e)}(t,_,g):3===n&&t.destroyNode(_),null!=c&&function ti(n,t,e,i,r){const c=e[7];c!==fs(e)&&Eu(t,n,i,c,r);for(let _=10;_<e.length;_++){const w=e[_];Bd(w[1],w,n,t,i,c)}}(t,n,c,e,r)}}function sc(n,t,e){return n.createElement(t,e)}function H0(n,t){const e=n[9],i=e.indexOf(t),r=t[3];512&t[2]&&(t[2]&=-513,ro(r,-1)),e.splice(i,1)}function ts(n,t){if(n.length<=10)return;const e=10+t,i=n[e];if(i){const r=i[17];null!==r&&r!==n&&H0(r,i),t>0&&(n[e-1][4]=i[4]);const c=Kf(n,10+t);!function Gc(n,t){Bd(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(i[1],i);const g=c[19];null!==g&&g.detachView(c[1]),i[3]=null,i[4]=null,i[2]&=-65}return i}function el(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&Bd(n,t,e,3,null,null),function Kh(n){let t=n[13];if(!t)return Zh(n[1],n);for(;t;){let e=null;if(Ga(t))e=t[13];else{const i=t[10];i&&(e=i)}if(!e){for(;t&&!t[4]&&t!==n;)Ga(t)&&Zh(t[1],t),t=t[3];null===t&&(t=n),Ga(t)&&Zh(t[1],t),e=t&&t[4]}t=e}}(t)}}function Zh(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function _p(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const r=t[e[i]];if(!(r instanceof zf)){const c=e[i+1];if(Array.isArray(c))for(let g=0;g<c.length;g+=2){const _=r[c[g]],w=c[g+1];try{w.call(_)}finally{}}else try{c.call(r)}finally{}}}}(n,t),function rg(n,t){const e=n.cleanup,i=t[7];let r=-1;if(null!==e)for(let c=0;c<e.length-1;c+=2)if("string"==typeof e[c]){const g=e[c+1],_="function"==typeof g?g(t):fs(t[g]),w=i[r=e[c+2]],C=e[c+3];"boolean"==typeof C?_.removeEventListener(e[c],w,C):C>=0?i[r=C]():i[r=-C].unsubscribe(),c+=2}else{const g=i[r=e[c+1]];e[c].call(g)}if(null!==i){for(let c=r+1;c<i.length;c++)(0,i[c])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&ja(t[3])){e!==t[3]&&H0(e,t);const i=t[19];null!==i&&i.detachView(n)}!function O0(n){ec.delete(n[20])}(t)}}function ps(n,t,e){return function yp(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===no.None||r===no.Emulated)return null}return zi(i,e)}(n,t.parent,e)}function oc(n,t,e,i,r){n.insertBefore(t,e,i,r)}function jc(n,t,e){n.appendChild(t,e)}function sg(n,t,e,i,r){null!==i?oc(n,t,e,i,r):jc(n,t,e)}function Fa(n,t){return n.parentNode(t)}function Mo(n,t,e){return zc(n,t,e)}let zc=function Zv(n,t,e){return 40&n.type?zi(n,e):null};function Mr(n,t,e,i){const r=ps(n,i,t),c=t[11],_=Mo(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(e))for(let w=0;w<e.length;w++)sg(c,r,e[w],_,!1);else sg(c,r,e,_,!1)}function Io(n,t){if(null!==t){const e=t.type;if(3&e)return zi(t,n);if(4&e)return og(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return Io(n,i);{const r=n[t.index];return ja(r)?og(-1,r):fs(r)}}if(32&e)return mp(t,n)()||fs(n[t.index]);{const i=Cu(n,t);return null!==i?Array.isArray(i)?i[0]:Io(Xh(n[16]),i):Io(n,t.next)}}return null}function Cu(n,t){return null!==t?n[16][6].projection[t.projection]:null}function og(n,t){const e=10+n+1;if(e<t.length){const i=t[e],r=i[1].firstChild;if(null!==r)return Io(i,r)}return t[7]}function ef(n,t,e,i,r,c,g){for(;null!=e;){const _=i[e.index],w=e.type;if(g&&0===t&&(_&&ka(fs(_),i),e.flags|=4),64!=(64&e.flags))if(8&w)ef(n,t,e.child,i,r,c,!1),Eu(t,n,r,_,c);else if(32&w){const C=mp(e,i);let L;for(;L=C();)Eu(t,n,r,L,c);Eu(t,n,r,_,c)}else 16&w?ug(n,t,i,e,r,c):Eu(t,n,r,_,c);e=g?e.projectionNext:e.next}}function Bd(n,t,e,i,r,c){ef(e,i,n.firstChild,t,r,c,!1)}function ug(n,t,e,i,r,c){const g=e[16],w=g[6].projection[i.projection];if(Array.isArray(w))for(let C=0;C<w.length;C++)Eu(t,n,r,w[C],c);else ef(n,t,w,g[3],r,c,!0)}function Wc(n,t,e){n.setAttribute(t,"style",e)}function bp(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function Tp(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const c=t.length;if(r+c===i||n.charCodeAt(r+c)<=32)return r}e=r+1}}const Ud="ng-template";function cg(n,t,e){let i=0;for(;i<n.length;){let r=n[i++];if(e&&"class"===r){if(r=n[i],-1!==Tp(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function yl(n){return 4===n.type&&n.value!==Ud}function z0(n,t,e){return t===(4!==n.type||e?n.value:Ud)}function Mb(n,t,e){let i=4;const r=n.attrs||[],c=function Nb(n){for(let t=0;t<n.length;t++)if(Jg(n[t]))return t;return n.length}(r);let g=!1;for(let _=0;_<t.length;_++){const w=t[_];if("number"!=typeof w){if(!g)if(4&i){if(i=2|1&i,""!==w&&!z0(n,w,e)||""===w&&1===t.length){if(Wl(i))return!1;g=!0}}else{const C=8&i?w:t[++_];if(8&i&&null!==n.attrs){if(!cg(n.attrs,C,e)){if(Wl(i))return!1;g=!0}continue}const z=Ib(8&i?"class":w,r,yl(n),e);if(-1===z){if(Wl(i))return!1;g=!0;continue}if(""!==C){let J;J=z>c?"":r[z+1].toLowerCase();const ae=8&i?J:null;if(ae&&-1!==Tp(ae,C,0)||2&i&&C!==J){if(Wl(i))return!1;g=!0}}}}else{if(!g&&!Wl(i)&&!Wl(w))return!1;if(g&&Wl(w))continue;g=!1,i=w|1&i}}return Wl(i)||g}function Wl(n){return 0==(1&n)}function Ib(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let c=!1;for(;r<t.length;){const g=t[r];if(g===n)return r;if(3===g||6===g)c=!0;else{if(1===g||2===g){let _=t[++r];for(;"string"==typeof _;)_=t[++r];continue}if(4===g)break;if(0===g){r+=4;continue}}r+=c?1:2}return-1}return function lc(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function tf(n,t,e=!1){for(let i=0;i<t.length;i++)if(Mb(n,t[i],e))return!0;return!1}function Pb(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function nf(n,t){return n?":not("+t.trim()+")":t}function Du(n){let t=n[0],e=1,i=2,r="",c=!1;for(;e<n.length;){let g=n[e];if("string"==typeof g)if(2&i){const _=n[++e];r+="["+g+(_.length>0?'="'+_+'"':"")+"]"}else 8&i?r+="."+g:4&i&&(r+=" "+g);else""!==r&&!Wl(g)&&(t+=nf(c,r),r=""),i=g,c=c||!Wl(i);e++}return""!==r&&(t+=nf(c,r)),t}const ii={};function $l(n,t,e,i){if(!i)if(3==(3&t[2])){const c=n.preOrderCheckHooks;null!==c&&qu(t,c,e)}else{const c=n.preOrderHooks;null!==c&&Xu(t,c,0,e)}Fs(e)}function pa(n,t=null,e=null,i){const r=wp(n,t,e,i);return r.resolveInjectorInitializers(),r}function wp(n,t=null,e=null,i,r=new Set){const c=[e||xn,qm(n)];return i=i||("object"==typeof n?void 0:Vr(n)),new op(c,t||ap(),i||null,r)}let Ea=(()=>{class n{static create(e,i){if(Array.isArray(e))return pa({name:""},i,e,"");{const r=e.name??"";return pa({name:r},e.parent,e.providers,r)}}}return n.THROW_IF_NOT_FOUND=Sh,n.NULL=new Nv,n.\u0275prov=kn({token:n,providedIn:"any",factory:()=>$t(kh)}),n.__NG_ELEMENT_ID__=-1,n})();function ue(n,t=gi.Default){const e=ft();return null===e?$t(n,t):J_(Os(),e,Ti(n),t)}function At(){throw new Error("invalid")}function rt(n,t){return n<<17|t<<2}function et(n){return n>>17&32767}function lt(n){return 2|n}function St(n){return(131068&n)>>2}function st(n,t){return-131069&n|t<<2}function pn(n){return 1|n}function ey(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],c=e[i+1];if(-1!==c){const g=n.data[c];Xg(r),g.contentQueries(2,t[c],c)}}}function a(n,t,e,i,r,c,g,_,w,C,L){const z=t.blueprint.slice();return z[0]=r,z[2]=76|i,(null!==L||n&&1024&n[2])&&(z[2]|=1024),So(z),z[3]=z[15]=n,z[8]=e,z[10]=g||n&&n[10],z[11]=_||n&&n[11],z[12]=w||n&&n[12]||null,z[9]=C||n&&n[9]||null,z[6]=c,z[20]=function P0(){return Ko++}(),z[21]=L,z[16]=2==t.type?n[16]:z,z}function o(n,t,e,i,r){let c=n.data[t];if(null===c)c=function l(n,t,e,i,r){const c=ao(),g=Vf(),w=n.data[t]=function $(n,t,e,i,r,c){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?c:c&&c.parent,e,t,i,r);return null===n.firstChild&&(n.firstChild=w),null!==c&&(g?null==c.child&&null!==w.parent&&(c.child=w):null===c.next&&(c.next=w)),w}(n,t,e,i,r),function Ws(){return Fn.lFrame.inI18n}()&&(c.flags|=64);else if(64&c.type){c.type=e,c.value=i,c.attrs=r;const g=function hr(){const n=Fn.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();c.injectorIndex=null===g?-1:g.injectorIndex}return zs(c,!0),c}function p(n,t,e,i){if(0===e)return-1;const r=t.length;for(let c=0;c<e;c++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function v(n,t,e){ph(t);try{const i=n.viewQuery;null!==i&&Gt(1,i,e);const r=n.template;null!==r&&E(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&ey(n,t),n.staticViewQueries&&Gt(2,n.viewQuery,e);const c=n.components;null!==c&&function Dp(n,t){for(let e=0;e<t.length;e++)Zt(n,t[e])}(t,c)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[2]&=-5,_m()}}function y(n,t,e,i){const r=t[2];if(128!=(128&r)){ph(t);try{So(t),function qg(n){return Fn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&E(n,t,e,2,i);const g=3==(3&r);if(g){const C=n.preOrderCheckHooks;null!==C&&qu(t,C,null)}else{const C=n.preOrderHooks;null!==C&&Xu(t,C,0,null),Kg(t,0)}if(function Hi(n){for(let t=Qv(n);null!==t;t=vp(t)){if(!t[2])continue;const e=t[9];for(let i=0;i<e.length;i++){const r=e[i],c=r[3];0==(512&r[2])&&ro(c,1),r[2]|=512}}}(t),function ri(n){for(let t=Qv(n);null!==t;t=vp(t))for(let e=10;e<t.length;e++){const i=t[e],r=i[1];xo(i)&&y(r,i,r.template,i[8])}}(t),null!==n.contentQueries&&ey(n,t),g){const C=n.contentCheckHooks;null!==C&&qu(t,C)}else{const C=n.contentHooks;null!==C&&Xu(t,C,1),Kg(t,1)}!function J0(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Fs(~r);else{const c=r,g=e[++i],_=e[++i];ks(g,c),_(2,t[c])}}}finally{Fs(-1)}}(n,t);const _=n.components;null!==_&&function Cp(n,t){for(let e=0;e<t.length;e++)si(n,t[e])}(t,_);const w=n.viewQuery;if(null!==w&&Gt(2,w,i),g){const C=n.viewCheckHooks;null!==C&&qu(t,C)}else{const C=n.viewHooks;null!==C&&Xu(t,C,2),Kg(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,ro(t[3],-1))}finally{_m()}}}function x(n,t,e,i){const r=t[10],g=mm(t);try{!g&&r.begin&&r.begin(),g&&v(n,t,i),y(n,t,e,i)}finally{!g&&r.end&&r.end()}}function E(n,t,e,i,r){const c=$a(),g=2&i;try{Fs(-1),g&&t.length>22&&$l(n,t,22,!1),e(i,r)}finally{Fs(c)}}function k(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=U(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function U(n,t,e,i,r,c,g,_,w,C){const L=22+i,z=L+r,J=function G(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:ii);return e}(L,z),ae="function"==typeof C?C():C;return J[1]={type:n,blueprint:J,template:e,queries:null,viewQuery:_,declTNode:t,data:J.slice().fill(null,L),bindingStartIndex:L,expandoStartIndex:z,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:w,consts:ae,incompleteFirstPass:!1}}function ie(n,t,e,i){const r=Gn(t);null===e?r.push(i):(r.push(e),n.firstCreatePass&&mn(n).push(i,r.length-1))}function q(n,t,e){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(t,r):e[i]=[t,r]}return e}function Ae(n,t){const i=t.directiveEnd,r=n.data,c=t.attrs,g=[];let _=null,w=null;for(let C=t.directiveStart;C<i;C++){const L=r[C],z=L.inputs,J=null===c||yl(t)?null:is(z,c);g.push(J),_=q(z,C,_),w=q(L.outputs,C,w)}null!==_&&(_.hasOwnProperty("class")&&(t.flags|=16),_.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=g,t.inputs=_,t.outputs=w}function tt(n,t,e,i,r,c){const g=c.hostBindings;if(g){let _=n.hostBindingOpCodes;null===_&&(_=n.hostBindingOpCodes=[]);const w=~t.index;(function ut(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(_)!=w&&_.push(w),_.push(i,r,g)}}function Fe(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function at(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function xt(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;fl(t)&&(e[""]=n)}}function Ut(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function qt(n,t,e,i,r){n.data[i]=r;const c=r.factory||(r.factory=hs(r.type)),g=new zf(c,fl(r),ue);n.blueprint[i]=g,e[i]=g,tt(n,t,0,i,p(n,e,r.hostVars,ii),r)}function Qn(n,t,e){const i=zi(t,n),r=k(e),c=n[10],g=On(n,a(n,r,null,e.onPush?32:16,i,t,c,c.createRenderer(i,e),null,null,null));n[t.index]=g}function Un(n,t,e,i,r,c){const g=zi(n,t);!function ki(n,t,e,i,r,c,g){if(null==c)n.removeAttribute(t,r,e);else{const _=null==g?Mi(c):g(c,i||"",r);n.setAttribute(t,r,_,e)}}(t[11],g,c,n.value,e,i,r)}function mt(n,t,e,i,r,c){const g=c[t];if(null!==g){const _=i.setInput;for(let w=0;w<g.length;){const C=g[w++],L=g[w++],z=g[w++];null!==_?i.setInput(e,z,C,L):e[L]=z}}}function is(n,t){let e=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,n[r],t[i+1])),i+=2}else i+=2;else i+=4}return e}function si(n,t){const e=xa(t,n);if(xo(e)){const i=e[1];48&e[2]?y(i,e,i.template,e[8]):e[5]>0&&Vt(e)}}function Vt(n){for(let i=Qv(n);null!==i;i=vp(i))for(let r=10;r<i.length;r++){const c=i[r];if(xo(c))if(512&c[2]){const g=c[1];y(g,c,g.template,c[8])}else c[5]>0&&Vt(c)}const e=n[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=xa(e[i],n);xo(r)&&r[5]>0&&Vt(r)}}function Zt(n,t){const e=xa(t,n),i=e[1];(function un(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(i,e),v(i,e,e[8])}function On(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function Ve(n){for(;n;){n[2]|=32;const t=Xh(n);if(kf(n)&&!t)return n;n=t}return null}function Gt(n,t,e){Xg(0),t(n,e)}function Gn(n){return n[7]||(n[7]=[])}function mn(n){return n.cleanup||(n.cleanup=[])}function $n(n,t){const e=n[9],i=e?e.get(uo,null):null;i&&i.handleError(t)}function Si(n,t,e,i,r){for(let c=0;c<e.length;){const g=e[c++],_=e[c++],w=t[g],C=n.data[g];null!==C.setInput?C.setInput(w,r,i,_):w[_]=r}}function li(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,c=0;if(null!==t)for(let g=0;g<t.length;g++){const _=t[g];"number"==typeof _?c=_:1==c?r=tm(r,_):2==c&&(i=tm(i,_+": "+t[++g]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}function ar(n,t,e,i,r=!1){for(;null!==e;){const c=t[e.index];if(null!==c&&i.push(fs(c)),ja(c))for(let _=10;_<c.length;_++){const w=c[_],C=w[1].firstChild;null!==C&&ar(w[1],w,C,i)}const g=e.type;if(8&g)ar(n,t,e.child,i);else if(32&g){const _=mp(e,t);let w;for(;w=_();)i.push(w)}else if(16&g){const _=Cu(t,e);if(Array.isArray(_))i.push(..._);else{const w=Xh(t[16]);ar(w[1],w,_,i,!0)}}e=r?e.projectionNext:e.next}return i}class Bs{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return ar(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(ja(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(ts(t,i),Kf(e,i))}this._attachedToViewContainer=!1}el(this._lView[1],this._lView)}onDestroy(t){ie(this._lView[1],this._lView,null,t)}markForCheck(){Ve(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function me(n,t,e){const i=t[10];i.begin&&i.begin();try{y(n,t,n.template,e)}catch(r){throw $n(t,r),r}finally{i.end&&i.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new wt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Qh(n,t){Bd(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new wt(902,!1);this._appRef=t}}class nl extends Bs{constructor(t){super(t),this._view=t}detectChanges(){!function Et(n){!function _e(n){for(let t=0;t<n.components.length;t++){const e=n.components[t],i=$v(e);if(null!==i){const r=i[1];x(r,i,r.template,e)}}}(n[8])}(this._view)}checkNoChanges(){}get context(){return null}}class Ql extends Nd{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Tr(t);return new tr(e,this.ngModule)}}function No(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class $r{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){const r=this.injector.get(t,up,i);return r!==up||e===up?r:this.parentInjector.get(t,e,i)}}class tr extends Hh{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function uc(n){return n.map(Du).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return No(this.componentDef.inputs)}get outputs(){return No(this.componentDef.outputs)}create(t,e,i,r){let c=(r=r||this.ngModule)instanceof Do?r:r?.injector;c&&null!==this.componentDef.getStandaloneInjector&&(c=this.componentDef.getStandaloneInjector(c)||c);const g=c?new $r(t,c):t,_=g.get(Hc,null);if(null===_)throw new wt(407,!1);const w=g.get(C0,null),C=_.createRenderer(null,this.componentDef),L=this.componentDef.selectors[0][0]||"div",z=i?function re(n,t,e){return n.selectRootElement(t,e===no.ShadowDom)}(C,i,this.componentDef.encapsulation):sc(_.createRenderer(null,this.componentDef),L,function Al(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(L)),J=this.componentDef.onPush?288:272,ae={components:[]},we=U(0,null,null,1,0,null,null,null,null,null),Ee=a(null,we,ae,J,null,null,_,C,w,g,null);let He,Ye;ph(Ee);try{const ot=function ur(n,t,e,i,r,c){const g=e[1];e[22]=n;const w=o(g,22,2,"#host",null),C=w.mergedAttrs=t.hostAttrs;null!==C&&(li(w,C,!0),null!==n&&(vh(r,n,C),null!==w.classes&&bp(r,n,w.classes),null!==w.styles&&Wc(r,n,w.styles)));const L=i.createRenderer(n,t),z=a(e,k(t),null,t.onPush?32:16,e[22],w,i,L,c||null,null,null);return g.firstCreatePass&&(bh(ha(w,e),g,t.type),at(g,w),Ut(w,e.length,1)),On(e,z),e[22]=z}(z,this.componentDef,Ee,_,C);if(z)if(i)vh(C,z,["ng-version",D0.full]);else{const{attrs:Ke,classes:Ct}=function tl(n){const t=[],e=[];let i=1,r=2;for(;i<n.length;){let c=n[i];if("string"==typeof c)2===r?""!==c&&t.push(c,n[++i]):8===r&&e.push(c);else{if(!Wl(r))break;r=c}i++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);Ke&&vh(C,z,Ke),Ct&&Ct.length>0&&bp(C,z,Ct.join(" "))}if(Ye=ch(we,22),void 0!==e){const Ke=Ye.projection=[];for(let Ct=0;Ct<this.ngContentSelectors.length;Ct++){const _n=e[Ct];Ke.push(null!=_n?Array.from(_n):null)}}He=function Zl(n,t,e,i,r){const c=e[1],g=function ke(n,t,e){const i=Os();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),qt(n,i,t,p(n,t,1,null),e),Ae(n,i));const r=Xf(t,n,i.directiveStart,i);ka(r,t);const c=zi(i,t);return c&&ka(c,t),r}(c,e,t);if(i.components.push(g),n[8]=g,null!==r)for(const w of r)w(g,t);if(t.contentQueries){const w=Os();t.contentQueries(1,g,w.directiveStart)}const _=Os();return!c.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Fs(_.index),tt(e[1],_,0,_.directiveStart,_.directiveEnd,t),Fe(t,g)),g}(ot,this.componentDef,Ee,ae,[fc]),v(we,Ee,null)}finally{_m()}return new yg(this.componentType,He,Pd(Ye,Ee),Ee,Ye)}}class yg extends class Vh{}{constructor(t,e,i,r,c){super(),this.location=i,this._rootLView=r,this._tNode=c,this.instance=e,this.hostView=this.changeDetectorRef=new nl(r),this.componentType=t}setInput(t,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[t])){const c=this._rootLView;Si(c[1],c,r,t,e),function he(n,t){const e=xa(t,n);16&e[2]||(e[2]|=32)}(c,this._tNode.index)}}get injector(){return new Th(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function fc(){const n=Os();mh(ft()[1],n)}function Xe(n){let t=function be(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let r;if(fl(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new wt(903,!1);r=t.\u0275dir}if(r){if(e){i.push(r);const g=n;g.inputs=bt(n.inputs),g.declaredInputs=bt(n.declaredInputs),g.outputs=bt(n.outputs);const _=r.hostBindings;_&&Fi(n,_);const w=r.viewQuery,C=r.contentQueries;if(w&&vn(n,w),C&&Pi(n,C),Ug(n.inputs,r.inputs),Ug(n.declaredInputs,r.declaredInputs),Ug(n.outputs,r.outputs),fl(r)&&r.data.animation){const L=n.data;L.animation=(L.animation||[]).concat(r.data.animation)}}const c=r.features;if(c)for(let g=0;g<c.length;g++){const _=c[g];_&&_.ngInherit&&_(n),_===Xe&&(e=!1)}}t=Object.getPrototypeOf(t)}!function nt(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=vd(r.hostAttrs,e=vd(e,r.hostAttrs))}}(i)}function bt(n){return n===Go?{}:n===xn?[]:n}function vn(n,t){const e=n.viewQuery;n.viewQuery=e?(i,r)=>{t(i,r),e(i,r)}:t}function Pi(n,t){const e=n.contentQueries;n.contentQueries=e?(i,r,c)=>{t(i,r,c),e(i,r,c)}:t}function Fi(n,t){const e=n.hostBindings;n.hostBindings=e?(i,r)=>{t(i,r),e(i,r)}:t}let os=null;function fi(){if(!os){const n=Cr.Symbol;if(n&&n.iterator)os=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const i=t[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(os=i)}}}return os}function Ts(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function Ar(n,t,e,i){const r=ft();return Ts(r,pd(),t)&&(Vi(),Un(function es(){const n=Fn.lFrame;return ch(n.tView,n.selectedIndex)}(),r,n,t,e,i)),Ar}function bi(n,t,e,i,r){const g=r?"class":"style";Si(n,e,t.inputs[g],g,i)}function nn(n,t,e,i){const r=ft(),c=Vi(),g=22+n,_=r[11],w=r[g]=sc(_,t,function Uy(){return Fn.lFrame.currentNamespace}()),C=c.firstCreatePass?function ir(n,t,e,i,r,c,g){const _=t.consts,C=o(t,n,2,r,$o(_,c));return function Qe(n,t,e,i){let r=!1;if(zu()){const c=function je(n,t,e){const i=n.directiveRegistry;let r=null;if(i)for(let c=0;c<i.length;c++){const g=i[c];tf(e,g.selectors,!1)&&(r||(r=[]),bh(ha(e,t),n,g.type),fl(g)?(at(n,e),r.unshift(g)):r.push(g))}return r}(n,t,e),g=null===i?null:{"":-1};if(null!==c){r=!0,Ut(e,n.data.length,c.length);for(let L=0;L<c.length;L++){const z=c[L];z.providersResolver&&z.providersResolver(z)}let _=!1,w=!1,C=p(n,t,c.length,null);for(let L=0;L<c.length;L++){const z=c[L];e.mergedAttrs=vd(e.mergedAttrs,z.hostAttrs),qt(n,e,t,C,z),xt(C,z,g),null!==z.contentQueries&&(e.flags|=8),(null!==z.hostBindings||null!==z.hostAttrs||0!==z.hostVars)&&(e.flags|=128);const J=z.type.prototype;!_&&(J.ngOnChanges||J.ngOnInit||J.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),_=!0),!w&&(J.ngOnChanges||J.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),w=!0),C++}Ae(n,e)}g&&function Pt(n,t,e){if(t){const i=n.localNames=[];for(let r=0;r<t.length;r+=2){const c=e[t[r+1]];if(null==c)throw new wt(-301,!1);i.push(t[r],c)}}}(e,i,g)}return e.mergedAttrs=vd(e.mergedAttrs,e.attrs),r}(t,e,C,$o(_,g)),null!==C.attrs&&li(C,C.attrs,!1),null!==C.mergedAttrs&&li(C,C.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,C),C}(g,c,r,0,t,e,i):c.data[g];zs(C,!0);const L=C.mergedAttrs;null!==L&&vh(_,w,L);const z=C.classes;null!==z&&bp(_,w,z);const J=C.styles;return null!==J&&Wc(_,w,J),64!=(64&C.flags)&&Mr(c,r,w,C),0===function Rc(){return Fn.lFrame.elementDepthCount}()&&ka(w,r),function hh(){Fn.lFrame.elementDepthCount++}(),Hu(C)&&(function R(n,t,e){!zu()||(function Ze(n,t,e,i){const r=e.directiveStart,c=e.directiveEnd;n.firstCreatePass||ha(e,t),ka(i,t);const g=e.initialInputs;for(let _=r;_<c;_++){const w=n.data[_],C=fl(w);C&&Qn(t,e,w);const L=Xf(t,n,_,e);ka(L,t),null!==g&&mt(0,_-r,L,w,0,g),C&&(xa(e.index,t)[8]=L)}}(n,t,e,zi(e,t)),128==(128&e.flags)&&function Ce(n,t,e){const i=e.directiveStart,r=e.directiveEnd,c=e.index,g=function fh(){return Fn.lFrame.currentDirectiveIndex}();try{Fs(c);for(let _=i;_<r;_++){const w=n.data[_],C=t[_];$u(_),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&Fe(w,C)}}finally{Fs(-1),$u(g)}}(n,t,e))}(c,r,C),function I(n,t,e){if(ca(t)){const r=t.directiveEnd;for(let c=t.directiveStart;c<r;c++){const g=n.data[c];g.contentQueries&&g.contentQueries(1,e[c],c)}}}(c,C,r)),null!==i&&function F(n,t,e=zi){const i=t.localNames;if(null!==i){let r=t.index+1;for(let c=0;c<i.length;c+=2){const g=i[c+1],_=-1===g?e(t,n):n[g];n[r++]=_}}}(r,C),nn}function rn(){let n=Os();Vf()?Cs():(n=n.parent,zs(n,!1));const t=n;!function kl(){Fn.lFrame.elementDepthCount--}();const e=Vi();return e.firstCreatePass&&(mh(e,n),ca(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Gy(n){return 0!=(16&n.flags)}(t)&&bi(e,t,ft(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function jy(n){return 0!=(32&n.flags)}(t)&&bi(e,t,ft(),t.stylesWithoutHost,!1),rn}function qi(n,t,e,i){return nn(n,t,e,i),rn(),qi}function xr(n){return!!n&&"function"==typeof n.then}const po=function Ms(n){return!!n&&"function"==typeof n.subscribe};function ji(n,t,e,i){const r=ft(),c=Vi(),g=Os();return function pf(n,t,e,i,r,c,g,_){const w=Hu(i),L=n.firstCreatePass&&mn(n),z=t[8],J=Gn(t);let ae=!0;if(3&i.type||_){const He=zi(i,t),Ye=_?_(He):He,ot=J.length,Ke=_?_n=>_(fs(_n[i.index])):i.index;let Ct=null;if(!_&&w&&(Ct=function Np(n,t,e,i){const r=n.cleanup;if(null!=r)for(let c=0;c<r.length-1;c+=2){const g=r[c];if(g===e&&r[c+1]===i){const _=t[7],w=r[c+2];return _.length>w?_[w]:null}"string"==typeof g&&(c+=2)}return null}(n,t,r,i.index)),null!==Ct)(Ct.__ngLastListenerFn__||Ct).__ngNextListenerFn__=c,Ct.__ngLastListenerFn__=c,ae=!1;else{c=gf(i,t,z,c,!1);const _n=e.listen(Ye,r,c);J.push(c,_n),L&&L.push(r,Ke,ot,ot+1)}}else c=gf(i,t,z,c,!1);const we=i.outputs;let Ee;if(ae&&null!==we&&(Ee=we[r])){const He=Ee.length;if(He)for(let Ye=0;Ye<He;Ye+=2){const Ln=t[Ee[Ye]][Ee[Ye+1]].subscribe(c),Ei=J.length;J.push(c,Ln),L&&L.push(r,i.index,Ei,-(Ei+1))}}}(c,r,r[11],g,n,t,0,i),ji}function mf(n,t,e,i){try{return!1!==e(i)}catch(r){return $n(n,r),!1}}function gf(n,t,e,i,r){return function c(g){if(g===Function)return i;Ve(2&n.flags?xa(n.index,t):t);let w=mf(t,0,i,g),C=c.__ngNextListenerFn__;for(;C;)w=mf(t,0,C,g)&&w,C=C.__ngNextListenerFn__;return r&&!1===w&&(g.preventDefault(),g.returnValue=!1),w}}function Pp(n,t){let e=null;const i=function Rb(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let r=0;r<t.length;r++){const c=t[r];if("*"!==c){if(null===i?tf(n,c,!0):Pb(i,c))return r}else e=r}return e}function qc(n){const t=ft()[16][6];if(!t.projection){const i=t.projection=Lc(n?n.length:1,null),r=i.slice();let c=t.child;for(;null!==c;){const g=n?Pp(c,n):0;null!==g&&(r[g]?r[g].projectionNext=c:i[g]=c,r[g]=c),c=c.next}}}function ee(n,t=0,e){const i=ft(),r=Vi(),c=o(r,22+n,16,null,e||null);null===c.projection&&(c.projection=t),Cs(),64!=(64&c.flags)&&function G0(n,t,e){ug(t[11],0,t,e,ps(n,e,t),Mo(e.parent||t[6],e,t))}(r,i,c)}function Mn(n,t,e,i,r){const c=n[e+1],g=null===t;let _=i?et(c):St(c),w=!1;for(;0!==_&&(!1===w||g);){const L=n[_+1];en(n[_],t)&&(w=!0,n[_+1]=i?pn(L):lt(L)),_=i?et(L):St(L)}w&&(n[e+1]=i?lt(c):pn(c))}function en(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&kc(n,t)>=0}const Nn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Ca(n){return n.substring(Nn.key,Nn.keyEnd)}function ty(n,t){const e=Nn.textEnd;return e===t?-1:(t=Nn.keyEnd=function yT(n,t,e){for(;t<e&&n.charCodeAt(t)>32;)t++;return t}(n,Nn.key=t,e),vf(n,t,e))}function vf(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function ga(n,t){return function qd(n,t,e,i){const r=ft(),c=Vi(),g=Bl(2);c.firstUpdatePass&&kE(c,n,g,i),t!==ii&&Ts(r,g,t)&&BE(c,c.data[$a()],r,r[11],n,r[g+1]=function h2(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Vr(Qa(n)))),n}(t,e),i,g)}(n,t,null,!0),ga}function a_(n){!function Xd(n,t,e,i){const r=Vi(),c=Bl(2);r.firstUpdatePass&&kE(r,null,c,i);const g=ft();if(e!==ii&&Ts(g,c,e)){const _=r.data[$a()];if(VE(_,i)&&!LE(r,c)){let w=i?_.classesWithoutHost:_.stylesWithoutHost;null!==w&&(e=tm(w,e||"")),bi(r,_,g,e,i)}else!function d2(n,t,e,i,r,c,g,_){r===ii&&(r=xn);let w=0,C=0,L=0<r.length?r[0]:null,z=0<c.length?c[0]:null;for(;null!==L||null!==z;){const J=w<r.length?r[w+1]:void 0,ae=C<c.length?c[C+1]:void 0;let Ee,we=null;L===z?(w+=2,C+=2,J!==ae&&(we=z,Ee=ae)):null===z||null!==L&&L<z?(w+=2,we=L):(C+=2,we=z,Ee=ae),null!==we&&BE(n,t,e,i,we,Ee,g,_),L=w<r.length?r[w]:null,z=C<c.length?c[C]:null}}(r,_,g,g[11],g[c+1],g[c+1]=function c2(n,t,e){if(null==e||""===e)return xn;const i=[],r=Qa(e);if(Array.isArray(r))for(let c=0;c<r.length;c++)n(i,r[c],!0);else if("object"==typeof r)for(const c in r)r.hasOwnProperty(c)&&n(i,c,r[c]);else"string"==typeof r&&t(i,r);return i}(n,t,e),i,c)}}(Xa,yf,n,!0)}function yf(n,t){for(let e=function Op(n){return function Hb(n){Nn.key=0,Nn.keyEnd=0,Nn.value=0,Nn.valueEnd=0,Nn.textEnd=n.length}(n),ty(n,vf(n,0,Nn.textEnd))}(t);e>=0;e=ty(t,e))Xa(n,Ca(t),!0)}function LE(n,t){return t>=n.expandoStartIndex}function kE(n,t,e,i){const r=n.data;if(null===r[e+1]){const c=r[$a()],g=LE(n,e);VE(c,i)&&null===t&&!g&&(t=!1),t=function a2(n,t,e,i){const r=function Ul(n){const t=Fn.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let c=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(e=jb(e=TA(null,n,t,e,i),t.attrs,i),c=null);else{const g=t.directiveStylingLast;if(-1===g||n[g]!==r)if(e=TA(r,n,t,e,i),null===c){let w=function o2(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==St(i))return n[et(i)]}(n,t,i);void 0!==w&&Array.isArray(w)&&(w=TA(null,n,t,w[1],i),w=jb(w,t.attrs,i),function l2(n,t,e,i){n[et(e?t.classBindings:t.styleBindings)]=i}(n,t,i,w))}else c=function u2(n,t,e){let i;const r=t.directiveEnd;for(let c=1+t.directiveStylingLast;c<r;c++)i=jb(i,n[c].hostAttrs,e);return jb(i,t.attrs,e)}(n,t,i)}return void 0!==c&&(i?t.residualClasses=c:t.residualStyles=c),e}(r,c,t,i),function ct(n,t,e,i,r,c){let g=c?t.classBindings:t.styleBindings,_=et(g),w=St(g);n[i]=e;let L,C=!1;if(Array.isArray(e)){const z=e;L=z[1],(null===L||kc(z,L)>0)&&(C=!0)}else L=e;if(r)if(0!==w){const J=et(n[_+1]);n[i+1]=rt(J,_),0!==J&&(n[J+1]=st(n[J+1],i)),n[_+1]=function pt(n,t){return 131071&n|t<<17}(n[_+1],i)}else n[i+1]=rt(_,0),0!==_&&(n[_+1]=st(n[_+1],i)),_=i;else n[i+1]=rt(w,0),0===_?_=i:n[w+1]=st(n[w+1],i),w=i;C&&(n[i+1]=lt(n[i+1])),Mn(n,L,i,!0),Mn(n,L,i,!1),function cn(n,t,e,i,r){const c=r?n.residualClasses:n.residualStyles;null!=c&&"string"==typeof t&&kc(c,t)>=0&&(e[i+1]=pn(e[i+1]))}(t,L,n,i,c),g=rt(_,w),c?t.classBindings=g:t.styleBindings=g}(r,c,t,e,g,i)}}function TA(n,t,e,i,r){let c=null;const g=e.directiveEnd;let _=e.directiveStylingLast;for(-1===_?_=e.directiveStart:_++;_<g&&(c=t[_],i=jb(i,c.hostAttrs,r),c!==n);)_++;return null!==n&&(e.directiveStylingLast=_),i}function jb(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let c=0;c<t.length;c++){const g=t[c];"number"==typeof g?r=g:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Xa(n,g,!!e||t[++c]))}return void 0===n?null:n}function BE(n,t,e,i,r,c,g,_){if(!(3&t.type))return;const w=n.data,C=w[_+1];bT(function Wn(n){return 1==(1&n)}(C)?UE(w,t,e,r,St(C),g):void 0)||(bT(c)||function Ft(n){return 2==(2&n)}(C)&&(c=UE(w,null,e,r,_,g)),function ho(n,t,e,i,r){if(t)r?n.addClass(e,i):n.removeClass(e,i);else{let c=-1===i.indexOf("-")?void 0:co.DashCase;null==r?n.removeStyle(e,i,c):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),c|=co.Important),n.setStyle(e,i,r,c))}}(i,g,Ic($a(),e),r,c))}function UE(n,t,e,i,r,c){const g=null===t;let _;for(;r>0;){const w=n[r],C=Array.isArray(w),L=C?w[1]:w,z=null===L;let J=e[r+1];J===ii&&(J=z?xn:void 0);let ae=z?Sm(J,i):L===i?J:void 0;if(C&&!bT(ae)&&(ae=Sm(w,i)),bT(ae)&&(_=ae,g))return _;const we=n[r+1];r=g?et(we):St(we)}if(null!==t){let w=c?t.residualClasses:t.residualStyles;null!=w&&(_=Sm(w,i))}return _}function bT(n){return void 0!==n}function VE(n,t){return 0!=(n.flags&(t?16:32))}function al(n,t=""){const e=ft(),i=Vi(),r=n+22,c=i.firstCreatePass?o(i,r,1,t,null):i.data[r],g=e[r]=function rc(n,t){return n.createText(t)}(e[11],t);Mr(i,e,g,c),zs(c,!1)}function ny(n,t,e){const i=ft(),r=function lf(n,t,e,i){return Ts(n,pd(),e)?t+Mi(e)+i:ii}(i,n,t,e);return r!==ii&&function Cn(n,t,e){const i=Ic(t,n);!function Yh(n,t,e){n.setValue(t,e)}(n[11],i,e)}(i,$a(),r),ny}const sy="en-US";let lC=sy;class l_{}class OC{}class LC extends l_{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ql(this);const i=Js(t);this._bootstrapComponents=Zo(i.bootstrap),this._r3Injector=wp(t,e,[{provide:l_,useValue:this},{provide:Nd,useValue:this.componentFactoryResolver}],Vr(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class MA extends OC{constructor(t){super(),this.moduleType=t}create(t){return new LC(this.moduleType,t)}}class IL extends l_{constructor(t,e,i){super(),this.componentFactoryResolver=new Ql(this),this.instance=null;const r=new op([...t,{provide:l_,useValue:this},{provide:Nd,useValue:this.componentFactoryResolver}],e||ap(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function ST(n,t,e=null){return new IL(n,t,e).injector}let RL=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const i=x0(0,e.type),r=i.length>0?ST([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,r)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=kn({token:n,providedIn:"environment",factory:()=>new n($t(Do))}),n})();function kC(n){n.getStandaloneInjector=t=>t.get(RL).getOrCreateStandaloneInjector(n)}function jC(n,t,e,i,r,c){const g=t+e;return Ts(n,g,r)?function Qi(n,t,e){return n[t]=e}(n,g+1,c?i.call(c,r):i(r)):function Yb(n,t){const e=n[t];return e===ii?void 0:e}(n,g+1)}function YC(n,t,e){const i=n+22,r=ft(),c=function dh(n,t){return n[t]}(r,i);return function Qb(n,t){return n[1].data[t].pure}(r,i)?jC(r,function Ls(){const n=Fn.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}(),t,c.transform,e,c):c.transform(e)}function NA(n){return t=>{setTimeout(n,void 0,t)}}const Ki=class ZL extends Yt{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let r=t,c=e||(()=>null),g=i;if(t&&"object"==typeof t){const w=t;r=w.next?.bind(w),c=w.error?.bind(w),g=w.complete?.bind(w)}this.__isAsync&&(c=NA(c),r&&(r=NA(r)),g&&(g=NA(g)));const _=super.subscribe({next:r,error:c,complete:g});return t instanceof Mt&&t.add(_),_}};function JL(){return this._results[fi()]()}class PA{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=fi(),i=PA.prototype;i[e]||(i[e]=JL)}get changes(){return this._changes||(this._changes=new Ki)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const r=qo(t);(this._changesDetected=!function sv(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],c=t[i];if(e&&(r=e(r),c=e(c)),c!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ma=(()=>{class n{}return n.__NG_ELEMENT_ID__=nk,n})();const ek=Ma,tk=class extends ek{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t,e){const i=this._declarationTContainer.tViews,r=a(this._declarationLView,i,t,16,null,i.declTNode,null,null,null,null,e||null);r[17]=this._declarationLView[this._declarationTContainer.index];const g=this._declarationLView[19];return null!==g&&(r[19]=g.createEmbeddedView(i)),v(i,r,t),new Bs(r)}};function nk(){return CT(Os(),ft())}function CT(n,t){return 4&n.type?new tk(t,n,Pd(n,t)):null}let Yd=(()=>{class n{}return n.__NG_ELEMENT_ID__=ik,n})();function ik(){return ZC(Os(),ft())}const rk=Yd,QC=class extends rk{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return Pd(this._hostTNode,this._hostLView)}get injector(){return new Th(this._hostTNode,this._hostLView)}get parentInjector(){const t=gu(this._hostTNode,this._hostLView);if(ev(t)){const e=yd(t,this._hostLView),i=_d(t);return new Th(e[1].data[i+8],e)}return new Th(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=KC(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,i){let r,c;"number"==typeof i?r=i:null!=i&&(r=i.index,c=i.injector);const g=t.createEmbeddedView(e||{},c);return this.insert(g,r),g}createComponent(t,e,i,r,c){const g=t&&!function _u(n){return"function"==typeof n}(t);let _;if(g)_=e;else{const z=e||{};_=z.index,i=z.injector,r=z.projectableNodes,c=z.environmentInjector||z.ngModuleRef}const w=g?t:new tr(Tr(t)),C=i||this.parentInjector;if(!c&&null==w.ngModule){const J=(g?C:this.parentInjector).get(Do,null);J&&(c=J)}const L=w.create(C,r,void 0,c);return this.insert(L.hostView,_),L}insert(t,e){const i=t._lView,r=i[1];if(function gm(n){return ja(n[3])}(i)){const L=this.indexOf(t);if(-1!==L)this.detach(L);else{const z=i[3],J=new QC(z,z[6],z[3]);J.detach(J.indexOf(t))}}const c=this._adjustIndex(e),g=this._lContainer;!function zl(n,t,e,i){const r=10+i,c=e.length;i>0&&(e[r-1][4]=t),i<c-10?(t[4]=e[r],s0(e,10+i,t)):(e.push(t),t[4]=null),t[3]=e;const g=t[17];null!==g&&e!==g&&function Fd(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(g,t);const _=t[19];null!==_&&_.insertView(n),t[2]|=64}(r,i,g,c);const _=og(c,g),w=i[11],C=Fa(w,g[7]);return null!==C&&function ac(n,t,e,i,r,c){i[0]=r,i[6]=t,Bd(n,i,e,1,r,c)}(r,g[6],w,i,C,_),t.attachToViewContainerRef(),s0(OA(g),c,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=KC(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=ts(this._lContainer,e);i&&(Kf(OA(this._lContainer),e),el(i[1],i))}detach(t){const e=this._adjustIndex(t,-1),i=ts(this._lContainer,e);return i&&null!=Kf(OA(this._lContainer),e)?new Bs(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function KC(n){return n[8]}function OA(n){return n[8]||(n[8]=[])}function ZC(n,t){let e;const i=t[n.index];if(ja(i))e=i;else{let r;if(8&n.type)r=fs(i);else{const c=t[11];r=c.createComment("");const g=zi(n,t);oc(c,Fa(c,g),r,function Ds(n,t){return n.nextSibling(t)}(c,g),!1)}t[n.index]=e=function Ni(n,t,e,i){return new Array(n,!0,!1,t,null,0,i,e,null,null)}(i,t,r,n),On(t,e)}return new QC(e,n,t)}class LA{constructor(t){this.queryList=t,this.matches=null}clone(){return new LA(this.queryList)}setDirty(){this.queryList.setDirty()}}class kA{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let c=0;c<i;c++){const g=e.getByIndex(c);r.push(this.queries[g.indexInDeclarationView].clone())}return new kA(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==iD(t,e).matches&&this.queries[e].setDirty()}}class JC{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class FA{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,c=this.getByIndex(i).embeddedTView(t,r);c&&(c.indexInDeclarationView=i,null!==e?e.push(c):e=[c])}return null!==e?new FA(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class BA{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new BA(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const c=i[r];this.matchTNodeWithReadOption(t,e,ok(e,c)),this.matchTNodeWithReadOption(t,e,qf(e,t,c,!1,!1))}else i===Ma?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,qf(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Pr||r===Yd||r===Ma&&4&e.type)this.addMatch(e.index,-2);else{const c=qf(e,t,r,!1,!1);null!==c&&this.addMatch(e.index,c)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function ok(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function uk(n,t,e,i){return-1===e?function lk(n,t){return 11&n.type?Pd(n,t):4&n.type?CT(n,t):null}(t,n):-2===e?function ck(n,t,e){return e===Pr?Pd(t,n):e===Ma?CT(t,n):e===Yd?ZC(t,n):void 0}(n,t,i):Xf(n,n[1],e,t)}function eD(n,t,e,i){const r=t[19].queries[i];if(null===r.matches){const c=n.data,g=e.matches,_=[];for(let w=0;w<g.length;w+=2){const C=g[w];_.push(C<0?null:uk(t,c[C],g[w+1],e.metadata.read))}r.matches=_}return r.matches}function UA(n,t,e,i){const r=n.queries.getByIndex(e),c=r.matches;if(null!==c){const g=eD(n,t,r,e);for(let _=0;_<c.length;_+=2){const w=c[_];if(w>0)i.push(g[_/2]);else{const C=c[_+1],L=t[-w];for(let z=10;z<L.length;z++){const J=L[z];J[17]===J[3]&&UA(J[1],J,C,i)}if(null!==L[9]){const z=L[9];for(let J=0;J<z.length;J++){const ae=z[J];UA(ae[1],ae,C,i)}}}}}return i}function Xs(n){const t=ft(),e=Vi(),i=Rr();Xg(i+1);const r=iD(e,i);if(n.dirty&&mm(t)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const c=r.crossesNgTemplate?UA(e,t,i,[]):eD(e,t,r,i);n.reset(c,Qm),n.notifyOnChanges()}return!0}return!1}function DT(n,t,e){const i=Vi();i.firstCreatePass&&(nD(i,new JC(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),tD(i,ft(),t)}function Ys(){return function dk(n,t){return n[19].queries[t].queryList}(ft(),Rr())}function tD(n,t,e){const i=new PA(4==(4&e));ie(n,t,i,i.destroy),null===t[19]&&(t[19]=new kA),t[19].queries.push(new LA(i))}function nD(n,t,e){null===n.queries&&(n.queries=new FA),n.queries.track(new BA(t,e))}function iD(n,t){return n.queries.getByIndex(t)}function IT(...n){}const RT=new En("Application Initializer");let NT=(()=>{class n{constructor(e){this.appInits=e,this.resolve=IT,this.reject=IT,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const c=this.appInits[r]();if(xr(c))e.push(c);else if(po(c)){const g=new Promise((_,w)=>{c.subscribe({complete:_,error:w})});e.push(g)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)($t(RT,8))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Zb=new En("AppId",{providedIn:"root",factory:function wD(){return`${zA()}${zA()}${zA()}`}});function zA(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const AD=new En("Platform Initializer"),PT=new En("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),xD=new En("appBootstrapListener"),SD=new En("AnimationModuleType");let Nk=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const bf=new En("LocaleId",{providedIn:"root",factory:()=>Bn(bf,gi.Optional|gi.SkipSelf)||function Pk(){return typeof $localize<"u"&&$localize.locale||sy}()});class Lk{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let WA=(()=>{class n{compileModuleSync(e){return new MA(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const i=this.compileModuleSync(e),c=Zo(Js(e).declarations).reduce((g,_)=>{const w=Tr(_);return w&&g.push(new tr(w)),g},[]);return new Lk(i,c)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Bk=(()=>Promise.resolve(0))();function $A(n){typeof Zone>"u"?Bk.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class vs{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ki(!1),this.onMicrotaskEmpty=new Ki(!1),this.onStable=new Ki(!1),this.onError=new Ki(!1),typeof Zone>"u")throw new wt(908,!1);Zone.assertZonePatched();const r=this;if(r._nesting=0,r._outer=r._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const c=Zone.AsyncStackTaggingZoneSpec;r._inner=r._inner.fork(new c("Angular"))}Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function Uk(){let n=Cr.requestAnimationFrame,t=Cr.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Gk(n){const t=()=>{!function Hk(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Cr,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,XA(n),n.isCheckStableRunning=!0,qA(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),XA(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,c,g,_)=>{try{return DD(n),e.invokeTask(r,c,g,_)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||n.shouldCoalesceRunChangeDetection)&&t(),MD(n)}},onInvoke:(e,i,r,c,g,_,w)=>{try{return DD(n),e.invoke(r,c,g,_,w)}finally{n.shouldCoalesceRunChangeDetection&&t(),MD(n)}},onHasTask:(e,i,r,c)=>{e.hasTask(r,c),i===r&&("microTask"==c.change?(n._hasPendingMicrotasks=c.microTask,XA(n),qA(n)):"macroTask"==c.change&&(n.hasPendingMacrotasks=c.macroTask))},onHandleError:(e,i,r,c)=>(e.handleError(r,c),n.runOutsideAngular(()=>n.onError.emit(c)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vs.isInAngularZone())throw new wt(909,!1)}static assertNotInAngularZone(){if(vs.isInAngularZone())throw new wt(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const c=this._inner,g=c.scheduleEventTask("NgZoneEvent: "+r,t,Vk,IT,IT);try{return c.runTask(g,e,i)}finally{c.cancelTask(g)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const Vk={};function qA(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function XA(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function DD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function MD(n){n._nesting--,qA(n)}class jk{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ki,this.onMicrotaskEmpty=new Ki,this.onStable=new Ki,this.onError=new Ki}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}const ID=new En(""),OT=new En("");let KA,YA=(()=>{class n{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,KA||(function zk(n){KA=n}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vs.assertNotInAngularZone(),$A(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())$A(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let c=-1;i&&i>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==c),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:c,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}}return n.\u0275fac=function(e){return new(e||n)($t(vs),$t(QA),$t(OT))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})(),QA=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return KA?.findTestabilityInTree(this,e,i)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),Tg=null;const RD=new En("AllowMultipleToken"),ZA=new En("PlatformDestroyListeners");class ND{constructor(t,e){this.name=t,this.token=e}}function OD(n,t,e=[]){const i=`Platform: ${t}`,r=new En(i);return(c=[])=>{let g=JA();if(!g||g.injector.get(RD,!1)){const _=[...e,...c,{provide:r,useValue:!0}];n?n(_):function qk(n){if(Tg&&!Tg.get(RD,!1))throw new wt(400,!1);Tg=n;const t=n.get(kD);(function PD(n){const t=n.get(AD,null);t&&t.forEach(e=>e())})(n)}(function LD(n=[],t){return Ea.create({name:t,providers:[{provide:Bc,useValue:"platform"},{provide:ZA,useValue:new Set([()=>Tg=null])},...n]})}(_,i))}return function Yk(n){const t=JA();if(!t)throw new wt(401,!1);return t}()}}function JA(){return Tg?.get(kD)??null}let kD=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function BD(n,t){let e;return e="noop"===n?new jk:("zone.js"===n?void 0:n)||new vs(t),e}(i?.ngZone,function FD(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),c=[{provide:vs,useValue:r}];return r.run(()=>{const g=Ea.create({providers:c,parent:this.injector,name:e.moduleType.name}),_=e.create(g),w=_.injector.get(uo,null);if(!w)throw new wt(402,!1);return r.runOutsideAngular(()=>{const C=r.onError.subscribe({next:L=>{w.handleError(L)}});_.onDestroy(()=>{LT(this._modules,_),C.unsubscribe()})}),function UD(n,t,e){try{const i=e();return xr(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(w,r,()=>{const C=_.injector.get(NT);return C.runInitializers(),C.donePromise.then(()=>(function uC(n){Vo(n,"Expected localeId to be defined"),"string"==typeof n&&(lC=n.toLowerCase().replace(/_/g,"-"))}(_.injector.get(bf,sy)||sy),this._moduleDoBootstrap(_),_))})})}bootstrapModule(e,i=[]){const r=VD({},i);return function Wk(n,t,e){const i=new MA(e);return Promise.resolve(i)}(0,0,e).then(c=>this.bootstrapModuleFactory(c,r))}_moduleDoBootstrap(e){const i=e.injector.get(uy);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new wt(403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new wt(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(ZA,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)($t(Ea))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function VD(n,t){return Array.isArray(t)?t.reduce(VD,n):{...n,...t}}let uy=(()=>{class n{constructor(e,i,r){this._zone=e,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const c=new jt(_=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{_.next(this._stable),_.complete()})}),g=new jt(_=>{let w;this._zone.runOutsideAngular(()=>{w=this._zone.onStable.subscribe(()=>{vs.assertNotInAngularZone(),$A(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,_.next(!0))})})});const C=this._zone.onUnstable.subscribe(()=>{vs.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{_.next(!1)}))});return()=>{w.unsubscribe(),C.unsubscribe()}});this.isStable=function k_(...n){const t=Bo(n),e=function If(n,t){return"number"==typeof sd(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?Re(i[0]):bo(e)(Gs(i,t)):Qr}(c,g.pipe(function Bg(n={}){const{connector:t=(()=>new Yt),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return c=>{let g,_,w,C=0,L=!1,z=!1;const J=()=>{_?.unsubscribe(),_=void 0},ae=()=>{J(),g=w=void 0,L=z=!1},we=()=>{const Ee=g;ae(),Ee?.unsubscribe()};return Dn((Ee,He)=>{C++,!z&&!L&&J();const Ye=w=w??t();He.add(()=>{C--,0===C&&!z&&!L&&(_=em(we,r))}),Ye.subscribe(He),!g&&C>0&&(g=new Yn({next:ot=>Ye.next(ot),error:ot=>{z=!0,J(),_=em(ae,e,ot),Ye.error(ot)},complete:()=>{L=!0,J(),_=em(ae,i),Ye.complete()}}),Re(Ee).subscribe(g))})(c)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof Hh;if(!this._injector.get(NT).done)throw!r&&function jo(n){const t=Tr(n)||Ss(n)||lr(n);return null!==t&&t.standalone}(e),new wt(405,false);let g;g=r?e:this._injector.get(Nd).resolveComponentFactory(e),this.componentTypes.push(g.componentType);const _=function $k(n){return n.isBoundToModule}(g)?void 0:this._injector.get(l_),C=g.create(Ea.NULL,[],i||g.selector,_),L=C.location.nativeElement,z=C.injector.get(ID,null);return z?.registerApplication(L),C.onDestroy(()=>{this.detachView(C.hostView),LT(this.components,C),z?.unregisterApplication(L)}),this._loadComponent(C),C}tick(){if(this._runningTick)throw new wt(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;LT(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(xD,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>LT(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new wt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)($t(vs),$t(Do),$t(uo))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function LT(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let GD=!0,Bp=(()=>{class n{}return n.__NG_ELEMENT_ID__=Zk,n})();function Zk(n){return function Jk(n,t,e){if(Vu(n)&&!e){const i=xa(n.index,t);return new Bs(i,i)}return 47&n.type?new Bs(t[16],t):null}(Os(),ft(),16==(16&n))}const hF=OD(null,"core",[]);let fF=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)($t(uy))},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})();function Up(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function rx(n,t){const e=Tr(n),i=t.elementInjector||ap();return new tr(e).create(i,t.projectableNodes,t.hostElement,t.environmentInjector)}let UT=null;function Tf(){return UT}const ls=new En("DocumentToken");let sx=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:function(){return function vF(){return $t(JD)}()},providedIn:"platform"}),n})();const _F=new En("Location Initialized");let JD=(()=>{class n extends sx{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Tf().getBaseHref(this._doc)}onPopState(e){const i=Tf().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=Tf().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,i,r){eM()?this._history.pushState(e,i,r):this.location.hash=r}replaceState(e,i,r){eM()?this._history.replaceState(e,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)($t(ls))},n.\u0275prov=kn({token:n,factory:function(){return function yF(){return new JD($t(ls))}()},providedIn:"platform"}),n})();function eM(){return!!window.history.pushState}function ax(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function tM(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Vp(n){return n&&"?"!==n[0]?"?"+n:n}let c_=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:function(){return Bn(iM)},providedIn:"root"}),n})();const nM=new En("appBaseHref");let iM=(()=>{class n extends c_{constructor(e,i){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Bn(ls).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return ax(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+Vp(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${i}${r}`:i}pushState(e,i,r,c){const g=this.prepareExternalUrl(r+Vp(c));this._platformLocation.pushState(e,i,g)}replaceState(e,i,r,c){const g=this.prepareExternalUrl(r+Vp(c));this._platformLocation.replaceState(e,i,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)($t(sx),$t(nM,8))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),bF=(()=>{class n extends c_{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=ax(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,r,c){let g=this.prepareExternalUrl(r+Vp(c));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.pushState(e,i,g)}replaceState(e,i,r,c){let g=this.prepareExternalUrl(r+Vp(c));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)($t(sx),$t(nM,8))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})(),ox=(()=>{class n{constructor(e){this._subject=new Ki,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._baseHref=tM(rM(i)),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+Vp(i))}normalize(e){return n.stripTrailingSlash(function wF(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,rM(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",r=null){this._locationStrategy.pushState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Vp(i)),r)}replaceState(e,i="",r=null){this._locationStrategy.replaceState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Vp(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(r=>r(e,i))}subscribe(e,i,r){return this._subject.subscribe({next:e,error:i,complete:r})}}return n.normalizeQueryParams=Vp,n.joinWithSlash=ax,n.stripTrailingSlash=tM,n.\u0275fac=function(e){return new(e||n)($t(c_))},n.\u0275prov=kn({token:n,factory:function(){return function TF(){return new ox($t(c_))}()},providedIn:"root"}),n})();function rM(n){return n.replace(/\/index.html$/,"")}let _M=(()=>{class n{transform(e){return JSON.stringify(e,null,2)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=js({name:"json",type:n,pure:!1,standalone:!0}),n})(),Nu=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})();const bM="browser";let U3=(()=>{class n{}return n.\u0275prov=kn({token:n,providedIn:"root",factory:()=>new V3($t(ls),window)}),n})();class V3{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function H3(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const c=r.shadowRoot;if(c){const g=c.getElementById(t)||c.querySelector(`[name="${t}"]`);if(g)return g}r=i.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,c=this.offset();this.window.scrollTo(i-c[0],r-c[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=wM(this.window.history)||wM(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function wM(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Ax extends class aB extends class gF{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function mF(n){UT||(UT=n)}(new Ax)}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function oB(){return o1=o1||document.querySelector("base"),o1?o1.getAttribute("href"):null}();return null==e?null:function lB(n){QT=QT||document.createElement("a"),QT.setAttribute("href",n);const t=QT.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){o1=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function a3(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,c]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(c)}return null}(document.cookie,t)}}let QT,o1=null;const EM=new En("TRANSITION_ID"),cB=[{provide:RT,useFactory:function uB(n,t,e){return()=>{e.get(NT).donePromise.then(()=>{const i=Tf(),r=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let c=0;c<r.length;c++)i.remove(r[c])})}},deps:[EM,ls,Ea],multi:!0}];let hB=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();const KT=new En("EventManagerPlugins");let ZT=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let c=0;c<r.length;c++){const g=r[c];if(g.supports(e))return this._eventNameToPlugin.set(e,g),g}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)($t(KT),$t(vs))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();class CM{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const r=Tf().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let DM=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})(),l1=(()=>{class n extends DM{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(c=>{const g=this._doc.createElement("style");g.textContent=c,r.push(i.appendChild(g))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(MM),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(MM))}}return n.\u0275fac=function(e){return new(e||n)($t(ls))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();function MM(n){Tf().remove(n)}const xx={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Sx=/%COMP%/g;function JT(n,t,e){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?JT(n,r,e):(r=r.replace(Sx,n),e.push(r))}return e}function NM(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let ew=(()=>{class n{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Ex(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case no.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new _B(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case no.ShadowDom:return new yB(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=JT(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)($t(ZT),$t(l1),$t(Zb))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();class Ex{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(xx[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(OM(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(OM(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const c=xx[r];c?t.setAttributeNS(c,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=xx[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(co.DashCase|co.Important)?t.style.setProperty(e,i,r&co.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&co.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,NM(i)):this.eventManager.addEventListener(t,e,NM(i))}}function OM(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class _B extends Ex{constructor(t,e,i,r){super(t),this.component=i;const c=JT(r+"-"+i.id,i.styles,[]);e.addStyles(c),this.contentAttr=function mB(n){return"_ngcontent-%COMP%".replace(Sx,n)}(r+"-"+i.id),this.hostAttr=function gB(n){return"_nghost-%COMP%".replace(Sx,n)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class yB extends Ex{constructor(t,e,i,r){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=JT(r.id,r.styles,[]);for(let g=0;g<c.length;g++){const _=document.createElement("style");_.textContent=c[g],this.shadowRoot.appendChild(_)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let bB=(()=>{class n extends CM{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return n.\u0275fac=function(e){return new(e||n)($t(ls))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();const LM=["alt","control","meta","shift"],TB={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let AB=(()=>{class n extends CM{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const c=n.parseEventName(i),g=n.eventCallback(c.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Tf().onAndCancel(e,c.domEventName,g))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const c=n._normalizeKey(i.pop());let g="",_=i.indexOf("code");if(_>-1&&(i.splice(_,1),g="code."),LM.forEach(C=>{const L=i.indexOf(C);L>-1&&(i.splice(L,1),g+=C+".")}),g+=c,0!=i.length||0===c.length)return null;const w={};return w.domEventName=r,w.fullKey=g,w}static matchEventFullKeyCode(e,i){let r=TB[e.key]||e.key,c="";return i.indexOf("code.")>-1&&(r=e.code,c="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),LM.forEach(g=>{g!==r&&(0,wB[g])(e)&&(c+=g+".")}),c+=r,c===i)}static eventCallback(e,i,r){return c=>{n.matchEventFullKeyCode(c,e)&&r.runGuarded(()=>i(c))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)($t(ls))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();const CB=OD(hF,"browser",[{provide:PT,useValue:bM},{provide:AD,useValue:function xB(){Ax.makeCurrent()},multi:!0},{provide:ls,useFactory:function EB(){return function g0(n){_v=n}(document),document},deps:[]}]),BM=new En(""),UM=[{provide:OT,useClass:class dB{addToWindow(t){Cr.getAngularTestability=(i,r=!0)=>{const c=t.findTestabilityInTree(i,r);if(null==c)throw new Error("Could not find testability for element.");return c},Cr.getAllAngularTestabilities=()=>t.getAllTestabilities(),Cr.getAllAngularRootElements=()=>t.getAllRootElements(),Cr.frameworkStabilizers||(Cr.frameworkStabilizers=[]),Cr.frameworkStabilizers.push(i=>{const r=Cr.getAllAngularTestabilities();let c=r.length,g=!1;const _=function(w){g=g||w,c--,0==c&&i(g)};r.forEach(function(w){w.whenStable(_)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?Tf().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:ID,useClass:YA,deps:[vs,QA,OT]},{provide:YA,useClass:YA,deps:[vs,QA,OT]}],VM=[{provide:Bc,useValue:"root"},{provide:uo,useFactory:function SB(){return new uo},deps:[]},{provide:KT,useClass:bB,multi:!0,deps:[ls,vs,PT]},{provide:KT,useClass:AB,multi:!0,deps:[ls]},{provide:ew,useClass:ew,deps:[ZT,l1,Zb]},{provide:Hc,useExisting:ew},{provide:DM,useExisting:l1},{provide:l1,useClass:l1,deps:[ls]},{provide:ZT,useClass:ZT,deps:[KT,vs]},{provide:class G3{},useClass:hB,deps:[]},[]];let HM=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:Zb,useValue:e.appId},{provide:EM,useExisting:Zb},cB]}}}return n.\u0275fac=function(e){return new(e||n)($t(BM,12))},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({providers:[...VM,...UM],imports:[Nu,fF]}),n})(),GM=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)($t(ls))},n.\u0275prov=kn({token:n,factory:function(e){let i=null;return i=e?new e:function MB(){return new GM($t(ls))}(),i},providedIn:"root"}),n})();function qn(...n){return Gs(n,Bo(n))}typeof window<"u"&&window;class Po extends Yt{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}const tw=se(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:FB}=Array,{getPrototypeOf:BB,prototype:UB,keys:VB}=Object;const{isArray:GB}=Array;function Ix(n){return hn(t=>function jB(n,t){return GB(t)?n(...t):n(t)}(n,t))}function u1(...n){const t=Bo(n),e=Fo(n),{args:i,keys:r}=function $M(n){if(1===n.length){const t=n[0];if(FB(t))return{args:t,keys:null};if(function HB(n){return n&&"object"==typeof n&&BB(n)===UB}(t)){const e=VB(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}(n);if(0===i.length)return Gs([],t);const c=new jt(function zB(n,t,e=Tt){return i=>{XM(t,()=>{const{length:r}=n,c=new Array(r);let g=r,_=r;for(let w=0;w<r;w++)XM(t,()=>{const C=Gs(n[w],t);let L=!1;C.subscribe(gn(i,z=>{c[w]=z,L||(L=!0,_--),_||i.next(e(c.slice()))},()=>{--g||i.complete()}))},i)},i)}}(i,t,r?g=>function qM(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}(r,g):Tt));return e?c.pipe(Ix(e)):c}function XM(n,t,e){n?Ps(e,n,t):t()}function cy(...n){return function WB(){return bo(1)}()(Gs(n,Bo(n)))}function YM(n){return new jt(t=>{Re(n()).subscribe(t)})}function dy(n,t){const e=ht(n)?n:()=>n,i=r=>r.error(e());return new jt(t?r=>t.schedule(i,0,r):i)}function Rx(){return Dn((n,t)=>{let e=null;n._refCount++;const i=gn(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,c=e;e=null,r&&(!c||r===c)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}class QM extends jt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Oi(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Mt;const e=this.getSubject();t.add(this.source.subscribe(gn(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Mt.EMPTY)}return t}refCount(){return Rx()(this)}}function Qc(n,t){return Dn((e,i)=>{let r=null,c=0,g=!1;const _=()=>g&&!r&&i.complete();e.subscribe(gn(i,w=>{r?.unsubscribe();let C=0;const L=c++;Re(n(w,L)).subscribe(r=gn(i,z=>i.next(t?t(w,z,L,C++):z),()=>{r=null,_()}))},()=>{g=!0,_()}))})}function Oo(n){return n<=0?()=>Qr:Dn((t,e)=>{let i=0;t.subscribe(gn(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function c1(...n){const t=Bo(n);return Dn((e,i)=>{(t?cy(n,e,t):cy(n,e)).subscribe(i)})}function Sl(n,t){return Dn((e,i)=>{let r=0;e.subscribe(gn(i,c=>n.call(t,c,r++)&&i.next(c)))})}function nw(n){return Dn((t,e)=>{let i=!1;t.subscribe(gn(e,r=>{i=!0,e.next(r)},()=>{i||e.next(n),e.complete()}))})}function KM(n=$B){return Dn((t,e)=>{let i=!1;t.subscribe(gn(e,r=>{i=!0,e.next(r)},()=>i?e.complete():e.error(n())))})}function $B(){return new tw}function Ag(n,t){const e=arguments.length>=2;return i=>i.pipe(n?Sl((r,c)=>n(r,c,i)):Tt,Oo(1),e?nw(t):KM(()=>new tw))}function xg(n,t){return ht(t)?vr(n,t,1):vr(n,1)}function Ua(n,t,e){const i=ht(n)||t||e?{next:n,error:t,complete:e}:n;return i?Dn((r,c)=>{var g;null===(g=i.subscribe)||void 0===g||g.call(i);let _=!0;r.subscribe(gn(c,w=>{var C;null===(C=i.next)||void 0===C||C.call(i,w),c.next(w)},()=>{var w;_=!1,null===(w=i.complete)||void 0===w||w.call(i),c.complete()},w=>{var C;_=!1,null===(C=i.error)||void 0===C||C.call(i,w),c.error(w)},()=>{var w,C;_&&(null===(w=i.unsubscribe)||void 0===w||w.call(i)),null===(C=i.finalize)||void 0===C||C.call(i)}))}):Tt}function Gp(n){return Dn((t,e)=>{let c,i=null,r=!1;i=t.subscribe(gn(e,void 0,void 0,g=>{c=Re(n(g,Gp(n)(t))),i?(i.unsubscribe(),i=null,c.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,c.subscribe(e))})}function qB(n,t,e,i,r){return(c,g)=>{let _=e,w=t,C=0;c.subscribe(gn(g,L=>{const z=C++;w=_?n(w,L,z):(_=!0,L),i&&g.next(w)},r&&(()=>{_&&g.next(w),g.complete()})))}}function ZM(n,t){return Dn(qB(n,t,arguments.length>=2,!0))}function Nx(n){return n<=0?()=>Qr:Dn((t,e)=>{let i=[];t.subscribe(gn(e,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)e.next(r);e.complete()},void 0,()=>{i=null}))})}function JM(n,t){const e=arguments.length>=2;return i=>i.pipe(n?Sl((r,c)=>n(r,c,i)):Tt,Nx(1),e?nw(t):KM(()=>new tw))}function iw(n){return Dn((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const rr="primary",d1=Symbol("RouteTitle");class YB{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function hy(n){return new YB(n)}function QB(n,t,e){const i=e.path.split("/");if(i.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||i.length<n.length))return null;const r={};for(let c=0;c<i.length;c++){const g=i[c],_=n[c];if(g.startsWith(":"))r[g.substring(1)]=_;else if(g!==_.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function wf(n,t){const e=n?Object.keys(n):void 0,i=t?Object.keys(t):void 0;if(!e||!i||e.length!=i.length)return!1;let r;for(let c=0;c<e.length;c++)if(r=e[c],!tI(n[r],t[r]))return!1;return!0}function tI(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),i=[...t].sort();return e.every((r,c)=>i[c]===r)}return n===t}function nI(n){return Array.prototype.concat.apply([],n)}function iI(n){return n.length>0?n[n.length-1]:null}function ol(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function Sg(n){return po(n)?n:xr(n)?Gs(Promise.resolve(n)):qn(n)}const JB={exact:function aI(n,t,e){if(!h_(n.segments,t.segments)||!rw(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!n.children[i]||!aI(n.children[i],t.children[i],e))return!1;return!0},subset:oI},rI={exact:function e4(n,t){return wf(n,t)},subset:function t4(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>tI(n[e],t[e]))},ignored:()=>!0};function sI(n,t,e){return JB[e.paths](n.root,t.root,e.matrixParams)&&rI[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function oI(n,t,e){return lI(n,t,t.segments,e)}function lI(n,t,e,i){if(n.segments.length>e.length){const r=n.segments.slice(0,e.length);return!(!h_(r,e)||t.hasChildren()||!rw(r,e,i))}if(n.segments.length===e.length){if(!h_(n.segments,e)||!rw(n.segments,e,i))return!1;for(const r in t.children)if(!n.children[r]||!oI(n.children[r],t.children[r],i))return!1;return!0}{const r=e.slice(0,n.segments.length),c=e.slice(n.segments.length);return!!(h_(n.segments,r)&&rw(n.segments,r,i)&&n.children[rr])&&lI(n.children[rr],t,c,i)}}function rw(n,t,e){return t.every((i,r)=>rI[e](n[r].parameters,i.parameters))}class d_{constructor(t,e,i){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hy(this.queryParams)),this._queryParamMap}toString(){return r4.serialize(this)}}class or{constructor(t,e){this.segments=t,this.children=e,this.parent=null,ol(e,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return sw(this)}}class h1{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=hy(this.parameters)),this._parameterMap}toString(){return hI(this)}}function h_(n,t){return n.length===t.length&&n.every((e,i)=>e.path===t[i].path)}let uI=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:function(){return new Ox},providedIn:"root"}),n})();class Ox{parse(t){const e=new f4(t);return new d_(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${f1(t.root,!0)}`,i=function o4(n){const t=Object.keys(n).map(e=>{const i=n[e];return Array.isArray(i)?i.map(r=>`${aw(e)}=${aw(r)}`).join("&"):`${aw(e)}=${aw(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${i}${"string"==typeof t.fragment?`#${function s4(n){return encodeURI(n)}(t.fragment)}`:""}`}}const r4=new Ox;function sw(n){return n.segments.map(t=>hI(t)).join("/")}function f1(n,t){if(!n.hasChildren())return sw(n);if(t){const e=n.children[rr]?f1(n.children[rr],!1):"",i=[];return ol(n.children,(r,c)=>{c!==rr&&i.push(`${c}:${f1(r,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function i4(n,t){let e=[];return ol(n.children,(i,r)=>{r===rr&&(e=e.concat(t(i,r)))}),ol(n.children,(i,r)=>{r!==rr&&(e=e.concat(t(i,r)))}),e}(n,(i,r)=>r===rr?[f1(n.children[rr],!1)]:[`${r}:${f1(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[rr]?`${sw(n)}/${e[0]}`:`${sw(n)}/(${e.join("//")})`}}function cI(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function aw(n){return cI(n).replace(/%3B/gi,";")}function Lx(n){return cI(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ow(n){return decodeURIComponent(n)}function dI(n){return ow(n.replace(/\+/g,"%20"))}function hI(n){return`${Lx(n.path)}${function a4(n){return Object.keys(n).map(t=>`;${Lx(t)}=${Lx(n[t])}`).join("")}(n.parameters)}`}const l4=/^[^\/()?;=#]+/;function lw(n){const t=n.match(l4);return t?t[0]:""}const u4=/^[^=?&#]+/,d4=/^[^&#]+/;class f4{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new or([],{}):new or([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[rr]=new or(t,e)),i}parseSegment(){const t=lw(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new wt(4009,!1);return this.capture(t),new h1(ow(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=lw(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const r=lw(this.remaining);r&&(i=r,this.capture(i))}t[ow(e)]=ow(i)}parseQueryParam(t){const e=function c4(n){const t=n.match(u4);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const g=function h4(n){const t=n.match(d4);return t?t[0]:""}(this.remaining);g&&(i=g,this.capture(i))}const r=dI(e),c=dI(i);if(t.hasOwnProperty(r)){let g=t[r];Array.isArray(g)||(g=[g],t[r]=g),g.push(c)}else t[r]=c}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=lw(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new wt(4010,!1);let c;i.indexOf(":")>-1?(c=i.slice(0,i.indexOf(":")),this.capture(c),this.capture(":")):t&&(c=rr);const g=this.parseChildren();e[c]=1===Object.keys(g).length?g[rr]:new or([],g),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new wt(4011,!1)}}function kx(n){return n.segments.length>0?new or([],{[rr]:n}):n}function uw(n){const t={};for(const i of Object.keys(n.children)){const c=uw(n.children[i]);(c.segments.length>0||c.hasChildren())&&(t[i]=c)}return function p4(n){if(1===n.numberOfChildren&&n.children[rr]){const t=n.children[rr];return new or(n.segments.concat(t.segments),t.children)}return n}(new or(n.segments,t))}function f_(n){return n instanceof d_}function v4(n,t,e,i,r){if(0===e.length)return fy(t.root,t.root,t.root,i,r);const c=function mI(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new pI(!0,0,n);let t=0,e=!1;const i=n.reduce((r,c,g)=>{if("object"==typeof c&&null!=c){if(c.outlets){const _={};return ol(c.outlets,(w,C)=>{_[C]="string"==typeof w?w.split("/"):w}),[...r,{outlets:_}]}if(c.segmentPath)return[...r,c.segmentPath]}return"string"!=typeof c?[...r,c]:0===g?(c.split("/").forEach((_,w)=>{0==w&&"."===_||(0==w&&""===_?e=!0:".."===_?t++:""!=_&&r.push(_))}),r):[...r,c]},[]);return new pI(e,t,i)}(e);return c.toRoot()?fy(t.root,t.root,new or([],{}),i,r):function g(w){const C=function y4(n,t,e,i){if(n.isAbsolute)return new py(t.root,!0,0);if(-1===i)return new py(e,e===t.root,0);return function gI(n,t,e){let i=n,r=t,c=e;for(;c>r;){if(c-=r,i=i.parent,!i)throw new wt(4005,!1);r=i.segments.length}return new py(i,!1,r-c)}(e,i+(p1(n.commands[0])?0:1),n.numberOfDoubleDots)}(c,t,n.snapshot?._urlSegment,w),L=C.processChildren?g1(C.segmentGroup,C.index,c.commands):Bx(C.segmentGroup,C.index,c.commands);return fy(t.root,C.segmentGroup,L,i,r)}(n.snapshot?._lastPathIndex)}function p1(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function m1(n){return"object"==typeof n&&null!=n&&n.outlets}function fy(n,t,e,i,r){let g,c={};i&&ol(i,(w,C)=>{c[C]=Array.isArray(w)?w.map(L=>`${L}`):`${w}`}),g=n===t?e:fI(n,t,e);const _=kx(uw(g));return new d_(_,c,r)}function fI(n,t,e){const i={};return ol(n.children,(r,c)=>{i[c]=r===t?e:fI(r,t,e)}),new or(n.segments,i)}class pI{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&p1(i[0]))throw new wt(4003,!1);const r=i.find(m1);if(r&&r!==iI(i))throw new wt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class py{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function Bx(n,t,e){if(n||(n=new or([],{})),0===n.segments.length&&n.hasChildren())return g1(n,t,e);const i=function T4(n,t,e){let i=0,r=t;const c={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=e.length)return c;const g=n.segments[r],_=e[i];if(m1(_))break;const w=`${_}`,C=i<e.length-1?e[i+1]:null;if(r>0&&void 0===w)break;if(w&&C&&"object"==typeof C&&void 0===C.outlets){if(!_I(w,C,g))return c;i+=2}else{if(!_I(w,{},g))return c;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,t,e),r=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const c=new or(n.segments.slice(0,i.pathIndex),{});return c.children[rr]=new or(n.segments.slice(i.pathIndex),n.children),g1(c,0,r)}return i.match&&0===r.length?new or(n.segments,{}):i.match&&!n.hasChildren()?Ux(n,t,e):i.match?g1(n,0,r):Ux(n,t,e)}function g1(n,t,e){if(0===e.length)return new or(n.segments,{});{const i=function b4(n){return m1(n[0])?n[0].outlets:{[rr]:n}}(e),r={};return ol(i,(c,g)=>{"string"==typeof c&&(c=[c]),null!==c&&(r[g]=Bx(n.children[g],t,c))}),ol(n.children,(c,g)=>{void 0===i[g]&&(r[g]=c)}),new or(n.segments,r)}}function Ux(n,t,e){const i=n.segments.slice(0,t);let r=0;for(;r<e.length;){const c=e[r];if(m1(c)){const w=w4(c.outlets);return new or(i,w)}if(0===r&&p1(e[0])){i.push(new h1(n.segments[t].path,vI(e[0]))),r++;continue}const g=m1(c)?c.outlets[rr]:`${c}`,_=r<e.length-1?e[r+1]:null;g&&_&&p1(_)?(i.push(new h1(g,vI(_))),r+=2):(i.push(new h1(g,{})),r++)}return new or(i,{})}function w4(n){const t={};return ol(n,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[i]=Ux(new or([],{}),0,e))}),t}function vI(n){const t={};return ol(n,(e,i)=>t[i]=`${e}`),t}function _I(n,t,e){return n==e.path&&wf(t,e.parameters)}class jp{constructor(t,e){this.id=t,this.url=e}}class Vx extends jp{constructor(t,e,i="imperative",r=null){super(t,e),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class p_ extends jp{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class cw extends jp{constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class yI extends jp{constructor(t,e,i,r){super(t,e),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class A4 extends jp{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class x4 extends jp{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class S4 extends jp{constructor(t,e,i,r,c){super(t,e),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=c,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class E4 extends jp{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class C4 extends jp{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class D4{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class M4{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class I4{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class R4{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class N4{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class P4{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bI{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class TI{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Hx(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){const e=Hx(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Gx(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return Gx(t,this._root).map(e=>e.value)}}function Hx(n,t){if(n===t.value)return t;for(const e of t.children){const i=Hx(n,e);if(i)return i}return null}function Gx(n,t){if(n===t.value)return[t];for(const e of t.children){const i=Gx(n,e);if(i.length)return i.unshift(t),i}return[]}class zp{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function my(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class wI extends TI{constructor(t,e){super(t),this.snapshot=e,jx(this,t)}toString(){return this.snapshot.toString()}}function AI(n,t){const e=function L4(n,t){const g=new dw([],{},{},"",{},rr,t,null,n.root,-1,{});return new SI("",new zp(g,[]))}(n,t),i=new Po([new h1("",{})]),r=new Po({}),c=new Po({}),g=new Po({}),_=new Po(""),w=new m_(i,r,g,_,c,rr,t,e.root);return w.snapshot=e.root,new wI(new zp(w,[]),e)}class m_{constructor(t,e,i,r,c,g,_,w){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=c,this.outlet=g,this.component=_,this.title=this.data?.pipe(hn(C=>C[d1]))??qn(void 0),this._futureSnapshot=w}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(hn(t=>hy(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(hn(t=>hy(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function xI(n,t="emptyOnly"){const e=n.pathFromRoot;let i=0;if("always"!==t)for(i=e.length-1;i>=1;){const r=e[i],c=e[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(c.component)break;i--}}return function k4(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(i))}class dw{constructor(t,e,i,r,c,g,_,w,C,L,z,J){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=c,this.outlet=g,this.component=_,this.title=this.data?.[d1],this.routeConfig=w,this._urlSegment=C,this._lastPathIndex=L,this._correctedLastPathIndex=J??L,this._resolve=z}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=hy(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=hy(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class SI extends TI{constructor(t,e){super(e),this.url=t,jx(this,e)}toString(){return EI(this._root)}}function jx(n,t){t.value._routerState=n,t.children.forEach(e=>jx(n,e))}function EI(n){const t=n.children.length>0?` { ${n.children.map(EI).join(", ")} } `:"";return`${n.value}${t}`}function zx(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,wf(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),wf(t.params,e.params)||n.params.next(e.params),function KB(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!wf(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),wf(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Wx(n,t){const e=wf(n.params,t.params)&&function n4(n,t){return h_(n,t)&&n.every((e,i)=>wf(e.parameters,t[i].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||Wx(n.parent,t.parent))}function v1(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=t.value;const r=function B4(n,t,e){return t.children.map(i=>{for(const r of e.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return v1(n,i,r);return v1(n,i)})}(n,t,e);return new zp(i,r)}{if(n.shouldAttach(t.value)){const c=n.retrieve(t.value);if(null!==c){const g=c.route;return g.value._futureSnapshot=t.value,g.children=t.children.map(_=>v1(n,_)),g}}const i=function U4(n){return new m_(new Po(n.url),new Po(n.params),new Po(n.queryParams),new Po(n.fragment),new Po(n.data),n.outlet,n.component,n)}(t.value),r=t.children.map(c=>v1(n,c));return new zp(i,r)}}const $x="ngNavigationCancelingError";function CI(n,t){const{redirectTo:e,navigationBehaviorOptions:i}=f_(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=DI(!1,0,t);return r.url=e,r.navigationBehaviorOptions=i,r}function DI(n,t,e){const i=new Error("NavigationCancelingError: "+(n||""));return i[$x]=!0,i.cancellationCode=t,e&&(i.url=e),i}function MI(n){return II(n)&&f_(n.url)}function II(n){return n&&n[$x]}class V4{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new _1,this.attachRef=null}}let _1=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new V4,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const hw=!1;let qx=(()=>{class n{constructor(e,i,r,c,g){this.parentContexts=e,this.location=i,this.changeDetector=c,this.environmentInjector=g,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ki,this.deactivateEvents=new Ki,this.attachEvents=new Ki,this.detachEvents=new Ki,this.name=r||rr,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new wt(4012,hw);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new wt(4012,hw);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new wt(4012,hw);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new wt(4013,hw);this._activatedRoute=e;const r=this.location,g=e._futureSnapshot.component,_=this.parentContexts.getOrCreateContext(this.name).children,w=new H4(e,_,r.injector);if(i&&function G4(n){return!!n.resolveComponentFactory}(i)){const C=i.resolveComponentFactory(g);this.activated=r.createComponent(C,r.length,w)}else this.activated=r.createComponent(g,{index:r.length,injector:w,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(ue(_1),ue(Yd),function bd(n){return function wm(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let r=0;for(;r<i;){const c=e[r];if(Jg(c))break;if(0===c)r+=2;else if("number"==typeof c)for(r++;r<i&&"string"==typeof e[r];)r++;else{if(c===t)return e[r+1];r+=2}}}return null}(Os(),n)}("name"),ue(Bp),ue(Do))},n.\u0275dir=Tn({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class H4{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===m_?this.route:t===_1?this.childContexts:this.parent.get(t,e)}}let Xx=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Li({type:n,selectors:[["ng-component"]],standalone:!0,features:[kC],decls:1,vars:0,template:function(e,i){1&e&&qi(0,"router-outlet")},dependencies:[qx],encapsulation:2}),n})();function RI(n,t){return n.providers&&!n._injector&&(n._injector=ST(n.providers,t,`Route: ${n.path}`)),n._injector??t}function Qx(n){const t=n.children&&n.children.map(Qx),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==rr&&(e.component=Xx),e}function Kc(n){return n.outlet||rr}function NI(n,t){const e=n.filter(i=>Kc(i)===t);return e.push(...n.filter(i=>Kc(i)!==t)),e}function y1(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class q4{constructor(t,e,i,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=r}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),zx(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const r=my(e);t.children.forEach(c=>{const g=c.value.outlet;this.deactivateRoutes(c,r[g],i),delete r[g]}),ol(r,(c,g)=>{this.deactivateRouteAndItsChildren(c,i)})}deactivateRoutes(t,e,i){const r=t.value,c=e?e.value:null;if(r===c)if(r.component){const g=i.getContext(r.outlet);g&&this.deactivateChildRoutes(t,e,g.children)}else this.deactivateChildRoutes(t,e,i);else c&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,c=my(t);for(const g of Object.keys(c))this.deactivateRouteAndItsChildren(c[g],r);if(i&&i.outlet){const g=i.outlet.detach(),_=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:g,route:t,contexts:_})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,c=my(t);for(const g of Object.keys(c))this.deactivateRouteAndItsChildren(c[g],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(t,e,i){const r=my(e);t.children.forEach(c=>{this.activateRoutes(c,r[c.value.outlet],i),this.forwardEvent(new P4(c.value.snapshot))}),t.children.length&&this.forwardEvent(new R4(t.value.snapshot))}activateRoutes(t,e,i){const r=t.value,c=e?e.value:null;if(zx(r),r===c)if(r.component){const g=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,g.children)}else this.activateChildRoutes(t,e,i);else if(r.component){const g=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const _=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),g.children.onOutletReAttached(_.contexts),g.attachRef=_.componentRef,g.route=_.route.value,g.outlet&&g.outlet.attach(_.componentRef,_.route.value),zx(_.route.value),this.activateChildRoutes(t,null,g.children)}else{const _=y1(r.snapshot),w=_?.get(Nd)??null;g.attachRef=null,g.route=r,g.resolver=w,g.injector=_,g.outlet&&g.outlet.activateWith(r,g.injector),this.activateChildRoutes(t,null,g.children)}}else this.activateChildRoutes(t,null,i)}}class PI{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class fw{constructor(t,e){this.component=t,this.route=e}}function X4(n,t,e){const i=n._root;return b1(i,t?t._root:null,e,[i.value])}function gy(n,t){const e=Symbol(),i=t.get(n,e);return i===e?"function"!=typeof n||function oh(n){return null!==Pf(n)}(n)?t.get(n):n:i}function b1(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const c=my(t);return n.children.forEach(g=>{(function Q4(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const c=n.value,g=t?t.value:null,_=e?e.getContext(n.value.outlet):null;if(g&&c.routeConfig===g.routeConfig){const w=function K4(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!h_(n.url,t.url);case"pathParamsOrQueryParamsChange":return!h_(n.url,t.url)||!wf(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Wx(n,t)||!wf(n.queryParams,t.queryParams);default:return!Wx(n,t)}}(g,c,c.routeConfig.runGuardsAndResolvers);w?r.canActivateChecks.push(new PI(i)):(c.data=g.data,c._resolvedData=g._resolvedData),b1(n,t,c.component?_?_.children:null:e,i,r),w&&_&&_.outlet&&_.outlet.isActivated&&r.canDeactivateChecks.push(new fw(_.outlet.component,g))}else g&&T1(t,_,r),r.canActivateChecks.push(new PI(i)),b1(n,null,c.component?_?_.children:null:e,i,r)})(g,c[g.value.outlet],e,i.concat([g.value]),r),delete c[g.value.outlet]}),ol(c,(g,_)=>T1(g,e.getContext(_),r)),r}function T1(n,t,e){const i=my(n),r=n.value;ol(i,(c,g)=>{T1(c,r.component?t?t.children.getContext(g):null:t,e)}),e.canDeactivateChecks.push(new fw(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function w1(n){return"function"==typeof n}function Kx(n){return n instanceof tw||"EmptyError"===n?.name}const pw=Symbol("INITIAL_VALUE");function vy(){return Qc(n=>u1(n.map(t=>t.pipe(Oo(1),c1(pw)))).pipe(hn(t=>{for(const e of t)if(!0!==e){if(e===pw)return pw;if(!1===e||e instanceof d_)return e}return!0}),Sl(t=>t!==pw),Oo(1)))}function OI(n){return function tn(...n){return Lt(n)}(Ua(t=>{if(f_(t))throw CI(0,t)}),hn(t=>!0===t))}const Zx={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function LI(n,t,e,i,r){const c=Jx(n,t,e);return c.matched?function pU(n,t,e,i){const r=t.canMatch;return r&&0!==r.length?qn(r.map(g=>{const _=gy(g,n);return Sg(function iU(n){return n&&w1(n.canMatch)}(_)?_.canMatch(t,e):n.runInContext(()=>_(t,e)))})).pipe(vy(),OI()):qn(!0)}(i=RI(t,i),t,e).pipe(hn(g=>!0===g?c:{...Zx})):qn(c)}function Jx(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...Zx}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(t.matcher||QB)(e,n,t);if(!r)return{...Zx};const c={};ol(r.posParams,(_,w)=>{c[w]=_.path});const g=r.consumed.length>0?{...c,...r.consumed[r.consumed.length-1].parameters}:c;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:g,positionalParamSegments:r.posParams??{}}}function mw(n,t,e,i,r="corrected"){if(e.length>0&&function vU(n,t,e){return e.some(i=>gw(n,t,i)&&Kc(i)!==rr)}(n,e,i)){const g=new or(t,function gU(n,t,e,i){const r={};r[rr]=i,i._sourceSegment=n,i._segmentIndexShift=t.length;for(const c of e)if(""===c.path&&Kc(c)!==rr){const g=new or([],{});g._sourceSegment=n,g._segmentIndexShift=t.length,r[Kc(c)]=g}return r}(n,t,i,new or(e,n.children)));return g._sourceSegment=n,g._segmentIndexShift=t.length,{segmentGroup:g,slicedSegments:[]}}if(0===e.length&&function _U(n,t,e){return e.some(i=>gw(n,t,i))}(n,e,i)){const g=new or(n.segments,function mU(n,t,e,i,r,c){const g={};for(const _ of i)if(gw(n,e,_)&&!r[Kc(_)]){const w=new or([],{});w._sourceSegment=n,w._segmentIndexShift="legacy"===c?n.segments.length:t.length,g[Kc(_)]=w}return{...r,...g}}(n,t,e,i,n.children,r));return g._sourceSegment=n,g._segmentIndexShift=t.length,{segmentGroup:g,slicedSegments:e}}const c=new or(n.segments,n.children);return c._sourceSegment=n,c._segmentIndexShift=t.length,{segmentGroup:c,slicedSegments:e}}function gw(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function kI(n,t,e,i){return!!(Kc(n)===i||i!==rr&&gw(t,e,n))&&("**"===n.path||Jx(t,n,e).matched)}function FI(n,t,e){return 0===t.length&&!n.children[e]}const vw=!1;class _w{constructor(t){this.segmentGroup=t||null}}class BI{constructor(t){this.urlTree=t}}function A1(n){return dy(new _w(n))}function UI(n){return dy(new BI(n))}class wU{constructor(t,e,i,r,c){this.injector=t,this.configLoader=e,this.urlSerializer=i,this.urlTree=r,this.config=c,this.allowRedirects=!0}apply(){const t=mw(this.urlTree.root,[],[],this.config).segmentGroup,e=new or(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,rr).pipe(hn(c=>this.createUrlTree(uw(c),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Gp(c=>{if(c instanceof BI)return this.allowRedirects=!1,this.match(c.urlTree);throw c instanceof _w?this.noMatchError(c):c}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,rr).pipe(hn(r=>this.createUrlTree(uw(r),t.queryParams,t.fragment))).pipe(Gp(r=>{throw r instanceof _w?this.noMatchError(r):r}))}noMatchError(t){return new wt(4002,vw)}createUrlTree(t,e,i){const r=kx(t);return new d_(r,e,i)}expandSegmentGroup(t,e,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,e,i).pipe(hn(c=>new or([],c))):this.expandSegment(t,i,e,i.segments,r,!0)}expandChildren(t,e,i){const r=[];for(const c of Object.keys(i.children))"primary"===c?r.unshift(c):r.push(c);return Gs(r).pipe(xg(c=>{const g=i.children[c],_=NI(e,c);return this.expandSegmentGroup(t,_,g,c).pipe(hn(w=>({segment:w,outlet:c})))}),ZM((c,g)=>(c[g.outlet]=g.segment,c),{}),JM())}expandSegment(t,e,i,r,c,g){return Gs(i).pipe(xg(_=>this.expandSegmentAgainstRoute(t,e,i,_,r,c,g).pipe(Gp(C=>{if(C instanceof _w)return qn(null);throw C}))),Ag(_=>!!_),Gp((_,w)=>{if(Kx(_))return FI(e,r,c)?qn(new or([],{})):A1(e);throw _}))}expandSegmentAgainstRoute(t,e,i,r,c,g,_){return kI(r,e,c,g)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,c,g):_&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,i,r,c,g):A1(e):A1(e)}expandSegmentAgainstRouteUsingRedirect(t,e,i,r,c,g){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,g):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,c,g)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,r){const c=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?UI(c):this.lineralizeSegments(i,c).pipe(vr(g=>{const _=new or(g,{});return this.expandSegment(t,_,e,g,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,c,g){const{matched:_,consumedSegments:w,remainingSegments:C,positionalParamSegments:L}=Jx(e,r,c);if(!_)return A1(e);const z=this.applyRedirectCommands(w,r.redirectTo,L);return r.redirectTo.startsWith("/")?UI(z):this.lineralizeSegments(r,z).pipe(vr(J=>this.expandSegment(t,e,i,J.concat(C),g,!1)))}matchSegmentAgainstRoute(t,e,i,r,c){return"**"===i.path?(t=RI(i,t),i.loadChildren?(i._loadedRoutes?qn({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(t,i)).pipe(hn(_=>(i._loadedRoutes=_.routes,i._loadedInjector=_.injector,new or(r,{})))):qn(new or(r,{}))):LI(e,i,r,t).pipe(Qc(({matched:g,consumedSegments:_,remainingSegments:w})=>g?this.getChildConfig(t=i._injector??t,i,r).pipe(vr(L=>{const z=L.injector??t,J=L.routes,{segmentGroup:ae,slicedSegments:we}=mw(e,_,w,J),Ee=new or(ae.segments,ae.children);if(0===we.length&&Ee.hasChildren())return this.expandChildren(z,J,Ee).pipe(hn(Ke=>new or(_,Ke)));if(0===J.length&&0===we.length)return qn(new or(_,{}));const He=Kc(i)===c;return this.expandSegment(z,Ee,J,we,He?rr:c,!0).pipe(hn(ot=>new or(_.concat(ot.segments),ot.children)))})):A1(e)))}getChildConfig(t,e,i){return e.children?qn({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?qn({routes:e._loadedRoutes,injector:e._loadedInjector}):function fU(n,t,e,i){const r=t.canLoad;return void 0===r||0===r.length?qn(!0):qn(r.map(g=>{const _=gy(g,n);return Sg(function J4(n){return n&&w1(n.canLoad)}(_)?_.canLoad(t,e):n.runInContext(()=>_(t,e)))})).pipe(vy(),OI())}(t,e,i).pipe(vr(r=>r?this.configLoader.loadChildren(t,e).pipe(Ua(c=>{e._loadedRoutes=c.routes,e._loadedInjector=c.injector})):function bU(n){return dy(DI(vw,3))}())):qn({routes:[],injector:t})}lineralizeSegments(t,e){let i=[],r=e.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return qn(i);if(r.numberOfChildren>1||!r.children[rr])return dy(new wt(4e3,vw));r=r.children[rr]}}applyRedirectCommands(t,e,i){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreateUrlTree(t,e,i,r){const c=this.createSegmentGroup(t,e.root,i,r);return new d_(c,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return ol(t,(r,c)=>{if("string"==typeof r&&r.startsWith(":")){const _=r.substring(1);i[c]=e[_]}else i[c]=r}),i}createSegmentGroup(t,e,i,r){const c=this.createSegments(t,e.segments,i,r);let g={};return ol(e.children,(_,w)=>{g[w]=this.createSegmentGroup(t,_,i,r)}),new or(c,g)}createSegments(t,e,i,r){return e.map(c=>c.path.startsWith(":")?this.findPosParam(t,c,r):this.findOrReturn(c,i))}findPosParam(t,e,i){const r=i[e.path.substring(1)];if(!r)throw new wt(4001,vw);return r}findOrReturn(t,e){let i=0;for(const r of e){if(r.path===t.path)return e.splice(i),r;i++}return t}}class xU{}class CU{constructor(t,e,i,r,c,g,_,w){this.injector=t,this.rootComponentType=e,this.config=i,this.urlTree=r,this.url=c,this.paramsInheritanceStrategy=g,this.relativeLinkResolution=_,this.urlSerializer=w}recognize(){const t=mw(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,rr).pipe(hn(e=>{if(null===e)return null;const i=new dw([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},rr,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new zp(i,e),c=new SI(this.url,r);return this.inheritParamsAndData(c._root),c}))}inheritParamsAndData(t){const e=t.value,i=xI(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,e,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,e,i):this.processSegment(t,e,i,i.segments,r)}processChildren(t,e,i){return Gs(Object.keys(i.children)).pipe(xg(r=>{const c=i.children[r],g=NI(e,r);return this.processSegmentGroup(t,g,c,r)}),ZM((r,c)=>r&&c?(r.push(...c),r):null),function XB(n,t=!1){return Dn((e,i)=>{let r=0;e.subscribe(gn(i,c=>{const g=n(c,r++);(g||t)&&i.next(c),!g&&i.complete()}))})}(r=>null!==r),nw(null),JM(),hn(r=>{if(null===r)return null;const c=VI(r);return function DU(n){n.sort((t,e)=>t.value.outlet===rr?-1:e.value.outlet===rr?1:t.value.outlet.localeCompare(e.value.outlet))}(c),c}))}processSegment(t,e,i,r,c){return Gs(e).pipe(xg(g=>this.processSegmentAgainstRoute(g._injector??t,g,i,r,c)),Ag(g=>!!g),Gp(g=>{if(Kx(g))return FI(i,r,c)?qn([]):qn(null);throw g}))}processSegmentAgainstRoute(t,e,i,r,c){if(e.redirectTo||!kI(e,i,r,c))return qn(null);let g;if("**"===e.path){const _=r.length>0?iI(r).parameters:{},w=GI(i)+r.length;g=qn({snapshot:new dw(r,_,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,zI(e),Kc(e),e.component??e._loadedComponent??null,e,HI(i),w,WI(e),w),consumedSegments:[],remainingSegments:[]})}else g=LI(i,e,r,t).pipe(hn(({matched:_,consumedSegments:w,remainingSegments:C,parameters:L})=>{if(!_)return null;const z=GI(i)+w.length;return{snapshot:new dw(w,L,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,zI(e),Kc(e),e.component??e._loadedComponent??null,e,HI(i),z,WI(e),z),consumedSegments:w,remainingSegments:C}}));return g.pipe(Qc(_=>{if(null===_)return qn(null);const{snapshot:w,consumedSegments:C,remainingSegments:L}=_;t=e._injector??t;const z=e._loadedInjector??t,J=function MU(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:ae,slicedSegments:we}=mw(i,C,L,J.filter(He=>void 0===He.redirectTo),this.relativeLinkResolution);if(0===we.length&&ae.hasChildren())return this.processChildren(z,J,ae).pipe(hn(He=>null===He?null:[new zp(w,He)]));if(0===J.length&&0===we.length)return qn([new zp(w,[])]);const Ee=Kc(e)===c;return this.processSegment(z,J,ae,we,Ee?rr:c).pipe(hn(He=>null===He?null:[new zp(w,He)]))}))}}function IU(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function VI(n){const t=[],e=new Set;for(const i of n){if(!IU(i)){t.push(i);continue}const r=t.find(c=>i.value.routeConfig===c.value.routeConfig);void 0!==r?(r.children.push(...i.children),e.add(r)):t.push(i)}for(const i of e){const r=VI(i.children);t.push(new zp(i.value,r))}return t.filter(i=>!e.has(i))}function HI(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function GI(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function zI(n){return n.data||{}}function WI(n){return n.resolve||{}}function PU(n,t){return vr(e=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=e;if(!r.length)return qn(e);let c=0;return Gs(r).pipe(xg(g=>function OU(n,t,e,i){const r=n.routeConfig,c=n._resolve;return void 0!==r?.title&&!$I(r)&&(c[d1]=r.title),function LU(n,t,e,i){const r=function kU(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return qn({});const c={};return Gs(r).pipe(vr(g=>function FU(n,t,e,i){const r=y1(t)??i,c=gy(n,r);return Sg(c.resolve?c.resolve(t,e):r.runInContext(()=>c(t,e)))}(n[g],t,e,i).pipe(Ag(),Ua(_=>{c[g]=_}))),Nx(1),function eI(n){return hn(()=>n)}(c),Gp(g=>Kx(g)?Qr:dy(g)))}(c,n,t,i).pipe(hn(g=>(n._resolvedData=g,n.data=xI(n,e).resolve,r&&$I(r)&&(n.data[d1]=r.title),null)))}(g.route,i,n,t)),Ua(()=>c++),Nx(1),vr(g=>c===r.length?qn(e):Qr))})}function $I(n){return"string"==typeof n.title||null===n.title}function eS(n){return Qc(t=>{const e=n(t);return e?Gs(e).pipe(hn(()=>t)):qn(t)})}let qI=(()=>{class n{buildTitle(e){let i,r=e.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(c=>c.outlet===rr);return i}getResolvedTitleForRoute(e){return e.data[d1]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:function(){return Bn(XI)},providedIn:"root"}),n})(),XI=(()=>{class n extends qI{constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(e){return new(e||n)($t(GM))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class BU{}class VU extends class UU{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const bw=new En("",{providedIn:"root",factory:()=>({})}),tS=new En("ROUTES");let nS=(()=>{class n{constructor(e,i){this.injector=e,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return qn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=Sg(e.loadComponent()).pipe(Ua(c=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=c}),iw(()=>{this.componentLoaders.delete(e)})),r=new QM(i,()=>new Yt).pipe(Rx());return this.componentLoaders.set(e,r),r}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return qn({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const c=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(hn(_=>{this.onLoadEndListener&&this.onLoadEndListener(i);let w,C,L=!1;Array.isArray(_)?C=_:(w=_.create(e).injector,C=nI(w.get(tS,[],gi.Self|gi.Optional)));return{routes:C.map(Qx),injector:w}}),iw(()=>{this.childrenLoaders.delete(i)})),g=new QM(c,()=>new Yt).pipe(Rx());return this.childrenLoaders.set(i,g),g}loadModuleFactoryOrRoutes(e){return Sg(e()).pipe(vr(i=>i instanceof OC||Array.isArray(i)?qn(i):Gs(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(e){return new(e||n)($t(Ea),$t(WA))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class GU{}class jU{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function zU(n){throw n}function WU(n,t,e){return t.parse("/")}const $U={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},qU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function QI(){const n=Bn(uI),t=Bn(_1),e=Bn(ox),i=Bn(Ea),r=Bn(WA),c=Bn(tS,{optional:!0})??[],g=Bn(bw,{optional:!0})??{},_=Bn(XI),w=Bn(qI,{optional:!0}),C=Bn(GU,{optional:!0}),L=Bn(BU,{optional:!0}),z=new Lo(null,n,t,e,i,r,nI(c));return C&&(z.urlHandlingStrategy=C),L&&(z.routeReuseStrategy=L),z.titleStrategy=w??_,function XU(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(g,z),z}let Lo=(()=>{class n{constructor(e,i,r,c,g,_,w){this.rootComponentType=e,this.urlSerializer=i,this.rootContexts=r,this.location=c,this.config=w,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Yt,this.errorHandler=zU,this.malformedUriErrorHandler=WU,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>qn(void 0),this.urlHandlingStrategy=new jU,this.routeReuseStrategy=new VU,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=g.get(nS),this.configLoader.onLoadEndListener=J=>this.triggerEvent(new M4(J)),this.configLoader.onLoadStartListener=J=>this.triggerEvent(new D4(J)),this.ngModule=g.get(l_),this.console=g.get(Nk);const z=g.get(vs);this.isNgZoneEnabled=z instanceof vs&&vs.isInAngularZone(),this.resetConfig(w),this.currentUrlTree=function ZB(){return new d_(new or([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=AI(this.currentUrlTree,this.rootComponentType),this.transitions=new Po({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const i=this.events;return e.pipe(Sl(r=>0!==r.id),hn(r=>({...r,extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Qc(r=>{let c=!1,g=!1;return qn(r).pipe(Ua(_=>{this.currentNavigation={id:_.id,initialUrl:_.rawUrl,extractedUrl:_.extractedUrl,trigger:_.source,extras:_.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Qc(_=>{const w=this.browserUrlTree.toString(),C=!this.navigated||_.extractedUrl.toString()!==w||w!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||C)&&this.urlHandlingStrategy.shouldProcessUrl(_.rawUrl))return KI(_.source)&&(this.browserUrlTree=_.extractedUrl),qn(_).pipe(Qc(z=>{const J=this.transitions.getValue();return i.next(new Vx(z.id,this.serializeUrl(z.extractedUrl),z.source,z.restoredState)),J!==this.transitions.getValue()?Qr:Promise.resolve(z)}),function AU(n,t,e,i){return Qc(r=>function TU(n,t,e,i,r){return new wU(n,t,e,i,r).apply()}(n,t,e,r.extractedUrl,i).pipe(hn(c=>({...r,urlAfterRedirects:c}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Ua(z=>{this.currentNavigation={...this.currentNavigation,finalUrl:z.urlAfterRedirects},r.urlAfterRedirects=z.urlAfterRedirects}),function NU(n,t,e,i,r,c){return vr(g=>function EU(n,t,e,i,r,c,g="emptyOnly",_="legacy"){return new CU(n,t,e,i,r,g,_,c).recognize().pipe(Qc(w=>null===w?function SU(n){return new jt(t=>t.error(n))}(new xU):qn(w)))}(n,t,e,g.urlAfterRedirects,i.serialize(g.urlAfterRedirects),i,r,c).pipe(hn(_=>({...g,targetSnapshot:_}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),Ua(z=>{if(r.targetSnapshot=z.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!z.extras.skipLocationChange){const ae=this.urlHandlingStrategy.merge(z.urlAfterRedirects,z.rawUrl);this.setBrowserUrl(ae,z)}this.browserUrlTree=z.urlAfterRedirects}const J=new A4(z.id,this.serializeUrl(z.extractedUrl),this.serializeUrl(z.urlAfterRedirects),z.targetSnapshot);i.next(J)}));if(C&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:J,extractedUrl:ae,source:we,restoredState:Ee,extras:He}=_,Ye=new Vx(J,this.serializeUrl(ae),we,Ee);i.next(Ye);const ot=AI(ae,this.rootComponentType).snapshot;return qn(r={..._,targetSnapshot:ot,urlAfterRedirects:ae,extras:{...He,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=_.rawUrl,_.resolve(null),Qr}),Ua(_=>{const w=new x4(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(_.urlAfterRedirects),_.targetSnapshot);this.triggerEvent(w)}),hn(_=>r={..._,guards:X4(_.targetSnapshot,_.currentSnapshot,this.rootContexts)}),function sU(n,t){return vr(e=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:c,canDeactivateChecks:g}}=e;return 0===g.length&&0===c.length?qn({...e,guardsResult:!0}):function aU(n,t,e,i){return Gs(n).pipe(vr(r=>function hU(n,t,e,i,r){const c=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return c&&0!==c.length?qn(c.map(_=>{const w=y1(t)??r,C=gy(_,w);return Sg(function nU(n){return n&&w1(n.canDeactivate)}(C)?C.canDeactivate(n,t,e,i):w.runInContext(()=>C(n,t,e,i))).pipe(Ag())})).pipe(vy()):qn(!0)}(r.component,r.route,e,t,i)),Ag(r=>!0!==r,!0))}(g,i,r,n).pipe(vr(_=>_&&function Z4(n){return"boolean"==typeof n}(_)?function oU(n,t,e,i){return Gs(t).pipe(xg(r=>cy(function uU(n,t){return null!==n&&t&&t(new I4(n)),qn(!0)}(r.route.parent,i),function lU(n,t){return null!==n&&t&&t(new N4(n)),qn(!0)}(r.route,i),function dU(n,t,e){const i=t[t.length-1],c=t.slice(0,t.length-1).reverse().map(g=>function Y4(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(g)).filter(g=>null!==g).map(g=>YM(()=>qn(g.guards.map(w=>{const C=y1(g.node)??e,L=gy(w,C);return Sg(function tU(n){return n&&w1(n.canActivateChild)}(L)?L.canActivateChild(i,n):C.runInContext(()=>L(i,n))).pipe(Ag())})).pipe(vy())));return qn(c).pipe(vy())}(n,r.path,e),function cU(n,t,e){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return qn(!0);const r=i.map(c=>YM(()=>{const g=y1(t)??e,_=gy(c,g);return Sg(function eU(n){return n&&w1(n.canActivate)}(_)?_.canActivate(t,n):g.runInContext(()=>_(t,n))).pipe(Ag())}));return qn(r).pipe(vy())}(n,r.route,e))),Ag(r=>!0!==r,!0))}(i,c,n,t):qn(_)),hn(_=>({...e,guardsResult:_})))})}(this.ngModule.injector,_=>this.triggerEvent(_)),Ua(_=>{if(r.guardsResult=_.guardsResult,f_(_.guardsResult))throw CI(0,_.guardsResult);const w=new S4(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(_.urlAfterRedirects),_.targetSnapshot,!!_.guardsResult);this.triggerEvent(w)}),Sl(_=>!!_.guardsResult||(this.restoreHistory(_),this.cancelNavigationTransition(_,"",3),!1)),eS(_=>{if(_.guards.canActivateChecks.length)return qn(_).pipe(Ua(w=>{const C=new E4(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(C)}),Qc(w=>{let C=!1;return qn(w).pipe(PU(this.paramsInheritanceStrategy,this.ngModule.injector),Ua({next:()=>C=!0,complete:()=>{C||(this.restoreHistory(w),this.cancelNavigationTransition(w,"",2))}}))}),Ua(w=>{const C=new C4(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(C)}))}),eS(_=>{const w=C=>{const L=[];C.routeConfig?.loadComponent&&!C.routeConfig._loadedComponent&&L.push(this.configLoader.loadComponent(C.routeConfig).pipe(Ua(z=>{C.component=z}),hn(()=>{})));for(const z of C.children)L.push(...w(z));return L};return u1(w(_.targetSnapshot.root)).pipe(nw(),Oo(1))}),eS(()=>this.afterPreactivation()),hn(_=>{const w=function F4(n,t,e){const i=v1(n,t._root,e?e._root:void 0);return new wI(i,t)}(this.routeReuseStrategy,_.targetSnapshot,_.currentRouterState);return r={..._,targetRouterState:w}}),Ua(_=>{this.currentUrlTree=_.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(_.urlAfterRedirects,_.rawUrl),this.routerState=_.targetRouterState,"deferred"===this.urlUpdateStrategy&&(_.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,_),this.browserUrlTree=_.urlAfterRedirects)}),((n,t,e)=>hn(i=>(new q4(t,i.targetRouterState,i.currentRouterState,e).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,_=>this.triggerEvent(_)),Ua({next(){c=!0},complete(){c=!0}}),iw(()=>{c||g||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),Gp(_=>{if(g=!0,II(_)){MI(_)||(this.navigated=!0,this.restoreHistory(r,!0));const w=new cw(r.id,this.serializeUrl(r.extractedUrl),_.message,_.cancellationCode);if(i.next(w),MI(_)){const C=this.urlHandlingStrategy.merge(_.url,this.rawUrlTree),L={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||KI(r.source)};this.scheduleNavigation(C,"imperative",null,L,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{this.restoreHistory(r,!0);const w=new yI(r.id,this.serializeUrl(r.extractedUrl),_,r.targetSnapshot??void 0);i.next(w);try{r.resolve(this.errorHandler(_))}catch(C){r.reject(C)}}return Qr}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{const r={replaceUrl:!0},c=e.state?.navigationId?e.state:null;if(c){const _={...c};delete _.navigationId,delete _.\u0275routerPageId,0!==Object.keys(_).length&&(r.state=_)}const g=this.parseUrl(e.url);this.scheduleNavigation(g,i,c,r)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(Qx),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,i={}){const{relativeTo:r,queryParams:c,fragment:g,queryParamsHandling:_,preserveFragment:w}=i,C=r||this.routerState.root,L=w?this.currentUrlTree.fragment:g;let z=null;switch(_){case"merge":z={...this.currentUrlTree.queryParams,...c};break;case"preserve":z=this.currentUrlTree.queryParams;break;default:z=c||null}return null!==z&&(z=this.removeEmptyProps(z)),v4(C,this.currentUrlTree,e,z,L??null)}navigateByUrl(e,i={skipLocationChange:!1}){const r=f_(e)?e:this.parseUrl(e),c=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(c,"imperative",null,i)}navigate(e,i={skipLocationChange:!1}){return function YU(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new wt(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return i}isActive(e,i){let r;if(r=!0===i?{...$U}:!1===i?{...qU}:i,f_(e))return sI(this.currentUrlTree,e,r);const c=this.parseUrl(e);return sI(this.currentUrlTree,c,r)}removeEmptyProps(e){return Object.keys(e).reduce((i,r)=>{const c=e[r];return null!=c&&(i[r]=c),i},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new p_(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,i,r,c,g){if(this.disposed)return Promise.resolve(!1);let _,w,C;g?(_=g.resolve,w=g.reject,C=g.promise):C=new Promise((J,ae)=>{_=J,w=ae});const L=++this.navigationId;let z;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),z=r&&r.\u0275routerPageId?r.\u0275routerPageId:c.replaceUrl||c.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):z=0,this.setTransition({id:L,targetPageId:z,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:c,resolve:_,reject:w,promise:C,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),C.catch(J=>Promise.reject(J))}setBrowserUrl(e,i){const r=this.urlSerializer.serialize(e),c={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",c):this.location.go(r,"",c)}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===r?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===r&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,i,r){const c=new cw(e.id,this.serializeUrl(e.extractedUrl),i,r);this.triggerEvent(c),e.resolve(!1)}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}}return n.\u0275fac=function(e){At()},n.\u0275prov=kn({token:n,factory:function(){return QI()},providedIn:"root"}),n})();function KI(n){return"imperative"!==n}let ww=(()=>{class n{constructor(e,i,r){this.router=e,this.route=i,this.locationStrategy=r,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new Yt,this.subscription=e.events.subscribe(c=>{c instanceof p_&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=Up(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Up(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Up(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,i,r,c,g){return!!(0!==e||i||r||c||g||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(ue(Lo),ue(m_),ue(c_))},n.\u0275dir=Tn({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,i){1&e&&ji("click",function(c){return i.onClick(c.button,c.ctrlKey,c.shiftKey,c.altKey,c.metaKey)}),2&e&&Ar("target",i.target)("href",i.href,Mv)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Aa]}),n})();class ZI{}let ZU=(()=>{class n{constructor(e,i,r,c,g){this.router=e,this.injector=r,this.preloadingStrategy=c,this.loader=g}setUpPreloading(){this.subscription=this.router.events.pipe(Sl(e=>e instanceof p_),xg(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const r=[];for(const c of i){c.providers&&!c._injector&&(c._injector=ST(c.providers,e,`Route: ${c.path}`));const g=c._injector??e,_=c._loadedInjector??g;c.loadChildren&&!c._loadedRoutes&&void 0===c.canLoad||c.loadComponent&&!c._loadedComponent?r.push(this.preloadConfig(g,c)):(c.children||c._loadedRoutes)&&r.push(this.processRoutes(_,c.children??c._loadedRoutes))}return Gs(r).pipe(bo())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):qn(null);const c=r.pipe(vr(g=>null===g?qn(void 0):(i._loadedRoutes=g.routes,i._loadedInjector=g.injector,this.processRoutes(g.injector??e,g.routes))));return i.loadComponent&&!i._loadedComponent?Gs([c,this.loader.loadComponent(i)]).pipe(bo()):c})}}return n.\u0275fac=function(e){return new(e||n)($t(Lo),$t(WA),$t(Do),$t(ZI),$t(nS))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const rS=new En("");let JI=(()=>{class n{constructor(e,i,r={}){this.router=e,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Vx?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof p_&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof bI&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.router.triggerEvent(new bI(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){At()},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();function _y(n,t){return{\u0275kind:n,\u0275providers:t}}function sS(n){return[{provide:tS,multi:!0,useValue:n}]}function tR(){const n=Bn(Ea);return t=>{const e=n.get(uy);if(t!==e.components[0])return;const i=n.get(Lo),r=n.get(nR);1===n.get(aS)&&i.initialNavigation(),n.get(iR,null,gi.Optional)?.setUpPreloading(),n.get(rS,null,gi.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),r.next(),r.complete()}}const nR=new En("",{factory:()=>new Yt}),aS=new En("",{providedIn:"root",factory:()=>1});const iR=new En("");function n5(n){return _y(0,[{provide:iR,useExisting:ZU},{provide:ZI,useExisting:n}])}const rR=new En("ROUTER_FORROOT_GUARD"),i5=[ox,{provide:uI,useClass:Ox},{provide:Lo,useFactory:QI},_1,{provide:m_,useFactory:function eR(n){return n.routerState.root},deps:[Lo]},nS];function r5(){return new ND("Router",Lo)}let oS=(()=>{class n{constructor(e){}static forRoot(e,i){return{ngModule:n,providers:[i5,[],sS(e),{provide:rR,useFactory:l5,deps:[[Lo,new yu,new wd]]},{provide:bw,useValue:i||{}},i?.useHash?{provide:c_,useClass:bF}:{provide:c_,useClass:iM},{provide:rS,useFactory:()=>{const n=Bn(Lo),t=Bn(U3),e=Bn(bw);return e.scrollOffset&&t.setOffset(e.scrollOffset),new JI(n,t,e)}},i?.preloadingStrategy?n5(i.preloadingStrategy).\u0275providers:[],{provide:ND,multi:!0,useFactory:r5},i?.initialNavigation?u5(i):[],[{provide:sR,useFactory:tR},{provide:xD,multi:!0,useExisting:sR}]]}}static forChild(e){return{ngModule:n,providers:[sS(e)]}}}return n.\u0275fac=function(e){return new(e||n)($t(rR,8))},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Xx]}),n})();function l5(n){return"guarded"}function u5(n){return["disabled"===n.initialNavigation?_y(3,[{provide:RT,multi:!0,useFactory:()=>{const t=Bn(Lo);return()=>{t.setUpLocationChangeListener()}}},{provide:aS,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?_y(2,[{provide:aS,useValue:0},{provide:RT,multi:!0,deps:[Ea],useFactory:t=>{const e=t.get(_F,Promise.resolve());let i=!1;return()=>e.then(()=>new Promise(c=>{const g=t.get(Lo),_=t.get(nR);(function r(c){t.get(Lo).events.pipe(Sl(_=>_ instanceof p_||_ instanceof cw||_ instanceof yI),hn(_=>_ instanceof p_||_ instanceof cw&&(0===_.code||1===_.code)&&null),Sl(_=>null!==_),Oo(1)).subscribe(()=>{c()})})(()=>{c(!0),i=!0}),g.afterPreactivation=()=>(c(!0),i||_.closed?qn(void 0):_),g.initialNavigation()}))}}]).\u0275providers:[]]}const sR=new En("");function aR(n,t,e,i,r,c,g){try{var _=n[c](g),w=_.value}catch(C){return void e(C)}_.done?t(w):Promise.resolve(w).then(i,r)}function Sw(n){return function(){var t=this,e=arguments;return new Promise(function(i,r){var c=n.apply(t,e);function g(w){aR(c,i,r,g,_,"next",w)}function _(w){aR(c,i,r,g,_,"throw",w)}g(void 0)})}}let d5=(()=>{class n{constructor(){this.testLog="testData => "}ngOnInit(){this.loadSiteView()}btnGetAllLevel(){var e=this;return Sw(function*(){e.testLog=yield siteView4embed.getLevelAll()})()}loadSiteView(){return Sw(function*(){yield siteView4embed.init("cupix-container","https://eagletest.cupix.works"),yield siteView4embed.start(999999),yield siteView4embed.signinWithToken("T1A05SaIqmIzWdiSX2rcR98YrWutixwf"),yield siteView4embed.goSiteView("c9dvnk",!0)})()}KeyUpCtrl(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Li({type:n,selectors:[["app-cupix"]],hostBindings:function(e,i){1&e&&ji("message",function(c){return i.KeyUpCtrl(c)},0,tc)},decls:11,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-2"],[3,"click"],[1,"col-10"],[1,"col"],["id","cupix-container",1,"ratio","ratio-16x9"]],template:function(e,i){1&e&&(nn(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),ji("click",function(){return i.btnGetAllLevel()}),al(4,"Get All Levels"),rn()(),nn(5,"div",4),al(6),function XC(n,t){const e=Vi();let i;const r=n+22;e.firstCreatePass?(i=function qL(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const c=i.factory||(i.factory=hs(i.type)),g=Rl(ue);try{const _=$f(!1),w=c();return $f(_),function Xt(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,ft(),r,w),w}finally{Rl(g)}}(7,"json"),rn()(),nn(8,"div",1)(9,"div",5),qi(10,"div",6),rn()()()),2&e&&(function Ri(n){$l(Vi(),ft(),$a()+n,!1)}(6),ny(" ",YC(7,1,i.testLog)," "))},dependencies:[_M]}),n})(),h5=(()=>{class n{constructor(){this.testLog="testData => "}ngOnInit(){this.loadSiteView()}btnGetAllLevel(){var e=this;return Sw(function*(){e.testLog=yield siteView4embed.getLevelAll()})()}loadSiteView(){return Sw(function*(){yield siteView4embed.init("cupix-container","https://eagletest.cupix.works"),yield siteView4embed.start(999999),yield siteView4embed.signinWithToken("T1A05SaIqmIzWdiSX2rcR98YrWutixwf"),yield siteView4embed.goSiteView("c9dvnk",!0)})()}KeyUpCtrl(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Li({type:n,selectors:[["app-home"]],hostBindings:function(e,i){1&e&&ji("message",function(c){return i.KeyUpCtrl(c)},0,tc)},decls:3,vars:0,consts:[[1,"row"],[1,"col"]],template:function(e,i){1&e&&(nn(0,"div",0)(1,"div",1),al(2," This is the Home Page. "),rn()())}}),n})(),f5=(()=>{class n{constructor(){this.playStarted=!1,this.video=document.createElement("video")}ngOnInit(){this.loadVideo()}loadVideo(){}playVideo(){if(!this.playStarted){this.playStarted=!0;var e=new Marzipano.Viewer(document.getElementById("pano")),i=new VideoAsset(this.video),r=new Marzipano.SingleAssetSource(i),c=new Marzipano.EquirectGeometry([{width:1}]),g=Marzipano.RectilinearView.limit.vfov(90*Math.PI/180,90*Math.PI/180),_=new Marzipano.RectilinearView({fov:Math.PI/2},g);e.createScene({source:r,geometry:c,view:_}).switchTo(),this.video.src="//media.githubusercontent.com/media/AaronZabala/AaronZabala.github.io/main/assets/sample4.mp4",this.video.crossOrigin="anonymous",this.video.autoplay=!0,this.video.loop=!0,this.video.play()}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Li({type:n,selectors:[["app-marzipano"]],decls:12,vars:0,consts:[[1,"row"],[1,"col-12"],[1,"col"],[3,"click"],["id","pano"]],template:function(e,i){1&e&&(nn(0,"div",0)(1,"div",1)(2,"h3"),al(3,"Marzipano"),rn()()(),nn(4,"div",0)(5,"div",2)(6,"button",3),ji("click",function(){return i.playVideo()}),al(7,"Play"),rn()()(),nn(8,"div",0)(9,"div",2)(10,"div",4),qi(11,"video"),rn()()())}}),n})(),p5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu,oS]}),n})();on(557);const m5=["my_video"],g5=[{path:"",component:h5},{path:"cupix",component:d5},{path:"marzipano",component:f5},{path:"videojs",component:(()=>{class n{constructor(e){this.router=e,this.url="",this.config={controls:!0,autoplay:!1,responsive:!0,loop:!0,preload:"auto",forceCardboard:!0,width:1024,height:768}}ngOnInit(){this.url=decodeURIComponent("https://media.githubusercontent.com/media/AaronZabala/AaronZabala.github.io/main/assets/sample4.mp4")}ngAfterViewInit(){videojs.Vhs.GOAL_BUFFER_LENGTH=100,videojs.Vhs.MAX_GOAL_BUFFER_LENGTH=150,this.player=videojs(this.element.nativeElement,this.config,()=>{this.player.src(this.url),this.player.vr({projection:"360"})}),this.player.on("error",e=>{console.warn(e)})}ngOnDestroy(){this.player&&this.player.dispose()}}return n.\u0275fac=function(e){return new(e||n)(ue(Lo))},n.\u0275cmp=Li({type:n,selectors:[["app-videojs"]],viewQuery:function(e,i){if(1&e&&DT(m5,5),2&e){let r;Xs(r=Ys())&&(i.element=r.first)}},decls:9,vars:0,consts:[[1,"row"],[1,"col-12"],[1,"video-view"],["data-setup",'{ "playbackRates": [0.5, 1, 1.5, 2]}',"crossorigin","anonymous",1,"video-js","vjs-default-skin"],["my_video",""]],template:function(e,i){1&e&&(nn(0,"div",0)(1,"div",1)(2,"h3"),al(3,"Video JS"),rn()()(),nn(4,"div",0)(5,"div",1)(6,"div",2),qi(7,"video",3,4),rn()()())}}),n})()}];let lS,v5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[oS.forRoot(g5),p5,oS]}),n})();try{lS=typeof Intl<"u"&&Intl.v8BreakIterator}catch{lS=!1}let uS=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function TM(n){return n===bM}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!lS)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(e){return new(e||n)($t(PT))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function lR(n){return Array.isArray(n)?n:[n]}class C5 extends Mt{constructor(t,e){super()}schedule(t,e=0){return this}}const Cw={setInterval(n,t,...e){const{delegate:i}=Cw;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=Cw;return(t?.clearInterval||clearInterval)(n)},delegate:void 0},cR={now:()=>(cR.delegate||Date).now(),delegate:void 0};class S1{constructor(t,e=S1.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}S1.now=cR.now;const hS=new class M5 extends S1{constructor(t,e=S1.now){super(t,e),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}(class D5 extends C5{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,i=0){return Cw.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;Cw.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,i=!1;try{this.work(t)}catch(c){i=!0,r=c||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Oe(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}),I5=hS;function Ja(n){return Dn((t,e)=>{Re(n).subscribe(gn(e,()=>e.complete(),Bt)),!e.closed&&t.subscribe(e)})}const dR=new Set;let by,N5=(()=>{class n{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):O5}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function P5(n){if(!dR.has(n))try{by||(by=document.createElement("style"),by.setAttribute("type","text/css"),document.head.appendChild(by)),by.sheet&&(by.sheet.insertRule(`@media ${n} {body{ }}`,0),dR.add(n))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return n.\u0275fac=function(e){return new(e||n)($t(uS))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function O5(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let L5=(()=>{class n{constructor(e,i){this._mediaMatcher=e,this._zone=i,this._queries=new Map,this._destroySubject=new Yt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return hR(lR(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let c=u1(hR(lR(e)).map(g=>this._registerQuery(g).observable));return c=cy(c.pipe(Oo(1)),c.pipe(function uR(n){return Sl((t,e)=>n<=e)}(1),function R5(n,t=hS){return Dn((e,i)=>{let r=null,c=null,g=null;const _=()=>{if(r){r.unsubscribe(),r=null;const C=c;c=null,i.next(C)}};function w(){const C=g+n,L=t.now();if(L<C)return r=this.schedule(void 0,C-L),void i.add(r);_()}e.subscribe(gn(i,C=>{c=C,g=t.now(),r||(r=t.schedule(w,n),i.add(r))},()=>{_(),i.complete()},void 0,()=>{c=r=null}))})}(0))),c.pipe(hn(g=>{const _={matches:!1,breakpoints:{}};return g.forEach(({matches:w,query:C})=>{_.matches=_.matches||w,_.breakpoints[C]=w}),_}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const i=this._mediaMatcher.matchMedia(e),c={observable:new jt(g=>{const _=w=>this._zone.run(()=>g.next(w));return i.addListener(_),()=>{i.removeListener(_)}}).pipe(c1(i),hn(({matches:g})=>({query:e,matches:g})),Ja(this._destroySubject)),mql:i};return this._queries.set(e,c),c}}return n.\u0275fac=function(e){return new(e||n)($t(N5),$t(vs))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hR(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}const gR="cdk-high-contrast-black-on-white",vR="cdk-high-contrast-white-on-black",fS="cdk-high-contrast-active";let z5=(()=>{class n{constructor(e,i){this._platform=e,this._document=i,this._breakpointSubscription=Bn(L5).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(e):null,c=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),c){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(fS,gR,vR),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?e.add(fS,gR):2===i&&e.add(fS,vR)}}}return n.\u0275fac=function(e){return new(e||n)($t(uS),$t(ls))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),_R=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})();const X5=new En("mat-sanity-checks",{providedIn:"root",factory:function q5(){return!0}});let Dw=(()=>{class n{constructor(e,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!function b5(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return n.\u0275fac=function(e){return new(e||n)($t(z5),$t(X5,8),$t(ls))},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[_R,_R]}),n})();function Y5(n,t){return class extends n{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const i=e||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}const eV=["*",[["mat-toolbar-row"]]],tV=["*","mat-toolbar-row"],nV=Y5(class{constructor(n){this._elementRef=n}});let xR=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Tn({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),iV=(()=>{class n extends nV{constructor(e,i,r){super(e),this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(e){return new(e||n)(ue(Pr),ue(uS),ue(ls))},n.\u0275cmp=Li({type:n,selectors:[["mat-toolbar"]],contentQueries:function(e,i,r){if(1&e&&function Ia(n,t,e,i){const r=Vi();if(r.firstCreatePass){const c=Os();nD(r,new JC(t,e,i),c.index),function hk(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(r,n),2==(2&e)&&(r.staticContentQueries=!0)}tD(r,ft(),e)}(r,xR,5),2&e){let c;Xs(c=Ys())&&(i._toolbarRows=c)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(e,i){2&e&&ga("mat-toolbar-multiple-rows",i._toolbarRows.length>0)("mat-toolbar-single-row",0===i._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Xe],ngContentSelectors:tV,decls:2,vars:0,template:function(e,i){1&e&&(qc(eV),ee(0),ee(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),rV=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Dw,Dw]}),n})(),sV=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Li({type:n,selectors:[["app-header"]],decls:9,vars:0,consts:[[1,"row"],[1,"col"]],template:function(e,i){1&e&&(nn(0,"div",0)(1,"div",1)(2,"mat-toolbar")(3,"mat-toolbar-row")(4,"span"),al(5,"Demo 360 Video Player"),rn()()()()(),nn(6,"div",0)(7,"div",1),al(8," \xa0 "),rn()())},dependencies:[iV,xR]}),n})(),aV=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Li({type:n,selectors:[["app-footer"]],decls:2,vars:0,consts:[[1,"row"],[1,"col"]],template:function(e,i){1&e&&(nn(0,"div",0),qi(1,"div",1),rn())}}),n})(),oV=(()=>{class n{constructor(){this.title="msc-app"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Li({type:n,selectors:[["app-root"]],decls:19,vars:0,consts:[[1,"row"],[1,"col-1"],["routerLink","/"],["routerLink","/cupix"],["routerLink","/videojs"],["routerLink","/marzipano"],[1,"col-11"]],template:function(e,i){1&e&&(qi(0,"app-header"),nn(1,"div",0)(2,"div",1)(3,"ul")(4,"li")(5,"a",2),al(6,"Home"),rn()(),nn(7,"li")(8,"a",3),al(9,"Cupix"),rn()(),nn(10,"li")(11,"a",4),al(12,"Video JS"),rn()(),nn(13,"li")(14,"a",5),al(15,"Marzipano"),rn()()()(),nn(16,"div",6),qi(17,"router-outlet"),rn()(),qi(18,"app-footer"))},dependencies:[qx,ww,sV,aV]}),n})();class SR{}const Wp="*";function ER(n,t=null){return{type:2,steps:n,options:t}}function CR(n){return{type:6,styles:n,offset:null}}function DR(n){Promise.resolve().then(n)}class C1{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){DR(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class MR{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,r=0;const c=this.players.length;0==c?DR(()=>this._onFinish()):this.players.forEach(g=>{g.onDone(()=>{++e==c&&this._onFinish()}),g.onDestroy(()=>{++i==c&&this._onDestroy()}),g.onStart(()=>{++r==c&&this._onStart()})}),this.totalTime=this.players.reduce((g,_)=>Math.max(g,_.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function IR(n){return new wt(3e3,!1)}function jV(){return typeof window<"u"&&typeof window.document<"u"}function gS(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Eg(n){switch(n.length){case 0:return new C1;case 1:return n[0];default:return new MR(n)}}function RR(n,t,e,i,r=new Map,c=new Map){const g=[],_=[];let w=-1,C=null;if(i.forEach(L=>{const z=L.get("offset"),J=z==w,ae=J&&C||new Map;L.forEach((we,Ee)=>{let He=Ee,Ye=we;if("offset"!==Ee)switch(He=t.normalizePropertyName(He,g),Ye){case"!":Ye=r.get(Ee);break;case Wp:Ye=c.get(Ee);break;default:Ye=t.normalizeStyleValue(Ee,He,Ye,g)}ae.set(He,Ye)}),J||_.push(ae),C=ae,w=z}),g.length)throw function RV(n){return new wt(3502,!1)}();return _}function vS(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&_S(e,"start",n)));break;case"done":n.onDone(()=>i(e&&_S(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&_S(e,"destroy",n)))}}function _S(n,t,e){const c=yS(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),g=n._data;return null!=g&&(c._data=g),c}function yS(n,t,e,i,r="",c=0,g){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:r,totalTime:c,disabled:!!g}}function gc(n,t,e){let i=n.get(t);return i||n.set(t,i=e),i}function NR(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let bS=(n,t)=>!1,PR=(n,t,e)=>[],OR=null;function TS(n){const t=n.parentNode||n.host;return t===OR?null:t}(gS()||typeof Element<"u")&&(jV()?(OR=(()=>document.documentElement)(),bS=(n,t)=>{for(;t;){if(t===n)return!0;t=TS(t)}return!1}):bS=(n,t)=>n.contains(t),PR=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]});let v_=null,LR=!1;const kR=bS,FR=PR;let BR=(()=>{class n{validateStyleProperty(e){return function WV(n){v_||(v_=function $V(){return typeof document<"u"?document.body:null}()||{},LR=!!v_.style&&"WebkitAppearance"in v_.style);let t=!0;return v_.style&&!function zV(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in v_.style,!t&&LR&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in v_.style)),t}(e)}matchesElement(e,i){return!1}containsElement(e,i){return kR(e,i)}getParentElement(e){return TS(e)}query(e,i,r){return FR(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,c,g,_=[],w){return new C1(r,c)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})(),wS=(()=>{class n{}return n.NOOP=new BR,n})();const AS="ng-enter",Mw="ng-leave",Iw="ng-trigger",Rw=".ng-trigger",VR="ng-animating",xS=".ng-animating";function Cg(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:SS(parseFloat(t[1]),t[2])}function SS(n,t){return"s"===t?1e3*n:n}function Nw(n,t,e){return n.hasOwnProperty("duration")?n:function YV(n,t,e){let r,c=0,g="";if("string"==typeof n){const _=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===_)return t.push(IR()),{duration:0,delay:0,easing:""};r=SS(parseFloat(_[1]),_[2]);const w=_[3];null!=w&&(c=SS(parseFloat(w),_[4]));const C=_[5];C&&(g=C)}else r=n;if(!e){let _=!1,w=t.length;r<0&&(t.push(function uV(){return new wt(3100,!1)}()),_=!0),c<0&&(t.push(function cV(){return new wt(3101,!1)}()),_=!0),_&&t.splice(w,0,IR())}return{duration:r,delay:c,easing:g}}(n,t,e)}function D1(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function HR(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function Dg(n,t=new Map,e){if(e)for(let[i,r]of e)t.set(i,r);for(let[i,r]of n)t.set(i,r);return t}function jR(n,t,e){return e?t+":"+e+";":""}function zR(n){let t="";for(let e=0;e<n.style.length;e++){const i=n.style.item(e);t+=jR(0,i,n.style.getPropertyValue(i))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=jR(0,JV(e),n.style[e]));n.setAttribute("style",t)}function Af(n,t,e){n.style&&(t.forEach((i,r)=>{const c=CS(r);e&&!e.has(r)&&e.set(r,n.style[c]),n.style[c]=i}),gS()&&zR(n))}function __(n,t){n.style&&(t.forEach((e,i)=>{const r=CS(i);n.style[r]=""}),gS()&&zR(n))}function M1(n){return Array.isArray(n)?1==n.length?n[0]:ER(n):n}const ES=new RegExp("{{\\s*(.+?)\\s*}}","g");function WR(n){let t=[];if("string"==typeof n){let e;for(;e=ES.exec(n);)t.push(e[1]);ES.lastIndex=0}return t}function Pw(n,t,e){const i=n.toString(),r=i.replace(ES,(c,g)=>{let _=t[g];return null==_&&(e.push(function hV(n){return new wt(3003,!1)}()),_=""),_.toString()});return r==i?n:r}function Ow(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const ZV=/-+([a-z0-9])/g;function CS(n){return n.replace(ZV,(...t)=>t[1].toUpperCase())}function JV(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function vc(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function fV(n){return new wt(3004,!1)}()}}function s8(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function a8(n,t,e){if(":"==n[0]){const w=function o8(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function CV(n){return new wt(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof w)return void t.push(w);n=w}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function EV(n){return new wt(3015,!1)}()),t;const r=i[1],c=i[2],g=i[3];t.push(qR(r,g));"<"==c[0]&&!("*"==r&&"*"==g)&&t.push(qR(g,r))}(i,e,t)):e.push(n),e}const Bw=new Set(["true","1"]),Uw=new Set(["false","0"]);function qR(n,t){const e=Bw.has(n)||Uw.has(n),i=Bw.has(t)||Uw.has(t);return(r,c)=>{let g="*"==n||n==r,_="*"==t||t==c;return!g&&e&&"boolean"==typeof r&&(g=r?Bw.has(n):Uw.has(n)),!_&&i&&"boolean"==typeof c&&(_=c?Bw.has(t):Uw.has(t)),g&&_}}const l8=new RegExp("s*:selfs*,?","g");function DS(n,t,e,i){return new u8(n).build(t,e,i)}class u8{constructor(t){this._driver=t}build(t,e,i){const r=new h8(e);return this._resetContextStyleTimingState(r),vc(this,M1(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,r=e.depCount=0;const c=[],g=[];return"@"==t.name.charAt(0)&&e.errors.push(function mV(){return new wt(3006,!1)}()),t.definitions.forEach(_=>{if(this._resetContextStyleTimingState(e),0==_.type){const w=_,C=w.name;C.toString().split(/\s*,\s*/).forEach(L=>{w.name=L,c.push(this.visitState(w,e))}),w.name=C}else if(1==_.type){const w=this.visitTransition(_,e);i+=w.queryCount,r+=w.depCount,g.push(w)}else e.errors.push(function gV(){return new wt(3007,!1)}())}),{type:7,name:t.name,states:c,transitions:g,queryCount:i,depCount:r,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const c=new Set,g=r||{};i.styles.forEach(_=>{_ instanceof Map&&_.forEach(w=>{WR(w).forEach(C=>{g.hasOwnProperty(C)||c.add(C)})})}),c.size&&(Ow(c.values()),e.errors.push(function vV(n,t){return new wt(3008,!1)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=vc(this,M1(t.animation),e);return{type:1,matchers:s8(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:y_(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>vc(this,i,e)),options:y_(t.options)}}visitGroup(t,e){const i=e.currentTime;let r=0;const c=t.steps.map(g=>{e.currentTime=i;const _=vc(this,g,e);return r=Math.max(r,e.currentTime),_});return e.currentTime=r,{type:3,steps:c,options:y_(t.options)}}visitAnimate(t,e){const i=function p8(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return MS(Nw(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(c=>"{"==c.charAt(0)&&"{"==c.charAt(1))){const c=MS(0,0,"");return c.dynamic=!0,c.strValue=e,c}const r=Nw(e,t);return MS(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let r,c=t.styles?t.styles:CR({});if(5==c.type)r=this.visitKeyframes(c,e);else{let g=t.styles,_=!1;if(!g){_=!0;const C={};i.easing&&(C.easing=i.easing),g=CR(C)}e.currentTime+=i.duration+i.delay;const w=this.visitStyle(g,e);w.isEmptyStep=_,r=w}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let _ of r)"string"==typeof _?_===Wp?i.push(_):e.errors.push(new wt(3002,!1)):i.push(HR(_));let c=!1,g=null;return i.forEach(_=>{if(_ instanceof Map&&(_.has("easing")&&(g=_.get("easing"),_.delete("easing")),!c))for(let w of _.values())if(w.toString().indexOf("{{")>=0){c=!0;break}}),{type:6,styles:i,easing:g,offset:t.offset,containsDynamicStyles:c,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let r=e.currentTime,c=e.currentTime;i&&c>0&&(c-=i.duration+i.delay),t.styles.forEach(g=>{"string"!=typeof g&&g.forEach((_,w)=>{const C=e.collectedStyles.get(e.currentQuerySelector),L=C.get(w);let z=!0;L&&(c!=r&&c>=L.startTime&&r<=L.endTime&&(e.errors.push(function yV(n,t,e,i,r){return new wt(3010,!1)}()),z=!1),c=L.startTime),z&&C.set(w,{startTime:c,endTime:r}),e.options&&function KV(n,t,e){const i=t.params||{},r=WR(n);r.length&&r.forEach(c=>{i.hasOwnProperty(c)||e.push(function dV(n){return new wt(3001,!1)}())})}(_,e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function bV(){return new wt(3011,!1)}()),i;let c=0;const g=[];let _=!1,w=!1,C=0;const L=t.steps.map(Ye=>{const ot=this._makeStyleAst(Ye,e);let Ke=null!=ot.offset?ot.offset:function f8(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(ot.styles),Ct=0;return null!=Ke&&(c++,Ct=ot.offset=Ke),w=w||Ct<0||Ct>1,_=_||Ct<C,C=Ct,g.push(Ct),ot});w&&e.errors.push(function TV(){return new wt(3012,!1)}()),_&&e.errors.push(function wV(){return new wt(3200,!1)}());const z=t.steps.length;let J=0;c>0&&c<z?e.errors.push(function AV(){return new wt(3202,!1)}()):0==c&&(J=1/(z-1));const ae=z-1,we=e.currentTime,Ee=e.currentAnimateTimings,He=Ee.duration;return L.forEach((Ye,ot)=>{const Ke=J>0?ot==ae?1:J*ot:g[ot],Ct=Ke*He;e.currentTime=we+Ee.delay+Ct,Ee.duration=Ct,this._validateStyleAst(Ye,e),Ye.offset=Ke,i.styles.push(Ye)}),i}visitReference(t,e){return{type:8,animation:vc(this,M1(t.animation),e),options:y_(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:y_(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:y_(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[c,g]=function c8(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(l8,"")),n=n.replace(/@\*/g,Rw).replace(/@\w+/g,e=>Rw+"-"+e.slice(1)).replace(/:animating/g,xS),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+c:c,gc(e.collectedStyles,e.currentQuerySelector,new Map);const _=vc(this,M1(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:c,limit:r.limit||0,optional:!!r.optional,includeSelf:g,animation:_,originalSelector:t.selector,options:y_(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function xV(){return new wt(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:Nw(t.timings,e.errors,!0);return{type:12,animation:vc(this,M1(t.animation),e),timings:i,options:null}}}class h8{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function y_(n){return n?(n=D1(n)).params&&(n.params=function d8(n){return n?D1(n):null}(n.params)):n={},n}function MS(n,t,e){return{duration:n,delay:t,easing:e}}function IS(n,t,e,i,r,c,g=null,_=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:r,delay:c,totalTime:r+c,easing:g,subTimeline:_}}class Vw{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const v8=new RegExp(":enter","g"),y8=new RegExp(":leave","g");function RS(n,t,e,i,r,c=new Map,g=new Map,_,w,C=[]){return(new b8).buildKeyframes(n,t,e,i,r,c,g,_,w,C)}class b8{buildKeyframes(t,e,i,r,c,g,_,w,C,L=[]){C=C||new Vw;const z=new NS(t,e,C,r,c,L,[]);z.options=w;const J=w.delay?Cg(w.delay):0;z.currentTimeline.delayNextStep(J),z.currentTimeline.setStyles([g],null,z.errors,w),vc(this,i,z);const ae=z.timelines.filter(we=>we.containsAnimation());if(ae.length&&_.size){let we;for(let Ee=ae.length-1;Ee>=0;Ee--){const He=ae[Ee];if(He.element===e){we=He;break}}we&&!we.allowOnlyTimelineStyles()&&we.setStyles([_],null,z.errors,w)}return ae.length?ae.map(we=>we.buildKeyframes()):[IS(e,[],[],[],0,J,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(t.options),c=e.currentTimeline.currentTime,g=this._visitSubInstructions(i,r,r.options);c!=g&&e.transformIntoNewTimeline(g)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,i){let c=e.currentTimeline.currentTime;const g=null!=i.duration?Cg(i.duration):null,_=null!=i.delay?Cg(i.delay):null;return 0!==g&&t.forEach(w=>{const C=e.appendInstructionToTimeline(w,g,_);c=Math.max(c,C.duration+C.delay)}),c}visitReference(t,e){e.updateOptions(t.options,!0),vc(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let r=e;const c=t.options;if(c&&(c.params||c.delay)&&(r=e.createSubContext(c),r.transformIntoNewTimeline(),null!=c.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Hw);const g=Cg(c.delay);r.delayNextStep(g)}t.steps.length&&(t.steps.forEach(g=>vc(this,g,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let r=e.currentTimeline.currentTime;const c=t.options&&t.options.delay?Cg(t.options.delay):0;t.steps.forEach(g=>{const _=e.createSubContext(t.options);c&&_.delayNextStep(c),vc(this,g,_),r=Math.max(r,_.currentTimeline.currentTime),i.push(_.currentTimeline)}),i.forEach(g=>e.currentTimeline.mergeTimelineCollectedStyles(g)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return Nw(e.params?Pw(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const c=t.style;5==c.type?this.visitKeyframes(c,e):(e.incrementTime(i.duration),this.visitStyle(c,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const c=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(c):i.setStyles(t.styles,c,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,c=i.duration,_=e.createSubContext().currentTimeline;_.easing=i.easing,t.styles.forEach(w=>{_.forwardTime((w.offset||0)*c),_.setStyles(w.styles,w.easing,e.errors,e.options),_.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(_),e.transformIntoNewTimeline(r+c),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,r=t.options||{},c=r.delay?Cg(r.delay):0;c&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Hw);let g=i;const _=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=_.length;let w=null;_.forEach((C,L)=>{e.currentQueryIndex=L;const z=e.createSubContext(t.options,C);c&&z.delayNextStep(c),C===e.element&&(w=z.currentTimeline),vc(this,t.animation,z),z.currentTimeline.applyStylesToKeyframe(),g=Math.max(g,z.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(g),w&&(e.currentTimeline.mergeTimelineCollectedStyles(w),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,r=e.currentTimeline,c=t.timings,g=Math.abs(c.duration),_=g*(e.currentQueryTotal-1);let w=g*e.currentQueryIndex;switch(c.duration<0?"reverse":c.easing){case"reverse":w=_-w;break;case"full":w=i.currentStaggerTime}const L=e.currentTimeline;w&&L.delayNextStep(w);const z=L.currentTime;vc(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=r.currentTime-z+(r.startTime-i.currentTimeline.startTime)}}const Hw={};class NS{constructor(t,e,i,r,c,g,_,w){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=c,this.errors=g,this.timelines=_,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Hw,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=w||new Gw(this._driver,e,0),_.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=Cg(i.duration)),null!=i.delay&&(r.delay=Cg(i.delay));const c=i.params;if(c){let g=r.params;g||(g=this.options.params={}),Object.keys(c).forEach(_=>{(!e||!g.hasOwnProperty(_))&&(g[_]=Pw(c[_],g,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return t}createSubContext(t=null,e,i){const r=e||this.element,c=new NS(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return c.previousNode=this.previousNode,c.currentAnimateTimings=this.currentAnimateTimings,c.options=this._copyOptions(),c.updateOptions(t),c.currentQueryIndex=this.currentQueryIndex,c.currentQueryTotal=this.currentQueryTotal,c.parentContext=this,this.subContextCount++,c}transformIntoNewTimeline(t){return this.previousNode=Hw,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},c=new T8(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(c),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,r,c,g){let _=[];if(r&&_.push(this.element),t.length>0){t=(t=t.replace(v8,"."+this._enterClassName)).replace(y8,"."+this._leaveClassName);let C=this._driver.query(this.element,t,1!=i);0!==i&&(C=i<0?C.slice(C.length+i,C.length):C.slice(0,i)),_.push(...C)}return!c&&0==_.length&&g.push(function SV(n){return new wt(3014,!1)}()),_}}class Gw{constructor(t,e,i,r){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Gw(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||Wp),this._currentKeyframe.set(e,Wp);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,r){e&&this._previousKeyframe.set("easing",e);const c=r&&r.params||{},g=function w8(n,t){const e=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||t.keys();for(let c of i)e.set(c,Wp)}else Dg(r,e)}),e}(t,this._globalTimelineStyles);for(let[_,w]of g){const C=Pw(w,c,i);this._pendingStyles.set(_,C),this._localTimelineStyles.has(_)||this._backFill.set(_,this._globalTimelineStyles.get(_)??Wp),this._updateStyle(_,C)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((_,w)=>{const C=Dg(_,new Map,this._backFill);C.forEach((L,z)=>{"!"===L?t.add(z):L===Wp&&e.add(z)}),i||C.set("offset",w/this.duration),r.push(C)});const c=t.size?Ow(t.values()):[],g=e.size?Ow(e.values()):[];if(i){const _=r[0],w=new Map(_);_.set("offset",0),w.set("offset",1),r=[_,w]}return IS(this.element,r,c,g,this.duration,this.startTime,this.easing,!1)}}class T8 extends Gw{constructor(t,e,i,r,c,g,_=!1){super(t,e,g.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=c,this._stretchStartingKeyframe=_,this.timings={duration:g.duration,delay:g.delay,easing:g.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const c=[],g=i+e,_=e/g,w=Dg(t[0]);w.set("offset",0),c.push(w);const C=Dg(t[0]);C.set("offset",QR(_)),c.push(C);const L=t.length-1;for(let z=1;z<=L;z++){let J=Dg(t[z]);const ae=J.get("offset");J.set("offset",QR((e+ae*i)/g)),c.push(J)}i=g,e=0,r="",t=c}return IS(this.element,t,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function QR(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class PS{}const A8=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class x8 extends PS{normalizePropertyName(t,e){return CS(t)}normalizeStyleValue(t,e,i,r){let c="";const g=i.toString().trim();if(A8.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)c="px";else{const _=i.match(/^[+-]?[\d\.]+([a-z]*)$/);_&&0==_[1].length&&r.push(function pV(n,t){return new wt(3005,!1)}())}return g+c}}function KR(n,t,e,i,r,c,g,_,w,C,L,z,J){return{type:0,element:n,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:c,toState:i,toStyles:g,timelines:_,queriedElements:w,preStyleProps:C,postStyleProps:L,totalTime:z,errors:J}}const OS={};class ZR{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,r){return function S8(n,t,e,i,r){return n.some(c=>c(t,e,i,r))}(this.ast.matchers,t,e,i,r)}buildStyles(t,e,i){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,i):new Map}build(t,e,i,r,c,g,_,w,C,L){const z=[],J=this.ast.options&&this.ast.options.params||OS,we=this.buildStyles(i,_&&_.params||OS,z),Ee=w&&w.params||OS,He=this.buildStyles(r,Ee,z),Ye=new Set,ot=new Map,Ke=new Map,Ct="void"===r,_n={params:E8(Ee,J),delay:this.ast.options?.delay},Ln=L?[]:RS(t,e,this.ast.animation,c,g,we,He,_n,C,z);let Ei=0;if(Ln.forEach(Fr=>{Ei=Math.max(Fr.duration+Fr.delay,Ei)}),z.length)return KR(e,this._triggerName,i,r,Ct,we,He,[],[],ot,Ke,Ei,z);Ln.forEach(Fr=>{const Br=Fr.element,ws=gc(ot,Br,new Set);Fr.preStyleProps.forEach(Is=>ws.add(Is));const Va=gc(Ke,Br,new Set);Fr.postStyleProps.forEach(Is=>Va.add(Is)),Br!==e&&Ye.add(Br)});const Xi=Ow(Ye.values());return KR(e,this._triggerName,i,r,Ct,we,He,Ln,Xi,ot,Ke,Ei)}}function E8(n,t){const e=D1(t);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(e[i]=n[i]);return e}class C8{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i=new Map,r=D1(this.defaultParams);return Object.keys(t).forEach(c=>{const g=t[c];null!==g&&(r[c]=g)}),this.styles.styles.forEach(c=>{"string"!=typeof c&&c.forEach((g,_)=>{g&&(g=Pw(g,r,e));const w=this.normalizer.normalizePropertyName(_,e);g=this.normalizer.normalizeStyleValue(_,w,g,e),i.set(w,g)})}),i}}class M8{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new C8(r.style,r.options&&r.options.params||{},i))}),JR(this.states,"true","1"),JR(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new ZR(t,r,this.states))}),this.fallbackTransition=function I8(n,t,e){return new ZR(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(g,_)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,r){return this.transitionFactories.find(g=>g.match(t,e,i,r))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function JR(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const R8=new Vw;class N8{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const i=[],c=DS(this._driver,e,i,[]);if(i.length)throw function NV(n){return new wt(3503,!1)}();this._animations.set(t,c)}_buildPlayer(t,e,i){const r=t.element,c=RR(0,this._normalizer,0,t.keyframes,e,i);return this._driver.animate(r,c,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const r=[],c=this._animations.get(t);let g;const _=new Map;if(c?(g=RS(this._driver,e,c,AS,Mw,new Map,new Map,i,R8,r),g.forEach(L=>{const z=gc(_,L.element,new Map);L.postStyleProps.forEach(J=>z.set(J,null))})):(r.push(function PV(){return new wt(3300,!1)}()),g=[]),r.length)throw function OV(n){return new wt(3504,!1)}();_.forEach((L,z)=>{L.forEach((J,ae)=>{L.set(ae,this._driver.computeStyle(z,ae,Wp))})});const C=Eg(g.map(L=>{const z=_.get(L.element);return this._buildPlayer(L,new Map,z)}));return this._playersById.set(t,C),C.onDestroy(()=>this.destroy(t)),this.players.push(C),C}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function LV(n){return new wt(3301,!1)}();return e}listen(t,e,i,r){const c=yS(e,"","","");return vS(this._getPlayer(t),i,c,r),()=>{}}command(t,e,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,e,r[0]||{});const c=this._getPlayer(t);switch(i){case"play":c.play();break;case"pause":c.pause();break;case"reset":c.reset();break;case"restart":c.restart();break;case"finish":c.finish();break;case"init":c.init();break;case"setPosition":c.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const eN="ng-animate-queued",LS="ng-animate-disabled",F8=[],tN={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},B8={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Zc="__ng_removed";class kS{constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function G8(n){return n??null}(i?t.value:t),i){const c=D1(t);delete c.value,this.options=c}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const I1="void",FS=new kS(I1);class U8{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Jc(e,this._hostClassName)}listen(t,e,i,r){if(!this._triggers.has(e))throw function kV(n,t){return new wt(3302,!1)}();if(null==i||0==i.length)throw function FV(n){return new wt(3303,!1)}();if(!function j8(n){return"start"==n||"done"==n}(i))throw function BV(n,t){return new wt(3400,!1)}();const c=gc(this._elementListeners,t,[]),g={name:e,phase:i,callback:r};c.push(g);const _=gc(this._engine.statesByElement,t,new Map);return _.has(e)||(Jc(t,Iw),Jc(t,Iw+"-"+e),_.set(e,FS)),()=>{this._engine.afterFlush(()=>{const w=c.indexOf(g);w>=0&&c.splice(w,1),this._triggers.has(e)||_.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function UV(n){return new wt(3401,!1)}();return e}trigger(t,e,i,r=!0){const c=this._getTrigger(e),g=new BS(this.id,e,t);let _=this._engine.statesByElement.get(t);_||(Jc(t,Iw),Jc(t,Iw+"-"+e),this._engine.statesByElement.set(t,_=new Map));let w=_.get(e);const C=new kS(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&w&&C.absorbOptions(w.options),_.set(e,C),w||(w=FS),C.value!==I1&&w.value===C.value){if(!function $8(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const c=e[r];if(!t.hasOwnProperty(c)||n[c]!==t[c])return!1}return!0}(w.params,C.params)){const Ee=[],He=c.matchStyles(w.value,w.params,Ee),Ye=c.matchStyles(C.value,C.params,Ee);Ee.length?this._engine.reportError(Ee):this._engine.afterFlush(()=>{__(t,He),Af(t,Ye)})}return}const J=gc(this._engine.playersByElement,t,[]);J.forEach(Ee=>{Ee.namespaceId==this.id&&Ee.triggerName==e&&Ee.queued&&Ee.destroy()});let ae=c.matchTransition(w.value,C.value,t,C.params),we=!1;if(!ae){if(!r)return;ae=c.fallbackTransition,we=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:ae,fromState:w,toState:C,player:g,isFallbackTransition:we}),we||(Jc(t,eN),g.onStart(()=>{Ty(t,eN)})),g.onDone(()=>{let Ee=this.players.indexOf(g);Ee>=0&&this.players.splice(Ee,1);const He=this._engine.playersByElement.get(t);if(He){let Ye=He.indexOf(g);Ye>=0&&He.splice(Ye,1)}}),this.players.push(g),J.push(g),g}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,Rw,!0);i.forEach(r=>{if(r[Zc])return;const c=this._engine.fetchNamespacesByElement(r);c.size?c.forEach(g=>g.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,i,r){const c=this._engine.statesByElement.get(t),g=new Map;if(c){const _=[];if(c.forEach((w,C)=>{if(g.set(C,w.value),this._triggers.has(C)){const L=this.trigger(t,C,I1,r);L&&_.push(L)}}),_.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,g),i&&Eg(_).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const r=new Set;e.forEach(c=>{const g=c.name;if(r.has(g))return;r.add(g);const w=this._triggers.get(g).fallbackTransition,C=i.get(g)||FS,L=new kS(I1),z=new BS(this.id,g,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:g,transition:w,fromState:C,toState:L,player:z,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(i.totalAnimations){const c=i.players.length?i.playersByQueriedElement.get(t):[];if(c&&c.length)r=!0;else{let g=t;for(;g=g.parentNode;)if(i.statesByElement.get(g)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,e);else{const c=t[Zc];(!c||c===tN)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){Jc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const c=i.element,g=this._elementListeners.get(c);g&&g.forEach(_=>{if(_.name==i.triggerName){const w=yS(c,i.triggerName,i.fromState.value,i.toState.value);w._data=t,vS(i.player,_.phase,w,_.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const c=i.transition.ast.depCount,g=r.transition.ast.depCount;return 0==c||0==g?c-g:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class V8{constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,c)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new U8(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let g=!1,_=this.driver.getParentElement(e);for(;_;){const w=r.get(_);if(w){const C=i.indexOf(w);i.splice(C+1,0,t),g=!0;break}_=this.driver.getParentElement(_)}g||i.unshift(t)}else i.push(t);return r.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let r=this._namespaceLookup[t];r&&r.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i)for(let r of i.values())if(r.namespaceId){const c=this._fetchNamespace(r.namespaceId);c&&e.add(c)}return e}trigger(t,e,i,r){if(jw(e)){const c=this._fetchNamespace(t);if(c)return c.trigger(e,i,r),!0}return!1}insertNode(t,e,i,r){if(!jw(e))return;const c=e[Zc];if(c&&c.setForRemoval){c.setForRemoval=!1,c.setForMove=!0;const g=this.collectedLeaveElements.indexOf(e);g>=0&&this.collectedLeaveElements.splice(g,1)}if(t){const g=this._fetchNamespace(t);g&&g.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Jc(t,LS)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Ty(t,LS))}removeNode(t,e,i,r){if(jw(e)){const c=t?this._fetchNamespace(t):null;if(c?c.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),i){const g=this.namespacesByHostElement.get(e);g&&g.id!==t&&g.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,i,r,c){this.collectedLeaveElements.push(e),e[Zc]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:c}}listen(t,e,i,r,c){return jw(e)?this._fetchNamespace(t).listen(e,i,r,c):()=>{}}_buildInstruction(t,e,i,r,c){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,e,c)}destroyInnerAnimations(t){let e=this.driver.query(t,Rw,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,xS,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Eg(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Zc];if(e&&e.setForRemoval){if(t[Zc]=tN,e.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(LS)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Jc(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Eg(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function VV(n){return new wt(3402,!1)}()}_flushAnimations(t,e){const i=new Vw,r=[],c=new Map,g=[],_=new Map,w=new Map,C=new Map,L=new Set;this.disabledNodes.forEach(bn=>{L.add(bn);const jn=this.driver.query(bn,".ng-animate-queued",!0);for(let mi=0;mi<jn.length;mi++)L.add(jn[mi])});const z=this.bodyNode,J=Array.from(this.statesByElement.keys()),ae=rN(J,this.collectedEnterElements),we=new Map;let Ee=0;ae.forEach((bn,jn)=>{const mi=AS+Ee++;we.set(jn,mi),bn.forEach(Ji=>Jc(Ji,mi))});const He=[],Ye=new Set,ot=new Set;for(let bn=0;bn<this.collectedLeaveElements.length;bn++){const jn=this.collectedLeaveElements[bn],mi=jn[Zc];mi&&mi.setForRemoval&&(He.push(jn),Ye.add(jn),mi.hasAnimation?this.driver.query(jn,".ng-star-inserted",!0).forEach(Ji=>Ye.add(Ji)):ot.add(jn))}const Ke=new Map,Ct=rN(J,Array.from(Ye));Ct.forEach((bn,jn)=>{const mi=Mw+Ee++;Ke.set(jn,mi),bn.forEach(Ji=>Jc(Ji,mi))}),t.push(()=>{ae.forEach((bn,jn)=>{const mi=we.get(jn);bn.forEach(Ji=>Ty(Ji,mi))}),Ct.forEach((bn,jn)=>{const mi=Ke.get(jn);bn.forEach(Ji=>Ty(Ji,mi))}),He.forEach(bn=>{this.processLeaveNode(bn)})});const _n=[],Ln=[];for(let bn=this._namespaceList.length-1;bn>=0;bn--)this._namespaceList[bn].drainQueuedTransitions(e).forEach(mi=>{const Ji=mi.player,_a=mi.element;if(_n.push(Ji),this.collectedEnterElements.length){const Ha=_a[Zc];if(Ha&&Ha.setForMove){if(Ha.previousTriggersValues&&Ha.previousTriggersValues.has(mi.triggerName)){const su=Ha.previousTriggersValues.get(mi.triggerName),Cl=this.statesByElement.get(mi.element);if(Cl&&Cl.has(mi.triggerName)){const My=Cl.get(mi.triggerName);My.value=su,Cl.set(mi.triggerName,My)}}return void Ji.destroy()}}const Lu=!z||!this.driver.containsElement(z,_a),vo=Ke.get(_a),bc=we.get(_a),us=this._buildInstruction(mi,i,bc,vo,Lu);if(us.errors&&us.errors.length)return void Ln.push(us);if(Lu)return Ji.onStart(()=>__(_a,us.fromStyles)),Ji.onDestroy(()=>Af(_a,us.toStyles)),void r.push(Ji);if(mi.isFallbackTransition)return Ji.onStart(()=>__(_a,us.fromStyles)),Ji.onDestroy(()=>Af(_a,us.toStyles)),void r.push(Ji);const nh=[];us.timelines.forEach(Ha=>{Ha.stretchStartingKeyframe=!0,this.disabledNodes.has(Ha.element)||nh.push(Ha)}),us.timelines=nh,i.append(_a,us.timelines),g.push({instruction:us,player:Ji,element:_a}),us.queriedElements.forEach(Ha=>gc(_,Ha,[]).push(Ji)),us.preStyleProps.forEach((Ha,su)=>{if(Ha.size){let Cl=w.get(su);Cl||w.set(su,Cl=new Set),Ha.forEach((My,R_)=>Cl.add(R_))}}),us.postStyleProps.forEach((Ha,su)=>{let Cl=C.get(su);Cl||C.set(su,Cl=new Set),Ha.forEach((My,R_)=>Cl.add(R_))})});if(Ln.length){const bn=[];Ln.forEach(jn=>{bn.push(function HV(n,t){return new wt(3505,!1)}())}),_n.forEach(jn=>jn.destroy()),this.reportError(bn)}const Ei=new Map,Xi=new Map;g.forEach(bn=>{const jn=bn.element;i.has(jn)&&(Xi.set(jn,jn),this._beforeAnimationBuild(bn.player.namespaceId,bn.instruction,Ei))}),r.forEach(bn=>{const jn=bn.element;this._getPreviousPlayers(jn,!1,bn.namespaceId,bn.triggerName,null).forEach(Ji=>{gc(Ei,jn,[]).push(Ji),Ji.destroy()})});const Fr=He.filter(bn=>aN(bn,w,C)),Br=new Map;iN(Br,this.driver,ot,C,Wp).forEach(bn=>{aN(bn,w,C)&&Fr.push(bn)});const Va=new Map;ae.forEach((bn,jn)=>{iN(Va,this.driver,new Set(bn),w,"!")}),Fr.forEach(bn=>{const jn=Br.get(bn),mi=Va.get(bn);Br.set(bn,new Map([...Array.from(jn?.entries()??[]),...Array.from(mi?.entries()??[])]))});const Is=[],Pu=[],Ou={};g.forEach(bn=>{const{element:jn,player:mi,instruction:Ji}=bn;if(i.has(jn)){if(L.has(jn))return mi.onDestroy(()=>Af(jn,Ji.toStyles)),mi.disabled=!0,mi.overrideTotalTime(Ji.totalTime),void r.push(mi);let _a=Ou;if(Xi.size>1){let vo=jn;const bc=[];for(;vo=vo.parentNode;){const us=Xi.get(vo);if(us){_a=us;break}bc.push(vo)}bc.forEach(us=>Xi.set(us,_a))}const Lu=this._buildAnimation(mi.namespaceId,Ji,Ei,c,Va,Br);if(mi.setRealPlayer(Lu),_a===Ou)Is.push(mi);else{const vo=this.playersByElement.get(_a);vo&&vo.length&&(mi.parentPlayer=Eg(vo)),r.push(mi)}}else __(jn,Ji.fromStyles),mi.onDestroy(()=>Af(jn,Ji.toStyles)),Pu.push(mi),L.has(jn)&&r.push(mi)}),Pu.forEach(bn=>{const jn=c.get(bn.element);if(jn&&jn.length){const mi=Eg(jn);bn.setRealPlayer(mi)}}),r.forEach(bn=>{bn.parentPlayer?bn.syncPlayerEvents(bn.parentPlayer):bn.destroy()});for(let bn=0;bn<He.length;bn++){const jn=He[bn],mi=jn[Zc];if(Ty(jn,Mw),mi&&mi.hasAnimation)continue;let Ji=[];if(_.size){let Lu=_.get(jn);Lu&&Lu.length&&Ji.push(...Lu);let vo=this.driver.query(jn,xS,!0);for(let bc=0;bc<vo.length;bc++){let us=_.get(vo[bc]);us&&us.length&&Ji.push(...us)}}const _a=Ji.filter(Lu=>!Lu.destroyed);_a.length?z8(this,jn,_a):this.processLeaveNode(jn)}return He.length=0,Is.forEach(bn=>{this.players.push(bn),bn.onDone(()=>{bn.destroy();const jn=this.players.indexOf(bn);this.players.splice(jn,1)}),bn.play()}),Is}elementContainsData(t,e){let i=!1;const r=e[Zc];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,r,c){let g=[];if(e){const _=this.playersByQueriedElement.get(t);_&&(g=_)}else{const _=this.playersByElement.get(t);if(_){const w=!c||c==I1;_.forEach(C=>{C.queued||!w&&C.triggerName!=r||g.push(C)})}}return(i||r)&&(g=g.filter(_=>!(i&&i!=_.namespaceId||r&&r!=_.triggerName))),g}_beforeAnimationBuild(t,e,i){const c=e.element,g=e.isRemovalTransition?void 0:t,_=e.isRemovalTransition?void 0:e.triggerName;for(const w of e.timelines){const C=w.element,L=C!==c,z=gc(i,C,[]);this._getPreviousPlayers(C,L,g,_,e.toState).forEach(ae=>{const we=ae.getRealPlayer();we.beforeDestroy&&we.beforeDestroy(),ae.destroy(),z.push(ae)})}__(c,e.fromStyles)}_buildAnimation(t,e,i,r,c,g){const _=e.triggerName,w=e.element,C=[],L=new Set,z=new Set,J=e.timelines.map(we=>{const Ee=we.element;L.add(Ee);const He=Ee[Zc];if(He&&He.removedBeforeQueried)return new C1(we.duration,we.delay);const Ye=Ee!==w,ot=function W8(n){const t=[];return sN(n,t),t}((i.get(Ee)||F8).map(Ei=>Ei.getRealPlayer())).filter(Ei=>!!Ei.element&&Ei.element===Ee),Ke=c.get(Ee),Ct=g.get(Ee),_n=RR(0,this._normalizer,0,we.keyframes,Ke,Ct),Ln=this._buildPlayer(we,_n,ot);if(we.subTimeline&&r&&z.add(Ee),Ye){const Ei=new BS(t,_,Ee);Ei.setRealPlayer(Ln),C.push(Ei)}return Ln});C.forEach(we=>{gc(this.playersByQueriedElement,we.element,[]).push(we),we.onDone(()=>function H8(n,t,e){let i=n.get(t);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&n.delete(t)}return i}(this.playersByQueriedElement,we.element,we))}),L.forEach(we=>Jc(we,VR));const ae=Eg(J);return ae.onDestroy(()=>{L.forEach(we=>Ty(we,VR)),Af(w,e.toStyles)}),z.forEach(we=>{gc(r,we,[]).push(ae)}),ae}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new C1(t.duration,t.delay)}}class BS{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new C1,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>vS(t,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){gc(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function jw(n){return n&&1===n.nodeType}function nN(n,t){const e=n.style.display;return n.style.display=t??"none",e}function iN(n,t,e,i,r){const c=[];e.forEach(w=>c.push(nN(w)));const g=[];i.forEach((w,C)=>{const L=new Map;w.forEach(z=>{const J=t.computeStyle(C,z,r);L.set(z,J),(!J||0==J.length)&&(C[Zc]=B8,g.push(C))}),n.set(C,L)});let _=0;return e.forEach(w=>nN(w,c[_++])),g}function rN(n,t){const e=new Map;if(n.forEach(_=>e.set(_,[])),0==t.length)return e;const r=new Set(t),c=new Map;function g(_){if(!_)return 1;let w=c.get(_);if(w)return w;const C=_.parentNode;return w=e.has(C)?C:r.has(C)?1:g(C),c.set(_,w),w}return t.forEach(_=>{const w=g(_);1!==w&&e.get(w).push(_)}),e}function Jc(n,t){n.classList?.add(t)}function Ty(n,t){n.classList?.remove(t)}function z8(n,t,e){Eg(e).onDone(()=>n.processLeaveNode(t))}function sN(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof MR?sN(i.players,t):t.push(i)}}function aN(n,t,e){const i=e.get(n);if(!i)return!1;let r=t.get(n);return r?i.forEach(c=>r.add(c)):t.set(n,i),e.delete(n),!0}class zw{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,c)=>{},this._transitionEngine=new V8(t,e,i),this._timelineEngine=new N8(t,e,i),this._transitionEngine.onRemovalComplete=(r,c)=>this.onRemovalComplete(r,c)}registerTrigger(t,e,i,r,c){const g=t+"-"+r;let _=this._triggerCache[g];if(!_){const w=[],L=DS(this._driver,c,w,[]);if(w.length)throw function IV(n,t){return new wt(3404,!1)}();_=function D8(n,t,e){return new M8(n,t,e)}(r,L,this._normalizer),this._triggerCache[g]=_}this._transitionEngine.registerTrigger(e,r,_)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,r){this._transitionEngine.insertNode(t,e,i,r)}onRemove(t,e,i,r){this._transitionEngine.removeNode(t,e,r||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,r){if("@"==i.charAt(0)){const[c,g]=NR(i);this._timelineEngine.command(c,e,g,r)}else this._transitionEngine.trigger(t,e,i,r)}listen(t,e,i,r,c){if("@"==i.charAt(0)){const[g,_]=NR(i);return this._timelineEngine.listen(g,e,_,c)}return this._transitionEngine.listen(t,e,i,r,c)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let K8=(()=>{class n extends SR{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:no.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?ER(e):e;return lN(this._renderer,null,i,"register",[r]),new Z8(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)($t(Hc),$t(ls))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();class Z8 extends class lV{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new J8(this._id,t,e||{},this._renderer)}}class J8{constructor(t,e,i,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return lN(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function lN(n,t,e,i,r){return n.setProperty(t,`@@${e}:${i}`,r)}const uN="@.disabled";let eH=(()=>{class n{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(c,g)=>{const _=g?.parentNode(c);_&&g.removeChild(_,c)}}createRenderer(e,i){const c=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let L=this._rendererCache.get(c);return L||(L=new cN("",c,this.engine),this._rendererCache.set(c,L)),L}const g=i.id,_=i.id+"-"+this._currentId;this._currentId++,this.engine.register(_,e);const w=L=>{Array.isArray(L)?L.forEach(w):this.engine.registerTrigger(g,_,e,L.name,L)};return i.data.animation.forEach(w),new tH(this,_,c,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(c=>{const[g,_]=c;g(_)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)($t(Hc),$t(zw),$t(vs))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})();class cN{constructor(t,e,i){this.namespaceId=t,this.delegate=e,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,r=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,r){this.delegate.setAttribute(t,e,i,r)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,r){this.delegate.setStyle(t,e,i,r)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==uN?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class tH extends cN{constructor(t,e,i,r){super(e,i,r),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==uN?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.slice(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const r=function nH(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let c=e.slice(1),g="";return"@"!=c.charAt(0)&&([c,g]=function iH(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(c)),this.engine.listen(this.namespaceId,r,c,g,_=>{this.factory.scheduleListenerCallback(_._data||-1,i,_)})}return this.delegate.listen(t,e,i)}}const hN=[{provide:wS,useClass:BR},{provide:SD,useValue:"NoopAnimations"},...[{provide:SR,useClass:K8},{provide:PS,useFactory:function sH(){return new x8}},{provide:zw,useClass:(()=>{class n extends zw{constructor(e,i,r,c){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)($t(ls),$t(wS),$t(PS),$t(uy))},n.\u0275prov=kn({token:n,factory:n.\u0275fac}),n})()},{provide:Hc,useFactory:function aH(n,t,e){return new eH(n,t,e)},deps:[ew,zw,vs]}]];let lH=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({providers:hN,imports:[HM]}),n})();const uH=["addListener","removeListener"],cH=["addEventListener","removeEventListener"],dH=["on","off"];function nu(n,t,e,i){if(ht(e)&&(i=e,e=void 0),i)return nu(n,t,e).pipe(Ix(i));const[r,c]=function pH(n){return ht(n.addEventListener)&&ht(n.removeEventListener)}(n)?cH.map(g=>_=>n[g](t,_,e)):function hH(n){return ht(n.addListener)&&ht(n.removeListener)}(n)?uH.map(fN(n,t)):function fH(n){return ht(n.on)&&ht(n.off)}(n)?dH.map(fN(n,t)):[];if(!r&&xc(n))return vr(g=>nu(g,t,e))(Re(n));if(!r)throw new TypeError("Invalid event target");return new jt(g=>{const _=(...w)=>g.next(1<w.length?w:w[0]);return r(_),()=>c(_)})}function fN(n,t){return e=>i=>n[e](t,i)}const{isArray:gH}=Array;function pN(n){return 1===n.length&&gH(n[0])?n[0]:n}function $w(...n){const t=Fo(n),e=pN(n);return e.length?new jt(i=>{let r=e.map(()=>[]),c=e.map(()=>!1);i.add(()=>{r=c=null});for(let g=0;!i.closed&&g<e.length;g++)Re(e[g]).subscribe(gn(i,_=>{if(r[g].push(_),r.every(w=>w.length)){const w=r.map(C=>C.shift());i.next(t?t(...w):w),r.some((C,L)=>!C.length&&c[L])&&i.complete()}},()=>{c[g]=!0,!r[g].length&&i.complete()}));return()=>{r=c=null}}):Qr}function GS(...n){const t=Fo(n);return Dn((e,i)=>{const r=n.length,c=new Array(r);let g=n.map(()=>!1),_=!1;for(let w=0;w<r;w++)Re(n[w]).subscribe(gn(i,C=>{c[w]=C,!_&&!g[w]&&(g[w]=!0,(_=g.every(Tt))&&(g=null))},Bt));e.subscribe(gn(i,w=>{if(_){const C=[w,...c];i.next(t?t(...C):C)}}))})}new jt(Bt);let lP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})(),b6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[lP]}),n})(),T6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[b6]}),n})();Math,Math,Math;const PG=["*"],KG=["dialog"];function bE(n){return"string"==typeof n}function x_(n){return null!=n}function Cy(n){return(n||document.body).getBoundingClientRect()}const jP={animation:!0,transitionTimerDelayMs:5},W7=()=>{},{transitionTimerDelayMs:$7}=jP,H1=new Map,ru=(n,t,e,i)=>{let r=i.context||{};const c=H1.get(t);if(c)switch(i.runningTransition){case"continue":return Qr;case"stop":n.run(()=>c.transition$.complete()),r=Object.assign(c.context,r),H1.delete(t)}const g=e(t,i.animation,r)||W7;if(!i.animation||"none"===window.getComputedStyle(t).transitionProperty)return n.run(()=>g()),qn(void 0).pipe(function j7(n){return t=>new jt(e=>t.subscribe({next:g=>n.run(()=>e.next(g)),error:g=>n.run(()=>e.error(g)),complete:()=>n.run(()=>e.complete())}))}(n));const _=new Yt,w=new Yt,C=_.pipe(function _H(...n){return t=>cy(t,qn(...n))}(!0));H1.set(t,{transition$:_,complete:()=>{w.next(),w.complete()},context:r});const L=function z7(n){const{transitionDelay:t,transitionDuration:e}=window.getComputedStyle(n);return 1e3*(parseFloat(t)+parseFloat(e))}(t);return n.runOutsideAngular(()=>{const z=nu(t,"transitionend").pipe(Ja(C),Sl(({target:ae})=>ae===t));(function mN(...n){return 1===(n=pN(n)).length?Re(n[0]):new jt(function vH(n){return t=>{let e=[];for(let i=0;e&&!t.closed&&i<n.length;i++)e.push(Re(n[i]).subscribe(gn(t,r=>{if(e){for(let c=0;c<e.length;c++)c!==i&&e[c].unsubscribe();e=null}t.next(r)})))}}(n))})(function VS(n=0,t,e=I5){let i=-1;return null!=t&&(_r(t)?e=t:i=t),new jt(r=>{let c=function mH(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;c<0&&(c=0);let g=0;return e.schedule(function(){r.closed||(r.next(g++),0<=i?this.schedule(void 0,i):r.complete())},c)})}(L+$7).pipe(Ja(C)),z,w).pipe(Ja(C)).subscribe(()=>{H1.delete(t),n.run(()=>{g(),_.next(),_.complete()})})}),_.asObservable()};let oA=(()=>{class n{constructor(){this.animation=jP.animation}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),YP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),QP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),JP=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),eO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})();var go=(()=>{return(n=go||(go={}))[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.Escape=27]="Escape",n[n.Space=32]="Space",n[n.PageUp=33]="PageUp",n[n.PageDown=34]="PageDown",n[n.End=35]="End",n[n.Home=36]="Home",n[n.ArrowLeft=37]="ArrowLeft",n[n.ArrowUp=38]="ArrowUp",n[n.ArrowRight=39]="ArrowRight",n[n.ArrowDown=40]="ArrowDown",go;var n})();typeof navigator<"u"&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const nO=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function iO(n){const t=Array.from(n.querySelectorAll(nO)).filter(e=>-1!==e.tabIndex);return[t[0],t[t.length-1]]}new Date(1882,10,12),new Date(2174,10,25);let dO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu,T6]}),n})(),mO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})();class D_{constructor(t,e,i){this.nodes=t,this.viewRef=e,this.componentRef=i}}let Fj=(()=>{class n{constructor(e,i){this._el=e,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(Oo(1)).subscribe(()=>{ru(this._zone,this._el.nativeElement,(e,i)=>{i&&Cy(e),e.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return ru(this._zone,this._el.nativeElement,({classList:e})=>e.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return n.\u0275fac=function(e){return new(e||n)(ue(Pr),ue(vs))},n.\u0275cmp=Li({type:n,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(e,i){2&e&&(a_("modal-backdrop"+(i.backdropClass?" "+i.backdropClass:"")),ga("show",!i.animation)("fade",i.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(e,i){},encapsulation:2}),n})();class gO{close(t){}dismiss(t){}}class Bj{constructor(t,e,i,r){this._windowCmptRef=t,this._contentRef=e,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new Yt,this._dismissed=new Yt,this._hidden=new Yt,t.instance.dismissEvent.subscribe(c=>{this.dismiss(c)}),this.result=new Promise((c,g)=>{this._resolve=c,this._reject=g}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Ja(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Ja(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(t){this._windowCmptRef&&(this._closed.next(t),this._resolve(t),this._removeModalElements())}_dismiss(t){this._dismissed.next(t),this._reject(t),this._removeModalElements()}dismiss(t){if(this._windowCmptRef)if(this._beforeDismiss){const e=this._beforeDismiss();!function GP(n){return n&&n.then}(e)?!1!==e&&this._dismiss(t):e.then(i=>{!1!==i&&this._dismiss(t)},()=>{})}else this._dismiss(t)}_removeModalElements(){const t=this._windowCmptRef.instance.hide(),e=this._backdropCmptRef?this._backdropCmptRef.instance.hide():qn(void 0);t.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),e.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),$w(t,e).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var W1=(()=>{return(n=W1||(W1={}))[n.BACKDROP_CLICK=0]="BACKDROP_CLICK",n[n.ESC=1]="ESC",W1;var n})();let Uj=(()=>{class n{constructor(e,i,r){this._document=e,this._elRef=i,this._zone=r,this._closed$=new Yt,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new Ki,this.shown=new Yt,this.hidden=new Yt}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":bE(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(e){this.dismissEvent.emit(e)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(Oo(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:e}=this._elRef,i={animation:this.animation,runningTransition:"stop"},g=$w(ru(this._zone,e,()=>e.classList.remove("show"),i),ru(this._zone,this._dialogEl.nativeElement,()=>{},i));return g.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),g}_show(){const e={animation:this.animation,runningTransition:"continue"};$w(ru(this._zone,this._elRef.nativeElement,(c,g)=>{g&&Cy(c),c.classList.add("show")},e),ru(this._zone,this._dialogEl.nativeElement,()=>{},e)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:e}=this._elRef;this._zone.runOutsideAngular(()=>{nu(e,"keydown").pipe(Ja(this._closed$),Sl(r=>r.which===go.Escape)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(W1.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;nu(this._dialogEl.nativeElement,"mousedown").pipe(Ja(this._closed$),Ua(()=>i=!1),Qc(()=>nu(e,"mouseup").pipe(Ja(this._closed$),Oo(1))),Sl(({target:r})=>e===r)).subscribe(()=>{i=!0}),nu(e,"click").pipe(Ja(this._closed$)).subscribe(({target:r})=>{e===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(W1.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:e}=this._elRef;if(!e.contains(document.activeElement)){const i=e.querySelector("[ngbAutofocus]"),r=iO(e)[0];(i||r||e).focus()}}_restoreFocus(){const e=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&e.contains(i)?i:e,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&ru(this._zone,this._elRef.nativeElement,({classList:e})=>(e.add("modal-static"),()=>e.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return n.\u0275fac=function(e){return new(e||n)(ue(ls),ue(Pr),ue(vs))},n.\u0275cmp=Li({type:n,selectors:[["ngb-modal-window"]],viewQuery:function(e,i){if(1&e&&DT(KG,7),2&e){let r;Xs(r=Ys())&&(i._dialogEl=r.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(e,i){2&e&&(Ar("aria-modal",!0)("aria-labelledby",i.ariaLabelledBy)("aria-describedby",i.ariaDescribedBy),a_("modal d-block"+(i.windowClass?" "+i.windowClass:"")),ga("fade",i.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:PG,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(e,i){1&e&&(qc(),nn(0,"div",0,1)(2,"div",2),ee(3),rn()()),2&e&&a_("modal-dialog"+(i.size?" modal-"+i.size:"")+(i.centered?" modal-dialog-centered":"")+i.fullscreenClass+(i.scrollable?" modal-dialog-scrollable":"")+(i.modalDialogClass?" "+i.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),n})(),Vj=(()=>{class n{constructor(e){this._document=e}hide(){const e=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:c,paddingRight:g}=r;if(e>0){const _=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${_+e}px`}return r.overflow="hidden",()=>{e>0&&(r.paddingRight=g),r.overflow=c}}}return n.\u0275fac=function(e){return new(e||n)($t(ls))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Hj=(()=>{class n{constructor(e,i,r,c,g,_){this._applicationRef=e,this._injector=i,this._document=r,this._scrollBar=c,this._rendererFactory=g,this._ngZone=_,this._activeWindowCmptHasChanged=new Yt,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new Ki,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const w=this._windowCmpts[this._windowCmpts.length-1];((n,t,e,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const r=nu(t,"focusin").pipe(Ja(e),hn(c=>c.target));nu(t,"keydown").pipe(Ja(e),Sl(c=>c.which===go.Tab),GS(r)).subscribe(([c,g])=>{const[_,w]=iO(t);(g===_||g===t)&&c.shiftKey&&(w.focus(),c.preventDefault()),g===w&&!c.shiftKey&&(_.focus(),c.preventDefault())}),i&&nu(t,"click").pipe(Ja(e),GS(r),hn(c=>c[1])).subscribe(c=>c.focus())})})(0,w.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(w.location.nativeElement)}})}_restoreScrollBar(){const e=this._scrollBarRestoreFn;e&&(this._scrollBarRestoreFn=null,e())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(e,i,r){const c=r.container instanceof HTMLElement?r.container:x_(r.container)?this._document.querySelector(r.container):this._document.body,g=this._rendererFactory.createRenderer(null,null);if(!c)throw new Error(`The specified modal container "${r.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const _=new gO,w=this._getContentRef(r.injector||e,i,_,r);let C=!1!==r.backdrop?this._attachBackdrop(c):void 0,L=this._attachWindowComponent(c,w.nodes),z=new Bj(L,w,C,r.beforeDismiss);return this._registerModalRef(z),this._registerWindowCmpt(L),z.hidden.pipe(Oo(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(g.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),_.close=J=>{z.close(J)},_.dismiss=J=>{z.dismiss(J)},this._applyWindowOptions(L.instance,r),1===this._modalRefs.length&&g.addClass(this._document.body,"modal-open"),C&&C.instance&&(this._applyBackdropOptions(C.instance,r),C.changeDetectorRef.detectChanges()),L.changeDetectorRef.detectChanges(),z}get activeInstances(){return this._activeInstances}dismissAll(e){this._modalRefs.forEach(i=>i.dismiss(e))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(e){let i=rx(Fj,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector});return this._applicationRef.attachView(i.hostView),e.appendChild(i.location.nativeElement),i}_attachWindowComponent(e,i){let r=rx(Uj,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector,projectableNodes:i});return this._applicationRef.attachView(r.hostView),e.appendChild(r.location.nativeElement),r}_applyWindowOptions(e,i){this._windowAttributes.forEach(r=>{x_(i[r])&&(e[r]=i[r])})}_applyBackdropOptions(e,i){this._backdropAttributes.forEach(r=>{x_(i[r])&&(e[r]=i[r])})}_getContentRef(e,i,r,c){return i?i instanceof Ma?this._createFromTemplateRef(i,r):bE(i)?this._createFromString(i):this._createFromComponent(e,i,r,c):new D_([])}_createFromTemplateRef(e,i){const c=e.createEmbeddedView({$implicit:i,close(g){i.close(g)},dismiss(g){i.dismiss(g)}});return this._applicationRef.attachView(c),new D_([c.rootNodes],c)}_createFromString(e){const i=this._document.createTextNode(`${e}`);return new D_([[i]])}_createFromComponent(e,i,r,c){const g=Ea.create({providers:[{provide:gO,useValue:r}],parent:e}),_=rx(i,{environmentInjector:this._applicationRef.injector,elementInjector:g}),w=_.location.nativeElement;return c.scrollable&&w.classList.add("component-host-scrollable"),this._applicationRef.attachView(_.hostView),new D_([[w]],_.hostView,_)}_setAriaHidden(e){const i=e.parentElement;i&&e!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==e&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((e,i)=>{e?i.setAttribute("aria-hidden",e):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(e){const i=()=>{const r=this._modalRefs.indexOf(e);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(e),this._activeInstances.emit(this._modalRefs),e.result.then(i,i)}_registerWindowCmpt(e){this._windowCmpts.push(e),this._activeWindowCmptHasChanged.next(),e.onDestroy(()=>{const i=this._windowCmpts.indexOf(e);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}}return n.\u0275fac=function(e){return new(e||n)($t(uy),$t(Ea),$t(ls),$t(Vj),$t(Hc),$t(vs))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Gj=(()=>{class n{constructor(e){this._ngbConfig=e,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(e){this._animation=e}}return n.\u0275fac=function(e){return new(e||n)($t(oA))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),jj=(()=>{class n{constructor(e,i,r){this._injector=e,this._modalStack=i,this._config=r}open(e,i={}){const r={...this._config,animation:this._config.animation,...i};return this._modalStack.open(this._injector,e,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(e){this._modalStack.dismissAll(e)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return n.\u0275fac=function(e){return new(e||n)($t(Ea),$t(Hj),$t(Gj))},n.\u0275prov=kn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({providers:[jj]}),n})(),TO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),MO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),RO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),NO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),PO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),OO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),LO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),kO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})();new En("live announcer delay",{providedIn:"root",factory:function n9(){return 100}});let FO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Nu]}),n})(),BO=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({}),n})();const i9=[YP,QP,JP,eO,dO,mO,vO,TO,BO,MO,RO,NO,PO,OO,LO,kO,FO];let r9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[i9,YP,QP,JP,eO,dO,mO,vO,TO,BO,MO,RO,NO,PO,OO,LO,kO,FO]}),n})(),b9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n}),n.\u0275inj=Wi({imports:[Dw,Dw]}),n})(),T9=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ci({type:n,bootstrap:[oV]}),n.\u0275inj=Wi({imports:[HM,v5,lH,r9,rV,b9]}),n})();(function Kk(){GD=!1})(),CB().bootstrapModule(T9).catch(n=>console.error(n))},992:(ni,In,on)=>{"use strict";var ht=on(226);ni.exports=function(Mt,Wt){return void 0===Wt&&(Wt=!1),function(yt,gt,Nt){if(yt)Mt(yt);else if(gt.statusCode>=400&&gt.statusCode<=599){var ze=Nt;if(Wt)if(ht.TextDecoder){var Yi=function dt(Oe){return void 0===Oe&&(Oe=""),Oe.toLowerCase().split(";").reduce(function(Mt,Wt){var yt=Wt.split("="),Nt=yt[1];return"charset"===yt[0].trim()?Nt.trim():Mt},"utf-8")}(gt.headers&&gt.headers["content-type"]);try{ze=new TextDecoder(Yi).decode(Nt)}catch{}}else ze=String.fromCharCode.apply(null,new Uint8Array(Nt));Mt({cause:ze})}else Mt(null,Nt)}}},745:(ni,In,on)=>{"use strict";var ht=on(226),se=on(434),dt=on(703);function yt(Bt,ui,wi){var Ir=Bt;return dt(ui)?(wi=ui,"string"==typeof Bt&&(Ir={uri:Bt})):Ir=se({},ui,{uri:Bt}),Ir.callback=wi,Ir}function gt(Bt,ui,wi){return Nt(ui=yt(Bt,ui,wi))}function Nt(Bt){if(typeof Bt.callback>"u")throw new Error("callback argument missing");var ui=!1,wi=function(tn,Lt,jt){ui||(ui=!0,Bt.callback(tn,Lt,jt))};function cs(){var Tt=void 0;if(Tt=yn.response?yn.response:yn.responseText||function ze(Bt){try{if("document"===Bt.responseType)return Bt.responseXML;if(""===Bt.responseType&&(!Bt.responseXML||"parsererror"!==Bt.responseXML.documentElement.nodeName))return Bt.responseXML}catch{}return null}(yn),Te)try{Tt=JSON.parse(Tt)}catch{}return Tt}function zt(Tt){return clearTimeout(it),Tt instanceof Error||(Tt=new Error(""+(Tt||"Unknown XMLHttpRequest Error"))),Tt.statusCode=0,wi(Tt,Ot)}function Xn(){if(!Bi){var Tt;clearTimeout(it);var tn=Ot,Lt=null;return 0!==(Tt=Bt.useXDR&&void 0===yn.status?200:1223===yn.status?204:yn.status)?(tn={body:cs(),statusCode:Tt,method:Zn,headers:{},url:Pn,rawRequest:yn},yn.getAllResponseHeaders&&(tn.headers=function(ui){var wi={};return ui&&ui.trim().split("\n").forEach(function(Ir){var cs=Ir.indexOf(":"),zt=Ir.slice(0,cs).trim().toLowerCase(),Xn=Ir.slice(cs+1).trim();typeof wi[zt]>"u"?wi[zt]=Xn:Array.isArray(wi[zt])?wi[zt].push(Xn):wi[zt]=[wi[zt],Xn]}),wi}(yn.getAllResponseHeaders()))):Lt=new Error("Internal XMLHttpRequest Error"),wi(Lt,tn,tn.body)}}var yn=Bt.xhr||null;yn||(yn=Bt.cors||Bt.useXDR?new gt.XDomainRequest:new gt.XMLHttpRequest);var Hn,Bi,it,Pn=yn.url=Bt.uri||Bt.url,Zn=yn.method=Bt.method||"GET",Yn=Bt.body||Bt.data,oi=yn.headers=Bt.headers||{},ge=!!Bt.sync,Te=!1,Ot={body:void 0,headers:{},statusCode:0,method:Zn,url:Pn,rawRequest:yn};if("json"in Bt&&!1!==Bt.json&&(Te=!0,oi.accept||oi.Accept||(oi.Accept="application/json"),"GET"!==Zn&&"HEAD"!==Zn&&(oi["content-type"]||oi["Content-Type"]||(oi["Content-Type"]="application/json"),Yn=JSON.stringify(!0===Bt.json?Yn:Bt.json))),yn.onreadystatechange=function Ir(){4===yn.readyState&&setTimeout(Xn,0)},yn.onload=Xn,yn.onerror=zt,yn.onprogress=function(){},yn.onabort=function(){Bi=!0},yn.ontimeout=zt,yn.open(Zn,Pn,!ge,Bt.username,Bt.password),ge||(yn.withCredentials=!!Bt.withCredentials),!ge&&Bt.timeout>0&&(it=setTimeout(function(){if(!Bi){Bi=!0,yn.abort("timeout");var Tt=new Error("XMLHttpRequest timeout");Tt.code="ETIMEDOUT",zt(Tt)}},Bt.timeout)),yn.setRequestHeader)for(Hn in oi)oi.hasOwnProperty(Hn)&&yn.setRequestHeader(Hn,oi[Hn]);else if(Bt.headers&&!function Wt(Bt){for(var ui in Bt)if(Bt.hasOwnProperty(ui))return!1;return!0}(Bt.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in Bt&&(yn.responseType=Bt.responseType),"beforeSend"in Bt&&"function"==typeof Bt.beforeSend&&Bt.beforeSend(yn),yn.send(Yn||null),yn}gt.httpHandler=on(992),ni.exports=gt,ni.exports.default=gt,gt.XMLHttpRequest=ht.XMLHttpRequest||function Yi(){},gt.XDomainRequest="withCredentials"in new gt.XMLHttpRequest?gt.XMLHttpRequest:ht.XDomainRequest,function Mt(Bt,ui){for(var wi=0;wi<Bt.length;wi++)ui(Bt[wi])}(["get","put","post","patch","head","delete"],function(Bt){gt["delete"===Bt?"del":Bt]=function(ui,wi,Ir){return(wi=yt(ui,wi,Ir)).method=Bt.toUpperCase(),Nt(wi)}})},401:(ni,In)=>{"use strict";function on(dt,Oe){return void 0===Oe&&(Oe=Object),Oe&&"function"==typeof Oe.freeze?Oe.freeze(dt):dt}var ht=on({HTML:"text/html",isHTML:function(dt){return dt===ht.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),se=on({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(dt){return dt===se.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});In.freeze=on,In.MIME_TYPE=ht,In.NAMESPACE=se},991:(ni,In,on)=>{var se=on(401),dt=on(853),Oe=on(436),Mt=on(702),Wt=dt.DOMImplementation,yt=se.NAMESPACE,gt=Mt.ParseError,Nt=Mt.XMLReader;function ze(zt){this.options=zt||{locator:{}}}function Bt(){this.cdata=!1}function ui(zt,Xn){Xn.lineNumber=zt.lineNumber,Xn.columnNumber=zt.columnNumber}function wi(zt){if(zt)return"\n@"+(zt.systemId||"")+"#[line:"+zt.lineNumber+",col:"+zt.columnNumber+"]"}function Ir(zt,Xn,yn){return"string"==typeof zt?zt.substr(Xn,yn):zt.length>=Xn+yn||Xn?new java.lang.String(zt,Xn,yn)+"":zt}function cs(zt,Xn){zt.currentElement?zt.currentElement.appendChild(Xn):zt.doc.appendChild(Xn)}ze.prototype.parseFromString=function(zt,Xn){var yn=this.options,Hn=new Nt,Bi=yn.domBuilder||new Bt,Pn=yn.errorHandler,Zn=yn.locator,Yn=yn.xmlns||{},oi=/\/x?html?$/.test(Xn),ge=oi?Oe.HTML_ENTITIES:Oe.XML_ENTITIES;return Zn&&Bi.setDocumentLocator(Zn),Hn.errorHandler=function Yi(zt,Xn,yn){if(!zt){if(Xn instanceof Bt)return Xn;zt=Xn}var Hn={},Bi=zt instanceof Function;function Pn(Zn){var Yn=zt[Zn];!Yn&&Bi&&(Yn=2==zt.length?function(oi){zt(Zn,oi)}:zt),Hn[Zn]=Yn&&function(oi){Yn("[xmldom "+Zn+"]\t"+oi+wi(yn))}||function(){}}return yn=yn||{},Pn("warning"),Pn("error"),Pn("fatalError"),Hn}(Pn,Bi,Zn),Hn.domBuilder=yn.domBuilder||Bi,oi&&(Yn[""]=yt.HTML),Yn.xml=Yn.xml||yt.XML,zt&&"string"==typeof zt?Hn.parse(zt,Yn,ge):Hn.errorHandler.error("invalid doc source"),Bi.doc},Bt.prototype={startDocument:function(){this.doc=(new Wt).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(zt,Xn,yn,Hn){var Bi=this.doc,Pn=Bi.createElementNS(zt,yn||Xn),Zn=Hn.length;cs(this,Pn),this.currentElement=Pn,this.locator&&ui(this.locator,Pn);for(var Yn=0;Yn<Zn;Yn++){zt=Hn.getURI(Yn);var oi=Hn.getValue(Yn),ge=(yn=Hn.getQName(Yn),Bi.createAttributeNS(zt,yn));this.locator&&ui(Hn.getLocator(Yn),ge),ge.value=ge.nodeValue=oi,Pn.setAttributeNode(ge)}},endElement:function(zt,Xn,yn){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(zt,Xn){},endPrefixMapping:function(zt){},processingInstruction:function(zt,Xn){var yn=this.doc.createProcessingInstruction(zt,Xn);this.locator&&ui(this.locator,yn),cs(this,yn)},ignorableWhitespace:function(zt,Xn,yn){},characters:function(zt,Xn,yn){if(zt=Ir.apply(this,arguments)){if(this.cdata)var Hn=this.doc.createCDATASection(zt);else Hn=this.doc.createTextNode(zt);this.currentElement?this.currentElement.appendChild(Hn):/^\s*$/.test(zt)&&this.doc.appendChild(Hn),this.locator&&ui(this.locator,Hn)}},skippedEntity:function(zt){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(zt){(this.locator=zt)&&(zt.lineNumber=0)},comment:function(zt,Xn,yn){zt=Ir.apply(this,arguments);var Hn=this.doc.createComment(zt);this.locator&&ui(this.locator,Hn),cs(this,Hn)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(zt,Xn,yn){var Hn=this.doc.implementation;if(Hn&&Hn.createDocumentType){var Bi=Hn.createDocumentType(zt,Xn,yn);this.locator&&ui(this.locator,Bi),cs(this,Bi),this.doc.doctype=Bi}},warning:function(zt){console.warn("[xmldom warning]\t"+zt,wi(this.locator))},error:function(zt){console.error("[xmldom error]\t"+zt,wi(this.locator))},fatalError:function(zt){throw new gt(zt,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(zt){Bt.prototype[zt]=function(){return null}}),In.DOMParser=ze},853:(ni,In,on)=>{var se=on(401).NAMESPACE;function dt(oe){return""!==oe}function Mt(oe,pe){return oe.hasOwnProperty(pe)||(oe[pe]=!0),oe}function Wt(oe){if(!oe)return[];var pe=function Oe(oe){return oe?oe.split(/[\t\n\f\r ]+/).filter(dt):[]}(oe);return Object.keys(pe.reduce(Mt,{}))}function gt(oe,pe){for(var Re in oe)pe[Re]=oe[Re]}function Nt(oe,pe){var Re=oe.prototype;if(!(Re instanceof pe)){let an=function(){};an.prototype=pe.prototype,an=new an,gt(Re,an),oe.prototype=Re=an}Re.constructor!=oe&&("function"!=typeof oe&&console.error("unknown Class:"+oe),Re.constructor=oe)}var ze={},Yi=ze.ELEMENT_NODE=1,Bt=ze.ATTRIBUTE_NODE=2,ui=ze.TEXT_NODE=3,wi=ze.CDATA_SECTION_NODE=4,Ir=ze.ENTITY_REFERENCE_NODE=5,cs=ze.ENTITY_NODE=6,zt=ze.PROCESSING_INSTRUCTION_NODE=7,Xn=ze.COMMENT_NODE=8,yn=ze.DOCUMENT_NODE=9,Hn=ze.DOCUMENT_TYPE_NODE=10,Bi=ze.DOCUMENT_FRAGMENT_NODE=11,Pn=ze.NOTATION_NODE=12,Zn={},Yn={},Te=(Zn.INDEX_SIZE_ERR=(Yn[1]="Index size error",1),Zn.DOMSTRING_SIZE_ERR=(Yn[2]="DOMString size error",2),Zn.HIERARCHY_REQUEST_ERR=(Yn[3]="Hierarchy request error",3)),Lt=(Zn.WRONG_DOCUMENT_ERR=(Yn[4]="Wrong document",4),Zn.INVALID_CHARACTER_ERR=(Yn[5]="Invalid character",5),Zn.NO_DATA_ALLOWED_ERR=(Yn[6]="No data allowed",6),Zn.NO_MODIFICATION_ALLOWED_ERR=(Yn[7]="No modification allowed",7),Zn.NOT_FOUND_ERR=(Yn[8]="Not found",8)),kt=(Zn.NOT_SUPPORTED_ERR=(Yn[9]="Not supported",9),Zn.INUSE_ATTRIBUTE_ERR=(Yn[10]="Attribute in use",10));function Oi(oe,pe){if(pe instanceof Error)var Re=pe;else Re=this,Error.call(this,Yn[oe]),this.message=Yn[oe],Error.captureStackTrace&&Error.captureStackTrace(this,Oi);return Re.code=oe,pe&&(this.message=this.message+": "+pe),Re}function Dn(){}function gn(oe,pe){this._node=oe,this._refresh=pe,Ra(this)}function Ra(oe){var pe=oe._node._inc||oe._node.ownerDocument._inc;if(oe._inc!=pe){var Re=oe._refresh(oe._node);Mf(oe,"length",Re.length),gt(Re,oe),oe._inc=pe}}function hn(){}function Rs(oe,pe){for(var Re=oe.length;Re--;)if(oe[Re]===pe)return Re}function eo(oe,pe,Re,Je){if(Je?pe[Rs(pe,Je)]=Re:pe[pe.length++]=Re,oe){Re.ownerElement=oe;var an=oe.ownerDocument;an&&(Je&&wc(an,oe,Je),function Qs(oe,pe,Re){oe&&oe._inc++,Re.namespaceURI===se.XMLNS&&(pe._nsMap[Re.prefix?Re.localName:""]=Re.value)}(an,oe,Re))}}function _o(oe,pe,Re){var Je=Rs(pe,Re);if(!(Je>=0))throw Oi(Lt,new Error(oe.tagName+"@"+Re));for(var an=pe.length-1;Je<an;)pe[Je]=pe[++Je];if(pe.length=an,oe){var nr=oe.ownerDocument;nr&&(wc(nr,oe,Re),Re.ownerElement=null)}}function ku(){}function As(){}function Tc(oe){return("<"==oe?"&lt;":">"==oe&&"&gt;")||"&"==oe&&"&amp;"||'"'==oe&&"&quot;"||"&#"+oe.charCodeAt()+";"}function Ns(oe,pe){if(pe(oe))return!0;if(oe=oe.firstChild)do{if(Ns(oe,pe))return!0}while(oe=oe.nextSibling)}function ul(){}function wc(oe,pe,Re,Je){oe&&oe._inc++,Re.namespaceURI===se.XMLNS&&delete pe._nsMap[Re.prefix?Re.localName:""]}function ih(oe,pe,Re){if(oe&&oe._inc){oe._inc++;var Je=pe.childNodes;if(Re)Je[Je.length++]=Re;else{for(var an=pe.firstChild,nr=0;an;)Je[nr++]=an,an=an.nextSibling;Je.length=nr}}}function au(oe,pe){var Re=pe.previousSibling,Je=pe.nextSibling;return Re?Re.nextSibling=Je:oe.firstChild=Je,Je?Je.previousSibling=Re:oe.lastChild=Re,ih(oe.ownerDocument,oe),pe}function nd(oe,pe,Re){var Je=pe.parentNode;if(Je&&Je.removeChild(pe),pe.nodeType===Bi){var an=pe.firstChild;if(null==an)return pe;var nr=pe.lastChild}else an=nr=pe;var rs=Re?Re.previousSibling:oe.lastChild;an.previousSibling=rs,nr.nextSibling=Re,rs?rs.nextSibling=an:oe.firstChild=an,null==Re?oe.lastChild=nr:Re.previousSibling=nr;do{an.parentNode=oe}while(an!==nr&&(an=an.nextSibling));return ih(oe.ownerDocument||oe,oe),pe.nodeType==Bi&&(pe.firstChild=pe.lastChild=null),pe}function Vs(){this._nsMap={}}function Ac(){}function ya(){}function Df(){}function zn(){}function Xp(){}function Yp(){}function Ks(){}function rh(){}function id(){}function sh(){}function Qp(){}function Kp(){}function xc(oe,pe){var Re=[],Je=9==this.nodeType&&this.documentElement||this,an=Je.prefix,nr=Je.namespaceURI;if(nr&&null==an&&null==(an=Je.lookupPrefix(nr)))var rs=[{namespace:nr,prefix:null}];return Hs(this,Re,oe,pe,rs),Re.join("")}function rd(oe,pe,Re){var Je=oe.prefix||"",an=oe.namespaceURI;if(!an||"xml"===Je&&an===se.XML||an===se.XMLNS)return!1;for(var nr=Re.length;nr--;){var rs=Re[nr];if(rs.prefix===Je)return rs.namespace!==an}return!0}function Fu(oe,pe,Re){oe.push(" ",pe,'="',Re.replace(/[<&"]/g,Tc),'"')}function Hs(oe,pe,Re,Je,an){if(an||(an=[]),Je){if(!(oe=Je(oe)))return;if("string"==typeof oe)return void pe.push(oe)}switch(oe.nodeType){case Yi:var nr=oe.attributes,rs=nr.length,_r=oe.firstChild,ko=oe.tagName,Dl=ko;if(!(Re=se.isHTML(oe.namespaceURI)||Re)&&!oe.prefix&&oe.namespaceURI){for(var oa,Ps=0;Ps<nr.length;Ps++)if("xmlns"===nr.item(Ps).name){oa=nr.item(Ps).value;break}if(!oa)for(var yo=an.length-1;yo>=0;yo--)if(""===(vr=an[yo]).prefix&&vr.namespace===oe.namespaceURI){oa=vr.namespace;break}if(oa!==oe.namespaceURI)for(yo=an.length-1;yo>=0;yo--){var vr;if((vr=an[yo]).namespace===oe.namespaceURI){vr.prefix&&(Dl=vr.prefix+":"+ko);break}}}pe.push("<",Dl);for(var bo=0;bo<rs;bo++)"xmlns"==(Qr=nr.item(bo)).prefix?an.push({prefix:Qr.localName,namespace:Qr.value}):"xmlns"==Qr.nodeName&&an.push({prefix:"",namespace:Qr.value});for(bo=0;bo<rs;bo++){var Qr,Sc,To;rd(Qr=nr.item(bo),0,an)&&(Fu(pe,(Sc=Qr.prefix||"")?"xmlns:"+Sc:"xmlns",To=Qr.namespaceURI),an.push({prefix:Sc,namespace:To})),Hs(Qr,pe,Re,Je,an)}if(ko===Dl&&rd(oe,0,an)&&(Fu(pe,(Sc=oe.prefix||"")?"xmlns:"+Sc:"xmlns",To=oe.namespaceURI),an.push({prefix:Sc,namespace:To})),_r||Re&&!/^(?:meta|link|img|br|hr|input)$/i.test(ko)){if(pe.push(">"),Re&&/^script$/i.test(ko))for(;_r;)_r.data?pe.push(_r.data):Hs(_r,pe,Re,Je,an.slice()),_r=_r.nextSibling;else for(;_r;)Hs(_r,pe,Re,Je,an.slice()),_r=_r.nextSibling;pe.push("</",Dl,">")}else pe.push("/>");return;case yn:case Bi:for(_r=oe.firstChild;_r;)Hs(_r,pe,Re,Je,an.slice()),_r=_r.nextSibling;return;case Bt:return Fu(pe,oe.name,oe.value);case ui:return pe.push(oe.data.replace(/[<&]/g,Tc).replace(/]]>/g,"]]&gt;"));case wi:return pe.push("<![CDATA[",oe.data,"]]>");case Xn:return pe.push("\x3c!--",oe.data,"--\x3e");case Hn:var sd=oe.publicId,Fo=oe.systemId;if(pe.push("<!DOCTYPE ",oe.name),sd)pe.push(" PUBLIC ",sd),Fo&&"."!=Fo&&pe.push(" ",Fo),pe.push(">");else if(Fo&&"."!=Fo)pe.push(" SYSTEM ",Fo,">");else{var Bo=oe.internalSubset;Bo&&pe.push(" [",Bo,"]"),pe.push(">")}return;case zt:return pe.push("<?",oe.target," ",oe.data,"?>");case Ir:return pe.push("&",oe.nodeName,";");default:pe.push("??",oe.nodeName)}}function Sr(oe,pe,Re){var Je;switch(pe.nodeType){case Yi:(Je=pe.cloneNode(!1)).ownerDocument=oe;case Bi:break;case Bt:Re=!0}if(Je||(Je=pe.cloneNode(!1)),Je.ownerDocument=oe,Je.parentNode=null,Re)for(var an=pe.firstChild;an;)Je.appendChild(Sr(oe,an,Re)),an=an.nextSibling;return Je}function ba(oe,pe,Re){var Je=new pe.constructor;for(var an in pe){var nr=pe[an];"object"!=typeof nr&&nr!=Je[an]&&(Je[an]=nr)}switch(pe.childNodes&&(Je.childNodes=new Dn),Je.ownerDocument=oe,Je.nodeType){case Yi:var rs=pe.attributes,ko=Je.attributes=new hn,Dl=rs.length;ko._ownerElement=Je;for(var oa=0;oa<Dl;oa++)Je.setAttributeNode(ba(oe,rs.item(oa),!0));break;case Bt:Re=!0}if(Re)for(var Ps=pe.firstChild;Ps;)Je.appendChild(ba(oe,Ps,Re)),Ps=Ps.nextSibling;return Je}function Mf(oe,pe,Re){oe[pe]=Re}Zn.INVALID_STATE_ERR=(Yn[11]="Invalid state",11),Zn.SYNTAX_ERR=(Yn[12]="Syntax error",12),Zn.INVALID_MODIFICATION_ERR=(Yn[13]="Invalid modification",13),Zn.NAMESPACE_ERR=(Yn[14]="Invalid namespace",14),Zn.INVALID_ACCESS_ERR=(Yn[15]="Invalid access",15),Oi.prototype=Error.prototype,gt(Zn,Oi),Dn.prototype={length:0,item:function(oe){return this[oe]||null},toString:function(oe,pe){for(var Re=[],Je=0;Je<this.length;Je++)Hs(this[Je],Re,oe,pe);return Re.join("")}},gn.prototype.item=function(oe){return Ra(this),this[oe]},Nt(gn,Dn),hn.prototype={length:0,item:Dn.prototype.item,getNamedItem:function(oe){for(var pe=this.length;pe--;){var Re=this[pe];if(Re.nodeName==oe)return Re}},setNamedItem:function(oe){var pe=oe.ownerElement;if(pe&&pe!=this._ownerElement)throw new Oi(kt);var Re=this.getNamedItem(oe.nodeName);return eo(this._ownerElement,this,oe,Re),Re},setNamedItemNS:function(oe){var Re,pe=oe.ownerElement;if(pe&&pe!=this._ownerElement)throw new Oi(kt);return Re=this.getNamedItemNS(oe.namespaceURI,oe.localName),eo(this._ownerElement,this,oe,Re),Re},removeNamedItem:function(oe){var pe=this.getNamedItem(oe);return _o(this._ownerElement,this,pe),pe},removeNamedItemNS:function(oe,pe){var Re=this.getNamedItemNS(oe,pe);return _o(this._ownerElement,this,Re),Re},getNamedItemNS:function(oe,pe){for(var Re=this.length;Re--;){var Je=this[Re];if(Je.localName==pe&&Je.namespaceURI==oe)return Je}return null}},ku.prototype={hasFeature:function(oe,pe){return!0},createDocument:function(oe,pe,Re){var Je=new ul;if(Je.implementation=this,Je.childNodes=new Dn,Je.doctype=Re||null,Re&&Je.appendChild(Re),pe){var an=Je.createElementNS(oe,pe);Je.appendChild(an)}return Je},createDocumentType:function(oe,pe,Re){var Je=new Yp;return Je.name=oe,Je.nodeName=oe,Je.publicId=pe||"",Je.systemId=Re||"",Je}},As.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(oe,pe){return nd(this,oe,pe)},replaceChild:function(oe,pe){this.insertBefore(oe,pe),pe&&this.removeChild(pe)},removeChild:function(oe){return au(this,oe)},appendChild:function(oe){return this.insertBefore(oe,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(oe){return ba(this.ownerDocument||this,this,oe)},normalize:function(){for(var oe=this.firstChild;oe;){var pe=oe.nextSibling;pe&&pe.nodeType==ui&&oe.nodeType==ui?(this.removeChild(pe),oe.appendData(pe.data)):(oe.normalize(),oe=pe)}},isSupported:function(oe,pe){return this.ownerDocument.implementation.hasFeature(oe,pe)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(oe){for(var pe=this;pe;){var Re=pe._nsMap;if(Re)for(var Je in Re)if(Re[Je]==oe)return Je;pe=pe.nodeType==Bt?pe.ownerDocument:pe.parentNode}return null},lookupNamespaceURI:function(oe){for(var pe=this;pe;){var Re=pe._nsMap;if(Re&&oe in Re)return Re[oe];pe=pe.nodeType==Bt?pe.ownerDocument:pe.parentNode}return null},isDefaultNamespace:function(oe){return null==this.lookupPrefix(oe)}},gt(ze,As),gt(ze,As.prototype),ul.prototype={nodeName:"#document",nodeType:yn,doctype:null,documentElement:null,_inc:1,insertBefore:function(oe,pe){if(oe.nodeType==Bi){for(var Re=oe.firstChild;Re;){var Je=Re.nextSibling;this.insertBefore(Re,pe),Re=Je}return oe}return null==this.documentElement&&oe.nodeType==Yi&&(this.documentElement=oe),nd(this,oe,pe),oe.ownerDocument=this,oe},removeChild:function(oe){return this.documentElement==oe&&(this.documentElement=null),au(this,oe)},importNode:function(oe,pe){return Sr(this,oe,pe)},getElementById:function(oe){var pe=null;return Ns(this.documentElement,function(Re){if(Re.nodeType==Yi&&Re.getAttribute("id")==oe)return pe=Re,!0}),pe},getElementsByClassName:function(oe){var pe=Wt(oe);return new gn(this,function(Re){var Je=[];return pe.length>0&&Ns(Re.documentElement,function(an){if(an!==Re&&an.nodeType===Yi){var nr=an.getAttribute("class");if(nr){var rs=oe===nr;if(!rs){var ko=Wt(nr);rs=pe.every(function yt(oe){return function(pe){return oe&&-1!==oe.indexOf(pe)}}(ko))}rs&&Je.push(an)}}}),Je})},createElement:function(oe){var pe=new Vs;return pe.ownerDocument=this,pe.nodeName=oe,pe.tagName=oe,pe.localName=oe,pe.childNodes=new Dn,(pe.attributes=new hn)._ownerElement=pe,pe},createDocumentFragment:function(){var oe=new sh;return oe.ownerDocument=this,oe.childNodes=new Dn,oe},createTextNode:function(oe){var pe=new Df;return pe.ownerDocument=this,pe.appendData(oe),pe},createComment:function(oe){var pe=new zn;return pe.ownerDocument=this,pe.appendData(oe),pe},createCDATASection:function(oe){var pe=new Xp;return pe.ownerDocument=this,pe.appendData(oe),pe},createProcessingInstruction:function(oe,pe){var Re=new Qp;return Re.ownerDocument=this,Re.tagName=Re.target=oe,Re.nodeValue=Re.data=pe,Re},createAttribute:function(oe){var pe=new Ac;return pe.ownerDocument=this,pe.name=oe,pe.nodeName=oe,pe.localName=oe,pe.specified=!0,pe},createEntityReference:function(oe){var pe=new id;return pe.ownerDocument=this,pe.nodeName=oe,pe},createElementNS:function(oe,pe){var Re=new Vs,Je=pe.split(":"),an=Re.attributes=new hn;return Re.childNodes=new Dn,Re.ownerDocument=this,Re.nodeName=pe,Re.tagName=pe,Re.namespaceURI=oe,2==Je.length?(Re.prefix=Je[0],Re.localName=Je[1]):Re.localName=pe,an._ownerElement=Re,Re},createAttributeNS:function(oe,pe){var Re=new Ac,Je=pe.split(":");return Re.ownerDocument=this,Re.nodeName=pe,Re.name=pe,Re.namespaceURI=oe,Re.specified=!0,2==Je.length?(Re.prefix=Je[0],Re.localName=Je[1]):Re.localName=pe,Re}},Nt(ul,As),ul.prototype.getElementsByTagName=(Vs.prototype={nodeType:Yi,hasAttribute:function(oe){return null!=this.getAttributeNode(oe)},getAttribute:function(oe){var pe=this.getAttributeNode(oe);return pe&&pe.value||""},getAttributeNode:function(oe){return this.attributes.getNamedItem(oe)},setAttribute:function(oe,pe){var Re=this.ownerDocument.createAttribute(oe);Re.value=Re.nodeValue=""+pe,this.setAttributeNode(Re)},removeAttribute:function(oe){var pe=this.getAttributeNode(oe);pe&&this.removeAttributeNode(pe)},appendChild:function(oe){return oe.nodeType===Bi?this.insertBefore(oe,null):function Yr(oe,pe){var Re=pe.parentNode;if(Re){var Je=oe.lastChild;Re.removeChild(pe),Je=oe.lastChild}return Je=oe.lastChild,pe.parentNode=oe,pe.previousSibling=Je,pe.nextSibling=null,Je?Je.nextSibling=pe:oe.firstChild=pe,oe.lastChild=pe,ih(oe.ownerDocument,oe,pe),pe}(this,oe)},setAttributeNode:function(oe){return this.attributes.setNamedItem(oe)},setAttributeNodeNS:function(oe){return this.attributes.setNamedItemNS(oe)},removeAttributeNode:function(oe){return this.attributes.removeNamedItem(oe.nodeName)},removeAttributeNS:function(oe,pe){var Re=this.getAttributeNodeNS(oe,pe);Re&&this.removeAttributeNode(Re)},hasAttributeNS:function(oe,pe){return null!=this.getAttributeNodeNS(oe,pe)},getAttributeNS:function(oe,pe){var Re=this.getAttributeNodeNS(oe,pe);return Re&&Re.value||""},setAttributeNS:function(oe,pe,Re){var Je=this.ownerDocument.createAttributeNS(oe,pe);Je.value=Je.nodeValue=""+Re,this.setAttributeNode(Je)},getAttributeNodeNS:function(oe,pe){return this.attributes.getNamedItemNS(oe,pe)},getElementsByTagName:function(oe){return new gn(this,function(pe){var Re=[];return Ns(pe,function(Je){Je!==pe&&Je.nodeType==Yi&&("*"===oe||Je.tagName==oe)&&Re.push(Je)}),Re})},getElementsByTagNameNS:function(oe,pe){return new gn(this,function(Re){var Je=[];return Ns(Re,function(an){an!==Re&&an.nodeType===Yi&&("*"===oe||an.namespaceURI===oe)&&("*"===pe||an.localName==pe)&&Je.push(an)}),Je})}}).getElementsByTagName,ul.prototype.getElementsByTagNameNS=Vs.prototype.getElementsByTagNameNS,Nt(Vs,As),Ac.prototype.nodeType=Bt,Nt(Ac,As),ya.prototype={data:"",substringData:function(oe,pe){return this.data.substring(oe,oe+pe)},appendData:function(oe){this.nodeValue=this.data=oe=this.data+oe,this.length=oe.length},insertData:function(oe,pe){this.replaceData(oe,0,pe)},appendChild:function(oe){throw new Error(Yn[Te])},deleteData:function(oe,pe){this.replaceData(oe,pe,"")},replaceData:function(oe,pe,Re){var Je=this.data.substring(0,oe),an=this.data.substring(oe+pe);this.nodeValue=this.data=Re=Je+Re+an,this.length=Re.length}},Nt(ya,As),Df.prototype={nodeName:"#text",nodeType:ui,splitText:function(oe){var pe=this.data,Re=pe.substring(oe);pe=pe.substring(0,oe),this.data=this.nodeValue=pe,this.length=pe.length;var Je=this.ownerDocument.createTextNode(Re);return this.parentNode&&this.parentNode.insertBefore(Je,this.nextSibling),Je}},Nt(Df,ya),zn.prototype={nodeName:"#comment",nodeType:Xn},Nt(zn,ya),Xp.prototype={nodeName:"#cdata-section",nodeType:wi},Nt(Xp,ya),Yp.prototype.nodeType=Hn,Nt(Yp,As),Ks.prototype.nodeType=Pn,Nt(Ks,As),rh.prototype.nodeType=cs,Nt(rh,As),id.prototype.nodeType=Ir,Nt(id,As),sh.prototype.nodeName="#document-fragment",sh.prototype.nodeType=Bi,Nt(sh,As),Qp.prototype.nodeType=zt,Nt(Qp,As),Kp.prototype.serializeToString=function(oe,pe,Re){return xc.call(oe,pe,Re)},As.prototype.toString=xc;try{if(Object.defineProperty){let oe=function(pe){switch(pe.nodeType){case Yi:case Bi:var Re=[];for(pe=pe.firstChild;pe;)7!==pe.nodeType&&8!==pe.nodeType&&Re.push(oe(pe)),pe=pe.nextSibling;return Re.join("");default:return pe.nodeValue}};Object.defineProperty(gn.prototype,"length",{get:function(){return Ra(this),this.$$length}}),Object.defineProperty(As.prototype,"textContent",{get:function(){return oe(this)},set:function(pe){switch(this.nodeType){case Yi:case Bi:for(;this.firstChild;)this.removeChild(this.firstChild);(pe||String(pe))&&this.appendChild(this.ownerDocument.createTextNode(pe));break;default:this.data=pe,this.value=pe,this.nodeValue=pe}}}),Mf=function(pe,Re,Je){pe["$$"+Re]=Je}}}catch{}In.DocumentType=Yp,In.DOMException=Oi,In.DOMImplementation=ku,In.Element=Vs,In.Node=As,In.NodeList=Dn,In.XMLSerializer=Kp},436:(ni,In,on)=>{var ht=on(401).freeze;In.XML_ENTITIES=ht({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),In.HTML_ENTITIES=ht({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xc0",Aacute:"\xc1",Acirc:"\xc2",Atilde:"\xc3",Auml:"\xc4",Aring:"\xc5",AElig:"\xc6",Ccedil:"\xc7",Egrave:"\xc8",Eacute:"\xc9",Ecirc:"\xca",Euml:"\xcb",Igrave:"\xcc",Iacute:"\xcd",Icirc:"\xce",Iuml:"\xcf",ETH:"\xd0",Ntilde:"\xd1",Ograve:"\xd2",Oacute:"\xd3",Ocirc:"\xd4",Otilde:"\xd5",Ouml:"\xd6",Oslash:"\xd8",Ugrave:"\xd9",Uacute:"\xda",Ucirc:"\xdb",Uuml:"\xdc",Yacute:"\xdd",THORN:"\xde",szlig:"\xdf",agrave:"\xe0",aacute:"\xe1",acirc:"\xe2",atilde:"\xe3",auml:"\xe4",aring:"\xe5",aelig:"\xe6",ccedil:"\xe7",egrave:"\xe8",eacute:"\xe9",ecirc:"\xea",euml:"\xeb",igrave:"\xec",iacute:"\xed",icirc:"\xee",iuml:"\xef",eth:"\xf0",ntilde:"\xf1",ograve:"\xf2",oacute:"\xf3",ocirc:"\xf4",otilde:"\xf5",ouml:"\xf6",oslash:"\xf8",ugrave:"\xf9",uacute:"\xfa",ucirc:"\xfb",uuml:"\xfc",yacute:"\xfd",thorn:"\xfe",yuml:"\xff",nbsp:"\xa0",iexcl:"\xa1",cent:"\xa2",pound:"\xa3",curren:"\xa4",yen:"\xa5",brvbar:"\xa6",sect:"\xa7",uml:"\xa8",copy:"\xa9",ordf:"\xaa",laquo:"\xab",not:"\xac",shy:"\xad\xad",reg:"\xae",macr:"\xaf",deg:"\xb0",plusmn:"\xb1",sup2:"\xb2",sup3:"\xb3",acute:"\xb4",micro:"\xb5",para:"\xb6",middot:"\xb7",cedil:"\xb8",sup1:"\xb9",ordm:"\xba",raquo:"\xbb",frac14:"\xbc",frac12:"\xbd",frac34:"\xbe",iquest:"\xbf",times:"\xd7",divide:"\xf7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220b",prod:"\u220f",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221a",prop:"\u221d",infin:"\u221e",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222a",int:"\u222b",there4:"\u2234",sim:"\u223c",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22a5",sdot:"\u22c5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039a",Lambda:"\u039b",Mu:"\u039c",Nu:"\u039d",Xi:"\u039e",Omicron:"\u039f",Pi:"\u03a0",Rho:"\u03a1",Sigma:"\u03a3",Tau:"\u03a4",Upsilon:"\u03a5",Phi:"\u03a6",Chi:"\u03a7",Psi:"\u03a8",Omega:"\u03a9",alpha:"\u03b1",beta:"\u03b2",gamma:"\u03b3",delta:"\u03b4",epsilon:"\u03b5",zeta:"\u03b6",eta:"\u03b7",theta:"\u03b8",iota:"\u03b9",kappa:"\u03ba",lambda:"\u03bb",mu:"\u03bc",nu:"\u03bd",xi:"\u03be",omicron:"\u03bf",pi:"\u03c0",rho:"\u03c1",sigmaf:"\u03c2",sigma:"\u03c3",tau:"\u03c4",upsilon:"\u03c5",phi:"\u03c6",chi:"\u03c7",psi:"\u03c8",omega:"\u03c9",thetasym:"\u03d1",upsih:"\u03d2",piv:"\u03d6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02c6",tilde:"\u02dc",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200c",zwj:"\u200d",lrm:"\u200e",rlm:"\u200f",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201a",ldquo:"\u201c",rdquo:"\u201d",bdquo:"\u201e",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203a",oline:"\u203e",euro:"\u20ac",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21b5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230a",rfloor:"\u230b",loz:"\u25ca",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}),In.entityMap=In.HTML_ENTITIES},978:(ni,In,on)=>{on(853);In.DOMParser=on(991).DOMParser},702:(ni,In,on)=>{var ht=on(401).NAMESPACE,se=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,dt=new RegExp("[\\-\\.0-9"+se.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Oe=new RegExp("^"+se.source+dt.source+"*(?::"+se.source+dt.source+"*)?$");function ui(ge,Te){this.message=ge,this.locator=Te,Error.captureStackTrace&&Error.captureStackTrace(this,ui)}function wi(){}function cs(ge,Te){return Te.lineNumber=ge.lineNumber,Te.columnNumber=ge.columnNumber,Te}function zt(ge,Te,it,Ot,Tt,tn){function Lt(Ui,Oi,Dn){it.attributeNames.hasOwnProperty(Ui)&&tn.fatalError("Attribute "+Ui+" redefined"),it.addValue(Ui,Oi,Dn)}for(var jt,Qt=++Te,Ht=0;;){var Jt=ge.charAt(Qt);switch(Jt){case"=":if(1===Ht)jt=ge.slice(Te,Qt),Ht=3;else{if(2!==Ht)throw new Error("attribute equal must after attrName");Ht=3}break;case"'":case'"':if(3===Ht||1===Ht){if(1===Ht&&(tn.warning('attribute value must after "="'),jt=ge.slice(Te,Qt)),!((Qt=ge.indexOf(Jt,Te=Qt+1))>0))throw new Error("attribute value no end '"+Jt+"' match");Lt(jt,kt=ge.slice(Te,Qt).replace(/&#?\w+;/g,Tt),Te-1),Ht=5}else{if(4!=Ht)throw new Error('attribute value must after "="');Lt(jt,kt=ge.slice(Te,Qt).replace(/&#?\w+;/g,Tt),Te),tn.warning('attribute "'+jt+'" missed start quot('+Jt+")!!"),Te=Qt+1,Ht=5}break;case"/":switch(Ht){case 0:it.setTagName(ge.slice(Te,Qt));case 5:case 6:case 7:Ht=7,it.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return tn.error("unexpected end of input"),0==Ht&&it.setTagName(ge.slice(Te,Qt)),Qt;case">":switch(Ht){case 0:it.setTagName(ge.slice(Te,Qt));case 5:case 6:case 7:break;case 4:case 1:"/"===(kt=ge.slice(Te,Qt)).slice(-1)&&(it.closed=!0,kt=kt.slice(0,-1));case 2:2===Ht&&(kt=jt),4==Ht?(tn.warning('attribute "'+kt+'" missed quot(")!'),Lt(jt,kt.replace(/&#?\w+;/g,Tt),Te)):((!ht.isHTML(Ot[""])||!kt.match(/^(?:disabled|checked|selected)$/i))&&tn.warning('attribute "'+kt+'" missed value!! "'+kt+'" instead!!'),Lt(kt,kt,Te));break;case 3:throw new Error("attribute value missed!!")}return Qt;case"\x80":Jt=" ";default:if(Jt<=" ")switch(Ht){case 0:it.setTagName(ge.slice(Te,Qt)),Ht=6;break;case 1:jt=ge.slice(Te,Qt),Ht=2;break;case 4:var kt=ge.slice(Te,Qt).replace(/&#?\w+;/g,Tt);tn.warning('attribute "'+kt+'" missed quot(")!!'),Lt(jt,kt,Te);case 5:Ht=6}else switch(Ht){case 2:(!ht.isHTML(Ot[""])||!jt.match(/^(?:disabled|checked|selected)$/i))&&tn.warning('attribute "'+jt+'" missed value!! "'+jt+'" instead2!!'),Lt(jt,jt,Te),Te=Qt,Ht=1;break;case 5:tn.warning('attribute space is required"'+jt+'"!!');case 6:Ht=1,Te=Qt;break;case 3:Ht=4,Te=Qt;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}Qt++}}function Xn(ge,Te,it){for(var Ot=ge.tagName,Tt=null,Jt=ge.length;Jt--;){var tn=ge[Jt],Lt=tn.qName,jt=tn.value;if((Yt=Lt.indexOf(":"))>0)var kt=tn.prefix=Lt.slice(0,Yt),Qt=Lt.slice(Yt+1),Ht="xmlns"===kt&&Qt;else Qt=Lt,kt=null,Ht="xmlns"===Lt&&"";tn.localName=Qt,!1!==Ht&&(null==Tt&&(Tt={},Bi(it,it={})),it[Ht]=Tt[Ht]=jt,tn.uri=ht.XMLNS,Te.startPrefixMapping(Ht,jt))}for(Jt=ge.length;Jt--;)(kt=(tn=ge[Jt]).prefix)&&("xml"===kt&&(tn.uri=ht.XML),"xmlns"!==kt&&(tn.uri=it[kt||""]));var Yt;(Yt=Ot.indexOf(":"))>0?(kt=ge.prefix=Ot.slice(0,Yt),Qt=ge.localName=Ot.slice(Yt+1)):(kt=null,Qt=ge.localName=Ot);var Ui=ge.uri=it[kt||""];if(Te.startElement(Ui,Qt,Ot,ge),!ge.closed)return ge.currentNSMap=it,ge.localNSMap=Tt,!0;if(Te.endElement(Ui,Qt,Ot),Tt)for(kt in Tt)Te.endPrefixMapping(kt)}function yn(ge,Te,it,Ot,Tt){if(/^(?:script|textarea)$/i.test(it)){var tn=ge.indexOf("</"+it+">",Te),Lt=ge.substring(Te+1,tn);if(/[&<]/.test(Lt))return/^script$/i.test(it)?(Tt.characters(Lt,0,Lt.length),tn):(Lt=Lt.replace(/&#?\w+;/g,Ot),Tt.characters(Lt,0,Lt.length),tn)}return Te+1}function Hn(ge,Te,it,Ot){var Tt=Ot[it];return null==Tt&&((Tt=ge.lastIndexOf("</"+it+">"))<Te&&(Tt=ge.lastIndexOf("</"+it)),Ot[it]=Tt),Tt<Te}function Bi(ge,Te){for(var it in ge)Te[it]=ge[it]}function Pn(ge,Te,it,Ot){if("-"===ge.charAt(Te+2))return"-"===ge.charAt(Te+3)?(tn=ge.indexOf("--\x3e",Te+4))>Te?(it.comment(ge,Te+4,tn-Te-4),tn+3):(Ot.error("Unclosed comment"),-1):-1;if("CDATA["==ge.substr(Te+3,6)){var tn=ge.indexOf("]]>",Te+9);return it.startCDATA(),it.characters(ge,Te+9,tn-Te-9),it.endCDATA(),tn+3}var Lt=function oi(ge,Te){var it,Ot=[],Tt=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(Tt.lastIndex=Te,Tt.exec(ge);it=Tt.exec(ge);)if(Ot.push(it),it[1])return Ot}(ge,Te),jt=Lt.length;if(jt>1&&/!doctype/i.test(Lt[0][0])){var kt=Lt[1][0],Qt=!1,Ht=!1;jt>3&&(/^public$/i.test(Lt[2][0])?(Qt=Lt[3][0],Ht=jt>4&&Lt[4][0]):/^system$/i.test(Lt[2][0])&&(Ht=Lt[3][0]));var Jt=Lt[jt-1];return it.startDTD(kt,Qt,Ht),it.endDTD(),Jt.index+Jt[0].length}return-1}function Zn(ge,Te,it){var Ot=ge.indexOf("?>",Te);if(Ot){var Tt=ge.substring(Te,Ot).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return Tt?(it.processingInstruction(Tt[1],Tt[2]),Ot+2):-1}return-1}function Yn(){this.attributeNames={}}(ui.prototype=new Error).name=ui.name,wi.prototype={parse:function(ge,Te,it){var Ot=this.domBuilder;Ot.startDocument(),Bi(Te,Te={}),function Ir(ge,Te,it,Ot,Tt){function Lt(Yr){var Vs=Yr.slice(1,-1);return Vs in it?it[Vs]:"#"===Vs.charAt(0)?function tn(Yr){return Yr>65535?(Yr-=65536,String.fromCharCode(55296+(Yr>>10),56320+(1023&Yr))):String.fromCharCode(Yr)}(parseInt(Vs.substr(1).replace("x","0x"))):(Tt.error("entity not found:"+Yr),Yr)}function jt(Yr){if(Yr>Dn){var Vs=ge.substring(Dn,Yr).replace(/&#?\w+;/g,Lt);Yt&&kt(Dn),Ot.characters(Vs,0,Yr-Dn),Dn=Yr}}function kt(Yr,Vs){for(;Yr>=Ht&&(Vs=Jt.exec(ge));)Ht=(Qt=Vs.index)+Vs[0].length,Yt.lineNumber++;Yt.columnNumber=Yr-Qt+1}for(var Qt=0,Ht=0,Jt=/.*(?:\r\n?|\n)|.*$/g,Yt=Ot.locator,Ui=[{currentNSMap:Te}],Oi={},Dn=0;;){try{var gn=ge.indexOf("<",Dn);if(gn<0){if(!ge.substr(Dn).match(/^\s*$/)){var Ra=Ot.doc,hn=Ra.createTextNode(ge.substr(Dn));Ra.appendChild(hn),Ot.currentElement=hn}return}switch(gn>Dn&&jt(gn),ge.charAt(gn+1)){case"/":var Qs=ge.indexOf(">",gn+3),Rs=ge.substring(gn+2,Qs).replace(/[ \t\n\r]+$/g,""),eo=Ui.pop();Qs<0?(Rs=ge.substring(gn+2).replace(/[\s<].*/,""),Tt.error("end tag name: "+Rs+" is not complete:"+eo.tagName),Qs=gn+1+Rs.length):Rs.match(/\s</)&&(Rs=Rs.replace(/[\s<].*/,""),Tt.error("end tag name: "+Rs+" maybe not complete"),Qs=gn+1+Rs.length);var _o=eo.localNSMap,ku=eo.tagName==Rs;if(ku||eo.tagName&&eo.tagName.toLowerCase()==Rs.toLowerCase()){if(Ot.endElement(eo.uri,eo.localName,Rs),_o)for(var Tc in _o)Ot.endPrefixMapping(Tc);ku||Tt.fatalError("end tag name: "+Rs+" is not match the current start tagName:"+eo.tagName)}else Ui.push(eo);Qs++;break;case"?":Yt&&kt(gn),Qs=Zn(ge,gn,Ot);break;case"!":Yt&&kt(gn),Qs=Pn(ge,gn,Ot,Tt);break;default:Yt&&kt(gn);var Ns=new Yn,ul=Ui[Ui.length-1].currentNSMap,wc=(Qs=zt(ge,gn,Ns,ul,Lt,Tt),Ns.length);if(!Ns.closed&&Hn(ge,Qs,Ns.tagName,Oi)&&(Ns.closed=!0,it.nbsp||Tt.warning("unclosed xml attribute")),Yt&&wc){for(var ih=cs(Yt,{}),au=0;au<wc;au++){var nd=Ns[au];kt(nd.offset),nd.locator=cs(Yt,{})}Ot.locator=ih,Xn(Ns,Ot,ul)&&Ui.push(Ns),Ot.locator=Yt}else Xn(Ns,Ot,ul)&&Ui.push(Ns);ht.isHTML(Ns.uri)&&!Ns.closed?Qs=yn(ge,Qs,Ns.tagName,Lt,Ot):Qs++}}catch(Yr){if(Yr instanceof ui)throw Yr;Tt.error("element parse error: "+Yr),Qs=-1}Qs>Dn?Dn=Qs:jt(Math.max(gn,Dn)+1)}}(ge,Te,it,Ot,this.errorHandler),Ot.endDocument()}},Yn.prototype={setTagName:function(ge){if(!Oe.test(ge))throw new Error("invalid tagName:"+ge);this.tagName=ge},addValue:function(ge,Te,it){if(!Oe.test(ge))throw new Error("invalid attribute:"+ge);this.attributeNames[ge]=this.length,this[this.length++]={qName:ge,value:Te,offset:it}},length:0,getLocalName:function(ge){return this[ge].localName},getLocator:function(ge){return this[ge].locator},getQName:function(ge){return this[ge].qName},getURI:function(ge){return this[ge].uri},getValue:function(ge){return this[ge].value}},In.XMLReader=wi,In.ParseError=ui},421:(ni,In,on)=>{var dt,ht=typeof global<"u"?global:typeof window<"u"?window:{},se=on(893);typeof document<"u"?dt=document:(dt=ht["__GLOBAL_DOCUMENT_CACHE@4"])||(dt=ht["__GLOBAL_DOCUMENT_CACHE@4"]=se),ni.exports=dt},226:ni=>{var In;In=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ni.exports=In},703:ni=>{ni.exports=function on(ht){if(!ht)return!1;var se=In.call(ht);return"[object Function]"===se||"function"==typeof ht&&"[object RegExp]"!==se||typeof window<"u"&&(ht===window.setTimeout||ht===window.alert||ht===window.confirm||ht===window.prompt)};var In=Object.prototype.toString},234:(ni,In)=>{function on(Wt){if(Wt&&"object"==typeof Wt){var yt=Wt.which||Wt.keyCode||Wt.charCode;yt&&(Wt=yt)}if("number"==typeof Wt)return Oe[Wt];var Nt,gt=String(Wt);return(Nt=ht[gt.toLowerCase()])?Nt:(Nt=se[gt.toLowerCase()])||(1===gt.length?gt.charCodeAt(0):void 0)}on.isEventKey=function(yt,gt){if(yt&&"object"==typeof yt){var Nt=yt.which||yt.keyCode||yt.charCode;if(null==Nt)return!1;if("string"==typeof gt){var ze;if(ze=ht[gt.toLowerCase()])return ze===Nt;if(ze=se[gt.toLowerCase()])return ze===Nt}else if("number"==typeof gt)return gt===Nt;return!1}};var ht=(In=ni.exports=on).code=In.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},se=In.aliases={windows:91,"\u21e7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(dt=97;dt<123;dt++)ht[String.fromCharCode(dt)]=dt-32;for(var dt=48;dt<58;dt++)ht[dt-48]=dt;for(dt=1;dt<13;dt++)ht["f"+dt]=dt+111;for(dt=0;dt<10;dt++)ht["numpad "+dt]=dt+96;var Oe=In.names=In.title={};for(dt in ht)Oe[ht[dt]]=dt;for(var Mt in se)ht[Mt]=se[Mt]},459:(ni,In,on)=>{var ht=on(357).getUint64;ni.exports=function(dt){var Oe=new DataView(dt.buffer,dt.byteOffset,dt.byteLength),Mt={version:dt[0],flags:new Uint8Array(dt.subarray(1,4)),references:[],referenceId:Oe.getUint32(4),timescale:Oe.getUint32(8)},Wt=12;0===Mt.version?(Mt.earliestPresentationTime=Oe.getUint32(Wt),Mt.firstOffset=Oe.getUint32(Wt+4),Wt+=8):(Mt.earliestPresentationTime=ht(dt.subarray(Wt)),Mt.firstOffset=ht(dt.subarray(Wt+8)),Wt+=16);var yt=Oe.getUint16(Wt+=2);for(Wt+=2;yt>0;Wt+=12,yt--)Mt.references.push({referenceType:(128&dt[Wt])>>>7,referencedSize:2147483647&Oe.getUint32(Wt),subsegmentDuration:Oe.getUint32(Wt+4),startsWithSap:!!(128&dt[Wt+8]),sapType:(112&dt[Wt+8])>>>4,sapDeltaTime:268435455&Oe.getUint32(Wt+8)});return Mt}},277:ni=>{var on,ht,se,dt,Oe,Mt,Wt;Oe=function(yt,gt){return on(dt(yt,gt))},Mt=function(yt,gt){return ht(se(yt),gt)},Wt=function(yt,gt,Nt){return se(Nt?yt:yt-gt)},ni.exports={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:on=function(yt){return 9e4*yt},secondsToAudioTs:ht=function(yt,gt){return yt*gt},videoTsToSeconds:se=function(yt){return yt/9e4},audioTsToSeconds:dt=function(yt,gt){return yt/gt},audioTsToVideoTs:Oe,videoTsToAudioTs:Mt,metadataTsToSeconds:Wt}},357:ni=>{var In=Math.pow(2,32);ni.exports={getUint64:function(ht){var dt,se=new DataView(ht.buffer,ht.byteOffset,ht.byteLength);return se.getBigUint64?(dt=se.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(dt):dt:se.getUint32(0)*In+se.getUint32(4)},MAX_UINT32:In}},99:ni=>{ni.exports=function In(on,ht){var se,dt=null;try{se=JSON.parse(on,ht)}catch(Oe){dt=Oe}return[dt,se]}},871:function(ni){var on,ht,se,dt,Oe;on=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,ht=/^(?=([^\/?#]*))\1([^]*)$/,se=/(?:\/|^)\.(?=\/)/g,dt=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,ni.exports=Oe={buildAbsoluteURL:function(Mt,Wt,yt){if(yt=yt||{},Mt=Mt.trim(),!(Wt=Wt.trim())){if(!yt.alwaysNormalize)return Mt;var gt=Oe.parseURL(Mt);if(!gt)throw new Error("Error trying to parse base URL.");return gt.path=Oe.normalizePath(gt.path),Oe.buildURLFromParts(gt)}var Nt=Oe.parseURL(Wt);if(!Nt)throw new Error("Error trying to parse relative URL.");if(Nt.scheme)return yt.alwaysNormalize?(Nt.path=Oe.normalizePath(Nt.path),Oe.buildURLFromParts(Nt)):Wt;var ze=Oe.parseURL(Mt);if(!ze)throw new Error("Error trying to parse base URL.");if(!ze.netLoc&&ze.path&&"/"!==ze.path[0]){var Yi=ht.exec(ze.path);ze.netLoc=Yi[1],ze.path=Yi[2]}ze.netLoc&&!ze.path&&(ze.path="/");var Bt={scheme:ze.scheme,netLoc:Nt.netLoc,path:null,params:Nt.params,query:Nt.query,fragment:Nt.fragment};if(!Nt.netLoc&&(Bt.netLoc=ze.netLoc,"/"!==Nt.path[0]))if(Nt.path){var ui=ze.path,wi=ui.substring(0,ui.lastIndexOf("/")+1)+Nt.path;Bt.path=Oe.normalizePath(wi)}else Bt.path=ze.path,Nt.params||(Bt.params=ze.params,Nt.query||(Bt.query=ze.query));return null===Bt.path&&(Bt.path=yt.alwaysNormalize?Oe.normalizePath(Nt.path):Nt.path),Oe.buildURLFromParts(Bt)},parseURL:function(Mt){var Wt=on.exec(Mt);return Wt?{scheme:Wt[1]||"",netLoc:Wt[2]||"",path:Wt[3]||"",params:Wt[4]||"",query:Wt[5]||"",fragment:Wt[6]||""}:null},normalizePath:function(Mt){for(Mt=Mt.split("").reverse().join("").replace(se,"");Mt.length!==(Mt=Mt.replace(dt,"")).length;);return Mt.split("").reverse().join("")},buildURLFromParts:function(Mt){return Mt.scheme+Mt.netLoc+Mt.path+Mt.params+Mt.query+Mt.fragment}}},17:(ni,In,on)=>{"use strict";on.r(In),on.d(In,{default:()=>t_});var ht=on(226),se=on.n(ht),dt=on(421),Oe=on.n(dt);function Mt(){return Mt=Object.assign?Object.assign.bind():function(b){for(var d=1;d<arguments.length;d++){var f=arguments[d];for(var h in f)Object.prototype.hasOwnProperty.call(f,h)&&(b[h]=f[h])}return b},Mt.apply(this,arguments)}var Wt=on(234),yt=on.n(Wt);function gt(b){if(void 0===b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function Nt(b,d){return(Nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,s){return h.__proto__=s,h})(b,d)}function ze(b,d){b.prototype=Object.create(d.prototype),b.prototype.constructor=b,Nt(b,d)}var Yi=on(99),Bt=on.n(Yi),ui=on(745),wi=on.n(ui),Ir=on(629),cs=on.n(Ir);function zt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xn(b,d,f){return(Xn=zt()?Reflect.construct.bind():function(s,u,m){var T=[null];T.push.apply(T,u);var D=new(Function.bind.apply(s,T));return m&&Nt(D,m.prototype),D}).apply(null,arguments)}var Hn=on(871),Bi=on.n(Hn),Pn="http://example.com";const Yn=function(d,f){if(/^[a-z]+:/i.test(f))return f;/^data:/.test(d)&&(d=se().location&&se().location.href||"");var h="function"==typeof se().URL,s=/^\/\//.test(d),u=!se().location&&!/\/\//i.test(d);if(h?d=new(se().URL)(d,se().location||Pn):/\/\//i.test(d)||(d=Bi().buildAbsoluteURL(se().location&&se().location.href||"",d)),h){var m=new URL(f,d);return u?m.href.slice(Pn.length):s?m.href.slice(m.protocol.length):m.href}return Bi().buildAbsoluteURL(d,f)};var oi=function(){function b(){this.listeners={}}var d=b.prototype;return d.on=function(h,s){this.listeners[h]||(this.listeners[h]=[]),this.listeners[h].push(s)},d.off=function(h,s){if(!this.listeners[h])return!1;var u=this.listeners[h].indexOf(s);return this.listeners[h]=this.listeners[h].slice(0),this.listeners[h].splice(u,1),u>-1},d.trigger=function(h){var s=this.listeners[h];if(s)if(2===arguments.length)for(var u=s.length,m=0;m<u;++m)s[m].call(this,arguments[1]);else for(var T=Array.prototype.slice.call(arguments,1),S=s.length,D=0;D<S;++D)s[D].apply(this,T)},d.dispose=function(){this.listeners={}},d.pipe=function(h){this.on("data",function(s){h.push(s)})},b}();function Te(b){for(var d=function(d){return se().atob?se().atob(d):Buffer.from(d,"base64").toString("binary")}(b),f=new Uint8Array(d.length),h=0;h<d.length;h++)f[h]=d.charCodeAt(h);return f}var b,ou,it=function(b){function d(){var h;return(h=b.call(this)||this).buffer="",h}return ze(d,b),d.prototype.push=function(s){var u;for(this.buffer+=s,u=this.buffer.indexOf("\n");u>-1;u=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,u)),this.buffer=this.buffer.substring(u+1)},d}(oi),Ot=String.fromCharCode(9),Tt=function(d){var f=/([0-9.]*)?@?([0-9.]*)?/.exec(d||""),h={};return f[1]&&(h.length=parseInt(f[1],10)),f[2]&&(h.offset=parseInt(f[2],10)),h},Lt=function(d){for(var u,f=d.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),h={},s=f.length;s--;)""!==f[s]&&((u=/([^=]*)=(.*)/.exec(f[s]).slice(1))[0]=u[0].replace(/^\s+|\s+$/g,""),u[1]=u[1].replace(/^\s+|\s+$/g,""),u[1]=u[1].replace(/^['"](.*)['"]$/g,"$1"),h[u[0]]=u[1]);return h},jt=function(b){function d(){var h;return(h=b.call(this)||this).customParsers=[],h.tagMappers=[],h}ze(d,b);var f=d.prototype;return f.push=function(s){var m,T,u=this;if(0!==(s=s.trim()).length){if("#"!==s[0])return void this.trigger("data",{type:"uri",uri:s});this.tagMappers.reduce(function(D,P){var W=P(s);return W===s?D:D.concat([W])},[s]).forEach(function(D){for(var P=0;P<u.customParsers.length;P++)if(u.customParsers[P].call(u,D))return;if(0===D.indexOf("#EXT"))if(D=D.replace("\r",""),m=/^#EXTM3U/.exec(D))u.trigger("data",{type:"tag",tagType:"m3u"});else{if(m=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(D))return T={type:"tag",tagType:"inf"},m[1]&&(T.duration=parseFloat(m[1])),m[2]&&(T.title=m[2]),void u.trigger("data",T);if(m=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(D))return T={type:"tag",tagType:"targetduration"},m[1]&&(T.duration=parseInt(m[1],10)),void u.trigger("data",T);if(m=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(D))return T={type:"tag",tagType:"version"},m[1]&&(T.version=parseInt(m[1],10)),void u.trigger("data",T);if(m=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(D))return T={type:"tag",tagType:"media-sequence"},m[1]&&(T.number=parseInt(m[1],10)),void u.trigger("data",T);if(m=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(D))return T={type:"tag",tagType:"discontinuity-sequence"},m[1]&&(T.number=parseInt(m[1],10)),void u.trigger("data",T);if(m=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(D))return T={type:"tag",tagType:"playlist-type"},m[1]&&(T.playlistType=m[1]),void u.trigger("data",T);if(m=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(D))return T=Mt(Tt(m[1]),{type:"tag",tagType:"byterange"}),void u.trigger("data",T);if(m=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(D))return T={type:"tag",tagType:"allow-cache"},m[1]&&(T.allowed=!/NO/.test(m[1])),void u.trigger("data",T);if(m=/^#EXT-X-MAP:?(.*)$/.exec(D)){if(T={type:"tag",tagType:"map"},m[1]){var W=Lt(m[1]);W.URI&&(T.uri=W.URI),W.BYTERANGE&&(T.byterange=Tt(W.BYTERANGE))}u.trigger("data",T)}else if(m=/^#EXT-X-STREAM-INF:?(.*)$/.exec(D)){if(T={type:"tag",tagType:"stream-inf"},m[1]){if(T.attributes=Lt(m[1]),T.attributes.RESOLUTION){var H=T.attributes.RESOLUTION.split("x"),te={};H[0]&&(te.width=parseInt(H[0],10)),H[1]&&(te.height=parseInt(H[1],10)),T.attributes.RESOLUTION=te}T.attributes.BANDWIDTH&&(T.attributes.BANDWIDTH=parseInt(T.attributes.BANDWIDTH,10)),T.attributes["PROGRAM-ID"]&&(T.attributes["PROGRAM-ID"]=parseInt(T.attributes["PROGRAM-ID"],10))}u.trigger("data",T)}else{if(m=/^#EXT-X-MEDIA:?(.*)$/.exec(D))return T={type:"tag",tagType:"media"},m[1]&&(T.attributes=Lt(m[1])),void u.trigger("data",T);if(m=/^#EXT-X-ENDLIST/.exec(D))u.trigger("data",{type:"tag",tagType:"endlist"});else{if(!(m=/^#EXT-X-DISCONTINUITY/.exec(D)))return(m=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(D))?(T={type:"tag",tagType:"program-date-time"},m[1]&&(T.dateTimeString=m[1],T.dateTimeObject=new Date(m[1])),void u.trigger("data",T)):(m=/^#EXT-X-KEY:?(.*)$/.exec(D))?(T={type:"tag",tagType:"key"},m[1]&&(T.attributes=Lt(m[1]),T.attributes.IV&&("0x"===T.attributes.IV.substring(0,2).toLowerCase()&&(T.attributes.IV=T.attributes.IV.substring(2)),T.attributes.IV=T.attributes.IV.match(/.{8}/g),T.attributes.IV[0]=parseInt(T.attributes.IV[0],16),T.attributes.IV[1]=parseInt(T.attributes.IV[1],16),T.attributes.IV[2]=parseInt(T.attributes.IV[2],16),T.attributes.IV[3]=parseInt(T.attributes.IV[3],16),T.attributes.IV=new Uint32Array(T.attributes.IV))),void u.trigger("data",T)):(m=/^#EXT-X-START:?(.*)$/.exec(D))?(T={type:"tag",tagType:"start"},m[1]&&(T.attributes=Lt(m[1]),T.attributes["TIME-OFFSET"]=parseFloat(T.attributes["TIME-OFFSET"]),T.attributes.PRECISE=/YES/.test(T.attributes.PRECISE)),void u.trigger("data",T)):(m=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(D))?((T={type:"tag",tagType:"cue-out-cont"}).data=m[1]?m[1]:"",void u.trigger("data",T)):(m=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(D))?((T={type:"tag",tagType:"cue-out"}).data=m[1]?m[1]:"",void u.trigger("data",T)):(m=/^#EXT-X-CUE-IN:?(.*)?$/.exec(D))?((T={type:"tag",tagType:"cue-in"}).data=m[1]?m[1]:"",void u.trigger("data",T)):(m=/^#EXT-X-SKIP:(.*)$/.exec(D))&&m[1]?((T={type:"tag",tagType:"skip"}).attributes=Lt(m[1]),T.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(T.attributes["SKIPPED-SEGMENTS"]=parseInt(T.attributes["SKIPPED-SEGMENTS"],10)),T.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(T.attributes["RECENTLY-REMOVED-DATERANGES"]=T.attributes["RECENTLY-REMOVED-DATERANGES"].split(Ot)),void u.trigger("data",T)):(m=/^#EXT-X-PART:(.*)$/.exec(D))&&m[1]?((T={type:"tag",tagType:"part"}).attributes=Lt(m[1]),["DURATION"].forEach(function(le){T.attributes.hasOwnProperty(le)&&(T.attributes[le]=parseFloat(T.attributes[le]))}),["INDEPENDENT","GAP"].forEach(function(le){T.attributes.hasOwnProperty(le)&&(T.attributes[le]=/YES/.test(T.attributes[le]))}),T.attributes.hasOwnProperty("BYTERANGE")&&(T.attributes.byterange=Tt(T.attributes.BYTERANGE)),void u.trigger("data",T)):(m=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(D))&&m[1]?((T={type:"tag",tagType:"server-control"}).attributes=Lt(m[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(le){T.attributes.hasOwnProperty(le)&&(T.attributes[le]=parseFloat(T.attributes[le]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(le){T.attributes.hasOwnProperty(le)&&(T.attributes[le]=/YES/.test(T.attributes[le]))}),void u.trigger("data",T)):(m=/^#EXT-X-PART-INF:(.*)$/.exec(D))&&m[1]?((T={type:"tag",tagType:"part-inf"}).attributes=Lt(m[1]),["PART-TARGET"].forEach(function(le){T.attributes.hasOwnProperty(le)&&(T.attributes[le]=parseFloat(T.attributes[le]))}),void u.trigger("data",T)):(m=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(D))&&m[1]?((T={type:"tag",tagType:"preload-hint"}).attributes=Lt(m[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(le){if(T.attributes.hasOwnProperty(le)){T.attributes[le]=parseInt(T.attributes[le],10);var ce="BYTERANGE-LENGTH"===le?"length":"offset";T.attributes.byterange=T.attributes.byterange||{},T.attributes.byterange[ce]=T.attributes[le],delete T.attributes[le]}}),void u.trigger("data",T)):(m=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(D))&&m[1]?((T={type:"tag",tagType:"rendition-report"}).attributes=Lt(m[1]),["LAST-MSN","LAST-PART"].forEach(function(le){T.attributes.hasOwnProperty(le)&&(T.attributes[le]=parseInt(T.attributes[le],10))}),void u.trigger("data",T)):void u.trigger("data",{type:"tag",data:D.slice(4)});u.trigger("data",{type:"tag",tagType:"discontinuity"})}}}else u.trigger("data",{type:"comment",text:D.slice(1)})})}},f.addParser=function(s){var u=this,m=s.expression,T=s.customType,S=s.dataParser,D=s.segment;"function"!=typeof S&&(S=function(W){return W}),this.customParsers.push(function(P){if(m.exec(P))return u.trigger("data",{type:"custom",data:S(P),customType:T,segment:D}),!0})},f.addTagMapper=function(s){var u=s.expression,m=s.map;this.tagMappers.push(function(D){return u.test(D)?m(D):D})},d}(oi),Qt=function(d){var f={};return Object.keys(d).forEach(function(h){f[function(d){return d.toLowerCase().replace(/-(\w)/g,function(f){return f[1].toUpperCase()})}(h)]=d[h]}),f},Ht=function(d){var f=d.serverControl,h=d.targetDuration,s=d.partTargetDuration;if(f){var u="#EXT-X-SERVER-CONTROL",m="holdBack",T="partHoldBack",S=h&&3*h,D=s&&2*s;h&&!f.hasOwnProperty(m)&&(f[m]=S,this.trigger("info",{message:u+" defaulting HOLD-BACK to targetDuration * 3 ("+S+")."})),S&&f[m]<S&&(this.trigger("warn",{message:u+" clamping HOLD-BACK ("+f[m]+") to targetDuration * 3 ("+S+")"}),f[m]=S),s&&!f.hasOwnProperty(T)&&(f[T]=3*s,this.trigger("info",{message:u+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+f[T]+")."})),s&&f[T]<D&&(this.trigger("warn",{message:u+" clamping PART-HOLD-BACK ("+f[T]+") to partTargetDuration * 2 ("+D+")."}),f[T]=D)}},Jt=function(b){function d(){var h;(h=b.call(this)||this).lineStream=new it,h.parseStream=new jt,h.lineStream.pipe(h.parseStream);var T,S,s=gt(h),u=[],m={},D=!1,P=function(){},W={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},te=0;h.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var le=0,ce=0;return h.on("end",function(){m.uri||!m.parts&&!m.preloadHints||(!m.map&&T&&(m.map=T),!m.key&&S&&(m.key=S),!m.timeline&&"number"==typeof te&&(m.timeline=te),h.manifest.preloadSegment=m)}),h.parseStream.on("data",function(fe){var ue,At;({tag:function(){({version:function(){fe.version&&(this.manifest.version=fe.version)},"allow-cache":function(){this.manifest.allowCache=fe.allowed,"allowed"in fe||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var et={};"length"in fe&&(m.byterange=et,et.length=fe.length,"offset"in fe||(fe.offset=le)),"offset"in fe&&(m.byterange=et,et.offset=fe.offset),le=et.offset+et.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),fe.duration>0&&(m.duration=fe.duration),0===fe.duration&&(m.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=u},key:function(){if(fe.attributes)if("NONE"!==fe.attributes.METHOD)if(fe.attributes.URI){if("com.apple.streamingkeydelivery"===fe.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:fe.attributes});if("com.microsoft.playready"===fe.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.microsoft.playready"]={uri:fe.attributes.URI});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===fe.attributes.KEYFORMAT)return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(fe.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===fe.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==fe.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):fe.attributes.KEYID&&"0x"===fe.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:fe.attributes.KEYFORMAT,keyId:fe.attributes.KEYID.substring(2)},pssh:Te(fe.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));fe.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),S={method:fe.attributes.METHOD||"AES-128",uri:fe.attributes.URI},typeof fe.attributes.IV<"u"&&(S.iv=fe.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else S=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(fe.number)?this.manifest.mediaSequence=fe.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+fe.number})},"discontinuity-sequence":function(){isFinite(fe.number)?(this.manifest.discontinuitySequence=fe.number,te=fe.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+fe.number})},"playlist-type":function(){/VOD|EVENT/.test(fe.playlistType)?this.manifest.playlistType=fe.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+fe.playlist})},map:function(){T={},fe.uri&&(T.uri=fe.uri),fe.byterange&&(T.byterange=fe.byterange),S&&(T.key=S)},"stream-inf":function(){this.manifest.playlists=u,this.manifest.mediaGroups=this.manifest.mediaGroups||W,fe.attributes?(m.attributes||(m.attributes={}),Mt(m.attributes,fe.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||W,fe.attributes&&fe.attributes.TYPE&&fe.attributes["GROUP-ID"]&&fe.attributes.NAME){var et=this.manifest.mediaGroups[fe.attributes.TYPE];et[fe.attributes["GROUP-ID"]]=et[fe.attributes["GROUP-ID"]]||{},ue=et[fe.attributes["GROUP-ID"]],(At={default:/yes/i.test(fe.attributes.DEFAULT)}).autoselect=!!At.default||/yes/i.test(fe.attributes.AUTOSELECT),fe.attributes.LANGUAGE&&(At.language=fe.attributes.LANGUAGE),fe.attributes.URI&&(At.uri=fe.attributes.URI),fe.attributes["INSTREAM-ID"]&&(At.instreamId=fe.attributes["INSTREAM-ID"]),fe.attributes.CHARACTERISTICS&&(At.characteristics=fe.attributes.CHARACTERISTICS),fe.attributes.FORCED&&(At.forced=/yes/i.test(fe.attributes.FORCED)),ue[fe.attributes.NAME]=At}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){te+=1,m.discontinuity=!0,this.manifest.discontinuityStarts.push(u.length)},"program-date-time":function(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=fe.dateTimeString,this.manifest.dateTimeObject=fe.dateTimeObject),m.dateTimeString=fe.dateTimeString,m.dateTimeObject=fe.dateTimeObject},targetduration:function(){!isFinite(fe.duration)||fe.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+fe.duration}):(this.manifest.targetDuration=fe.duration,Ht.call(this,this.manifest))},start:function(){fe.attributes&&!isNaN(fe.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:fe.attributes["TIME-OFFSET"],precise:fe.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){m.cueOut=fe.data},"cue-out-cont":function(){m.cueOutCont=fe.data},"cue-in":function(){m.cueIn=fe.data},skip:function(){this.manifest.skip=Qt(fe.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",fe.attributes,["SKIPPED-SEGMENTS"])},part:function(){var et=this;D=!0;var Ft=this.manifest.segments.length,pt=Qt(fe.attributes);m.parts=m.parts||[],m.parts.push(pt),pt.byterange&&(pt.byterange.hasOwnProperty("offset")||(pt.byterange.offset=ce),ce=pt.byterange.offset+pt.byterange.length),this.warnOnMissingAttributes_("#EXT-X-PART #"+(m.parts.length-1)+" for segment #"+Ft,fe.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(function(St,st){St.hasOwnProperty("lastPart")||et.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+st+" lacks required attribute(s): LAST-PART"})})},"server-control":function(){var et=this.manifest.serverControl=Qt(fe.attributes);et.hasOwnProperty("canBlockReload")||(et.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Ht.call(this,this.manifest),et.canSkipDateranges&&!et.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var et=this.manifest.segments.length,Ft=Qt(fe.attributes),pt=Ft.type&&"PART"===Ft.type;m.preloadHints=m.preloadHints||[],m.preloadHints.push(Ft),Ft.byterange&&(Ft.byterange.hasOwnProperty("offset")||(Ft.byterange.offset=pt?ce:0,pt&&(ce=Ft.byterange.offset+Ft.byterange.length)));var lt=m.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+lt+" for segment #"+et,fe.attributes,["TYPE","URI"]),Ft.type)for(var St=0;St<m.preloadHints.length-1;St++){var st=m.preloadHints[St];!st.type||st.type===Ft.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+lt+" for segment #"+et+" has the same TYPE "+Ft.type+" as preload hint #"+St})}},"rendition-report":function(){var et=Qt(fe.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(et);var Ft=this.manifest.renditionReports.length-1,pt=["LAST-MSN","URI"];D&&pt.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+Ft,fe.attributes,pt)},"part-inf":function(){this.manifest.partInf=Qt(fe.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",fe.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Ht.call(this,this.manifest)}}[fe.tagType]||P).call(s)},uri:function(){m.uri=fe.uri,u.push(m),this.manifest.targetDuration&&!("duration"in m)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),m.duration=this.manifest.targetDuration),S&&(m.key=S),m.timeline=te,T&&(m.map=T),ce=0,m={}},comment:function(){},custom:function(){fe.segment?(m.custom=m.custom||{},m.custom[fe.customType]=fe.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[fe.customType]=fe.data)}})[fe.type].call(s)}),h}ze(d,b);var f=d.prototype;return f.warnOnMissingAttributes_=function(s,u,m){var T=[];m.forEach(function(S){u.hasOwnProperty(S)||T.push(S)}),T.length&&this.trigger("warn",{message:s+" lacks required attribute(s): "+T.join(", ")})},f.push=function(s){this.lineStream.push(s)},f.end=function(){this.lineStream.push("\n"),this.trigger("end")},f.addParser=function(s){this.parseStream.addParser(s)},f.addTagMapper=function(s){this.parseStream.addTagMapper(s)},d}(oi),Yt={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Ui=["video","audio","text"],Oi=["Video","Audio","Text"],Dn=function(d){return d&&d.replace(/avc1\.(\d+)\.(\d+)/i,function(f,h,s){return"avc1."+("00"+Number(h).toString(16)).slice(-2)+"00"+("00"+Number(s).toString(16)).slice(-2)})},hn=function(d){void 0===d&&(d="");var f=d.split(","),h=[];return f.forEach(function(s){var u;s=s.trim(),Ui.forEach(function(m){var T=Yt[m].exec(s.toLowerCase());if(T&&!(T.length<=1)){u=m;var S=s.substring(0,T[1].length),D=s.replace(S,"");h.push({type:S,details:D,mediaType:m})}}),u||h.push({type:s,details:"",mediaType:"unknown"})}),h},_o=function(d){return void 0===d&&(d=""),Yt.audio.test(d.trim().toLowerCase())},As=function(d){if(d&&"string"==typeof d){var f=d.toLowerCase().split(",").map(function(u){return Dn(u.trim())}),h="video";1===f.length&&_o(f[0])?h="audio":1===f.length&&function(d){return void 0===d&&(d=""),Yt.text.test(d.trim().toLowerCase())}(f[0])&&(h="application");var s="mp4";return f.every(function(u){return Yt.mp4.test(u)})?s="mp4":f.every(function(u){return Yt.webm.test(u)})?s="webm":f.every(function(u){return Yt.ogg.test(u)})&&(s="ogg"),h+"/"+s+';codecs="'+d+'"'}},Tc=function(d){return void 0===d&&(d=""),se().MediaSource&&se().MediaSource.isTypeSupported&&se().MediaSource.isTypeSupported(As(d))||!1},Ns=function(d){return void 0===d&&(d=""),d.toLowerCase().split(",").every(function(f){f=f.trim();for(var h=0;h<Oi.length;h++)if(Yt["muxer"+Oi[h]].test(f))return!0;return!1})},ul="mp4a.40.2",wc=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,ih=/^application\/dash\+xml/i,au=function(d){return wc.test(d)?"hls":ih.test(d)?"dash":"application/vnd.videojs.vhs+json"===d?"vhs-json":null},ya=function(d){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(d):d&&d.buffer instanceof ArrayBuffer},zn=function(d){return d instanceof Uint8Array?d:(!Array.isArray(d)&&!function(d){return ya(d)}(d)&&!(d instanceof ArrayBuffer)&&(d="number"!=typeof d||"number"==typeof d&&d!=d?0:[d]),new Uint8Array(d&&d.buffer||d,d&&d.byteOffset||0,d&&d.byteLength||0))},Ks=se().BigInt||Number,rh=[Ks("0x1"),Ks("0x100"),Ks("0x10000"),Ks("0x1000000"),Ks("0x100000000"),Ks("0x10000000000"),Ks("0x1000000000000"),Ks("0x100000000000000"),Ks("0x10000000000000000")],Kp=(b=new Uint16Array([65484]),new Uint8Array(b.buffer,b.byteOffset,b.byteLength),function(d,f){var h=void 0===f?{}:f,s=h.signed,u=void 0!==s&&s,m=h.le,T=void 0!==m&&m;d=zn(d);var S=T?"reduce":"reduceRight",P=(d[S]?d[S]:Array.prototype[S]).call(d,function(H,te,le){var ce=T?le:Math.abs(le+1-d.length);return H+Ks(te)*rh[ce]},Ks(0));if(u){var W=rh[d.length]/Ks(2)-Ks(1);(P=Ks(P))>W&&(P-=W,P-=W,P-=Ks(2))}return Number(P)}),Fu=function(d,f){if("string"!=typeof d&&d&&"function"==typeof d.toString&&(d=d.toString()),"string"!=typeof d)return new Uint8Array;f||(d=unescape(encodeURIComponent(d)));for(var h=new Uint8Array(d.length),s=0;s<d.length;s++)h[s]=d.charCodeAt(s);return h},Sr=function(d,f,h){var s=void 0===h?{}:h,u=s.offset,m=void 0===u?0:u,T=s.mask,S=void 0===T?[]:T;return d=zn(d),(f=zn(f)).length&&d.length-m>=f.length&&(f.every?f.every:Array.prototype.every).call(f,function(P,W){return P===(S[W]?S[W]&d[m+W]:d[m+W])})},oe=on(978),Re=function(d){return!!d&&"object"==typeof d},Je=function b(){for(var d=arguments.length,f=new Array(d),h=0;h<d;h++)f[h]=arguments[h];return f.reduce(function(s,u){return"object"!=typeof u||Object.keys(u).forEach(function(m){s[m]=Array.isArray(s[m])&&Array.isArray(u[m])?s[m].concat(u[m]):Re(s[m])&&Re(u[m])?b(s[m],u[m]):u[m]}),s},{})},an=function(d){return Object.keys(d).map(function(f){return d[f]})},rs=function(d){return d.reduce(function(f,h){return f.concat(h)},[])},ko=function(d){if(!d.length)return[];for(var f=[],h=0;h<d.length;h++)f.push(d[h]);return f},oa=function(d,f){for(var h=0;h<d.length;h++)if(f(d[h]))return h;return-1},vr=function(d){var f=d.baseUrl,s=d.source,u=void 0===s?"":s,m=d.range,T=void 0===m?"":m,S=d.indexRange,D=void 0===S?"":S,P={uri:u,resolvedUri:Yn((void 0===f?"":f)||"",u)};if(T||D){var ce,H=(T||D).split("-"),te=se().BigInt?se().BigInt(H[0]):parseInt(H[0],10),le=se().BigInt?se().BigInt(H[1]):parseInt(H[1],10);te<Number.MAX_SAFE_INTEGER&&"bigint"==typeof te&&(te=Number(te)),le<Number.MAX_SAFE_INTEGER&&"bigint"==typeof le&&(le=Number(le)),"bigint"==typeof(ce="bigint"==typeof le||"bigint"==typeof te?se().BigInt(le)-se().BigInt(te)+se().BigInt(1):le-te+1)&&ce<Number.MAX_SAFE_INTEGER&&(ce=Number(ce)),P.byterange={length:ce,offset:te}}return P},Qr=function(d){return d&&"number"!=typeof d&&(d=parseInt(d,10)),isNaN(d)?null:d},Sc={static:function(d){var f=d.duration,h=d.timescale,s=void 0===h?1:h,u=d.sourceDuration,m=d.periodDuration,T=Qr(d.endNumber),S=f/s;return"number"==typeof T?{start:0,end:T}:"number"==typeof m?{start:0,end:m/S}:{start:0,end:u/S}},dynamic:function(d){var f=d.NOW,h=d.clientOffset,s=d.availabilityStartTime,u=d.timescale,m=void 0===u?1:u,T=d.duration,S=d.periodStart,D=void 0===S?0:S,P=d.minimumUpdatePeriod,W=void 0===P?0:P,H=d.timeShiftBufferDepth,te=void 0===H?1/0:H,le=Qr(d.endNumber),ce=(f+h)/1e3,fe=s+D,sn=Math.ceil((ce+W-fe)*m/T),rt=Math.floor((ce-fe-te)*m/T),et=Math.floor((ce-fe)*m/T);return{start:Math.max(0,rt),end:"number"==typeof le?le:Math.min(sn,et)}}},_r=function(d){var f=d.type,h=d.duration,s=d.timescale,u=void 0===s?1:s,m=d.periodDuration,T=d.sourceDuration,S=Sc[f](d),W=function(d,f){for(var h=[],s=d;s<f;s++)h.push(s);return h}(S.start,S.end).map(function(d){return function(f){var h=d.duration,s=d.timescale,T=d.startNumber;return{number:(void 0===T?1:T)+f,duration:h/(void 0===s?1:s),timeline:d.periodStart,time:f*h}}}(d));if("static"===f){var H=W.length-1;W[H].duration=("number"==typeof m?m:T)-h/u*H}return W},sd=function(d){var f=d.baseUrl,h=d.initialization,s=void 0===h?{}:h,u=d.sourceDuration,m=d.indexRange,T=void 0===m?"":m,S=d.periodStart,D=d.presentationTime,P=d.number,W=void 0===P?0:P,H=d.duration;if(!f)throw new Error("NO_BASE_URL");var te=vr({baseUrl:f,source:s.sourceURL,range:s.range}),le=vr({baseUrl:f,source:f,indexRange:T});if(le.map=te,H){var ce=_r(d);ce.length&&(le.duration=ce[0].duration,le.timeline=ce[0].timeline)}else u&&(le.duration=u,le.timeline=S);return le.presentationTime=D||S,le.number=W,[le]},Fo=function(d,f,h){var fe,s=d.sidx.map?d.sidx.map:null,u=d.sidx.duration,m=d.timeline||0,T=d.sidx.byterange,S=T.offset+T.length,D=f.timescale,P=f.references.filter(function(St){return 1!==St.referenceType}),W=[],H=d.endList?"static":"dynamic",te=d.sidx.timeline,le=te,ce=d.mediaSequence||0;fe="bigint"==typeof f.firstOffset?se().BigInt(S)+f.firstOffset:S+f.firstOffset;for(var ue=0;ue<P.length;ue++){var et,At=f.references[ue],sn=At.referencedSize,rt=At.subsegmentDuration;et="bigint"==typeof fe?fe+se().BigInt(sn)-se().BigInt(1):fe+sn-1;var lt=sd({baseUrl:h,timescale:D,timeline:m,periodStart:te,presentationTime:le,number:ce,duration:rt,sourceDuration:u,indexRange:fe+"-"+et,type:H})[0];s&&(lt.map=s),W.push(lt),fe+="bigint"==typeof fe?se().BigInt(sn):sn,le+=rt/D,ce++}return d.segments=W,d},Bo=["AUDIO","SUBTITLES"],Fg=function(d){return function(d,f){return an(d.reduce(function(h,s){return s.forEach(function(u){h[function(f){return f.timeline}(u)]=u}),h},{}))}(d).sort(function(f,h){return f.timeline>h.timeline?1:-1})},O_=function(d){var f=[];return function(d,f,h){f.forEach(function(s){for(var u in d.mediaGroups[s])for(var m in d.mediaGroups[s][u])h(d.mediaGroups[s][u][m])})}(d,Bo,function(h,s,u,m){f=f.concat(h.playlists||[])}),f},L_=function(d){var f=d.playlist;f.mediaSequence=d.mediaSequence,f.segments.forEach(function(s,u){s.number=f.mediaSequence+u})},ah=function(d){return d&&d.uri+"-"+function(d){var f;return f="bigint"==typeof d.offset||"bigint"==typeof d.length?se().BigInt(d.offset)+se().BigInt(d.length)-se().BigInt(1):d.offset+d.length-1,d.offset+"-"+f}(d.byterange)},Zp=function(d){return an(d.reduce(function(h,s){var m,u=s.attributes.id+(s.attributes.lang||"");h[u]?(s.segments&&(s.segments[0]&&(s.segments[0].discontinuity=!0),(m=h[u].segments).push.apply(m,s.segments)),s.attributes.contentProtection&&(h[u].attributes.contentProtection=s.attributes.contentProtection)):(h[u]=s,h[u].attributes.timelineStarts=[]);return h[u].attributes.timelineStarts.push({start:s.attributes.periodStart,timeline:s.attributes.periodStart}),h},{})).map(function(h){return h.discontinuityStarts=function(d,f){return d.reduce(function(h,s,u){return s.discontinuity&&h.push(u),h},[])}(h.segments||[]),h})},Jp=function(d,f){var h=ah(d.sidx),s=h&&f[h]&&f[h].sidx;return s&&Fo(d,s,d.sidx.resolvedUri),d},Gs=function(d,f){if(void 0===f&&(f={}),!Object.keys(f).length)return d;for(var h in d)d[h]=Jp(d[h],f);return d},Vr=function(d){var f,h=d.attributes,s=d.segments,u=d.sidx,m=d.discontinuityStarts,T={attributes:(f={NAME:h.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:h.width,height:h.height},CODECS:h.codecs,BANDWIDTH:h.bandwidth},f["PROGRAM-ID"]=1,f),uri:"",endList:"static"===h.type,timeline:h.periodStart,resolvedUri:"",targetDuration:h.duration,discontinuityStarts:m,timelineStarts:h.timelineStarts,segments:s};return h.contentProtection&&(T.contentProtection=h.contentProtection),u&&(T.sidx=u),T},tm=function(d){var f=d.attributes;return"video/mp4"===f.mimeType||"video/webm"===f.mimeType||"video"===f.contentType},Ny=function(d){var f=d.attributes;return"audio/mp4"===f.mimeType||"audio/webm"===f.mimeType||"audio"===f.contentType},yr=function(d){var f=d.attributes;return"text/vtt"===f.mimeType||"text"===f.contentType},nm=function(d){return d?Object.keys(d).reduce(function(f,h){return f.concat(d[h].playlists)},[]):[]},X1=function(d){var f,h=d.dashPlaylists,s=d.locations,u=d.sidxMapping,m=void 0===u?{}:u,T=d.previousManifest;if(!h.length)return{};var S=h[0].attributes,D=S.sourceDuration,P=S.type,W=S.suggestedPresentationDelay,H=S.minimumUpdatePeriod,te=Zp(h.filter(tm)).map(Vr),le=Zp(h.filter(Ny)),ce=Zp(h.filter(yr)),fe=h.map(function(pt){return pt.attributes.captionServices}).filter(Boolean),ue={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(f={AUDIO:{},VIDEO:{}},f["CLOSED-CAPTIONS"]={},f.SUBTITLES={},f),uri:"",duration:D,playlists:Gs(te,m)};H>=0&&(ue.minimumUpdatePeriod=1e3*H),s&&(ue.locations=s),"dynamic"===P&&(ue.suggestedPresentationDelay=W);var sn=le.length?function(d,f,h){void 0===f&&(f={}),void 0===h&&(h=!1);var s,u=d.reduce(function(T,S){var D=S.attributes.role&&S.attributes.role.value||"",P=S.attributes.lang||"",W=S.attributes.label||"main";P&&!S.attributes.label&&(W=S.attributes.lang+(D?" ("+D+")":"")),T[W]||(T[W]={language:P,autoselect:!0,default:"main"===D,playlists:[],uri:""});var te=Jp(function(d,f){var h,s=d.attributes,u=d.segments,m=d.sidx,T=d.mediaSequence,S=d.discontinuitySequence,D=d.discontinuityStarts,P={attributes:(h={NAME:s.id,BANDWIDTH:s.bandwidth,CODECS:s.codecs},h["PROGRAM-ID"]=1,h),uri:"",endList:"static"===s.type,timeline:s.periodStart,resolvedUri:"",targetDuration:s.duration,discontinuitySequence:S,discontinuityStarts:D,timelineStarts:s.timelineStarts,mediaSequence:T,segments:u};return s.contentProtection&&(P.contentProtection=s.contentProtection),m&&(P.sidx=m),f&&(P.attributes.AUDIO="audio",P.attributes.SUBTITLES="subs"),P}(S,h),f);return T[W].playlists.push(te),typeof s>"u"&&"main"===D&&((s=S).default=!0),T},{});return s||(u[Object.keys(u)[0]].default=!0),u}(le,m,0===ue.playlists.length):null,rt=ce.length?function(d,f){return void 0===f&&(f={}),d.reduce(function(h,s){var u=s.attributes.lang||"text";return h[u]||(h[u]={language:u,default:!1,autoselect:!1,playlists:[],uri:""}),h[u].playlists.push(Jp(function(d){var f,h=d.attributes,s=d.segments,u=d.mediaSequence,m=d.discontinuityStarts,T=d.discontinuitySequence;typeof s>"u"&&(s=[{uri:h.baseUrl,timeline:h.periodStart,resolvedUri:h.baseUrl||"",duration:h.sourceDuration,number:0}],h.duration=h.sourceDuration);var S=((f={NAME:h.id,BANDWIDTH:h.bandwidth})["PROGRAM-ID"]=1,f);return h.codecs&&(S.CODECS=h.codecs),{attributes:S,uri:"",endList:"static"===h.type,timeline:h.periodStart,resolvedUri:h.baseUrl||"",targetDuration:h.duration,timelineStarts:h.timelineStarts,discontinuityStarts:m,discontinuitySequence:T,mediaSequence:u,segments:s}}(s),f)),h},{})}(ce,m):null,et=te.concat(nm(sn),nm(rt)),Ft=et.map(function(pt){return pt.timelineStarts});return ue.timelineStarts=Fg(Ft),function(d,f){d.forEach(function(h){h.mediaSequence=0,h.discontinuitySequence=oa(f,function(s){return s.timeline===h.timeline}),h.segments&&h.segments.forEach(function(s,u){s.number=u})})}(et,ue.timelineStarts),sn&&(ue.mediaGroups.AUDIO.audio=sn),rt&&(ue.mediaGroups.SUBTITLES.subs=rt),fe.length&&(ue.mediaGroups["CLOSED-CAPTIONS"].cc=function(d){return d.reduce(function(f,h){return h&&h.forEach(function(s){var m=s.language;f[m]={autoselect:!1,default:!1,instreamId:s.channel,language:m},s.hasOwnProperty("aspectRatio")&&(f[m].aspectRatio=s.aspectRatio),s.hasOwnProperty("easyReader")&&(f[m].easyReader=s.easyReader),s.hasOwnProperty("3D")&&(f[m]["3D"]=s["3D"])}),f},{})}(fe)),T?function(d){var f=d.oldManifest,h=d.newManifest,s=f.playlists.concat(O_(f)),u=h.playlists.concat(O_(h));return h.timelineStarts=Fg([f.timelineStarts,h.timelineStarts]),function(d){var f=d.oldPlaylists,s=d.timelineStarts;d.newPlaylists.forEach(function(u){u.discontinuitySequence=oa(s,function(P){return P.timeline===u.timeline});var m=function(d,f){for(var h=0;h<d.length;h++)if(d[h].attributes.NAME===f)return d[h];return null}(f,u.attributes.NAME);if(m&&!u.sidx){var T=u.segments[0],S=oa(m.segments,function(P){return Math.abs(P.presentationTime-T.presentationTime)<.016666666666666666});if(-1===S)return L_({playlist:u,mediaSequence:m.mediaSequence+m.segments.length}),u.segments[0].discontinuity=!0,u.discontinuityStarts.unshift(0),void((!m.segments.length&&u.timeline>m.timeline||m.segments.length&&u.timeline>m.segments[m.segments.length-1].timeline)&&u.discontinuitySequence--);m.segments[S].discontinuity&&!T.discontinuity&&(T.discontinuity=!0,u.discontinuityStarts.unshift(0),u.discontinuitySequence--),L_({playlist:u,mediaSequence:m.segments[S].number})}})}({oldPlaylists:s,newPlaylists:u,timelineStarts:h.timelineStarts}),h}({oldManifest:T,newManifest:ue}):ue},wt=function(d,f,h){var T=d.timescale,D=d.periodStart,W=d.minimumUpdatePeriod;return Math.ceil((((d.NOW+d.clientOffset)/1e3+(void 0===W?0:W)-(d.availabilityStartTime+(void 0===D?0:D)))*(void 0===T?1:T)-f)/h)},Rf=function(d,f){for(var h=d.type,s=d.minimumUpdatePeriod,u=void 0===s?0:s,m=d.media,T=void 0===m?"":m,S=d.sourceDuration,D=d.timescale,P=void 0===D?1:D,W=d.startNumber,H=void 0===W?1:W,te=d.periodStart,le=[],ce=-1,fe=0;fe<f.length;fe++){var ue=f[fe],At=ue.d,sn=ue.r||0,rt=ue.t||0;ce<0&&(ce=rt),rt&&rt>ce&&(ce=rt);var et=void 0;if(sn<0){var Ft=fe+1;et=Ft===f.length?"dynamic"===h&&u>0&&T.indexOf("$Number$")>0?wt(d,ce,At):(S*P-ce)/At:(f[Ft].t-ce)/At}else et=sn+1;for(var pt=H+le.length+et,lt=H+le.length;lt<pt;)le.push({number:lt,duration:At/P,time:ce,timeline:te}),ce+=At,lt++}return le},Mi=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,F_=function(d,f){return d.replace(Mi,function(d){return function(f,h,s,u){if("$$"===f)return"$";if(typeof d[h]>"u")return f;var m=""+d[h];return"RepresentationID"===h||(u=s?parseInt(u,10):1,m.length>=u)?m:""+new Array(u-m.length+1).join("0")+m}}(f))},Py=function(d,f){var h={RepresentationID:d.id,Bandwidth:d.bandwidth||0},s=d.initialization,u=void 0===s?{sourceURL:"",range:""}:s,m=vr({baseUrl:d.baseUrl,source:F_(u.sourceURL,h),range:u.range}),T=function(d,f){return d.duration||f?d.duration?_r(d):Rf(d,f):[{number:d.startNumber||1,duration:d.sourceDuration,time:0,timeline:d.periodStart}]}(d,f);return T.map(function(S){h.Number=S.number,h.Time=S.time;var D=F_(d.media||"",h),H=d.periodStart+(S.time-(d.presentationTimeOffset||0))/(d.timescale||1);return{uri:D,timeline:S.timeline,duration:S.duration,resolvedUri:Yn(d.baseUrl||"",D),map:m,number:S.number,presentationTime:H}})},Uo=function(d,f){var h=d.duration,s=d.segmentUrls,u=void 0===s?[]:s,m=d.periodStart;if(!h&&!f||h&&f)throw new Error("SEGMENT_TIME_UNSPECIFIED");var S,T=u.map(function(P){return function(d,f){var h=d.baseUrl,s=d.initialization,u=void 0===s?{}:s,m=vr({baseUrl:h,source:u.sourceURL,range:u.range}),T=vr({baseUrl:h,source:f.media,range:f.mediaRange});return T.map=m,T}(d,P)});return h&&(S=_r(d)),f&&(S=Rf(d,f)),S.map(function(P,W){if(T[W]){var H=T[W],te=d.timescale||1,le=d.presentationTimeOffset||0;return H.timeline=P.timeline,H.duration=P.duration,H.number=P.number,H.presentationTime=m+(P.time-le)/te,H}}).filter(function(P){return P})},Q1=function(d){var s,u,f=d.attributes,h=d.segmentInfo;h.template?(u=Py,s=Je(f,h.template)):h.base?(u=sd,s=Je(f,h.base)):h.list&&(u=Uo,s=Je(f,h.list));var m={attributes:f};if(!u)return m;var T=u(s,h.segmentTimeline);if(s.duration){var P=s.timescale;s.duration=s.duration/(void 0===P?1:P)}else s.duration=T.length?T.reduce(function(H,te){return Math.max(H,Math.ceil(te.duration))},0):0;return m.attributes=s,m.segments=T,h.base&&s.indexRange&&(m.sidx=T[0],m.segments=[]),m},Zs=function(d,f){return ko(d.childNodes).filter(function(h){return h.tagName===f})},Ml=function(d){return d.textContent.trim()},Nf=function(d){var S=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(d);if(!S)return 0;var D=S.slice(1),W=D[1],H=D[2],te=D[3],le=D[4],ce=D[5];return 31536e3*parseFloat(D[0]||0)+2592e3*parseFloat(W||0)+86400*parseFloat(H||0)+3600*parseFloat(te||0)+60*parseFloat(le||0)+parseFloat(ce||0)},Ly={mediaPresentationDuration:function(d){return Nf(d)},availabilityStartTime:function(d){return function(d){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(d)&&(d+="Z"),Date.parse(d)}(d)/1e3},minimumUpdatePeriod:function(d){return Nf(d)},suggestedPresentationDelay:function(d){return Nf(d)},type:function(d){return d},timeShiftBufferDepth:function(d){return Nf(d)},start:function(d){return Nf(d)},width:function(d){return parseInt(d,10)},height:function(d){return parseInt(d,10)},bandwidth:function(d){return parseInt(d,10)},startNumber:function(d){return parseInt(d,10)},timescale:function(d){return parseInt(d,10)},presentationTimeOffset:function(d){return parseInt(d,10)},duration:function(d){var f=parseInt(d,10);return isNaN(f)?Nf(d):f},d:function(d){return parseInt(d,10)},t:function(d){return parseInt(d,10)},r:function(d){return parseInt(d,10)},DEFAULT:function(d){return d}},to=function(d){return d&&d.attributes?ko(d.attributes).reduce(function(f,h){return f[h.name]=(Ly[h.name]||Ly.DEFAULT)(h.value),f},{}):{}},ky={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Vg=function(d,f){return f.length?rs(d.map(function(h){return f.map(function(s){return Yn(h,Ml(s))})})):d},Hg=function(d){var f=Zs(d,"SegmentTemplate")[0],h=Zs(d,"SegmentList")[0],s=h&&Zs(h,"SegmentURL").map(function(H){return Je({tag:"SegmentURL"},to(H))}),u=Zs(d,"SegmentBase")[0],m=h||f,T=m&&Zs(m,"SegmentTimeline")[0],S=h||u||f,D=S&&Zs(S,"Initialization")[0],P=f&&to(f);P&&D?P.initialization=D&&to(D):P&&P.initialization&&(P.initialization={sourceURL:P.initialization});var W={template:P,segmentTimeline:T&&Zs(T,"S").map(function(H){return to(H)}),list:h&&Je(to(h),{segmentUrls:s,initialization:to(D)}),base:u&&Je(to(u),{initialization:to(D)})};return Object.keys(W).forEach(function(H){W[H]||delete W[H]}),W},eT=function(d,f){return function(h,s){var u=Vg(f,Zs(h.node,"BaseURL")),m=Je(d,{periodStart:h.attributes.start});"number"==typeof h.attributes.duration&&(m.periodDuration=h.attributes.duration);var T=Zs(h.node,"AdaptationSet"),S=Hg(h.node);return rs(T.map(function(d,f,h){return function(s){var u=to(s),m=Vg(f,Zs(s,"BaseURL")),T=Zs(s,"Role")[0],S={role:to(T)},D=Je(d,u,S),P=Zs(s,"Accessibility")[0],W=function(d){return"urn:scte:dash:cc:cea-608:2015"===d.schemeIdUri?("string"!=typeof d.value?[]:d.value.split(";")).map(function(s){var u,m;if(m=s,/^CC\d=/.test(s)){var T=s.split("=");u=T[0],m=T[1]}else/^CC\d$/.test(s)&&(u=s);return{channel:u,language:m}}):"urn:scte:dash:cc:cea-708:2015"===d.schemeIdUri?("string"!=typeof d.value?[]:d.value.split(";")).map(function(s){var u={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(s)){var m=s.split("="),S=m[1],D=void 0===S?"":S;u.channel=m[0],u.language=s,D.split(",").forEach(function(P){var W=P.split(":"),H=W[0],te=W[1];"lang"===H?u.language=te:"er"===H?u.easyReader=Number(te):"war"===H?u.aspectRatio=Number(te):"3D"===H&&(u["3D"]=Number(te))})}else u.language=s;return u.channel&&(u.channel="SERVICE"+u.channel),u}):void 0}(to(P));W&&(D=Je(D,{captionServices:W}));var H=Zs(s,"Label")[0];if(H&&H.childNodes.length){var te=H.childNodes[0].nodeValue.trim();D=Je(D,{label:te})}var le=function(d){return d.reduce(function(f,h){var s=to(h);s.schemeIdUri&&(s.schemeIdUri=s.schemeIdUri.toLowerCase());var u=ky[s.schemeIdUri];if(u){f[u]={attributes:s};var m=Zs(h,"cenc:pssh")[0];if(m){var T=Ml(m);f[u].pssh=T&&Te(T)}}return f},{})}(Zs(s,"ContentProtection"));Object.keys(le).length&&(D=Je(D,{contentProtection:le}));var ce=Hg(s),fe=Zs(s,"Representation"),ue=Je(h,ce);return rs(fe.map(function(d,f,h){return function(s){var u=Zs(s,"BaseURL"),m=Vg(f,u),T=Je(d,to(s)),S=Hg(s);return m.map(function(D){return{segmentInfo:Je(h,S),attributes:Je(T,{baseUrl:D})}})}}(D,m,ue)))}}(m,u,S)))}},rm=function(d){if(""===d)throw new Error("DASH_EMPTY_MANIFEST");var h,s,f=new oe.DOMParser;try{s=(h=f.parseFromString(d,"application/xml"))&&"MPD"===h.documentElement.tagName?h.documentElement:null}catch{}if(!s||s&&s.getElementsByTagName("parsererror").length>0)throw new Error("DASH_INVALID_XML");return s},sm=on(459),Gg=on.n(sm),jg=zn([73,68,51]),Il=function b(d,f){return void 0===f&&(f=0),(d=zn(d)).length-f<10||!Sr(d,jg,{offset:f})?f:(f+=function(d,f){void 0===f&&(f=0);var s=(d=zn(d))[f+6]<<21|d[f+7]<<14|d[f+8]<<7|d[f+9];return(16&d[f+5])>>4?s+20:s+10}(d,f),b(d,f))},om=(new Uint8Array([79,112,117,115,72,101,97,100]),function(d){return"string"==typeof d?Fu(d):d}),Ta=function(d){d=zn(d);for(var f=[],h=0;d.length>h;){var s=d[h],u=0,m=0,T=d[++m];for(m++;128&T;)u=(127&T)<<7,T=d[m],m++;u+=127&T;for(var S=0;S<ou.length;S++){var D=ou[S];if(s===D.id){f.push((0,D.parser)(d.subarray(m,m+u)));break}}h+=u+m}return f};ou=[{id:3,parser:function(d){var f={tag:3,id:d[0]<<8|d[1],flags:d[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(128&f.flags&&(f.dependsOnEsId=d[f.size]<<8|d[f.size+1],f.size+=2),64&f.flags){var h=d[f.size];f.url=function(d){if(!d)return"";d=Array.prototype.slice.call(d);var f=String.fromCharCode.apply(null,zn(d));try{return decodeURIComponent(escape(f))}catch{}return f}(d.subarray(f.size+1,f.size+1+h)),f.size+=h}return 32&f.flags&&(f.ocrEsId=d[f.size]<<8|d[f.size+1],f.size+=2),f.descriptors=Ta(d.subarray(f.size))||[],f}},{id:4,parser:function(d){return{tag:4,oti:d[0],streamType:d[1],bufferSize:d[2]<<16|d[3]<<8|d[4],maxBitrate:d[5]<<24|d[6]<<16|d[7]<<8|d[8],avgBitrate:d[9]<<24|d[10]<<16|d[11]<<8|d[12],descriptors:Ta(d.subarray(13))}}},{id:5,parser:function(d){return{tag:5,bytes:d}}},{id:6,parser:function(d){return{tag:6,bytes:d}}}];var Ho=function b(d,f,h){void 0===h&&(h=!1),f=function(d){return Array.isArray(d)?d.map(function(f){return om(f)}):[om(d)]}(f),d=zn(d);var s=[];if(!f.length)return s;for(var u=0;u<d.length;){var m=(d[u]<<24|d[u+1]<<16|d[u+2]<<8|d[u+3])>>>0,T=d.subarray(u+4,u+8);if(0===m)break;var S=u+m;if(S>d.length){if(h)break;S=d.length}var D=d.subarray(u+8,S);Sr(T,f[0])&&(1===f.length?s.push(D):s.push.apply(s,b(D,f.slice(1),h))),u=S}return s},xn={EBML:zn([26,69,223,163]),DocType:zn([66,130]),Segment:zn([24,83,128,103]),SegmentInfo:zn([21,73,169,102]),Tracks:zn([22,84,174,107]),Track:zn([174]),TrackNumber:zn([215]),DefaultDuration:zn([35,227,131]),TrackEntry:zn([174]),TrackType:zn([131]),FlagDefault:zn([136]),CodecID:zn([134]),CodecPrivate:zn([99,162]),VideoTrack:zn([224]),AudioTrack:zn([225]),Cluster:zn([31,67,182,117]),Timestamp:zn([231]),TimestampScale:zn([42,215,177]),BlockGroup:zn([160]),BlockDuration:zn([155]),Block:zn([161]),SimpleBlock:zn([163])},Bu=[128,64,32,16,8,4,2,1],qe=function(d,f,h,s){void 0===h&&(h=!0),void 0===s&&(s=!1);var u=function(d){for(var f=1,h=0;h<Bu.length&&!(d&Bu[h]);h++)f++;return f}(d[f]),m=d.subarray(f,f+u);return h&&((m=Array.prototype.slice.call(d,f,f+u))[0]^=Bu[u-1]),{length:u,value:Kp(m,{signed:s}),bytes:m}},la=function b(d){return"string"==typeof d?d.match(/.{1,2}/g).map(function(f){return b(f)}):"number"==typeof d?function(d,f){var s=(void 0===f?{}:f).le,u=void 0!==s&&s;("bigint"!=typeof d&&"number"!=typeof d||"number"==typeof d&&d!=d)&&(d=0);for(var m=function(d){return Math.ceil(function(d){return d.toString(2).length}(d)/8)}(d=Ks(d)),T=new Uint8Array(new ArrayBuffer(m)),S=0;S<m;S++){var D=u?S:Math.abs(S+1-T.length);T[D]=Number(d/rh[S]&Ks(255)),d<0&&(T[D]=Math.abs(~T[D]),T[D]-=0===S?1:2)}return T}(d):d},lu=function b(d,f,h){if(h>=f.length)return f.length;var s=qe(f,h,!1);if(Sr(d.bytes,s.bytes))return h;var u=qe(f,h+s.length);return b(d,f,h+u.length+u.value+s.length)},xs=function b(d,f){f=function(d){return Array.isArray(d)?d.map(function(f){return la(f)}):[la(d)]}(f),d=zn(d);var h=[];if(!f.length)return h;for(var s=0;s<d.length;){var u=qe(d,s,!1),m=qe(d,s+u.length),T=s+u.length+m.length;127===m.value&&(m.value=lu(u,d,T),m.value!==d.length&&(m.value-=T));var D=d.subarray(T,T+m.value>d.length?d.length:T+m.value);Sr(f[0],u.bytes)&&(1===f.length?h.push(D):h=h.concat(b(D,f.slice(1)))),s+=u.length+m.length+D.length}return h},ci=zn([0,0,0,1]),xe=zn([0,0,1]),um=zn([0,0,3]),Tn=function(d){for(var f=[],h=1;h<d.length-2;)Sr(d.subarray(h,h+3),um)&&(f.push(h+2),h++),h++;if(0===f.length)return d;var s=d.length-f.length,u=new Uint8Array(s),m=0;for(h=0;h<s;m++,h++)m===f[0]&&(m++,f.shift()),u[h]=d[m];return u},js=function(d,f,h,s){void 0===s&&(s=1/0),d=zn(d),h=[].concat(h);for(var m,u=0,T=0;u<d.length&&(T<s||m);){var S=void 0;if(Sr(d.subarray(u),ci)?S=4:Sr(d.subarray(u),xe)&&(S=3),S){if(T++,m)return Tn(d.subarray(m,u));var D=void 0;"h264"===f?D=31&d[u+S]:"h265"===f&&(D=d[u+S]>>1&63),-1!==h.indexOf(D)&&(m=u+S),u+=S+("h264"===f?1:2)}else u++}return d.subarray(0,0)},lr={webm:zn([119,101,98,109]),matroska:zn([109,97,116,114,111,115,107,97]),flac:zn([102,76,97,67]),ogg:zn([79,103,103,83]),ac3:zn([11,119]),riff:zn([82,73,70,70]),avi:zn([65,86,73]),wav:zn([87,65,86,69]),"3gp":zn([102,116,121,112,51,103]),mp4:zn([102,116,121,112]),fmp4:zn([115,116,121,112]),mov:zn([102,116,121,112,113,116]),moov:zn([109,111,111,118]),moof:zn([109,111,111,102])},jo={aac:function(d){var f=Il(d);return Sr(d,[255,16],{offset:f,mask:[255,22]})},mp3:function(d){var f=Il(d);return Sr(d,[255,2],{offset:f,mask:[255,6]})},webm:function(d){var f=xs(d,[xn.EBML,xn.DocType])[0];return Sr(f,lr.webm)},mkv:function(d){var f=xs(d,[xn.EBML,xn.DocType])[0];return Sr(f,lr.matroska)},mp4:function(d){return!jo["3gp"](d)&&!jo.mov(d)&&(!!(Sr(d,lr.mp4,{offset:4})||Sr(d,lr.fmp4,{offset:4})||Sr(d,lr.moof,{offset:4})||Sr(d,lr.moov,{offset:4}))||void 0)},mov:function(d){return Sr(d,lr.mov,{offset:4})},"3gp":function(d){return Sr(d,lr["3gp"],{offset:4})},ac3:function(d){var f=Il(d);return Sr(d,lr.ac3,{offset:f})},ts:function(d){if(d.length<189&&d.length>=1)return 71===d[0];for(var f=0;f+188<d.length&&f<188;){if(71===d[f]&&71===d[f+188])return!0;f+=1}return!1},flac:function(d){var f=Il(d);return Sr(d,lr.flac,{offset:f})},ogg:function(d){return Sr(d,lr.ogg)},avi:function(d){return Sr(d,lr.riff)&&Sr(d,lr.avi,{offset:8})},wav:function(d){return Sr(d,lr.riff)&&Sr(d,lr.wav,{offset:8})},h264:function(d){return function(d,f,h){return js(d,"h264",7,3)}(d).length},h265:function(d){return function(d,f,h){return js(d,"h265",[32,33],3)}(d).length}},Js=Object.keys(jo).filter(function(b){return"ts"!==b&&"h264"!==b&&"h265"!==b}).concat(["ts","h264","h265"]);Js.forEach(function(b){var d=jo[b];jo[b]=function(f){return d(zn(f))}});for(var zo,Na=jo,dn=function(d){d=zn(d);for(var f=0;f<Js.length;f++){var h=Js[f];if(Na[h](d))return h}return""},sr=on(277),ua={},Gr=function(d,f){return ua[d]=ua[d]||[],f&&(ua[d]=ua[d].concat(f)),ua[d]},jr=function(d,f){var h=Gr(d).indexOf(f);return!(h<=-1||(ua[d]=ua[d].slice(),ua[d].splice(h,1),0))},io={prefixed:!0},di=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],ld=di[0],Wo=0;Wo<di.length;Wo++)if(di[Wo][1]in Oe()){zo=di[Wo];break}if(zo){for(var cl=0;cl<zo.length;cl++)io[ld[cl]]=zo[cl];io.prefixed=zo[0]!==ld[0]}var dr=[],Kt=function Nl(b){var f,d="info",h=function(){for(var u=arguments.length,m=new Array(u),T=0;T<u;T++)m[T]=arguments[T];f("log",d,m)};return f=function(d,f){return function(h,s,u){var m=f.levels[s],T=new RegExp("^("+m+")$");if("log"!==h&&u.unshift(h.toUpperCase()+":"),u.unshift(d+":"),dr){dr.push([].concat(u));var S=dr.length-1e3;dr.splice(0,S>0?S:0)}if(se().console){var D=se().console[h];!D&&"debug"===h&&(D=se().console.info||se().console.log),D&&m&&T.test(h)&&D[Array.isArray(u)?"apply":"call"](se().console,u)}}}(b,h),h.createLogger=function(s){return Nl(b+": "+s)},h.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:d},h.level=function(s){if("string"==typeof s){if(!h.levels.hasOwnProperty(s))throw new Error('"'+s+'" in not a valid log level');d=s}return d},(h.history=function(){return dr?[].concat(dr):[]}).filter=function(s){return(dr||[]).filter(function(u){return new RegExp(".*"+s+".*").test(u[0])})},h.history.clear=function(){dr&&(dr.length=0)},h.history.disable=function(){null!==dr&&(dr.length=0,dr=null)},h.history.enable=function(){null===dr&&(dr=[])},h.error=function(){for(var s=arguments.length,u=new Array(s),m=0;m<s;m++)u[m]=arguments[m];return f("error",d,u)},h.warn=function(){for(var s=arguments.length,u=new Array(s),m=0;m<s;m++)u[m]=arguments[m];return f("warn",d,u)},h.debug=function(){for(var s=arguments.length,u=new Array(s),m=0;m<s;m++)u[m]=arguments[m];return f("debug",d,u)},h}("VIDEOJS"),dl=Kt.createLogger,hl=Object.prototype.toString,Kr=function(d){return Es(d)?Object.keys(d):[]};function lh(b,d){Kr(b).forEach(function(f){return d(b[f],f)})}function zr(b){for(var d=arguments.length,f=new Array(d>1?d-1:0),h=1;h<d;h++)f[h-1]=arguments[h];return Object.assign?Mt.apply(void 0,[b].concat(f)):(f.forEach(function(s){!s||lh(s,function(u,m){b[m]=u})}),b)}function Es(b){return!!b&&"object"==typeof b}function cu(b){return Es(b)&&"[object Object]"===hl.call(b)&&b.constructor===Object}function Uu(b,d){if(!b||!d)return"";if("function"==typeof se().getComputedStyle){var f;try{f=se().getComputedStyle(b)}catch{return""}return f?f.getPropertyValue(d)||f[d]:""}return""}var ds=se().navigator&&se().navigator.userAgent||"",wa=/AppleWebKit\/([\d.]+)/i.exec(ds),Fy=wa?parseFloat(wa.pop()):null,Ga=/iPod/i.test(ds),ja=function(){var b=ds.match(/OS (\d+)_/i);return b&&b[1]?b[1]:null}(),ca=/Android/i.test(ds),Vu=function(){var b=ds.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!b)return null;var d=b[1]&&parseFloat(b[1]),f=b[2]&&parseFloat(b[2]);return d&&f?parseFloat(b[1]+"."+b[2]):d||null}(),Hu=ca&&Vu<5&&Fy<537,fl=/Firefox/i.test(ds),kf=/Edg/i.test(ds),Gu=!kf&&(/Chrome/i.test(ds)||/CriOS/i.test(ds)),Wg=function(){var b=ds.match(/(Chrome|CriOS)\/(\d+)/);return b&&b[2]?parseFloat(b[2]):null}(),uh=function(){var b=/MSIE\s(\d+)\.\d/.exec(ds),d=b&&parseFloat(b[1]);return!d&&/Trident\/7.0/i.test(ds)&&/rv:11.0/.test(ds)&&(d=11),d}(),V_=/Safari/i.test(ds)&&!Gu&&!ca&&!kf,H_=/Windows/i.test(ds),Jn=Boolean(hu()&&("ontouchstart"in se()||se().navigator.maxTouchPoints||se().DocumentTouch&&se().document instanceof se().DocumentTouch)),cm=/iPad/i.test(ds)||V_&&Jn&&!/iPhone/i.test(ds),G_=/iPhone/i.test(ds)&&!cm,Ao=G_||cm||Ga,Pl=(V_||Ao)&&!Gu,du=Object.freeze({__proto__:null,IS_IPOD:Ga,IOS_VERSION:ja,IS_ANDROID:ca,ANDROID_VERSION:Vu,IS_NATIVE_ANDROID:Hu,IS_FIREFOX:fl,IS_EDGE:kf,IS_CHROME:Gu,CHROME_VERSION:Wg,IE_VERSION:uh,IS_SAFARI:V_,IS_WINDOWS:H_,TOUCH_ENABLED:Jn,IS_IPAD:cm,IS_IPHONE:G_,IS_IOS:Ao,IS_ANY_SAFARI:Pl});function ju(b){return"string"==typeof b&&Boolean(b.trim())}function $g(b){if(b.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function hu(){return Oe()===se().document}function fu(b){return Es(b)&&1===b.nodeType}function j_(){try{return se().parent!==se().self}catch{return!0}}function Ff(b){return function(d,f){if(!ju(d))return Oe()[b](null);ju(f)&&(f=Oe().querySelector(f));var h=fu(f)?f:Oe();return h[b]&&h[b](d)}}function $i(b,d,f,h){void 0===b&&(b="div"),void 0===d&&(d={}),void 0===f&&(f={});var s=Oe().createElement(b);return Object.getOwnPropertyNames(d).forEach(function(u){var m=d[u];-1!==u.indexOf("aria-")||"role"===u||"type"===u?(Kt.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+u+" to "+m+"."),s.setAttribute(u,m)):"textContent"===u?Dc(s,m):(s[u]!==m||"tabIndex"===u)&&(s[u]=m)}),Object.getOwnPropertyNames(f).forEach(function(u){s.setAttribute(u,f[u])}),h&&fm(s,h),s}function Dc(b,d){return typeof b.textContent>"u"?b.innerText=d:b.textContent=d,b}function za(b,d){d.firstChild?d.insertBefore(b,d.firstChild):d.appendChild(b)}function cd(b,d){return $g(d),b.classList?b.classList.contains(d):function Cc(b){return new RegExp("(^|\\s)"+b+"($|\\s)")}(d).test(b.className)}function hs(b,d){return b.classList?b.classList.add(d):cd(b,d)||(b.className=(b.className+" "+d).trim()),b}function Mc(b,d){return b?(b.classList?b.classList.remove(d):($g(d),b.className=b.className.split(/\s+/).filter(function(f){return f!==d}).join(" ")),b):(Kt.warn("removeClass was called with an element that doesn't exist"),null)}function Aa(b,d,f){var h=cd(b,d);if("function"==typeof f&&(f=f(b,d)),"boolean"!=typeof f&&(f=!h),f!==h)return f?hs(b,d):Mc(b,d),b}function Bf(b,d){Object.getOwnPropertyNames(d).forEach(function(f){var h=d[f];null===h||typeof h>"u"||!1===h?b.removeAttribute(f):b.setAttribute(f,!0===h?"":h)})}function Ol(b){var d={};if(b&&b.attributes&&b.attributes.length>0)for(var h=b.attributes,s=h.length-1;s>=0;s--){var u=h[s].name,m=h[s].value;("boolean"==typeof b[u]||-1!==",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+u+","))&&(m=null!==m),d[u]=m}return d}function ei(b,d){return b.getAttribute(d)}function dd(b,d,f){b.setAttribute(d,f)}function Uf(b,d){b.removeAttribute(d)}function _i(){Oe().body.focus(),Oe().onselectstart=function(){return!1}}function Pa(){Oe().onselectstart=function(){return!0}}function wr(b){if(b&&b.getBoundingClientRect&&b.parentNode){var d=b.getBoundingClientRect(),f={};return["bottom","height","left","right","top","width"].forEach(function(h){void 0!==d[h]&&(f[h]=d[h])}),f.height||(f.height=parseFloat(Uu(b,"height"))),f.width||(f.width=parseFloat(Uu(b,"width"))),f}}function da(b){if(!b||b&&!b.offsetParent)return{left:0,top:0,width:0,height:0};for(var d=b.offsetWidth,f=b.offsetHeight,h=0,s=0;b.offsetParent&&b!==Oe()[io.fullscreenElement];)h+=b.offsetLeft,s+=b.offsetTop,b=b.offsetParent;return{left:h,top:s,width:d,height:f}}function Ii(b,d){var f={x:0,y:0};if(Ao)for(var h=b;h&&"html"!==h.nodeName.toLowerCase();){var s=Uu(h,"transform");if(/^matrix/.test(s)){var u=s.slice(7,-1).split(/,\s/).map(Number);f.x+=u[4],f.y+=u[5]}else if(/^matrix3d/.test(s)){var m=s.slice(9,-1).split(/,\s/).map(Number);f.x+=m[12],f.y+=m[13]}h=h.parentNode}var T={},S=da(d.target),D=da(b),P=D.width,H=d.offsetY-(D.top-S.top),te=d.offsetX-(D.left-S.left);return d.changedTouches&&(te=d.changedTouches[0].pageX-D.left,H=d.changedTouches[0].pageY+D.top,Ao&&(te-=f.x,H-=f.y)),T.y=1-Math.max(0,Math.min(1,H/D.height)),T.x=Math.max(0,Math.min(1,te/P)),T}function dm(b){return Es(b)&&3===b.nodeType}function hd(b){for(;b.firstChild;)b.removeChild(b.firstChild);return b}function hm(b){return"function"==typeof b&&(b=b()),(Array.isArray(b)?b:[b]).map(function(d){return"function"==typeof d&&(d=d()),fu(d)||dm(d)?d:"string"==typeof d&&/\S/.test(d)?Oe().createTextNode(d):void 0}).filter(function(d){return d})}function fm(b,d){return hm(d).forEach(function(f){return b.appendChild(f)}),b}function fs(b,d){return fm(hd(b),d)}function fd(b){return void 0===b.button&&void 0===b.buttons||0===b.button&&void 0===b.buttons||"mouseup"===b.type&&0===b.button&&0===b.buttons||!(0!==b.button||1!==b.buttons)}var ch,Ll=Ff("querySelector"),Ic=Ff("querySelectorAll"),zi=Object.freeze({__proto__:null,isReal:hu,isEl:fu,isInFrame:j_,createEl:$i,textContent:Dc,prependTo:za,hasClass:cd,addClass:hs,removeClass:Mc,toggleClass:Aa,setAttributes:Bf,getAttributes:Ol,getAttribute:ei,setAttribute:dd,removeAttribute:Uf,blockTextSelection:_i,unblockTextSelection:Pa,getBoundingClientRect:wr,findPosition:da,getPointerPosition:Ii,isTextNode:dm,emptyEl:hd,normalizeContent:hm,appendContent:fm,insertContent:fs,isSingleLeftClick:fd,$:Ll,$$:Ic}),pm=!1,dh=function(){if(!1!==ch.options.autoSetup){var d=Array.prototype.slice.call(Oe().getElementsByTagName("video")),f=Array.prototype.slice.call(Oe().getElementsByTagName("audio")),h=Array.prototype.slice.call(Oe().getElementsByTagName("video-js")),s=d.concat(f,h);if(s&&s.length>0)for(var u=0,m=s.length;u<m;u++){var T=s[u];if(!T||!T.getAttribute){xa(1);break}void 0===T.player&&null!==T.getAttribute("data-setup")&&ch(T)}else pm||xa(1)}};function xa(b,d){!hu()||(d&&(ch=d),se().setTimeout(dh,b))}function mm(){pm=!0,se().removeEventListener("load",mm)}hu()&&("complete"===Oe().readyState?mm():se().addEventListener("load",mm));var Fn,xo=function(d){var f=Oe().createElement("style");return f.className=d,f},gm=function(d,f){d.styleSheet?d.styleSheet.cssText=f:d.textContent=f},So=3;function ro(){return So++}se().WeakMap||(Fn=function(){function b(){this.vdata="vdata"+Math.floor(se().performance&&se().performance.now()||Date.now()),this.data={}}var d=b.prototype;return d.set=function(h,s){var u=h[this.vdata]||ro();return h[this.vdata]||(h[this.vdata]=u),this.data[u]=s,this},d.get=function(h){var s=h[this.vdata];if(s)return this.data[s];Kt("We have no data for this element",h)},d.has=function(h){return h[this.vdata]in this.data},d.delete=function(h){var s=h[this.vdata];s&&(delete this.data[s],delete h[this.vdata])},b}());var xi=se().WeakMap?new WeakMap:new Fn;function z_(b,d){if(xi.has(b)){var f=xi.get(b);0===f.handlers[d].length&&(delete f.handlers[d],b.removeEventListener?b.removeEventListener(d,f.dispatcher,!1):b.detachEvent&&b.detachEvent("on"+d,f.dispatcher)),Object.getOwnPropertyNames(f.handlers).length<=0&&(delete f.handlers,delete f.dispatcher,delete f.disabled),0===Object.getOwnPropertyNames(f).length&&xi.delete(b)}}function Rc(b,d,f,h){f.forEach(function(s){b(d,s,h)})}function hh(b){if(b.fixed_)return b;function d(){return!0}function f(){return!1}if(!b||!b.isPropagationStopped||!b.isImmediatePropagationStopped){var h=b||se().event;for(var s in b={},h)"layerX"!==s&&"layerY"!==s&&"keyLocation"!==s&&"webkitMovementX"!==s&&"webkitMovementY"!==s&&"path"!==s&&("returnValue"===s&&h.preventDefault||(b[s]=h[s]));if(b.target||(b.target=b.srcElement||Oe()),b.relatedTarget||(b.relatedTarget=b.fromElement===b.target?b.toElement:b.fromElement),b.preventDefault=function(){h.preventDefault&&h.preventDefault(),b.returnValue=!1,h.returnValue=!1,b.defaultPrevented=!0},b.defaultPrevented=!1,b.stopPropagation=function(){h.stopPropagation&&h.stopPropagation(),b.cancelBubble=!0,h.cancelBubble=!0,b.isPropagationStopped=d},b.isPropagationStopped=f,b.stopImmediatePropagation=function(){h.stopImmediatePropagation&&h.stopImmediatePropagation(),b.isImmediatePropagationStopped=d,b.stopPropagation()},b.isImmediatePropagationStopped=f,null!=b.clientX){var u=Oe().documentElement,m=Oe().body;b.pageX=b.clientX+(u&&u.scrollLeft||m&&m.scrollLeft||0)-(u&&u.clientLeft||m&&m.clientLeft||0),b.pageY=b.clientY+(u&&u.scrollTop||m&&m.scrollTop||0)-(u&&u.clientTop||m&&m.clientTop||0)}b.which=b.charCode||b.keyCode,null!=b.button&&(b.button=1&b.button?0:4&b.button?1:2&b.button?2:0)}return b.fixed_=!0,b}var kl,Nc=["touchstart","touchmove"];function so(b,d,f){if(Array.isArray(d))return Rc(so,b,d,f);xi.has(b)||xi.set(b,{});var h=xi.get(b);if(h.handlers||(h.handlers={}),h.handlers[d]||(h.handlers[d]=[]),f.guid||(f.guid=ro()),h.handlers[d].push(f),h.dispatcher||(h.disabled=!1,h.dispatcher=function(u,m){if(!h.disabled){u=hh(u);var T=h.handlers[u.type];if(T)for(var S=T.slice(0),D=0,P=S.length;D<P&&!u.isImmediatePropagationStopped();D++)try{S[D].call(b,u,m)}catch(W){Kt.error(W)}}}),1===h.handlers[d].length)if(b.addEventListener){var s=!1;(function(){if("boolean"!=typeof kl){kl=!1;try{var d=Object.defineProperty({},"passive",{get:function(){kl=!0}});se().addEventListener("test",null,d),se().removeEventListener("test",null,d)}catch{}}return kl})()&&Nc.indexOf(d)>-1&&(s={passive:!0}),b.addEventListener(d,h.dispatcher,s)}else b.attachEvent&&b.attachEvent("on"+d,h.dispatcher)}function ft(b,d,f){if(xi.has(b)){var h=xi.get(b);if(h.handlers){if(Array.isArray(d))return Rc(ft,b,d,f);var s=function(D,P){h.handlers[P]=[],z_(D,P)};if(void 0===d){for(var u in h.handlers)Object.prototype.hasOwnProperty.call(h.handlers||{},u)&&s(b,u);return}var m=h.handlers[d];if(m){if(!f)return void s(b,d);if(f.guid)for(var T=0;T<m.length;T++)m[T].guid===f.guid&&m.splice(T--,1);z_(b,d)}}}}function Vi(b,d,f){var h=xi.has(b)?xi.get(b):{},s=b.parentNode||b.ownerDocument;if("string"==typeof d?d={type:d,target:b}:d.target||(d.target=b),d=hh(d),h.dispatcher&&h.dispatcher.call(b,d,f),s&&!d.isPropagationStopped()&&!0===d.bubbles)Vi.call(null,s,d,f);else if(!s&&!d.defaultPrevented&&d.target&&d.target[d.type]){xi.has(d.target)||xi.set(d.target,{});var u=xi.get(d.target);d.target[d.type]&&(u.disabled=!0,"function"==typeof d.target[d.type]&&d.target[d.type](),u.disabled=!1)}return!d.defaultPrevented}function Wa(b,d,f){if(Array.isArray(d))return Rc(Wa,b,d,f);var h=function s(){ft(b,d,s),f.apply(this,arguments)};h.guid=f.guid=f.guid||ro(),so(b,d,h)}function Eo(b,d,f){var h=function s(){ft(b,d,s),f.apply(this,arguments)};h.guid=f.guid=f.guid||ro(),so(b,d,h)}var Zr,Os=Object.freeze({__proto__:null,fixEvent:hh,on:so,off:ft,trigger:Vi,one:Wa,any:Eo}),hr=function(d,f,h){f.guid||(f.guid=ro());var s=f.bind(d);return s.guid=h?h+"_"+f.guid:f.guid,s},zs=function(d,f){var h=se().performance.now();return function(){var m=se().performance.now();m-h>=f&&(d.apply(void 0,arguments),h=m)}},Cs=function(){};Cs.prototype.allowedEvents_={},Cs.prototype.addEventListener=Cs.prototype.on=function(b,d){var f=this.addEventListener;this.addEventListener=function(){},so(this,b,d),this.addEventListener=f},Cs.prototype.removeEventListener=Cs.prototype.off=function(b,d){ft(this,b,d)},Cs.prototype.one=function(b,d){var f=this.addEventListener;this.addEventListener=function(){},Wa(this,b,d),this.addEventListener=f},Cs.prototype.any=function(b,d){var f=this.addEventListener;this.addEventListener=function(){},Eo(this,b,d),this.addEventListener=f},Cs.prototype.dispatchEvent=Cs.prototype.trigger=function(b){var d=b.type||b;"string"==typeof b&&(b={type:d}),b=hh(b),this.allowedEvents_[d]&&this["on"+d]&&this["on"+d](b),Vi(this,b)},Cs.prototype.queueTrigger=function(b){var d=this;Zr||(Zr=new Map);var f=b.type||b,h=Zr.get(this);h||Zr.set(this,h=new Map);var s=h.get(f);h.delete(f),se().clearTimeout(s);var u=se().setTimeout(function(){0===h.size&&(h=null,Zr.delete(d)),d.trigger(b)},0);h.set(f,u)};var vm=function(d){return"function"==typeof d.name?d.name():"string"==typeof d.name?d.name:d.name_?d.name_:d.constructor&&d.constructor.name?d.constructor.name:typeof d},Fl=function(d){return d instanceof Cs||!!d.eventBusEl_&&["on","one","off","trigger"].every(function(f){return"function"==typeof d[f]})},Ls=function(d){return"string"==typeof d&&/\S/.test(d)||Array.isArray(d)&&!!d.length},Jr=function(d,f,h){if(!d||!d.nodeName&&!Fl(d))throw new Error("Invalid target for "+vm(f)+"#"+h+"; must be a DOM node or evented object.")},qg=function(d,f,h){if(!Ls(d))throw new Error("Invalid event type for "+vm(f)+"#"+h+"; must be a non-empty string or array.")},pd=function(d,f,h){if("function"!=typeof d)throw new Error("Invalid listener for "+vm(f)+"#"+h+"; must be a function.")},Bl=function(d,f,h){var u,m,T,s=f.length<3||f[0]===d||f[0]===d.eventBusEl_;return s?(u=d.eventBusEl_,f.length>=3&&f.shift(),m=f[0],T=f[1]):(u=f[0],m=f[1],T=f[2]),Jr(u,d,h),qg(m,d,h),pd(T,d,h),{isTargetingSelf:s,target:u,type:m,listener:T=hr(d,T)}},Ws=function(d,f,h,s){Jr(d,d,f),d.nodeName?Os[f](d,h,s):d[f](h,s)},Wu={on:function(){for(var d=this,f=arguments.length,h=new Array(f),s=0;s<f;s++)h[s]=arguments[s];var u=Bl(this,h,"on"),m=u.isTargetingSelf,T=u.target,S=u.type,D=u.listener;if(Ws(T,"on",S,D),!m){var P=function(){return d.off(T,S,D)};P.guid=D.guid;var W=function(){return d.off("dispose",P)};W.guid=D.guid,Ws(this,"on","dispose",P),Ws(T,"on","dispose",W)}},one:function(){for(var d=this,f=arguments.length,h=new Array(f),s=0;s<f;s++)h[s]=arguments[s];var u=Bl(this,h,"one"),m=u.isTargetingSelf,T=u.target,S=u.type,D=u.listener;if(m)Ws(T,"one",S,D);else{var P=function W(){d.off(T,S,W);for(var H=arguments.length,te=new Array(H),le=0;le<H;le++)te[le]=arguments[le];D.apply(null,te)};P.guid=D.guid,Ws(T,"one",S,P)}},any:function(){for(var d=this,f=arguments.length,h=new Array(f),s=0;s<f;s++)h[s]=arguments[s];var u=Bl(this,h,"any"),m=u.isTargetingSelf,T=u.target,S=u.type,D=u.listener;if(m)Ws(T,"any",S,D);else{var P=function W(){d.off(T,S,W);for(var H=arguments.length,te=new Array(H),le=0;le<H;le++)te[le]=arguments[le];D.apply(null,te)};P.guid=D.guid,Ws(T,"any",S,P)}},off:function(d,f,h){if(!d||Ls(d))ft(this.eventBusEl_,d,f);else{var s=d,u=f;Jr(s,this,"off"),qg(u,this,"off"),pd(h,this,"off"),h=hr(this,h),this.off("dispose",h),s.nodeName?(ft(s,u,h),ft(s,"dispose",h)):Fl(s)&&(s.off(u,h),s.off("dispose",h))}},trigger:function(d,f){if(Jr(this.eventBusEl_,this,"trigger"),!Ls(d&&"string"!=typeof d?d.type:d)){var s="Invalid event type for "+vm(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(!d)throw new Error(s);(this.log||Kt).error(s)}return Vi(this.eventBusEl_,d,f)}};function ks(b,d){void 0===d&&(d={});var h=d.eventBusKey;if(h){if(!b[h].nodeName)throw new Error('The eventBusKey "'+h+'" does not refer to an element.');b.eventBusEl_=b[h]}else b.eventBusEl_=$i("span",{className:"vjs-event-bus"});return zr(b,Wu),b.eventedCallbacks&&b.eventedCallbacks.forEach(function(s){s()}),b.on("dispose",function(){b.off(),[b,b.el_,b.eventBusEl_].forEach(function(s){s&&xi.has(s)&&xi.delete(s)}),se().setTimeout(function(){b.eventBusEl_=null},0)}),b}var fh={state:{},setState:function(d){var h,f=this;return"function"==typeof d&&(d=d()),lh(d,function(s,u){f.state[u]!==s&&((h=h||{})[u]={from:f.state[u],to:s}),f.state[u]=s}),h&&Fl(this)&&this.trigger({changes:h,type:"statechanged"}),h}};function $u(b,d){return zr(b,fh),b.state=zr({},b.state,d),"function"==typeof b.handleStateChanged&&Fl(b)&&b.on("statechanged",b.handleStateChanged),b}var Ul=function(d){return"string"!=typeof d?d:d.replace(/./,function(f){return f.toLowerCase()})},Rr=function(d){return"string"!=typeof d?d:d.replace(/./,function(f){return f.toUpperCase()})};function Dr(){for(var b={},d=arguments.length,f=new Array(d),h=0;h<d;h++)f[h]=arguments[h];return f.forEach(function(s){!s||lh(s,function(u,m){cu(u)?(cu(b[m])||(b[m]={}),b[m]=Dr(b[m],u)):b[m]=u})}),b}var md=function(){function b(){this.map_={}}var d=b.prototype;return d.has=function(h){return h in this.map_},d.delete=function(h){var s=this.has(h);return delete this.map_[h],s},d.set=function(h,s){return this.map_[h]=s,this},d.forEach=function(h,s){for(var u in this.map_)h.call(s,this.map_[u],u,this)},b}(),ph=se().Map?se().Map:md,Hf=function(){function b(){this.set_={}}var d=b.prototype;return d.has=function(h){return h in this.set_},d.delete=function(h){var s=this.has(h);return delete this.set_[h],s},d.add=function(h){return this.set_[h]=1,this},d.forEach=function(h,s){for(var u in this.set_)h.call(s,u,u,this)},b}(),Gf=se().Set?se().Set:Hf,Rt=function(){function b(f,h,s){var u=this;if(this.player_=!f&&this.play?f=this:f,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Dr({},this.options_),h=this.options_=Dr(this.options_,h),this.id_=h.id||h.el&&h.el.id,!this.id_){var m=f&&f.id&&f.id()||"no_player";this.id_=m+"_component_"+ro()}this.name_=h.name||null,h.el?this.el_=h.el:!1!==h.createEl&&(this.el_=this.createEl()),h.className&&this.el_&&h.className.split(" ").forEach(function(T){return u.addClass(T)}),!1!==h.evented&&(ks(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),$u(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Gf,this.setIntervalIds_=new Gf,this.rafIds_=new Gf,this.namedRafs_=new ph,this.clearingTimersOnDispose_=!1,!1!==h.initChildren&&this.initChildren(),this.ready(s),!1!==h.reportTouchActivity&&this.enableTouchActivity()}var d=b.prototype;return d.dispose=function(h){if(void 0===h&&(h={}),!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var s=this.children_.length-1;s>=0;s--)this.children_[s].dispose&&this.children_[s].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(h.restoreEl?this.el_.parentNode.replaceChild(h.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}},d.isDisposed=function(){return Boolean(this.isDisposed_)},d.player=function(){return this.player_},d.options=function(h){return h?(this.options_=Dr(this.options_,h),this.options_):this.options_},d.el=function(){return this.el_},d.createEl=function(h,s,u){return $i(h,s,u)},d.localize=function(h,s,u){void 0===u&&(u=h);var m=this.player_.language&&this.player_.language(),T=this.player_.languages&&this.player_.languages(),S=T&&T[m],D=m&&m.split("-")[0],P=T&&T[D],W=u;return S&&S[h]?W=S[h]:P&&P[h]&&(W=P[h]),s&&(W=W.replace(/\{(\d+)\}/g,function(H,te){var le=s[te-1],ce=le;return typeof le>"u"&&(ce=H),ce})),W},d.handleLanguagechange=function(){},d.contentEl=function(){return this.contentEl_||this.el_},d.id=function(){return this.id_},d.name=function(){return this.name_},d.children=function(){return this.children_},d.getChildById=function(h){return this.childIndex_[h]},d.getChild=function(h){if(h)return this.childNameIndex_[h]},d.getDescendant=function(){for(var h=arguments.length,s=new Array(h),u=0;u<h;u++)s[u]=arguments[u];s=s.reduce(function(S,D){return S.concat(D)},[]);for(var m=this,T=0;T<s.length;T++)if(!(m=m.getChild(s[T]))||!m.getChild)return;return m},d.addChild=function(h,s,u){var m,T;if(void 0===s&&(s={}),void 0===u&&(u=this.children_.length),"string"==typeof h){T=Rr(h);var S=s.componentClass||T;s.name=T;var D=b.getComponent(S);if(!D)throw new Error("Component "+S+" does not exist");if("function"!=typeof D)return null;m=new D(this.player_||this,s)}else m=h;if(m.parentComponent_&&m.parentComponent_.removeChild(m),this.children_.splice(u,0,m),m.parentComponent_=this,"function"==typeof m.id&&(this.childIndex_[m.id()]=m),(T=T||m.name&&Rr(m.name()))&&(this.childNameIndex_[T]=m,this.childNameIndex_[Ul(T)]=m),"function"==typeof m.el&&m.el()){var P=null;this.children_[u+1]&&(this.children_[u+1].el_?P=this.children_[u+1].el_:fu(this.children_[u+1])&&(P=this.children_[u+1])),this.contentEl().insertBefore(m.el(),P)}return m},d.removeChild=function(h){if("string"==typeof h&&(h=this.getChild(h)),h&&this.children_){for(var s=!1,u=this.children_.length-1;u>=0;u--)if(this.children_[u]===h){s=!0,this.children_.splice(u,1);break}if(s){h.parentComponent_=null,this.childIndex_[h.id()]=null,this.childNameIndex_[Rr(h.name())]=null,this.childNameIndex_[Ul(h.name())]=null;var m=h.el();m&&m.parentNode===this.contentEl()&&this.contentEl().removeChild(h.el())}}},d.initChildren=function(){var h=this,s=this.options_.children;if(s){var T,u=this.options_,S=b.getComponent("Tech");(T=Array.isArray(s)?s:Object.keys(s)).concat(Object.keys(this.options_).filter(function(D){return!T.some(function(P){return"string"==typeof P?D===P:D===P.name})})).map(function(D){var P,W;return"string"==typeof D?W=s[P=D]||h.options_[P]||{}:(P=D.name,W=D),{name:P,opts:W}}).filter(function(D){var P=b.getComponent(D.opts.componentClass||Rr(D.name));return P&&!S.isTech(P)}).forEach(function(P){var W=P.name,H=P.opts;if(void 0!==u[W]&&(H=u[W]),!1!==H){!0===H&&(H={}),H.playerOptions=h.options_.playerOptions;var te=h.addChild(W,H);te&&(h[W]=te)}})}},d.buildCSSClass=function(){return""},d.ready=function(h,s){if(void 0===s&&(s=!1),h){if(!this.isReady_)return this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(h);s?h.call(this):this.setTimeout(h,1)}},d.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var h=this.readyQueue_;this.readyQueue_=[],h&&h.length>0&&h.forEach(function(s){s.call(this)},this),this.trigger("ready")},1)},d.$=function(h,s){return Ll(h,s||this.contentEl())},d.$$=function(h,s){return Ic(h,s||this.contentEl())},d.hasClass=function(h){return cd(this.el_,h)},d.addClass=function(h){hs(this.el_,h)},d.removeClass=function(h){Mc(this.el_,h)},d.toggleClass=function(h,s){Aa(this.el_,h,s)},d.show=function(){this.removeClass("vjs-hidden")},d.hide=function(){this.addClass("vjs-hidden")},d.lockShowing=function(){this.addClass("vjs-lock-showing")},d.unlockShowing=function(){this.removeClass("vjs-lock-showing")},d.getAttribute=function(h){return ei(this.el_,h)},d.setAttribute=function(h,s){dd(this.el_,h,s)},d.removeAttribute=function(h){Uf(this.el_,h)},d.width=function(h,s){return this.dimension("width",h,s)},d.height=function(h,s){return this.dimension("height",h,s)},d.dimensions=function(h,s){this.width(h,!0),this.height(s)},d.dimension=function(h,s,u){if(void 0!==s)return(null===s||s!=s)&&(s=0),this.el_.style[h]=-1!==(""+s).indexOf("%")||-1!==(""+s).indexOf("px")?s:"auto"===s?"":s+"px",void(u||this.trigger("componentresize"));if(!this.el_)return 0;var m=this.el_.style[h],T=m.indexOf("px");return parseInt(-1!==T?m.slice(0,T):this.el_["offset"+Rr(h)],10)},d.currentDimension=function(h){var s=0;if("width"!==h&&"height"!==h)throw new Error("currentDimension only accepts width or height value");if(s=Uu(this.el_,h),0===(s=parseFloat(s))||isNaN(s)){var u="offset"+Rr(h);s=this.el_[u]}return s},d.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},d.currentWidth=function(){return this.currentDimension("width")},d.currentHeight=function(){return this.currentDimension("height")},d.focus=function(){this.el_.focus()},d.blur=function(){this.el_.blur()},d.handleKeyDown=function(h){this.player_&&(yt().isEventKey(h,"Tab")||h.stopPropagation(),this.player_.handleKeyDown(h))},d.handleKeyPress=function(h){this.handleKeyDown(h)},d.emitTapEvents=function(){var T,h=0,s=null;this.on("touchstart",function(D){1===D.touches.length&&(s={pageX:D.touches[0].pageX,pageY:D.touches[0].pageY},h=se().performance.now(),T=!0)}),this.on("touchmove",function(D){if(D.touches.length>1)T=!1;else if(s){var P=D.touches[0].pageX-s.pageX,W=D.touches[0].pageY-s.pageY;Math.sqrt(P*P+W*W)>10&&(T=!1)}});var S=function(){T=!1};this.on("touchleave",S),this.on("touchcancel",S),this.on("touchend",function(D){s=null,!0===T&&se().performance.now()-h<200&&(D.preventDefault(),this.trigger("tap"))})},d.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var s,h=hr(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){h(),this.clearInterval(s),s=this.setInterval(h,250)});var u=function(T){h(),this.clearInterval(s)};this.on("touchmove",h),this.on("touchend",u),this.on("touchcancel",u)}},d.setTimeout=function(h,s){var m,u=this;return h=hr(this,h),this.clearTimersOnDispose_(),m=se().setTimeout(function(){u.setTimeoutIds_.has(m)&&u.setTimeoutIds_.delete(m),h()},s),this.setTimeoutIds_.add(m),m},d.clearTimeout=function(h){return this.setTimeoutIds_.has(h)&&(this.setTimeoutIds_.delete(h),se().clearTimeout(h)),h},d.setInterval=function(h,s){h=hr(this,h),this.clearTimersOnDispose_();var u=se().setInterval(h,s);return this.setIntervalIds_.add(u),u},d.clearInterval=function(h){return this.setIntervalIds_.has(h)&&(this.setIntervalIds_.delete(h),se().clearInterval(h)),h},d.requestAnimationFrame=function(h){var u,s=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),h=hr(this,h),u=se().requestAnimationFrame(function(){s.rafIds_.has(u)&&s.rafIds_.delete(u),h()}),this.rafIds_.add(u),u):this.setTimeout(h,1e3/60)},d.requestNamedAnimationFrame=function(h,s){var u=this;if(!this.namedRafs_.has(h)){this.clearTimersOnDispose_(),s=hr(this,s);var m=this.requestAnimationFrame(function(){s(),u.namedRafs_.has(h)&&u.namedRafs_.delete(h)});return this.namedRafs_.set(h,m),h}},d.cancelNamedAnimationFrame=function(h){!this.namedRafs_.has(h)||(this.cancelAnimationFrame(this.namedRafs_.get(h)),this.namedRafs_.delete(h))},d.cancelAnimationFrame=function(h){return this.supportsRaf_?(this.rafIds_.has(h)&&(this.rafIds_.delete(h),se().cancelAnimationFrame(h)),h):this.clearTimeout(h)},d.clearTimersOnDispose_=function(){var h=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(s){var m=s[1];h[s[0]].forEach(function(T,S){return h[m](S)})}),h.clearingTimersOnDispose_=!1}))},b.registerComponent=function(h,s){if("string"!=typeof h||!h)throw new Error('Illegal component name, "'+h+'"; must be a non-empty string.');var u=b.getComponent("Tech"),m=u&&u.isTech(s),T=b===s||b.prototype.isPrototypeOf(s.prototype);if(m||!T)throw new Error('Illegal component, "'+h+'"; '+(m?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");h=Rr(h),b.components_||(b.components_={});var D=b.getComponent("Player");if("Player"===h&&D&&D.players){var P=D.players,W=Object.keys(P);if(P&&W.length>0&&W.map(function(H){return P[H]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return b.components_[h]=s,b.components_[Ul(h)]=s,s},b.getComponent=function(h){if(h&&b.components_)return b.components_[h]},b}();function _m(b,d,f,h){return function W_(b,d,f){if("number"!=typeof d||d<0||d>f)throw new Error("Failed to execute '"+b+"' on 'TimeRanges': The index provided ("+d+") is non-numeric or out of bounds (0-"+f+").")}(b,h,f.length-1),f[h][d]}function Yg(b){var d;return d=void 0===b||0===b.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:b.length,start:_m.bind(null,"start",0,b),end:_m.bind(null,"end",1,b)},se().Symbol&&se().Symbol.iterator&&(d[se().Symbol.iterator]=function(){return(b||[]).values()}),d}function gd(b,d){return Array.isArray(b)?Yg(b):void 0===b||void 0===d?Yg():Yg([[b,d]])}function $a(b,d){var h,s,f=0;if(!d)return 0;(!b||!b.length)&&(b=gd(0,0));for(var u=0;u<b.length;u++)h=b.start(u),(s=b.end(u))>d&&(s=d),f+=s-h;return f/d}function Fs(b){if(b instanceof Fs)return b;"number"==typeof b?this.code=b:"string"==typeof b?this.message=b:Es(b)&&("number"==typeof b.code&&(this.code=b.code),zr(this,b)),this.message||(this.message=Fs.defaultMessages[this.code]||"")}Rt.prototype.supportsRaf_="function"==typeof se().requestAnimationFrame&&"function"==typeof se().cancelAnimationFrame,Rt.registerComponent("Component",Rt),Fs.prototype.code=0,Fs.prototype.message="",Fs.prototype.status=null,Fs.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Fs.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var es=0;es<Fs.errorTypes.length;es++)Fs[Fs.errorTypes[es]]=es,Fs.prototype[Fs.errorTypes[es]]=es;function jf(b){return null!=b&&"function"==typeof b.then}function pu(b){jf(b)&&b.then(null,function(d){})}var Qg=function(d){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(h,s,u){return d[s]&&(h[s]=d[s]),h},{cues:d.cues&&Array.prototype.map.call(d.cues,function(h){return{startTime:h.startTime,endTime:h.endTime,text:h.text,id:h.id}})})},mh="vjs-modal-dialog",qu=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).handleKeyDown_=function(m){return u.handleKeyDown(m)},u.close_=function(m){return u.close(m)},u.opened_=u.hasBeenOpened_=u.hasBeenFilled_=!1,u.closeable(!u.options_.uncloseable),u.content(u.options_.content),u.contentEl_=$i("div",{className:mh+"-content"},{role:"document"}),u.descEl_=$i("p",{className:mh+"-description vjs-control-text",id:u.el().getAttribute("aria-describedby")}),Dc(u.descEl_,u.description()),u.el_.appendChild(u.descEl_),u.el_.appendChild(u.contentEl_),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},f.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,b.prototype.dispose.call(this)},f.buildCSSClass=function(){return mh+" vjs-hidden "+b.prototype.buildCSSClass.call(this)},f.label=function(){return this.localize(this.options_.label||"Modal Window")},f.description=function(){var s=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(s+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),s},f.open=function(){if(!this.opened_){var s=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!s.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&s.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=s.controls(),s.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},f.opened=function(s){return"boolean"==typeof s&&this[s?"open":"close"](),this.opened_},f.close=function(){if(this.opened_){var s=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&s.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&s.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},f.closeable=function(s){if("boolean"==typeof s){var u=this.closeable_=!!s,m=this.getChild("closeButton");if(u&&!m){var T=this.contentEl_;this.contentEl_=this.el_,m=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=T,this.on(m,"close",this.close_)}!u&&m&&(this.off(m,"close",this.close_),this.removeChild(m),m.dispose())}return this.closeable_},f.fill=function(){this.fillWith(this.content())},f.fillWith=function(s){var u=this.contentEl(),m=u.parentNode,T=u.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,m.removeChild(u),this.empty(),fs(u,s),this.trigger("modalfill"),T?m.insertBefore(u,T):m.appendChild(u);var S=this.getChild("closeButton");S&&m.appendChild(S.el_)},f.empty=function(){this.trigger("beforemodalempty"),hd(this.contentEl()),this.trigger("modalempty")},f.content=function(s){return typeof s<"u"&&(this.content_=s),this.content_},f.conditionalFocus_=function(){var s=Oe().activeElement,u=this.player_.el_;this.previouslyActiveEl_=null,(u.contains(s)||u===s)&&(this.previouslyActiveEl_=s,this.focus())},f.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},f.handleKeyDown=function(s){if(s.stopPropagation(),yt().isEventKey(s,"Escape")&&this.closeable())return s.preventDefault(),void this.close();if(yt().isEventKey(s,"Tab")){for(var T,u=this.focusableEls_(),m=this.el_.querySelector(":focus"),S=0;S<u.length;S++)if(m===u[S]){T=S;break}Oe().activeElement===this.el_&&(T=0),s.shiftKey&&0===T?(u[u.length-1].focus(),s.preventDefault()):!s.shiftKey&&T===u.length-1&&(u[0].focus(),s.preventDefault())}},f.focusableEls_=function(){var s=this.el_.querySelectorAll("*");return Array.prototype.filter.call(s,function(u){return(u instanceof se().HTMLAnchorElement||u instanceof se().HTMLAreaElement)&&u.hasAttribute("href")||(u instanceof se().HTMLInputElement||u instanceof se().HTMLSelectElement||u instanceof se().HTMLTextAreaElement||u instanceof se().HTMLButtonElement)&&!u.hasAttribute("disabled")||u instanceof se().HTMLIFrameElement||u instanceof se().HTMLObjectElement||u instanceof se().HTMLEmbedElement||u.hasAttribute("tabindex")&&-1!==u.getAttribute("tabindex")||u.hasAttribute("contenteditable")})},d}(Rt);qu.prototype.options_={pauseOnOpen:!0,temporary:!0},Rt.registerComponent("ModalDialog",qu);var Xu=function(b){function d(h){var s;void 0===h&&(h=[]),(s=b.call(this)||this).tracks_=[],Object.defineProperty(gt(s),"length",{get:function(){return this.tracks_.length}});for(var u=0;u<h.length;u++)s.addTrack(h[u]);return s}ze(d,b);var f=d.prototype;return f.addTrack=function(s){var u=this,m=this.tracks_.length;""+m in this||Object.defineProperty(this,m,{get:function(){return this.tracks_[m]}}),-1===this.tracks_.indexOf(s)&&(this.tracks_.push(s),this.trigger({track:s,type:"addtrack",target:this})),s.labelchange_=function(){u.trigger({track:s,type:"labelchange",target:u})},Fl(s)&&s.addEventListener("labelchange",s.labelchange_)},f.removeTrack=function(s){for(var u,m=0,T=this.length;m<T;m++)if(this[m]===s){(u=this[m]).off&&u.off(),this.tracks_.splice(m,1);break}!u||this.trigger({track:u,type:"removetrack",target:this})},f.getTrackById=function(s){for(var u=null,m=0,T=this.length;m<T;m++){var S=this[m];if(S.id===s){u=S;break}}return u},d}(Cs);for(var Kg in Xu.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"},Xu.prototype.allowedEvents_)Xu.prototype["on"+Kg]=null;var ym=function(d,f){for(var h=0;h<d.length;h++)!Object.keys(d[h]).length||f.id===d[h].id||(d[h].enabled=!1)},Vy=function(b){function d(h){var s;void 0===h&&(h=[]);for(var u=h.length-1;u>=0;u--)if(h[u].enabled){ym(h,h[u]);break}return(s=b.call(this,h)||this).changing_=!1,s}ze(d,b);var f=d.prototype;return f.addTrack=function(s){var u=this;s.enabled&&ym(this,s),b.prototype.addTrack.call(this,s),s.addEventListener&&(s.enabledChange_=function(){u.changing_||(u.changing_=!0,ym(u,s),u.changing_=!1,u.trigger("change"))},s.addEventListener("enabledchange",s.enabledChange_))},f.removeTrack=function(s){b.prototype.removeTrack.call(this,s),s.removeEventListener&&s.enabledChange_&&(s.removeEventListener("enabledchange",s.enabledChange_),s.enabledChange_=null)},d}(Xu),mu=function(d,f){for(var h=0;h<d.length;h++)!Object.keys(d[h]).length||f.id===d[h].id||(d[h].selected=!1)},zf=function(b){function d(h){var s;void 0===h&&(h=[]);for(var u=h.length-1;u>=0;u--)if(h[u].selected){mu(h,h[u]);break}return(s=b.call(this,h)||this).changing_=!1,Object.defineProperty(gt(s),"selectedIndex",{get:function(){for(var T=0;T<this.length;T++)if(this[T].selected)return T;return-1},set:function(){}}),s}ze(d,b);var f=d.prototype;return f.addTrack=function(s){var u=this;s.selected&&mu(this,s),b.prototype.addTrack.call(this,s),s.addEventListener&&(s.selectedChange_=function(){u.changing_||(u.changing_=!0,mu(u,s),u.changing_=!1,u.trigger("change"))},s.addEventListener("selectedchange",s.selectedChange_))},f.removeTrack=function(s){b.prototype.removeTrack.call(this,s),s.removeEventListener&&s.selectedChange_&&(s.removeEventListener("selectedchange",s.selectedChange_),s.selectedChange_=null)},d}(Xu),q_=function(b){function d(){return b.apply(this,arguments)||this}ze(d,b);var f=d.prototype;return f.addTrack=function(s){var u=this;b.prototype.addTrack.call(this,s),this.queueChange_||(this.queueChange_=function(){return u.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return u.trigger("selectedlanguagechange")}),s.addEventListener("modechange",this.queueChange_),-1===["metadata","chapters"].indexOf(s.kind)&&s.addEventListener("modechange",this.triggerSelectedlanguagechange_)},f.removeTrack=function(s){b.prototype.removeTrack.call(this,s),s.removeEventListener&&(this.queueChange_&&s.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&s.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},d}(Xu),Hy=function(){function b(f){void 0===f&&(f=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var h=0,s=f.length;h<s;h++)this.addTrackElement_(f[h])}var d=b.prototype;return d.addTrackElement_=function(h){var s=this.trackElements_.length;""+s in this||Object.defineProperty(this,s,{get:function(){return this.trackElements_[s]}}),-1===this.trackElements_.indexOf(h)&&this.trackElements_.push(h)},d.getTrackElementByTrack_=function(h){for(var s,u=0,m=this.trackElements_.length;u<m;u++)if(h===this.trackElements_[u].track){s=this.trackElements_[u];break}return s},d.removeTrackElement_=function(h){for(var s=0,u=this.trackElements_.length;s<u;s++)if(h===this.trackElements_[s]){this.trackElements_[s].track&&"function"==typeof this.trackElements_[s].track.off&&this.trackElements_[s].track.off(),"function"==typeof this.trackElements_[s].off&&this.trackElements_[s].off(),this.trackElements_.splice(s,1);break}},b}(),gh=function(){function b(f){b.prototype.setCues_.call(this,f),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var d=b.prototype;return d.setCues_=function(h){var s=this.length||0,u=0,m=h.length;this.cues_=h,this.length_=h.length;var T=function(D){""+D in this||Object.defineProperty(this,""+D,{get:function(){return this.cues_[D]}})};if(s<m)for(u=s;u<m;u++)T.call(this,u)},d.getCueById=function(h){for(var s=null,u=0,m=this.length;u<m;u++){var T=this[u];if(T.id===h){s=T;break}}return s},b}(),Zg={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Gy={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},jy={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},zy={disabled:"disabled",hidden:"hidden",showing:"showing"},X_=function(b){function d(f){var h;void 0===f&&(f={}),h=b.call(this)||this;var s={id:f.id||"vjs_track_"+ro(),kind:f.kind||"",language:f.language||""},u=f.label||"",m=function(D){Object.defineProperty(gt(h),D,{get:function(){return s[D]},set:function(){}})};for(var T in s)m(T);return Object.defineProperty(gt(h),"label",{get:function(){return u},set:function(D){D!==u&&(u=D,this.trigger("labelchange"))}}),h}return ze(d,b),d}(Cs),vh=function(d){var f=["protocol","hostname","port","pathname","search","hash","host"],h=Oe().createElement("a");h.href=d;for(var s={},u=0;u<f.length;u++)s[f[u]]=h[f[u]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=se().location.protocol),s.host||(s.host=se().location.host),s},Jg=function(d){if(!d.match(/^https?:\/\//)){var f=Oe().createElement("a");f.href=d,d=f.href}return d},bm=function(d){if("string"==typeof d){var h=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(d);if(h)return h.pop().toLowerCase()}return""},vd=function(d,f){void 0===f&&(f=se().location);var h=vh(d);return(":"===h.protocol?f.protocol:h.protocol)+h.host!==f.protocol+f.host},Y_=Object.freeze({__proto__:null,parseUrl:vh,getAbsoluteURL:Jg,getFileExtension:bm,isCrossOrigin:vd}),ev=function(d,f){var h=new(se().WebVTT.Parser)(se(),se().vttjs,se().WebVTT.StringDecoder()),s=[];h.oncue=function(u){f.addCue(u)},h.onparsingerror=function(u){s.push(u)},h.onflush=function(){f.trigger({type:"loadeddata",target:f})},h.parse(d),s.length>0&&(se().console&&se().console.groupCollapsed&&se().console.groupCollapsed("Text Track parsing errors for "+f.src),s.forEach(function(u){return Kt.error(u)}),se().console&&se().console.groupEnd&&se().console.groupEnd()),h.flush()},_d=function(d,f){var h={uri:d},s=vd(d);s&&(h.cors=s);var u="use-credentials"===f.tech_.crossOrigin();u&&(h.withCredentials=u),wi()(h,hr(this,function(m,T,S){if(m)return Kt.error(m,T);f.loaded_=!0,"function"!=typeof se().WebVTT?f.tech_&&f.tech_.any(["vttjsloaded","vttjserror"],function(D){if("vttjserror"!==D.type)return ev(S,f);Kt.error("vttjs failed to load, stopping trying to process "+f.src)}):ev(S,f)}))},Wf=function(b){function d(h){var s;if(void 0===h&&(h={}),!h.tech)throw new Error("A tech was not provided.");var u=Dr(h,{kind:jy[h.kind]||"subtitles",language:h.language||h.srclang||""}),m=zy[u.mode]||"disabled",T=u.default;("metadata"===u.kind||"chapters"===u.kind)&&(m="hidden"),(s=b.call(this,u)||this).tech_=u.tech,s.cues_=[],s.activeCues_=[],s.preload_=!1!==s.tech_.preloadTextTracks;var S=new gh(s.cues_),D=new gh(s.activeCues_),P=!1;return s.timeupdateHandler=hr(gt(s),function(H){if(void 0===H&&(H={}),!this.tech_.isDisposed()){if(!this.tech_.isReady_)return void("timeupdate"!==H.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)));this.activeCues=this.activeCues,P&&(this.trigger("cuechange"),P=!1),"timeupdate"!==H.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}}),s.tech_.one("dispose",function(){s.stopTracking()}),"disabled"!==m&&s.startTracking(),Object.defineProperties(gt(s),{default:{get:function(){return T},set:function(){}},mode:{get:function(){return m},set:function(te){!zy[te]||m!==te&&(m=te,!this.preload_&&"disabled"!==m&&0===this.cues.length&&_d(this.src,this),this.stopTracking(),"disabled"!==m&&this.startTracking(),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?S:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return D;for(var te=this.tech_.currentTime(),le=[],ce=0,fe=this.cues.length;ce<fe;ce++){var ue=this.cues[ce];(ue.startTime<=te&&ue.endTime>=te||ue.startTime===ue.endTime&&ue.startTime<=te&&ue.startTime+.5>=te)&&le.push(ue)}if(P=!1,le.length!==this.activeCues_.length)P=!0;else for(var At=0;At<le.length;At++)-1===this.activeCues_.indexOf(le[At])&&(P=!0);return this.activeCues_=le,D.setCues_(this.activeCues_),D},set:function(){}}}),u.src?(s.src=u.src,s.preload_||(s.loaded_=!0),(s.preload_||"subtitles"!==u.kind&&"captions"!==u.kind)&&_d(s.src,gt(s))):s.loaded_=!0,s}ze(d,b);var f=d.prototype;return f.startTracking=function(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)},f.stopTracking=function(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)},f.addCue=function(s){var u=s;if(se().vttjs&&!(s instanceof se().vttjs.VTTCue)){for(var m in u=new(se().vttjs.VTTCue)(s.startTime,s.endTime,s.text),s)m in u||(u[m]=s[m]);u.id=s.id,u.originalCue_=s}for(var T=this.tech_.textTracks(),S=0;S<T.length;S++)T[S]!==this&&T[S].removeCue(u);this.cues_.push(u),this.cues.setCues_(this.cues_)},f.removeCue=function(s){for(var u=this.cues_.length;u--;){var m=this.cues_[u];if(m===s||m.originalCue_&&m.originalCue_===s){this.cues_.splice(u,1),this.cues.setCues_(this.cues_);break}}},d}(X_);Wf.prototype.allowedEvents_={cuechange:"cuechange"};var yd=function(b){function d(f){var h;void 0===f&&(f={});var s=Dr(f,{kind:Gy[f.kind]||""});h=b.call(this,s)||this;var u=!1;return Object.defineProperty(gt(h),"enabled",{get:function(){return u},set:function(T){"boolean"!=typeof T||T===u||(u=T,this.trigger("enabledchange"))}}),s.enabled&&(h.enabled=s.enabled),h.loaded_=!0,h}return ze(d,b),d}(X_),Tm=function(b){function d(f){var h;void 0===f&&(f={});var s=Dr(f,{kind:Zg[f.kind]||""});h=b.call(this,s)||this;var u=!1;return Object.defineProperty(gt(h),"selected",{get:function(){return u},set:function(T){"boolean"!=typeof T||T===u||(u=T,this.trigger("selectedchange"))}}),s.selected&&(h.selected=s.selected),h}return ze(d,b),d}(X_),_h=function(b){function d(f){var h;void 0===f&&(f={}),h=b.call(this)||this;var s,u=new Wf(f);return h.kind=u.kind,h.src=u.src,h.srclang=u.language,h.label=u.label,h.default=u.default,Object.defineProperties(gt(h),{readyState:{get:function(){return s}},track:{get:function(){return u}}}),s=0,u.addEventListener("loadeddata",function(){s=2,h.trigger({type:"load",target:gt(h)})}),h}return ze(d,b),d}(Cs);_h.prototype.allowedEvents_={load:"load"},_h.NONE=0,_h.LOADING=1,_h.LOADED=2,_h.ERROR=3;var $s={audio:{ListClass:Vy,TrackClass:yd,capitalName:"Audio"},video:{ListClass:zf,TrackClass:Tm,capitalName:"Video"},text:{ListClass:q_,TrackClass:Wf,capitalName:"Text"}};Object.keys($s).forEach(function(b){$s[b].getterName=b+"Tracks",$s[b].privateName=b+"Tracks_"});var yh={remoteText:{ListClass:q_,TrackClass:Wf,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Hy,TrackClass:_h,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},ha=Mt({},$s,yh);yh.names=Object.keys(yh),$s.names=Object.keys($s),ha.names=[].concat(yh.names).concat($s.names);var Nr=function(b){function d(h,s){var u;return void 0===h&&(h={}),void 0===s&&(s=function(){}),h.reportTouchActivity=!1,(u=b.call(this,null,h,s)||this).onDurationChange_=function(m){return u.onDurationChange(m)},u.trackProgress_=function(m){return u.trackProgress(m)},u.trackCurrentTime_=function(m){return u.trackCurrentTime(m)},u.stopTrackingCurrentTime_=function(m){return u.stopTrackingCurrentTime(m)},u.disposeSourceHandler_=function(m){return u.disposeSourceHandler(m)},u.queuedHanders_=new Set,u.hasStarted_=!1,u.on("playing",function(){this.hasStarted_=!0}),u.on("loadstart",function(){this.hasStarted_=!1}),ha.names.forEach(function(m){var T=ha[m];h&&h[T.getterName]&&(u[T.privateName]=h[T.getterName])}),u.featuresProgressEvents||u.manualProgressOn(),u.featuresTimeupdateEvents||u.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(m){!1===h["native"+m+"Tracks"]&&(u["featuresNative"+m+"Tracks"]=!1)}),!1===h.nativeCaptions||!1===h.nativeTextTracks?u.featuresNativeTextTracks=!1:(!0===h.nativeCaptions||!0===h.nativeTextTracks)&&(u.featuresNativeTextTracks=!0),u.featuresNativeTextTracks||u.emulateTextTracks(),u.preloadTextTracks=!1!==h.preloadTextTracks,u.autoRemoteTextTracks_=new ha.text.ListClass,u.initTrackListeners(),h.nativeControlsForTouch||u.emitTapEvents(),u.constructor&&(u.name_=u.constructor.name||"Unknown Tech"),u}ze(d,b);var f=d.prototype;return f.triggerSourceset=function(s){var u=this;this.isReady_||this.one("ready",function(){return u.setTimeout(function(){return u.triggerSourceset(s)},1)}),this.trigger({src:s,type:"sourceset"})},f.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)},f.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)},f.trackProgress=function(s){this.stopTrackingProgress(),this.progressInterval=this.setInterval(hr(this,function(){var u=this.bufferedPercent();this.bufferedPercent_!==u&&this.trigger("progress"),this.bufferedPercent_=u,1===u&&this.stopTrackingProgress()}),500)},f.onDurationChange=function(s){this.duration_=this.duration()},f.buffered=function(){return gd(0,0)},f.bufferedPercent=function(){return $a(this.buffered(),this.duration_)},f.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},f.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)},f.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)},f.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},f.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},f.dispose=function(){this.clearTracks($s.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),b.prototype.dispose.call(this)},f.clearTracks=function(s){var u=this;(s=[].concat(s)).forEach(function(m){for(var T=u[m+"Tracks"]()||[],S=T.length;S--;){var D=T[S];"text"===m&&u.removeRemoteTextTrack(D),T.removeTrack(D)}})},f.cleanupAutoTextTracks=function(){for(var s=this.autoRemoteTextTracks_||[],u=s.length;u--;)this.removeRemoteTextTrack(s[u])},f.reset=function(){},f.crossOrigin=function(){},f.setCrossOrigin=function(){},f.error=function(s){return void 0!==s&&(this.error_=new Fs(s),this.trigger("error")),this.error_},f.played=function(){return this.hasStarted_?gd(0,0):gd()},f.play=function(){},f.setScrubbing=function(){},f.scrubbing=function(){},f.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},f.initTrackListeners=function(){var s=this;$s.names.forEach(function(u){var T=function(){s.trigger(u+"trackchange")},S=s[$s[u].getterName]();S.addEventListener("removetrack",T),S.addEventListener("addtrack",T),s.on("dispose",function(){S.removeEventListener("removetrack",T),S.removeEventListener("addtrack",T)})})},f.addWebVttScript_=function(){var s=this;if(!se().WebVTT)if(Oe().body.contains(this.el())){if(!this.options_["vtt.js"]&&cu(cs())&&Object.keys(cs()).length>0)return void this.trigger("vttjsloaded");var u=Oe().createElement("script");u.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",u.onload=function(){s.trigger("vttjsloaded")},u.onerror=function(){s.trigger("vttjserror")},this.on("dispose",function(){u.onload=null,u.onerror=null}),se().WebVTT=!0,this.el().parentNode.appendChild(u)}else this.ready(this.addWebVttScript_)},f.emulateTextTracks=function(){var s=this,u=this.textTracks(),m=this.remoteTextTracks(),T=function(H){return u.addTrack(H.track)},S=function(H){return u.removeTrack(H.track)};m.on("addtrack",T),m.on("removetrack",S),this.addWebVttScript_();var D=function(){return s.trigger("texttrackchange")},P=function(){D();for(var H=0;H<u.length;H++){var te=u[H];te.removeEventListener("cuechange",D),"showing"===te.mode&&te.addEventListener("cuechange",D)}};P(),u.addEventListener("change",P),u.addEventListener("addtrack",P),u.addEventListener("removetrack",P),this.on("dispose",function(){m.off("addtrack",T),m.off("removetrack",S),u.removeEventListener("change",P),u.removeEventListener("addtrack",P),u.removeEventListener("removetrack",P);for(var W=0;W<u.length;W++)u[W].removeEventListener("cuechange",D)})},f.addTextTrack=function(s,u,m){if(!s)throw new Error("TextTrack kind is required but was not provided");return function nv(b,d,f,h,s){void 0===s&&(s={});var u=b.textTracks();s.kind=d,f&&(s.label=f),h&&(s.language=h),s.tech=b;var m=new ha.text.TrackClass(s);return u.addTrack(m),m}(this,s,u,m)},f.createRemoteTextTrack=function(s){var u=Dr(s,{tech:this});return new yh.remoteTextEl.TrackClass(u)},f.addRemoteTextTrack=function(s,u){var m=this;void 0===s&&(s={});var T=this.createRemoteTextTrack(s);return!0!==u&&!1!==u&&(Kt.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),u=!0),this.remoteTextTrackEls().addTrackElement_(T),this.remoteTextTracks().addTrack(T.track),!0!==u&&this.ready(function(){return m.autoRemoteTextTracks_.addTrack(T.track)}),T},f.removeRemoteTextTrack=function(s){var u=this.remoteTextTrackEls().getTrackElementByTrack_(s);this.remoteTextTrackEls().removeTrackElement_(u),this.remoteTextTracks().removeTrack(s),this.autoRemoteTextTracks_.removeTrack(s)},f.getVideoPlaybackQuality=function(){return{}},f.requestPictureInPicture=function(){var s=this.options_.Promise||se().Promise;if(s)return s.reject()},f.disablePictureInPicture=function(){return!0},f.setDisablePictureInPicture=function(){},f.requestVideoFrameCallback=function(s){var u=this,m=ro();return!this.isReady_||this.paused()?(this.queuedHanders_.add(m),this.one("playing",function(){u.queuedHanders_.has(m)&&(u.queuedHanders_.delete(m),s())})):this.requestNamedAnimationFrame(m,s),m},f.cancelVideoFrameCallback=function(s){this.queuedHanders_.has(s)?this.queuedHanders_.delete(s):this.cancelNamedAnimationFrame(s)},f.setPoster=function(){},f.playsinline=function(){},f.setPlaysinline=function(){},f.overrideNativeAudioTracks=function(){},f.overrideNativeVideoTracks=function(){},f.canPlayType=function(){return""},d.canPlayType=function(){return""},d.canPlaySource=function(s,u){return d.canPlayType(s.type)},d.isTech=function(s){return s.prototype instanceof d||s instanceof d||s===d},d.registerTech=function(s,u){if(d.techs_||(d.techs_={}),!d.isTech(u))throw new Error("Tech "+s+" must be a Tech");if(!d.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!d.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return s=Rr(s),d.techs_[s]=u,d.techs_[Ul(s)]=u,"Tech"!==s&&d.defaultTechOrder_.push(s),u},d.getTech=function(s){if(s){if(d.techs_&&d.techs_[s])return d.techs_[s];if(s=Rr(s),se()&&se().videojs&&se().videojs[s])return Kt.warn("The "+s+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),se().videojs[s]}},d}(Rt);ha.names.forEach(function(b){var d=ha[b];Nr.prototype[d.getterName]=function(){return this[d.privateName]=this[d.privateName]||new d.ListClass,this[d.privateName]}}),Nr.prototype.featuresVolumeControl=!0,Nr.prototype.featuresMuteControl=!0,Nr.prototype.featuresFullscreenResize=!1,Nr.prototype.featuresPlaybackRate=!1,Nr.prototype.featuresProgressEvents=!1,Nr.prototype.featuresSourceset=!1,Nr.prototype.featuresTimeupdateEvents=!1,Nr.prototype.featuresNativeTextTracks=!1,Nr.prototype.featuresVideoFrameCallback=!1,Nr.withSourceHandlers=function(b){b.registerSourceHandler=function(f,h){var s=b.sourceHandlers;s||(s=b.sourceHandlers=[]),void 0===h&&(h=s.length),s.splice(h,0,f)},b.canPlayType=function(f){for(var s,h=b.sourceHandlers||[],u=0;u<h.length;u++)if(s=h[u].canPlayType(f))return s;return""},b.selectSourceHandler=function(f,h){for(var s=b.sourceHandlers||[],m=0;m<s.length;m++)if(s[m].canHandleSource(f,h))return s[m];return null},b.canPlaySource=function(f,h){var s=b.selectSourceHandler(f,h);return s?s.canHandleSource(f,h):""},["seekable","seeking","duration"].forEach(function(f){var h=this[f];"function"==typeof h&&(this[f]=function(){return this.sourceHandler_&&this.sourceHandler_[f]?this.sourceHandler_[f].apply(this.sourceHandler_,arguments):h.apply(this,arguments)})},b.prototype),b.prototype.setSource=function(f){var h=b.selectSourceHandler(f,this.options_);h||(b.nativeSourceHandler?h=b.nativeSourceHandler:Kt.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),h!==b.nativeSourceHandler&&(this.currentSource_=f),this.sourceHandler_=h.handleSource(f,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},b.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Rt.registerComponent("Tech",Nr),Nr.registerTech("Tech",Nr),Nr.defaultTechOrder_=[];var gu={},bh={},wm={};function Z_(b,d,f){b.setTimeout(function(){return Yu(d,gu[d.type],f,b)},1)}function qf(b,d,f,h){void 0===h&&(h=null);var s="call"+Rr(f),u=b.reduce(Am(s),h),m=u===wm,T=m?null:d[f](u);return function Th(b,d,f,h){for(var s=b.length-1;s>=0;s--){var u=b[s];u[d]&&u[d](h,f)}}(b,f,T,m),T}var Xf={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},$y={setCurrentTime:1,setMuted:1,setVolume:1},iv={play:1,pause:1};function Am(b){return function(d,f){return d===wm?wm:f[b]?f[b](d):d}}function Yu(b,d,f,h,s,u){void 0===b&&(b={}),void 0===d&&(d=[]),void 0===s&&(s=[]),void 0===u&&(u=!1);var T=d[0],S=d.slice(1);if("string"==typeof T)Yu(b,gu[T],f,h,s,u);else if(T){var D=function qa(b,d){var f=bh[b.id()],h=null;if(null==f)return h=d(b),bh[b.id()]=[[d,h]],h;for(var s=0;s<f.length;s++){var u=f[s];u[0]===d&&(h=u[1])}return null===h&&(h=d(b),f.push([d,h])),h}(h,T);if(!D.setSource)return s.push(D),Yu(b,S,f,h,s,u);D.setSource(zr({},b),function(P,W){if(P)return Yu(b,S,f,h,s,u);s.push(D),Yu(W,b.type===W.type?S:gu[W.type],f,h,s,u)})}else S.length?Yu(b,S,f,h,s,u):u?f(b,s):Yu(b,gu["*"],f,h,s,!0)}var Xy={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Yf=function(d){void 0===d&&(d="");var f=bm(d);return Xy[f.toLowerCase()]||""},wh=function b(d){if(Array.isArray(d)){var f=[];d.forEach(function(h){h=b(h),Array.isArray(h)?f=f.concat(h):Es(h)&&f.push(h)}),d=f}else d="string"==typeof d&&d.trim()?[Td({src:d})]:Es(d)&&"string"==typeof d.src&&d.src&&d.src.trim()?[Td(d)]:[];return d};function Td(b){if(!b.type){var d=Yf(b.src);d&&(b.type=d)}return b}var Ah=function(b){function d(f,h,s){var u,m=Dr({createEl:!1},h);if(u=b.call(this,f,m,s)||this,h.playerOptions.sources&&0!==h.playerOptions.sources.length)f.src(h.playerOptions.sources);else for(var T=0,S=h.playerOptions.techOrder;T<S.length;T++){var D=Rr(S[T]),P=Nr.getTech(D);if(D||(P=Rt.getComponent(D)),P&&P.isSupported()){f.loadTech_(D);break}}return u}return ze(d,b),d}(Rt);Rt.registerComponent("MediaLoader",Ah);var Qf=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).options_.controlText&&u.controlText(u.options_.controlText),u.handleMouseOver_=function(m){return u.handleMouseOver(m)},u.handleMouseOut_=function(m){return u.handleMouseOut(m)},u.handleClick_=function(m){return u.handleClick(m)},u.handleKeyDown_=function(m){return u.handleKeyDown(m)},u.emitTapEvents(),u.enable(),u}ze(d,b);var f=d.prototype;return f.createEl=function(s,u,m){void 0===s&&(s="div"),void 0===u&&(u={}),void 0===m&&(m={}),u=zr({className:this.buildCSSClass(),tabIndex:0},u),"button"===s&&Kt.error("Creating a ClickableComponent with an HTML element of "+s+" is not supported; use a Button instead."),m=zr({role:"button"},m),this.tabIndex_=u.tabIndex;var T=$i(s,u,m);return T.appendChild($i("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(T),T},f.dispose=function(){this.controlTextEl_=null,b.prototype.dispose.call(this)},f.createControlTextEl=function(s){return this.controlTextEl_=$i("span",{className:"vjs-control-text"},{"aria-live":"polite"}),s&&s.appendChild(this.controlTextEl_),this.controlText(this.controlText_,s),this.controlTextEl_},f.controlText=function(s,u){if(void 0===u&&(u=this.el()),void 0===s)return this.controlText_||"Need Text";var m=this.localize(s);this.controlText_=s,Dc(this.controlTextEl_,m),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&u.setAttribute("title",m)},f.buildCSSClass=function(){return"vjs-control vjs-button "+b.prototype.buildCSSClass.call(this)},f.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))},f.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)},f.handleLanguagechange=function(){this.controlText(this.controlText_)},f.handleClick=function(s){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},f.handleKeyDown=function(s){yt().isEventKey(s,"Space")||yt().isEventKey(s,"Enter")?(s.preventDefault(),s.stopPropagation(),this.trigger("click")):b.prototype.handleKeyDown.call(this,s)},d}(Rt);Rt.registerComponent("ClickableComponent",Qf);var rv=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).update(),u.update_=function(m){return u.update(m)},h.on("posterchange",u.update_),u}ze(d,b);var f=d.prototype;return f.dispose=function(){this.player().off("posterchange",this.update_),b.prototype.dispose.call(this)},f.createEl=function(){return $i("div",{className:"vjs-poster",tabIndex:-1})},f.update=function(s){var u=this.player().poster();this.setSrc(u),u?this.show():this.hide()},f.setSrc=function(s){var u="";s&&(u='url("'+s+'")'),this.el_.style.backgroundImage=u},f.handleClick=function(s){if(this.player_.controls()){var u=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;this.player_.tech(!0)&&!((uh||kf)&&u)&&this.player_.tech(!0).focus(),this.player_.paused()?pu(this.player_.play()):this.player_.pause()}},d}(Qf);Rt.registerComponent("PosterImage",rv);var Oa="#222",Qy={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function En(b,d){var f;if(4===b.length)f=b[1]+b[1]+b[2]+b[2]+b[3]+b[3];else{if(7!==b.length)throw new Error("Invalid color code provided, "+b+"; must be formatted as e.g. #f0e or #f604e2.");f=b.slice(1)}return"rgba("+parseInt(f.slice(0,2),16)+","+parseInt(f.slice(2,4),16)+","+parseInt(f.slice(4,6),16)+","+d+")"}function t0(b,d,f){try{b.style[d]=f}catch{return}}var oT=function(b){function d(h,s,u){var m;m=b.call(this,h,s,u)||this;var T=function(D){return m.updateDisplay(D)};return h.on("loadstart",function(S){return m.toggleDisplay(S)}),h.on("texttrackchange",T),h.on("loadedmetadata",function(S){return m.preselectTrack(S)}),h.ready(hr(gt(m),function(){if(h.tech_&&h.tech_.featuresNativeTextTracks)this.hide();else{h.on("fullscreenchange",T),h.on("playerresize",T),se().addEventListener("orientationchange",T),h.on("dispose",function(){return se().removeEventListener("orientationchange",T)});for(var S=this.options_.playerOptions.tracks||[],D=0;D<S.length;D++)this.player_.addRemoteTextTrack(S[D],!0);this.preselectTrack()}})),m}ze(d,b);var f=d.prototype;return f.preselectTrack=function(){for(var T,S,D,s={captions:1,subtitles:1},u=this.player_.textTracks(),m=this.player_.cache_.selectedLanguage,P=0;P<u.length;P++){var W=u[P];m&&m.enabled&&m.language&&m.language===W.language&&W.kind in s?W.kind===m.kind?D=W:D||(D=W):m&&!m.enabled?(D=null,T=null,S=null):W.default&&("descriptions"!==W.kind||T?W.kind in s&&!S&&(S=W):T=W)}D?D.mode="showing":S?S.mode="showing":T&&(T.mode="showing")},f.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})},f.clearDisplay=function(){"function"==typeof se().WebVTT&&se().WebVTT.processCues(se(),[],this.el_)},f.updateDisplay=function(){var s=this.player_.textTracks(),u=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),u){for(var m=[],T=0;T<s.length;++T){var S=s[T];"showing"===S.mode&&m.push(S)}this.updateForTrack(m)}else{for(var D=null,P=null,W=s.length;W--;){var H=s[W];"showing"===H.mode&&("descriptions"===H.kind?D=H:P=H)}P?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(P)):D&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(D))}},f.updateDisplayState=function(s){for(var u=this.player_.textTrackSettings.getValues(),m=s.activeCues,T=m.length;T--;){var S=m[T];if(S){var D=S.displayState;if(u.color&&(D.firstChild.style.color=u.color),u.textOpacity&&t0(D.firstChild,"color",En(u.color||"#fff",u.textOpacity)),u.backgroundColor&&(D.firstChild.style.backgroundColor=u.backgroundColor),u.backgroundOpacity&&t0(D.firstChild,"backgroundColor",En(u.backgroundColor||"#000",u.backgroundOpacity)),u.windowColor&&(u.windowOpacity?t0(D,"backgroundColor",En(u.windowColor,u.windowOpacity)):D.style.backgroundColor=u.windowColor),u.edgeStyle&&("dropshadow"===u.edgeStyle?D.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+Oa:"raised"===u.edgeStyle?D.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+Oa:"depressed"===u.edgeStyle?D.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+Oa:"uniform"===u.edgeStyle&&(D.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+Oa)),u.fontPercent&&1!==u.fontPercent){var P=se().parseFloat(D.style.fontSize);D.style.fontSize=P*u.fontPercent+"px",D.style.height="auto",D.style.top="auto"}u.fontFamily&&"default"!==u.fontFamily&&("small-caps"===u.fontFamily?D.firstChild.style.fontVariant="small-caps":D.firstChild.style.fontFamily=Qy[u.fontFamily])}}},f.updateForTrack=function(s){if(Array.isArray(s)||(s=[s]),"function"==typeof se().WebVTT&&!s.every(function(te){return!te.activeCues})){for(var u=[],m=0;m<s.length;++m)for(var T=s[m],S=0;S<T.activeCues.length;++S)u.push(T.activeCues[S]);se().WebVTT.processCues(se(),u,this.el_);for(var D=0;D<s.length;++D){for(var P=s[D],W=0;W<P.activeCues.length;++W){var H=P.activeCues[W].displayState;hs(H,"vjs-text-track-cue"),hs(H,"vjs-text-track-cue-"+(P.language?P.language:D)),P.language&&dd(H,"lang",P.language)}this.player_.textTrackSettings&&this.updateDisplayState(P)}}},d}(Rt);Rt.registerComponent("TextTrackDisplay",oT);var lT=function(b){function d(){return b.apply(this,arguments)||this}return ze(d,b),d.prototype.createEl=function(){var s=this.player_.isAudio(),u=this.localize(s?"Audio Player":"Video Player"),m=$i("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[u])}),T=b.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return T.appendChild(m),T},d}(Rt);Rt.registerComponent("LoadingSpinner",lT);var vu=function(b){function d(){return b.apply(this,arguments)||this}ze(d,b);var f=d.prototype;return f.createEl=function(s,u,m){void 0===u&&(u={}),void 0===m&&(m={});var T=$i("button",u=zr({className:this.buildCSSClass()},u),m=zr({type:"button"},m));return T.appendChild($i("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(T),T},f.addChild=function(s,u){return void 0===u&&(u={}),Kt.warn("Adding an actionable (user controllable) child to a Button ("+this.constructor.name+") is not supported; use a ClickableComponent instead."),Rt.prototype.addChild.call(this,s,u)},f.enable=function(){b.prototype.enable.call(this),this.el_.removeAttribute("disabled")},f.disable=function(){b.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},f.handleKeyDown=function(s){yt().isEventKey(s,"Space")||yt().isEventKey(s,"Enter")?s.stopPropagation():b.prototype.handleKeyDown.call(this,s)},d}(Qf);Rt.registerComponent("Button",vu);var Ky=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).mouseused_=!1,u.on("mousedown",function(m){return u.handleMouseDown(m)}),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-big-play-button"},f.handleClick=function(s){var u=this.player_.play();if(this.mouseused_&&s.clientX&&s.clientY){var m=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;return pu(u),void(this.player_.tech(!0)&&(!uh&&!kf||!m)&&this.player_.tech(!0).focus())}var T=this.player_.getChild("controlBar"),S=T&&T.getChild("playToggle");if(S){var D=function(){return S.focus()};jf(u)?u.then(D,function(){}):this.setTimeout(D,1)}else this.player_.tech(!0).focus()},f.handleKeyDown=function(s){this.mouseused_=!1,b.prototype.handleKeyDown.call(this,s)},f.handleMouseDown=function(s){this.mouseused_=!0},d}(vu);Ky.prototype.controlText_="Play Video",Rt.registerComponent("BigPlayButton",Ky);var uT=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).controlText(s&&s.controlText||u.localize("Close")),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-close-button "+b.prototype.buildCSSClass.call(this)},f.handleClick=function(s){this.trigger({type:"close",bubbles:!1})},f.handleKeyDown=function(s){yt().isEventKey(s,"Esc")?(s.preventDefault(),s.stopPropagation(),this.trigger("click")):b.prototype.handleKeyDown.call(this,s)},d}(vu);Rt.registerComponent("CloseButton",uT);var Zy=function(b){function d(h,s){var u;return void 0===s&&(s={}),u=b.call(this,h,s)||this,s.replay=void 0===s.replay||s.replay,u.on(h,"play",function(m){return u.handlePlay(m)}),u.on(h,"pause",function(m){return u.handlePause(m)}),s.replay&&u.on(h,"ended",function(m){return u.handleEnded(m)}),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-play-control "+b.prototype.buildCSSClass.call(this)},f.handleClick=function(s){this.player_.paused()?pu(this.player_.play()):this.player_.pause()},f.handleSeeked=function(s){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(s):this.handlePlay(s)},f.handlePlay=function(s){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},f.handlePause=function(s){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},f.handleEnded=function(s){var u=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",function(m){return u.handleSeeked(m)})},d}(vu);Zy.prototype.controlText_="Play",Rt.registerComponent("PlayToggle",Zy);var xh=function(d,f){d=d<0?0:d;var h=Math.floor(d%60),s=Math.floor(d/60%60),u=Math.floor(d/3600),m=Math.floor(f/60%60),T=Math.floor(f/3600);return(isNaN(d)||d===1/0)&&(u=s=h="-"),(u=u>0||T>0?u+":":"")+(s=((u||m>=10)&&s<10?"0"+s:s)+":")+(h<10?"0"+h:h)},n0=xh;function Oc(b,d){return void 0===d&&(d=b),n0(b,d)}var _u=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).on(h,["timeupdate","ended"],function(m){return u.updateContent(m)}),u.updateTextNode_(),u}ze(d,b);var f=d.prototype;return f.createEl=function(){var s=this.buildCSSClass(),u=b.prototype.createEl.call(this,"div",{className:s+" vjs-time-control vjs-control"}),m=$i("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+"\xa0"},{role:"presentation"});return u.appendChild(m),this.contentEl_=$i("span",{className:s+"-display"},{"aria-live":"off",role:"presentation"}),u.appendChild(this.contentEl_),u},f.dispose=function(){this.contentEl_=null,this.textNode_=null,b.prototype.dispose.call(this)},f.updateTextNode_=function(s){var u=this;void 0===s&&(s=0),s=Oc(s),this.formattedTime_!==s&&(this.formattedTime_=s,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(u.contentEl_){var m=u.textNode_;m&&u.contentEl_.firstChild!==m&&(m=null,Kt.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),u.textNode_=Oe().createTextNode(u.formattedTime_),u.textNode_&&(m?u.contentEl_.replaceChild(u.textNode_,m):u.contentEl_.appendChild(u.textNode_))}}))},f.updateContent=function(s){},d}(Rt);_u.prototype.labelText_="Time",_u.prototype.controlText_="Time",Rt.registerComponent("TimeDisplay",_u);var r0=function(b){function d(){return b.apply(this,arguments)||this}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-current-time"},f.updateContent=function(s){var u;u=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(u)},d}(_u);r0.prototype.labelText_="Current Time",r0.prototype.controlText_="Current Time",Rt.registerComponent("CurrentTimeDisplay",r0);var sv=function(b){function d(h,s){var u,m=function(S){return u.updateContent(S)};return(u=b.call(this,h,s)||this).on(h,"durationchange",m),u.on(h,"loadstart",m),u.on(h,"loadedmetadata",m),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-duration"},f.updateContent=function(s){var u=this.player_.duration();this.updateTextNode_(u)},d}(_u);sv.prototype.labelText_="Duration",sv.prototype.controlText_="Duration",Rt.registerComponent("DurationDisplay",sv);var qo=function(b){function d(){return b.apply(this,arguments)||this}return ze(d,b),d.prototype.createEl=function(){var s=b.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),u=b.prototype.createEl.call(this,"div"),m=b.prototype.createEl.call(this,"span",{textContent:"/"});return u.appendChild(m),s.appendChild(u),s},d}(Rt);Rt.registerComponent("TimeDivider",qo);var Vl=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).on(h,"durationchange",function(m){return u.updateContent(m)}),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-remaining-time"},f.createEl=function(){var s=b.prototype.createEl.call(this);return!1!==this.options_.displayNegative&&s.insertBefore($i("span",{},{"aria-hidden":!0},"-"),this.contentEl_),s},f.updateContent=function(s){var u;"number"==typeof this.player_.duration()&&(u=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(u))},d}(_u);Vl.prototype.labelText_="Remaining Time",Vl.prototype.controlText_="Remaining Time",Rt.registerComponent("RemainingTimeDisplay",Vl);var s0=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).updateShowing(),u.on(u.player(),"durationchange",function(m){return u.updateShowing(m)}),u}ze(d,b);var f=d.prototype;return f.createEl=function(){var s=b.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=$i("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild($i("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+"\xa0"})),this.contentEl_.appendChild(Oe().createTextNode(this.localize("LIVE"))),s.appendChild(this.contentEl_),s},f.dispose=function(){this.contentEl_=null,b.prototype.dispose.call(this)},f.updateShowing=function(s){this.player().duration()===1/0?this.show():this.hide()},d}(Rt);Rt.registerComponent("LiveDisplay",s0);var Kf=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).updateLiveEdgeStatus(),u.player_.liveTracker&&(u.updateLiveEdgeStatusHandler_=function(m){return u.updateLiveEdgeStatus(m)},u.on(u.player_.liveTracker,"liveedgechange",u.updateLiveEdgeStatusHandler_)),u}ze(d,b);var f=d.prototype;return f.createEl=function(){var s=b.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=$i("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),s.appendChild(this.textEl_),s},f.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},f.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},f.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,b.prototype.dispose.call(this)},d}(vu);Kf.prototype.controlText_="Seek to live, currently playing live",Rt.registerComponent("SeekToLive",Kf);var Lc=function(d,f,h){return d=Number(d),Math.min(h,Math.max(f,isNaN(d)?f:d))},xm=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).handleMouseDown_=function(m){return u.handleMouseDown(m)},u.handleMouseUp_=function(m){return u.handleMouseUp(m)},u.handleKeyDown_=function(m){return u.handleKeyDown(m)},u.handleClick_=function(m){return u.handleClick(m)},u.handleMouseMove_=function(m){return u.handleMouseMove(m)},u.update_=function(m){return u.update(m)},u.bar=u.getChild(u.options_.barName),u.vertical(!!u.options_.vertical),u.enable(),u}ze(d,b);var f=d.prototype;return f.enabled=function(){return this.enabled_},f.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},f.disable=function(){if(this.enabled()){var s=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(s,"mousemove",this.handleMouseMove_),this.off(s,"mouseup",this.handleMouseUp_),this.off(s,"touchmove",this.handleMouseMove_),this.off(s,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},f.createEl=function(s,u,m){return void 0===u&&(u={}),void 0===m&&(m={}),u.className=u.className+" vjs-slider",u=zr({tabIndex:0},u),m=zr({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},m),b.prototype.createEl.call(this,s,u,m)},f.handleMouseDown=function(s){var u=this.bar.el_.ownerDocument;"mousedown"===s.type&&s.preventDefault(),"touchstart"===s.type&&!Gu&&s.preventDefault(),_i(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(u,"mousemove",this.handleMouseMove_),this.on(u,"mouseup",this.handleMouseUp_),this.on(u,"touchmove",this.handleMouseMove_),this.on(u,"touchend",this.handleMouseUp_),this.handleMouseMove(s,!0)},f.handleMouseMove=function(s){},f.handleMouseUp=function(){var s=this.bar.el_.ownerDocument;Pa(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(s,"mousemove",this.handleMouseMove_),this.off(s,"mouseup",this.handleMouseUp_),this.off(s,"touchmove",this.handleMouseMove_),this.off(s,"touchend",this.handleMouseUp_),this.update()},f.update=function(){var s=this;if(this.el_&&this.bar){var u=this.getProgress();return u===this.progress_||(this.progress_=u,this.requestNamedAnimationFrame("Slider#update",function(){var m=s.vertical()?"height":"width";s.bar.el().style[m]=(100*u).toFixed(2)+"%"})),u}},f.getProgress=function(){return Number(Lc(this.getPercent(),0,1).toFixed(4))},f.calculateDistance=function(s){var u=Ii(this.el_,s);return this.vertical()?u.y:u.x},f.handleKeyDown=function(s){yt().isEventKey(s,"Left")||yt().isEventKey(s,"Down")?(s.preventDefault(),s.stopPropagation(),this.stepBack()):yt().isEventKey(s,"Right")||yt().isEventKey(s,"Up")?(s.preventDefault(),s.stopPropagation(),this.stepForward()):b.prototype.handleKeyDown.call(this,s)},f.handleClick=function(s){s.stopPropagation(),s.preventDefault()},f.vertical=function(s){if(void 0===s)return this.vertical_||!1;this.vertical_=!!s,this.addClass(this.vertical_?"vjs-slider-vertical":"vjs-slider-horizontal")},d}(Rt);Rt.registerComponent("Slider",xm);var av=function(d,f){return Lc(d/f*100,0,100).toFixed(2)+"%"},Jy=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).partEls_=[],u.on(h,"progress",function(m){return u.update(m)}),u}ze(d,b);var f=d.prototype;return f.createEl=function(){var s=b.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),u=$i("span",{className:"vjs-control-text"}),m=$i("span",{textContent:this.localize("Loaded")}),T=Oe().createTextNode(": ");return this.percentageEl_=$i("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),s.appendChild(u),u.appendChild(m),u.appendChild(T),u.appendChild(this.percentageEl_),s},f.dispose=function(){this.partEls_=null,this.percentageEl_=null,b.prototype.dispose.call(this)},f.update=function(s){var u=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var m=u.player_.liveTracker,T=u.player_.buffered(),S=m&&m.isLive()?m.seekableEnd():u.player_.duration(),D=u.player_.bufferedEnd(),P=u.partEls_,W=av(D,S);u.percent_!==W&&(u.el_.style.width=W,Dc(u.percentageEl_,W),u.percent_=W);for(var H=0;H<T.length;H++){var te=T.start(H),le=T.end(H),ce=P[H];ce||(ce=u.el_.appendChild($i()),P[H]=ce),(ce.dataset.start!==te||ce.dataset.end!==le)&&(ce.dataset.start=te,ce.dataset.end=le,ce.style.left=av(te,D),ce.style.width=av(le-te,D))}for(var fe=P.length;fe>T.length;fe--)u.el_.removeChild(P[fe-1]);P.length=T.length})},d}(Rt);Rt.registerComponent("LoadProgressBar",Jy);var dT=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).update=zs(hr(gt(u),u.update),30),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},f.update=function(s,u,m){var T=da(this.el_),S=wr(this.player_.el()),D=s.width*u;if(S&&T){var P=s.left-S.left+D,W=s.width-D+(S.right-s.right),H=T.width/2;P<H?H+=H-P:W<H&&(H=W),H<0?H=0:H>T.width&&(H=T.width),H=Math.round(H),this.el_.style.right="-"+H+"px",this.write(m)}},f.write=function(s){Dc(this.el_,s)},f.updateTime=function(s,u,m,T){var S=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var D,P=S.player_.duration();if(S.player_.liveTracker&&S.player_.liveTracker.isLive()){var W=S.player_.liveTracker.liveWindow(),H=W-u*W;D=(H<1?"":"-")+Oc(H,W)}else D=Oc(m,P);S.update(s,u,D),T&&T()})},d}(Rt);Rt.registerComponent("TimeTooltip",dT);var a0=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).update=zs(hr(gt(u),u.update),30),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},f.update=function(s,u){var m=this.getChild("timeTooltip");if(m){var T=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();m.updateTime(s,u,T)}},d}(Rt);a0.prototype.options_={children:[]},!Ao&&!ca&&a0.prototype.options_.children.push("timeTooltip"),Rt.registerComponent("PlayProgressBar",a0);var ov=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).update=zs(hr(gt(u),u.update),30),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},f.update=function(s,u){var m=this,T=u*this.player_.duration();this.getChild("timeTooltip").updateTime(s,u,T,function(){m.el_.style.left=s.width*u+"px"})},d}(Rt);ov.prototype.options_={children:["timeTooltip"]},Rt.registerComponent("MouseTimeDisplay",ov);var kc=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).setEventHandlers_(),u}ze(d,b);var f=d.prototype;return f.setEventHandlers_=function(){var s=this;this.update_=hr(this,this.update),this.update=zs(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(u){return s.enableInterval_(u)},this.disableIntervalHandler_=function(u){return s.disableInterval_(u)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Oe()&&"visibilityState"in Oe()&&this.on(Oe(),"visibilitychange",this.toggleVisibility_)},f.toggleVisibility_=function(s){"hidden"===Oe().visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(s)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())},f.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))},f.disableInterval_=function(s){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&s&&"ended"!==s.type||!this.updateInterval||(this.clearInterval(this.updateInterval),this.updateInterval=null)},f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},f.update=function(s){var u=this;if("hidden"!==Oe().visibilityState){var m=b.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var T=u.player_.ended()?u.player_.duration():u.getCurrentTime_(),S=u.player_.liveTracker,D=u.player_.duration();S&&S.isLive()&&(D=u.player_.liveTracker.liveCurrentTime()),u.percent_!==m&&(u.el_.setAttribute("aria-valuenow",(100*m).toFixed(2)),u.percent_=m),(u.currentTime_!==T||u.duration_!==D)&&(u.el_.setAttribute("aria-valuetext",u.localize("progress bar timing: currentTime={1} duration={2}",[Oc(T,D),Oc(D,D)],"{1} of {2}")),u.currentTime_=T,u.duration_=D),u.bar&&u.bar.update(wr(u.el()),u.getProgress())}),m}},f.userSeek_=function(s){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(s)},f.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},f.getPercent=function(){var u,s=this.getCurrentTime_(),m=this.player_.liveTracker;return m&&m.isLive()?(u=(s-m.seekableStart())/m.liveWindow(),m.atLiveEdge()&&(u=1)):u=s/this.player_.duration(),u},f.handleMouseDown=function(s){!fd(s)||(s.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),b.prototype.handleMouseDown.call(this,s))},f.handleMouseMove=function(s,u){if(void 0===u&&(u=!1),fd(s)){!u&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);var m,T=this.calculateDistance(s),S=this.player_.liveTracker;if(S&&S.isLive()){if(T>=.99)return void S.seekToLiveEdge();var D=S.seekableStart(),P=S.liveCurrentTime();if((m=D+T*S.liveWindow())>=P&&(m=P),m<=D&&(m=D+.1),m===1/0)return}else(m=T*this.player_.duration())===this.player_.duration()&&(m-=.1);this.userSeek_(m)}},f.enable=function(){b.prototype.enable.call(this);var s=this.getChild("mouseTimeDisplay");!s||s.show()},f.disable=function(){b.prototype.disable.call(this);var s=this.getChild("mouseTimeDisplay");!s||s.hide()},f.handleMouseUp=function(s){b.prototype.handleMouseUp.call(this,s),s&&s.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?pu(this.player_.play()):this.update_()},f.stepForward=function(){this.userSeek_(this.player_.currentTime()+5)},f.stepBack=function(){this.userSeek_(this.player_.currentTime()-5)},f.handleAction=function(s){this.player_.paused()?this.player_.play():this.player_.pause()},f.handleKeyDown=function(s){var u=this.player_.liveTracker;if(yt().isEventKey(s,"Space")||yt().isEventKey(s,"Enter"))s.preventDefault(),s.stopPropagation(),this.handleAction(s);else if(yt().isEventKey(s,"Home"))s.preventDefault(),s.stopPropagation(),this.userSeek_(0);else if(yt().isEventKey(s,"End"))s.preventDefault(),s.stopPropagation(),u&&u.isLive()?this.userSeek_(u.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(yt()(s))){s.preventDefault(),s.stopPropagation();var m=10*(yt().codes[yt()(s)]-yt().codes[0])/100;u&&u.isLive()?this.userSeek_(u.seekableStart()+u.liveWindow()*m):this.userSeek_(this.player_.duration()*m)}else yt().isEventKey(s,"PgDn")?(s.preventDefault(),s.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):yt().isEventKey(s,"PgUp")?(s.preventDefault(),s.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):b.prototype.handleKeyDown.call(this,s)},f.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Oe()&&"visibilityState"in Oe()&&this.off(Oe(),"visibilitychange",this.toggleVisibility_),b.prototype.dispose.call(this)},d}(xm);kc.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},!Ao&&!ca&&kc.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Rt.registerComponent("SeekBar",kc);var eb=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).handleMouseMove=zs(hr(gt(u),u.handleMouseMove),30),u.throttledHandleMouseSeek=zs(hr(gt(u),u.handleMouseSeek),30),u.handleMouseUpHandler_=function(m){return u.handleMouseUp(m)},u.handleMouseDownHandler_=function(m){return u.handleMouseDown(m)},u.enable(),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},f.handleMouseMove=function(s){var u=this.getChild("seekBar");if(u){var m=u.getChild("playProgressBar"),T=u.getChild("mouseTimeDisplay");if(m||T){var S=u.el(),D=da(S),P=Ii(S,s).x;P=Lc(P,0,1),T&&T.update(D,P),m&&m.update(D,u.getProgress())}}},f.handleMouseSeek=function(s){var u=this.getChild("seekBar");u&&u.handleMouseMove(s)},f.enabled=function(){return this.enabled_},f.disable=function(){if(this.children().forEach(function(u){return u.disable&&u.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var s=this.getChild("seekBar");this.player_.scrubbing(!1),s.videoWasPlaying&&pu(this.player_.play())}},f.enable=function(){this.children().forEach(function(s){return s.enable&&s.enable()}),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},f.removeListenersAddedOnMousedownAndTouchstart=function(){var s=this.el_.ownerDocument;this.off(s,"mousemove",this.throttledHandleMouseSeek),this.off(s,"touchmove",this.throttledHandleMouseSeek),this.off(s,"mouseup",this.handleMouseUpHandler_),this.off(s,"touchend",this.handleMouseUpHandler_)},f.handleMouseDown=function(s){var u=this.el_.ownerDocument,m=this.getChild("seekBar");m&&m.handleMouseDown(s),this.on(u,"mousemove",this.throttledHandleMouseSeek),this.on(u,"touchmove",this.throttledHandleMouseSeek),this.on(u,"mouseup",this.handleMouseUpHandler_),this.on(u,"touchend",this.handleMouseUpHandler_)},f.handleMouseUp=function(s){var u=this.getChild("seekBar");u&&u.handleMouseUp(s),this.removeListenersAddedOnMousedownAndTouchstart()},d}(Rt);eb.prototype.options_={children:["seekBar"]},Rt.registerComponent("ProgressControl",eb);var lv=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).on(h,["enterpictureinpicture","leavepictureinpicture"],function(m){return u.handlePictureInPictureChange(m)}),u.on(h,["disablepictureinpicturechanged","loadedmetadata"],function(m){return u.handlePictureInPictureEnabledChange(m)}),u.on(h,["loadedmetadata","audioonlymodechange","audiopostermodechange"],function(){"audio"===h.currentType().substring(0,5)||h.audioPosterMode()||h.audioOnlyMode()?(h.isInPictureInPicture()&&h.exitPictureInPicture(),u.hide()):u.show()}),u.disable(),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-picture-in-picture-control "+b.prototype.buildCSSClass.call(this)},f.handlePictureInPictureEnabledChange=function(){Oe().pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()?this.enable():this.disable()},f.handlePictureInPictureChange=function(s){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},f.handleClick=function(s){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},d}(vu);lv.prototype.controlText_="Picture-in-Picture",Rt.registerComponent("PictureInPictureToggle",lv);var o0=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).on(h,"fullscreenchange",function(m){return u.handleFullscreenChange(m)}),!1===Oe()[h.fsApi_.fullscreenEnabled]&&u.disable(),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-fullscreen-control "+b.prototype.buildCSSClass.call(this)},f.handleFullscreenChange=function(s){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},f.handleClick=function(s){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},d}(vu);o0.prototype.controlText_="Fullscreen",Rt.registerComponent("FullscreenToggle",o0);var nb=function(b){function d(){return b.apply(this,arguments)||this}return ze(d,b),d.prototype.createEl=function(){var s=b.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});return s.appendChild(b.prototype.createEl.call(this,"span",{className:"vjs-control-text"})),s},d}(Rt);Rt.registerComponent("VolumeLevel",nb);var ib=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).update=zs(hr(gt(u),u.update),30),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})},f.update=function(s,u,m,T){if(!m){var S=wr(this.el_),D=wr(this.player_.el()),P=s.width*u;if(!D||!S)return;var W=s.left-D.left+P,H=s.width-P+(D.right-s.right),te=S.width/2;W<te?te+=te-W:H<te&&(te=H),te<0?te=0:te>S.width&&(te=S.width),this.el_.style.right="-"+te+"px"}this.write(T+"%")},f.write=function(s){Dc(this.el_,s)},f.updateVolume=function(s,u,m,T,S){var D=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",function(){D.update(s,u,m,T.toFixed(0)),S&&S()})},d}(Rt);Rt.registerComponent("VolumeLevelTooltip",ib);var l0=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).update=zs(hr(gt(u),u.update),30),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},f.update=function(s,u,m){var T=this,S=100*u;this.getChild("volumeLevelTooltip").updateVolume(s,u,m,S,function(){m?T.el_.style.bottom=s.height*u+"px":T.el_.style.left=s.width*u+"px"})},d}(Rt);l0.prototype.options_={children:["volumeLevelTooltip"]},Rt.registerComponent("MouseVolumeLevelDisplay",l0);var Em=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).on("slideractive",function(m){return u.updateLastVolume_(m)}),u.on(h,"volumechange",function(m){return u.updateARIAAttributes(m)}),h.ready(function(){return u.updateARIAAttributes()}),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},f.handleMouseDown=function(s){!fd(s)||b.prototype.handleMouseDown.call(this,s)},f.handleMouseMove=function(s){var u=this.getChild("mouseVolumeLevelDisplay");if(u){var m=this.el(),T=wr(m),S=this.vertical(),D=Ii(m,s);D=Lc(D=S?D.y:D.x,0,1),u.update(T,D,S)}!fd(s)||(this.checkMuted(),this.player_.volume(this.calculateDistance(s)))},f.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},f.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},f.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},f.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},f.updateARIAAttributes=function(s){var u=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",u),this.el_.setAttribute("aria-valuetext",u+"%")},f.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},f.updateLastVolume_=function(){var s=this,u=this.player_.volume();this.one("sliderinactive",function(){0===s.player_.volume()&&s.player_.lastVolume_(u)})},d}(xm);Em.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},!Ao&&!ca&&Em.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),Em.prototype.playerEvent="volumechange",Rt.registerComponent("VolumeBar",Em);var Cm=function(b){function d(h,s){var u;return void 0===s&&(s={}),s.vertical=s.vertical||!1,(typeof s.volumeBar>"u"||cu(s.volumeBar))&&(s.volumeBar=s.volumeBar||{},s.volumeBar.vertical=s.vertical),function(d,f){f.tech_&&!f.tech_.featuresVolumeControl&&d.addClass("vjs-hidden"),d.on(f,"loadstart",function(){f.tech_.featuresVolumeControl?d.removeClass("vjs-hidden"):d.addClass("vjs-hidden")})}(gt(u=b.call(this,h,s)||this),h),u.throttledHandleMouseMove=zs(hr(gt(u),u.handleMouseMove),30),u.handleMouseUpHandler_=function(m){return u.handleMouseUp(m)},u.on("mousedown",function(m){return u.handleMouseDown(m)}),u.on("touchstart",function(m){return u.handleMouseDown(m)}),u.on("mousemove",function(m){return u.handleMouseMove(m)}),u.on(u.volumeBar,["focus","slideractive"],function(){u.volumeBar.addClass("vjs-slider-active"),u.addClass("vjs-slider-active"),u.trigger("slideractive")}),u.on(u.volumeBar,["blur","sliderinactive"],function(){u.volumeBar.removeClass("vjs-slider-active"),u.removeClass("vjs-slider-active"),u.trigger("sliderinactive")}),u}ze(d,b);var f=d.prototype;return f.createEl=function(){var s="vjs-volume-horizontal";return this.options_.vertical&&(s="vjs-volume-vertical"),b.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+s})},f.handleMouseDown=function(s){var u=this.el_.ownerDocument;this.on(u,"mousemove",this.throttledHandleMouseMove),this.on(u,"touchmove",this.throttledHandleMouseMove),this.on(u,"mouseup",this.handleMouseUpHandler_),this.on(u,"touchend",this.handleMouseUpHandler_)},f.handleMouseUp=function(s){var u=this.el_.ownerDocument;this.off(u,"mousemove",this.throttledHandleMouseMove),this.off(u,"touchmove",this.throttledHandleMouseMove),this.off(u,"mouseup",this.handleMouseUpHandler_),this.off(u,"touchend",this.handleMouseUpHandler_)},f.handleMouseMove=function(s){this.volumeBar.handleMouseMove(s)},d}(Rt);Cm.prototype.options_={children:["volumeBar"]},Rt.registerComponent("VolumeControl",Cm);var rb=function(b){function d(h,s){var u;return function(d,f){f.tech_&&!f.tech_.featuresMuteControl&&d.addClass("vjs-hidden"),d.on(f,"loadstart",function(){f.tech_.featuresMuteControl?d.removeClass("vjs-hidden"):d.addClass("vjs-hidden")})}(gt(u=b.call(this,h,s)||this),h),u.on(h,["loadstart","volumechange"],function(m){return u.update(m)}),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-mute-control "+b.prototype.buildCSSClass.call(this)},f.handleClick=function(s){var u=this.player_.volume(),m=this.player_.lastVolume_();0===u?(this.player_.volume(m<.1?.1:m),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())},f.update=function(s){this.updateIcon_(),this.updateControlText_()},f.updateIcon_=function(){var s=this.player_.volume(),u=3;Ao&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===s||this.player_.muted()?u=0:s<.33?u=1:s<.67&&(u=2);for(var m=0;m<4;m++)Mc(this.el_,"vjs-vol-"+m);hs(this.el_,"vjs-vol-"+u)},f.updateControlText_=function(){var u=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==u&&this.controlText(u)},d}(vu);rb.prototype.controlText_="Mute",Rt.registerComponent("MuteToggle",rb);var Sh=function(b){function d(h,s){var u;return void 0===s&&(s={}),s.inline=!(typeof s.inline<"u")||s.inline,(typeof s.volumeControl>"u"||cu(s.volumeControl))&&(s.volumeControl=s.volumeControl||{},s.volumeControl.vertical=!s.inline),(u=b.call(this,h,s)||this).handleKeyPressHandler_=function(m){return u.handleKeyPress(m)},u.on(h,["loadstart"],function(m){return u.volumePanelState_(m)}),u.on(u.muteToggle,"keyup",function(m){return u.handleKeyPress(m)}),u.on(u.volumeControl,"keyup",function(m){return u.handleVolumeControlKeyUp(m)}),u.on("keydown",function(m){return u.handleKeyPress(m)}),u.on("mouseover",function(m){return u.handleMouseOver(m)}),u.on("mouseout",function(m){return u.handleMouseOut(m)}),u.on(u.volumeControl,["slideractive"],u.sliderActive_),u.on(u.volumeControl,["sliderinactive"],u.sliderInactive_),u}ze(d,b);var f=d.prototype;return f.sliderActive_=function(){this.addClass("vjs-slider-active")},f.sliderInactive_=function(){this.removeClass("vjs-slider-active")},f.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},f.createEl=function(){var s="vjs-volume-panel-horizontal";return this.options_.inline||(s="vjs-volume-panel-vertical"),b.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+s})},f.dispose=function(){this.handleMouseOut(),b.prototype.dispose.call(this)},f.handleVolumeControlKeyUp=function(s){yt().isEventKey(s,"Esc")&&this.muteToggle.focus()},f.handleMouseOver=function(s){this.addClass("vjs-hover"),so(Oe(),"keyup",this.handleKeyPressHandler_)},f.handleMouseOut=function(s){this.removeClass("vjs-hover"),ft(Oe(),"keyup",this.handleKeyPressHandler_)},f.handleKeyPress=function(s){yt().isEventKey(s,"Esc")&&this.handleMouseOut()},d}(Rt);Sh.prototype.options_={children:["muteToggle","volumeControl"]},Rt.registerComponent("VolumePanel",Sh);var Mm=function(b){function d(h,s){var u;return u=b.call(this,h,s)||this,s&&(u.menuButton_=s.menuButton),u.focusedChild_=-1,u.on("keydown",function(m){return u.handleKeyDown(m)}),u.boundHandleBlur_=function(m){return u.handleBlur(m)},u.boundHandleTapClick_=function(m){return u.handleTapClick(m)},u}ze(d,b);var f=d.prototype;return f.addEventListenerForItem=function(s){s instanceof Rt&&(this.on(s,"blur",this.boundHandleBlur_),this.on(s,["tap","click"],this.boundHandleTapClick_))},f.removeEventListenerForItem=function(s){s instanceof Rt&&(this.off(s,"blur",this.boundHandleBlur_),this.off(s,["tap","click"],this.boundHandleTapClick_))},f.removeChild=function(s){"string"==typeof s&&(s=this.getChild(s)),this.removeEventListenerForItem(s),b.prototype.removeChild.call(this,s)},f.addItem=function(s){var u=this.addChild(s);u&&this.addEventListenerForItem(u)},f.createEl=function(){this.contentEl_=$i(this.options_.contentElType||"ul",{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var u=b.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return u.appendChild(this.contentEl_),so(u,"click",function(m){m.preventDefault(),m.stopImmediatePropagation()}),u},f.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,b.prototype.dispose.call(this)},f.handleBlur=function(s){var u=s.relatedTarget||Oe().activeElement;if(!this.children().some(function(T){return T.el()===u})){var m=this.menuButton_;m&&m.buttonPressed_&&u!==m.el().firstChild&&m.unpressButton()}},f.handleTapClick=function(s){if(this.menuButton_){this.menuButton_.unpressButton();var u=this.children();if(!Array.isArray(u))return;var m=u.filter(function(T){return T.el()===s.target})[0];if(!m)return;"CaptionSettingsMenuItem"!==m.name()&&this.menuButton_.focus()}},f.handleKeyDown=function(s){yt().isEventKey(s,"Left")||yt().isEventKey(s,"Down")?(s.preventDefault(),s.stopPropagation(),this.stepForward()):(yt().isEventKey(s,"Right")||yt().isEventKey(s,"Up"))&&(s.preventDefault(),s.stopPropagation(),this.stepBack())},f.stepForward=function(){var s=0;void 0!==this.focusedChild_&&(s=this.focusedChild_+1),this.focus(s)},f.stepBack=function(){var s=0;void 0!==this.focusedChild_&&(s=this.focusedChild_-1),this.focus(s)},f.focus=function(s){void 0===s&&(s=0);var u=this.children().slice();u.length&&u[0].hasClass("vjs-menu-title")&&u.shift(),u.length>0&&(s<0?s=0:s>=u.length&&(s=u.length-1),this.focusedChild_=s,u[s].el_.focus())},d}(Rt);Rt.registerComponent("Menu",Mm);var Eh=function(b){function d(h,s){var u;void 0===s&&(s={}),(u=b.call(this,h,s)||this).menuButton_=new vu(h,s),u.menuButton_.controlText(u.controlText_),u.menuButton_.el_.setAttribute("aria-haspopup","true");var m=vu.prototype.buildCSSClass();u.menuButton_.el_.className=u.buildCSSClass()+" "+m,u.menuButton_.removeClass("vjs-control"),u.addChild(u.menuButton_),u.update(),u.enabled_=!0;var T=function(D){return u.handleClick(D)};return u.handleMenuKeyUp_=function(S){return u.handleMenuKeyUp(S)},u.on(u.menuButton_,"tap",T),u.on(u.menuButton_,"click",T),u.on(u.menuButton_,"keydown",function(S){return u.handleKeyDown(S)}),u.on(u.menuButton_,"mouseenter",function(){u.addClass("vjs-hover"),u.menu.show(),so(Oe(),"keyup",u.handleMenuKeyUp_)}),u.on("mouseleave",function(S){return u.handleMouseLeave(S)}),u.on("keydown",function(S){return u.handleSubmenuKeyDown(S)}),u}ze(d,b);var f=d.prototype;return f.update=function(){var s=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=s,this.addChild(s),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))},f.createMenu=function(){var s=new Mm(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var u=$i("li",{className:"vjs-menu-title",textContent:Rr(this.options_.title),tabIndex:-1}),m=new Rt(this.player_,{el:u});s.addItem(m)}if(this.items=this.createItems(),this.items)for(var T=0;T<this.items.length;T++)s.addItem(this.items[T]);return s},f.createItems=function(){},f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},f.buildWrapperCSSClass=function(){var s="vjs-menu-button";return"vjs-menu-button "+(s+=!0===this.options_.inline?"-inline":"-popup")+" "+vu.prototype.buildCSSClass()+" "+b.prototype.buildCSSClass.call(this)},f.buildCSSClass=function(){var s="vjs-menu-button";return"vjs-menu-button "+(s+=!0===this.options_.inline?"-inline":"-popup")+" "+b.prototype.buildCSSClass.call(this)},f.controlText=function(s,u){return void 0===u&&(u=this.menuButton_.el()),this.menuButton_.controlText(s,u)},f.dispose=function(){this.handleMouseLeave(),b.prototype.dispose.call(this)},f.handleClick=function(s){this.buttonPressed_?this.unpressButton():this.pressButton()},f.handleMouseLeave=function(s){this.removeClass("vjs-hover"),ft(Oe(),"keyup",this.handleMenuKeyUp_)},f.focus=function(){this.menuButton_.focus()},f.blur=function(){this.menuButton_.blur()},f.handleKeyDown=function(s){yt().isEventKey(s,"Esc")||yt().isEventKey(s,"Tab")?(this.buttonPressed_&&this.unpressButton(),yt().isEventKey(s,"Tab")||(s.preventDefault(),this.menuButton_.focus())):(yt().isEventKey(s,"Up")||yt().isEventKey(s,"Down"))&&(this.buttonPressed_||(s.preventDefault(),this.pressButton()))},f.handleMenuKeyUp=function(s){(yt().isEventKey(s,"Esc")||yt().isEventKey(s,"Tab"))&&this.removeClass("vjs-hover")},f.handleSubmenuKeyPress=function(s){this.handleSubmenuKeyDown(s)},f.handleSubmenuKeyDown=function(s){(yt().isEventKey(s,"Esc")||yt().isEventKey(s,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),yt().isEventKey(s,"Tab")||(s.preventDefault(),this.menuButton_.focus()))},f.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Ao&&j_())return;this.menu.focus()}},f.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},f.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},f.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},d}(Rt);Rt.registerComponent("MenuButton",Eh);var uv=function(b){function d(f,h){var s,u=h.tracks;if((s=b.call(this,f,h)||this).items.length<=1&&s.hide(),!u)return gt(s);var m=hr(gt(s),s.update);return u.addEventListener("removetrack",m),u.addEventListener("addtrack",m),u.addEventListener("labelchange",m),s.player_.on("ready",m),s.player_.on("dispose",function(){u.removeEventListener("removetrack",m),u.removeEventListener("addtrack",m),u.removeEventListener("labelchange",m)}),s}return ze(d,b),d}(Eh);Rt.registerComponent("TrackButton",uv);var sb=["Tab","Esc","Up","Down","Right","Left"],Zf=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).selectable=s.selectable,u.isSelected_=s.selected||!1,u.multiSelectable=s.multiSelectable,u.selected(u.isSelected_),u.el_.setAttribute("role",u.selectable?u.multiSelectable?"menuitemcheckbox":"menuitemradio":"menuitem"),u}ze(d,b);var f=d.prototype;return f.createEl=function(s,u,m){this.nonIconControl=!0;var T=b.prototype.createEl.call(this,"li",zr({className:"vjs-menu-item",tabIndex:-1},u),m);return T.replaceChild($i("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),T.querySelector(".vjs-icon-placeholder")),T},f.handleKeyDown=function(s){sb.some(function(u){return yt().isEventKey(s,u)})||b.prototype.handleKeyDown.call(this,s)},f.handleClick=function(s){this.selected(!0)},f.selected=function(s){this.selectable&&(s?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},d}(Qf);Rt.registerComponent("MenuItem",Zf);var Ch=function(b){function d(h,s){var u,m=s.track,T=h.textTracks();s.label=m.label||m.language||"Unknown",s.selected="showing"===m.mode,(u=b.call(this,h,s)||this).track=m,u.kinds=(s.kinds||[s.kind||u.track.kind]).filter(Boolean);var P,S=function(){for(var H=arguments.length,te=new Array(H),le=0;le<H;le++)te[le]=arguments[le];u.handleTracksChange.apply(gt(u),te)},D=function(){for(var H=arguments.length,te=new Array(H),le=0;le<H;le++)te[le]=arguments[le];u.handleSelectedLanguageChange.apply(gt(u),te)};return h.on(["loadstart","texttrackchange"],S),T.addEventListener("change",S),T.addEventListener("selectedlanguagechange",D),u.on("dispose",function(){h.off(["loadstart","texttrackchange"],S),T.removeEventListener("change",S),T.removeEventListener("selectedlanguagechange",D)}),void 0===T.onchange&&u.on(["tap","click"],function(){if("object"!=typeof se().Event)try{P=new(se().Event)("change")}catch{}P||(P=Oe().createEvent("Event")).initEvent("change",!0,!0),T.dispatchEvent(P)}),u.handleTracksChange(),u}ze(d,b);var f=d.prototype;return f.handleClick=function(s){var u=this.track,m=this.player_.textTracks();if(b.prototype.handleClick.call(this,s),m)for(var T=0;T<m.length;T++){var S=m[T];-1!==this.kinds.indexOf(S.kind)&&(S===u?"showing"!==S.mode&&(S.mode="showing"):"disabled"!==S.mode&&(S.mode="disabled"))}},f.handleTracksChange=function(s){var u="showing"===this.track.mode;u!==this.isSelected_&&this.selected(u)},f.handleSelectedLanguageChange=function(s){if("showing"===this.track.mode){var u=this.player_.cache_.selectedLanguage;if(u&&u.enabled&&u.language===this.track.language&&u.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},f.dispose=function(){this.track=null,b.prototype.dispose.call(this)},d}(Zf);Rt.registerComponent("TextTrackMenuItem",Ch);var Dh=function(b){function d(h,s){return s.track={player:h,kind:s.kind,kinds:s.kinds,default:!1,mode:"disabled"},s.kinds||(s.kinds=[s.kind]),s.track.label=s.label?s.label:s.kinds.join(" and ")+" off",s.selectable=!0,s.multiSelectable=!1,b.call(this,h,s)||this}ze(d,b);var f=d.prototype;return f.handleTracksChange=function(s){for(var u=this.player().textTracks(),m=!0,T=0,S=u.length;T<S;T++){var D=u[T];if(this.options_.kinds.indexOf(D.kind)>-1&&"showing"===D.mode){m=!1;break}}m!==this.isSelected_&&this.selected(m)},f.handleSelectedLanguageChange=function(s){for(var u=this.player().textTracks(),m=!0,T=0,S=u.length;T<S;T++){var D=u[T];if(["captions","descriptions","subtitles"].indexOf(D.kind)>-1&&"showing"===D.mode){m=!1;break}}m&&(this.player_.cache_.selectedLanguage={enabled:!1})},d}(Ch);Rt.registerComponent("OffTextTrackMenuItem",Dh);var Hl=function(b){function d(h,s){return void 0===s&&(s={}),s.tracks=h.textTracks(),b.call(this,h,s)||this}return ze(d,b),d.prototype.createItems=function(s,u){var m;void 0===s&&(s=[]),void 0===u&&(u=Ch),this.label_&&(m=this.label_+" off"),s.push(new Dh(this.player_,{kinds:this.kinds_,kind:this.kind_,label:m})),this.hideThreshold_+=1;var T=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var S=0;S<T.length;S++){var D=T[S];if(this.kinds_.indexOf(D.kind)>-1){var P=new u(this.player_,{track:D,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});P.addClass("vjs-"+D.kind+"-menu-item"),s.push(P)}}return s},d}(uv);Rt.registerComponent("TextTrackButton",Hl);var u0=function(b){function d(h,s){var u,m=s.track,T=s.cue,S=h.currentTime();return s.selectable=!0,s.multiSelectable=!1,s.label=T.text,s.selected=T.startTime<=S&&S<T.endTime,(u=b.call(this,h,s)||this).track=m,u.cue=T,u}return ze(d,b),d.prototype.handleClick=function(s){b.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime)},d}(Zf);Rt.registerComponent("ChaptersTrackMenuItem",u0);var $t=function(b){function d(h,s,u){var m;return(m=b.call(this,h,s,u)||this).selectCurrentItem_=function(){m.items.forEach(function(T){T.selected(m.track_.activeCues[0]===T.cue)})},m}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-chapters-button "+b.prototype.buildCSSClass.call(this)},f.buildWrapperCSSClass=function(){return"vjs-chapters-button "+b.prototype.buildWrapperCSSClass.call(this)},f.update=function(s){if(!s||!s.track||"chapters"===s.track.kind){var u=this.findChaptersTrack();u!==this.track_?(this.setTrack(u),b.prototype.update.call(this)):(!this.items||u&&u.cues&&u.cues.length!==this.items.length)&&b.prototype.update.call(this)}},f.setTrack=function(s){if(this.track_!==s){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var u=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);u&&u.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=s,this.track_){this.track_.mode="hidden";var m=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);m&&m.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}},f.findChaptersTrack=function(){for(var s=this.player_.textTracks()||[],u=s.length-1;u>=0;u--){var m=s[u];if(m.kind===this.kind_)return m}},f.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Rr(this.kind_))},f.createMenu=function(){return this.options_.title=this.getMenuCaption(),b.prototype.createMenu.call(this)},f.createItems=function(){var s=[];if(!this.track_)return s;var u=this.track_.cues;if(!u)return s;for(var m=0,T=u.length;m<T;m++){var D=new u0(this.player_,{track:this.track_,cue:u[m]});s.push(D)}return s},d}(Hl);$t.prototype.kind_="chapters",$t.prototype.controlText_="Chapters",Rt.registerComponent("ChaptersButton",$t);var Im=function(b){function d(h,s,u){var m;m=b.call(this,h,s,u)||this;var T=h.textTracks(),S=hr(gt(m),m.handleTracksChange);return T.addEventListener("change",S),m.on("dispose",function(){T.removeEventListener("change",S)}),m}ze(d,b);var f=d.prototype;return f.handleTracksChange=function(s){for(var u=this.player().textTracks(),m=!1,T=0,S=u.length;T<S;T++){var D=u[T];if(D.kind!==this.kind_&&"showing"===D.mode){m=!0;break}}m?this.disable():this.enable()},f.buildCSSClass=function(){return"vjs-descriptions-button "+b.prototype.buildCSSClass.call(this)},f.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+b.prototype.buildWrapperCSSClass.call(this)},d}(Hl);Im.prototype.kind_="descriptions",Im.prototype.controlText_="Descriptions",Rt.registerComponent("DescriptionsButton",Im);var Bn=function(b){function d(h,s,u){return b.call(this,h,s,u)||this}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-subtitles-button "+b.prototype.buildCSSClass.call(this)},f.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+b.prototype.buildWrapperCSSClass.call(this)},d}(Hl);Bn.prototype.kind_="subtitles",Bn.prototype.controlText_="Subtitles",Rt.registerComponent("SubtitlesButton",Bn);var fn=function(b){function d(h,s){var u;return s.track={player:h,kind:s.kind,label:s.kind+" settings",selectable:!1,default:!1,mode:"disabled"},s.selectable=!1,s.name="CaptionSettingsMenuItem",(u=b.call(this,h,s)||this).addClass("vjs-texttrack-settings"),u.controlText(", opens "+s.kind+" settings dialog"),u}return ze(d,b),d.prototype.handleClick=function(s){this.player().getChild("textTrackSettings").open()},d}(Ch);Rt.registerComponent("CaptionSettingsMenuItem",fn);var Ya=function(b){function d(h,s,u){return b.call(this,h,s,u)||this}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-captions-button "+b.prototype.buildCSSClass.call(this)},f.buildWrapperCSSClass=function(){return"vjs-captions-button "+b.prototype.buildWrapperCSSClass.call(this)},f.createItems=function(){var s=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(s.push(new fn(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),b.prototype.createItems.call(this,s)},d}(Hl);Ya.prototype.kind_="captions",Ya.prototype.controlText_="Captions",Rt.registerComponent("CaptionsButton",Ya);var c0=function(b){function d(){return b.apply(this,arguments)||this}return ze(d,b),d.prototype.createEl=function(s,u,m){var T=b.prototype.createEl.call(this,s,u,m),S=T.querySelector(".vjs-menu-item-text");return"captions"===this.options_.track.kind&&(S.appendChild($i("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),S.appendChild($i("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),T},d}(Ch);Rt.registerComponent("SubsCapsMenuItem",c0);var cv=function(b){function d(h,s){var u;return void 0===s&&(s={}),(u=b.call(this,h,s)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(u.player_.language_)>-1&&(u.label_="captions"),u.menuButton_.controlText(Rr(u.label_)),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-subs-caps-button "+b.prototype.buildCSSClass.call(this)},f.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+b.prototype.buildWrapperCSSClass.call(this)},f.createItems=function(){var s=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(s.push(new fn(this.player_,{kind:this.label_})),this.hideThreshold_+=1),b.prototype.createItems.call(this,s,c0)},d}(Hl);cv.prototype.kinds_=["captions","subtitles"],cv.prototype.controlText_="Subtitles",Rt.registerComponent("SubsCapsButton",cv);var d0=function(b){function d(h,s){var u,m=s.track,T=h.audioTracks();s.label=m.label||m.language||"Unknown",s.selected=m.enabled,(u=b.call(this,h,s)||this).track=m,u.addClass("vjs-"+m.kind+"-menu-item");var S=function(){for(var P=arguments.length,W=new Array(P),H=0;H<P;H++)W[H]=arguments[H];u.handleTracksChange.apply(gt(u),W)};return T.addEventListener("change",S),u.on("dispose",function(){T.removeEventListener("change",S)}),u}ze(d,b);var f=d.prototype;return f.createEl=function(s,u,m){var T=b.prototype.createEl.call(this,s,u,m),S=T.querySelector(".vjs-menu-item-text");return"main-desc"===this.options_.track.kind&&(S.appendChild($i("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),S.appendChild($i("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),T},f.handleClick=function(s){if(b.prototype.handleClick.call(this,s),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks)for(var u=this.player_.audioTracks(),m=0;m<u.length;m++){var T=u[m];T!==this.track&&(T.enabled=T===this.track)}},f.handleTracksChange=function(s){this.selected(this.track.enabled)},d}(Zf);Rt.registerComponent("AudioTrackMenuItem",d0);var Rm=function(b){function d(h,s){return void 0===s&&(s={}),s.tracks=h.audioTracks(),b.call(this,h,s)||this}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-audio-button "+b.prototype.buildCSSClass.call(this)},f.buildWrapperCSSClass=function(){return"vjs-audio-button "+b.prototype.buildWrapperCSSClass.call(this)},f.createItems=function(s){void 0===s&&(s=[]),this.hideThreshold_=1;for(var u=this.player_.audioTracks(),m=0;m<u.length;m++)s.push(new d0(this.player_,{track:u[m],selectable:!0,multiSelectable:!1}));return s},d}(uv);Rm.prototype.controlText_="Audio Track",Rt.registerComponent("AudioTrackButton",Rm);var yu=function(b){function d(h,s){var u,m=s.rate,T=parseFloat(m,10);return s.label=m,s.selected=T===h.playbackRate(),s.selectable=!0,s.multiSelectable=!1,(u=b.call(this,h,s)||this).label=m,u.rate=T,u.on(h,"ratechange",function(S){return u.update(S)}),u}ze(d,b);var f=d.prototype;return f.handleClick=function(s){b.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},f.update=function(s){this.selected(this.player().playbackRate()===this.rate)},d}(Zf);yu.prototype.contentElType="button",Rt.registerComponent("PlaybackRateMenuItem",yu);var dv=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).menuButton_.el_.setAttribute("aria-describedby",u.labelElId_),u.updateVisibility(),u.updateLabel(),u.on(h,"loadstart",function(m){return u.updateVisibility(m)}),u.on(h,"ratechange",function(m){return u.updateLabel(m)}),u.on(h,"playbackrateschange",function(m){return u.handlePlaybackRateschange(m)}),u}ze(d,b);var f=d.prototype;return f.createEl=function(){var s=b.prototype.createEl.call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=$i("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),s.appendChild(this.labelEl_),s},f.dispose=function(){this.labelEl_=null,b.prototype.dispose.call(this)},f.buildCSSClass=function(){return"vjs-playback-rate "+b.prototype.buildCSSClass.call(this)},f.buildWrapperCSSClass=function(){return"vjs-playback-rate "+b.prototype.buildWrapperCSSClass.call(this)},f.createItems=function(){for(var s=this.playbackRates(),u=[],m=s.length-1;m>=0;m--)u.push(new yu(this.player(),{rate:s[m]+"x"}));return u},f.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},f.handleClick=function(s){var u=this.player().playbackRate(),m=this.playbackRates(),S=(m.indexOf(u)+1)%m.length;this.player().playbackRate(m[S])},f.handlePlaybackRateschange=function(s){this.update()},f.playbackRates=function(){var s=this.player();return s.playbackRates&&s.playbackRates()||[]},f.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},f.updateVisibility=function(s){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},f.updateLabel=function(s){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")},d}(Eh);dv.prototype.controlText_="Playback Rate",Rt.registerComponent("PlaybackRateMenuButton",dv);var wd=function(b){function d(){return b.apply(this,arguments)||this}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-spacer "+b.prototype.buildCSSClass.call(this)},f.createEl=function(s,u,m){return void 0===s&&(s="div"),void 0===u&&(u={}),void 0===m&&(m={}),u.className||(u.className=this.buildCSSClass()),b.prototype.createEl.call(this,s,u,m)},d}(Rt);Rt.registerComponent("Spacer",wd);var ab=function(b){function d(){return b.apply(this,arguments)||this}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-custom-control-spacer "+b.prototype.buildCSSClass.call(this)},f.createEl=function(){return b.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:"\xa0"})},d}(wd);Rt.registerComponent("CustomControlSpacer",ab);var Jf=function(b){function d(){return b.apply(this,arguments)||this}return ze(d,b),d.prototype.createEl=function(){return b.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},d}(Rt);Jf.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in Oe()&&Jf.prototype.options_.children.splice(Jf.prototype.options_.children.length-1,0,"pictureInPictureToggle"),Rt.registerComponent("ControlBar",Jf);var Mh=function(b){function d(h,s){var u;return(u=b.call(this,h,s)||this).on(h,"error",function(m){return u.open(m)}),u}ze(d,b);var f=d.prototype;return f.buildCSSClass=function(){return"vjs-error-display "+b.prototype.buildCSSClass.call(this)},f.content=function(){var s=this.player().error();return s?this.localize(s.message):""},d}(qu);Mh.prototype.options_=Mt({},qu.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Rt.registerComponent("ErrorDisplay",Mh);var Ih="vjs-text-track-settings",hv=["#000","Black"],h0=["#00F","Blue"],f0=["#0FF","Cyan"],Gl=["#0F0","Green"],bu=["#F0F","Magenta"],fv=["#F00","Red"],ob=["#FFF","White"],pv=["#FF0","Yellow"],Nm=["1","Opaque"],mv=["0.5","Semi-Transparent"],gv=["0","Transparent"],Fc={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[hv,ob,fv,Gl,h0,pv,bu,f0]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Nm,mv,gv]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[ob,hv,fv,Gl,h0,pv,bu,f0]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(d){return"1.00"===d?null:Number(d)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Nm,mv]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[gv,mv,Nm]}};function vv(b,d){if(d&&(b=d(b)),b&&"none"!==b)return b}Fc.windowColor.options=Fc.backgroundColor.options;var pl=function(b){function d(h,s){var u;return s.temporary=!1,(u=b.call(this,h,s)||this).updateDisplay=u.updateDisplay.bind(gt(u)),u.fill(),u.hasBeenOpened_=u.hasBeenFilled_=!0,u.endDialog=$i("p",{className:"vjs-control-text",textContent:u.localize("End of dialog window.")}),u.el().appendChild(u.endDialog),u.setDefaults(),void 0===s.persistTextTrackSettings&&(u.options_.persistTextTrackSettings=u.options_.playerOptions.persistTextTrackSettings),u.on(u.$(".vjs-done-button"),"click",function(){u.saveSettings(),u.close()}),u.on(u.$(".vjs-default-button"),"click",function(){u.setDefaults(),u.updateDisplay()}),lh(Fc,function(m){u.on(u.$(m.selector),"change",u.updateDisplay)}),u.options_.persistTextTrackSettings&&u.restoreSettings(),u}ze(d,b);var f=d.prototype;return f.dispose=function(){this.endDialog=null,b.prototype.dispose.call(this)},f.createElSelect_=function(s,u,m){var T=this;void 0===u&&(u=""),void 0===m&&(m="label");var S=Fc[s],D=S.id.replace("%s",this.id_),P=[u,D].join(" ").trim();return["<"+m+' id="'+D+'" class="'+("label"===m?"vjs-label":"")+'">',this.localize(S.label),"</"+m+">",'<select aria-labelledby="'+P+'">'].concat(S.options.map(function(W){var H=D+"-"+W[1].replace(/\W+/g,"");return['<option id="'+H+'" value="'+W[0]+'" ','aria-labelledby="'+P+" "+H+'">',T.localize(W[1]),"</option>"].join("")})).concat("</select>").join("")},f.createElFgColor_=function(){var s="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+s+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",s),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",s),"</span>","</fieldset>"].join("")},f.createElBgColor_=function(){var s="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+s+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",s),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",s),"</span>","</fieldset>"].join("")},f.createElWinColor_=function(){var s="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+s+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",s),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",s),"</span>","</fieldset>"].join("")},f.createElColors_=function(){return $i("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},f.createElFont_=function(){return $i("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},f.createElControls_=function(){var s=this.localize("restore all settings to the default values");return $i("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+s+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+s+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},f.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},f.label=function(){return this.localize("Caption Settings Dialog")},f.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},f.buildCSSClass=function(){return b.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},f.getValues=function(){var s=this;return function Ec(b,d,f){return void 0===f&&(f=0),Kr(b).reduce(function(h,s){return d(h,b[s],s)},f)}(Fc,function(u,m,T){var S=function ep(b,d){return vv(b.options[b.options.selectedIndex].value,d)}(s.$(m.selector),m.parser);return void 0!==S&&(u[T]=S),u},{})},f.setValues=function(s){var u=this;lh(Fc,function(m,T){!function Ad(b,d,f){if(d)for(var h=0;h<b.options.length;h++)if(vv(b.options[h].value,f)===d){b.selectedIndex=h;break}}(u.$(m.selector),s[T],m.parser)})},f.setDefaults=function(){var s=this;lh(Fc,function(u){var m=u.hasOwnProperty("default")?u.default:0;s.$(u.selector).selectedIndex=m})},f.restoreSettings=function(){var s;try{s=JSON.parse(se().localStorage.getItem(Ih))}catch(u){Kt.warn(u)}s&&this.setValues(s)},f.saveSettings=function(){if(this.options_.persistTextTrackSettings){var s=this.getValues();try{Object.keys(s).length?se().localStorage.setItem(Ih,JSON.stringify(s)):se().localStorage.removeItem(Ih)}catch(u){Kt.warn(u)}}},f.updateDisplay=function(){var s=this.player_.getChild("textTrackDisplay");s&&s.updateDisplay()},f.conditionalBlur_=function(){this.previouslyActiveEl_=null;var s=this.player_.controlBar,u=s&&s.subsCapsButton,m=s&&s.captionsButton;u?u.focus():m&&m.focus()},d}(qu);Rt.registerComponent("TextTrackSettings",pl);var Co=function(b){function d(h,s){var u,m=s.ResizeObserver||se().ResizeObserver;null===s.ResizeObserver&&(m=!1);var T=Dr({createEl:!m,reportTouchActivity:!1},s);return(u=b.call(this,h,T)||this).ResizeObserver=s.ResizeObserver||se().ResizeObserver,u.loadListener_=null,u.resizeObserver_=null,u.debouncedHandler_=function(d,f,h,s){void 0===s&&(s=se());var u,T=function(){var D=this,P=arguments,W=function(){u=null,W=null,d.apply(D,P)};s.clearTimeout(u),u=s.setTimeout(W,100)};return T.cancel=function(){s.clearTimeout(u),u=null},T}(function(){u.resizeHandler()},0,0,gt(u)),m?(u.resizeObserver_=new u.ResizeObserver(u.debouncedHandler_),u.resizeObserver_.observe(h.el())):(u.loadListener_=function(){if(u.el_&&u.el_.contentWindow){var S=u.debouncedHandler_,D=u.unloadListener_=function(){ft(this,"resize",S),ft(this,"unload",D),D=null};so(u.el_.contentWindow,"unload",D),so(u.el_.contentWindow,"resize",S)}},u.one("load",u.loadListener_)),u}ze(d,b);var f=d.prototype;return f.createEl=function(){return b.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})},f.resizeHandler=function(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")},f.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,b.prototype.dispose.call(this)},d}(Rt);Rt.registerComponent("ResizeManager",Co);var lb={trackingThreshold:20,liveTolerance:15},p0=function(b){function d(h,s){var u,m=Dr(lb,s,{createEl:!1});return(u=b.call(this,h,m)||this).handleVisibilityChange_=function(T){return u.handleVisibilityChange(T)},u.trackLiveHandler_=function(){return u.trackLive_()},u.handlePlay_=function(T){return u.handlePlay(T)},u.handleFirstTimeupdate_=function(T){return u.handleFirstTimeupdate(T)},u.handleSeeked_=function(T){return u.handleSeeked(T)},u.seekToLiveEdge_=function(T){return u.seekToLiveEdge(T)},u.reset_(),u.on(u.player_,"durationchange",function(T){return u.handleDurationchange(T)}),u.on(u.player_,"canplay",function(){return u.toggleTracking()}),uh&&"hidden"in Oe()&&"visibilityState"in Oe()&&u.on(Oe(),"visibilitychange",u.handleVisibilityChange_),u}ze(d,b);var f=d.prototype;return f.handleVisibilityChange=function(){this.player_.duration()===1/0&&(Oe().hidden?this.stopTracking():this.startTracking())},f.trackLive_=function(){var s=this.player_.seekable();if(s&&s.length){var u=Number(se().performance.now().toFixed(4)),m=-1===this.lastTime_?0:(u-this.lastTime_)/1e3;this.lastTime_=u,this.pastSeekEnd_=this.pastSeekEnd()+m;var T=this.liveCurrentTime(),S=this.player_.currentTime(),D=this.player_.paused()||this.seekedBehindLive_||Math.abs(T-S)>this.options_.liveTolerance;(!this.timeupdateSeen_||T===1/0)&&(D=!1),D!==this.behindLiveEdge_&&(this.behindLiveEdge_=D,this.trigger("liveedgechange"))}},f.handleDurationchange=function(){this.toggleTracking()},f.toggleTracking=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},f.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))},f.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)},f.handleSeeked=function(){var s=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&s>2,this.nextSeekedFromUser_=!1,this.trackLive_()},f.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)},f.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)},f.nextSeekedFromUser=function(){this.nextSeekedFromUser_=!0},f.stopTracking=function(){!this.isTracking()||(this.reset_(),this.trigger("liveedgechange"))},f.seekableEnd=function(){for(var s=this.player_.seekable(),u=[],m=s?s.length:0;m--;)u.push(s.end(m));return u.length?u.sort()[u.length-1]:1/0},f.seekableStart=function(){for(var s=this.player_.seekable(),u=[],m=s?s.length:0;m--;)u.push(s.start(m));return u.length?u.sort()[0]:0},f.liveWindow=function(){var s=this.liveCurrentTime();return s===1/0?0:s-this.seekableStart()},f.isLive=function(){return this.isTracking()},f.atLiveEdge=function(){return!this.behindLiveEdge()},f.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},f.pastSeekEnd=function(){var s=this.seekableEnd();return-1!==this.lastSeekEnd_&&s!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=s,this.pastSeekEnd_},f.behindLiveEdge=function(){return this.behindLiveEdge_},f.isTracking=function(){return"number"==typeof this.trackingInterval_},f.seekToLiveEdge=function(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))},f.dispose=function(){this.off(Oe(),"visibilitychange",this.handleVisibilityChange_),this.stopTracking(),b.prototype.dispose.call(this)},d}(Rt);Rt.registerComponent("LiveTracker",p0);var xd,m0=function(d){var f=d.el();if(f.hasAttribute("src"))return d.triggerSourceset(f.src),!0;var h=d.$$("source"),s=[],u="";if(!h.length)return!1;for(var m=0;m<h.length;m++){var T=h[m].src;T&&-1===s.indexOf(T)&&s.push(T)}return!!s.length&&(1===s.length&&(u=s[0]),d.triggerSourceset(u),!0)},_v=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(d){var f=Oe().createElement(this.nodeName.toLowerCase());f.innerHTML=d;for(var h=Oe().createDocumentFragment();f.childNodes.length;)h.appendChild(f.childNodes[0]);return this.innerText="",se().Element.prototype.appendChild.call(this,h),this.innerHTML}}),g0=function(d,f){for(var h={},s=0;s<d.length&&!((h=Object.getOwnPropertyDescriptor(d[s],f))&&h.set&&h.get);s++);return h.enumerable=!0,h.configurable=!0,h},tp=function(d){var f=d.el();if(!f.resetSourceWatch_){var h={},s=function(d){return g0([d.el(),se().HTMLMediaElement.prototype,se().Element.prototype,_v],"innerHTML")}(d),u=function(T){return function(){for(var S=arguments.length,D=new Array(S),P=0;P<S;P++)D[P]=arguments[P];var W=T.apply(f,D);return m0(d),W}};["append","appendChild","insertAdjacentHTML"].forEach(function(m){!f[m]||(h[m]=f[m],f[m]=u(h[m]))}),Object.defineProperty(f,"innerHTML",Dr(s,{set:u(s.set)})),f.resetSourceWatch_=function(){f.resetSourceWatch_=null,Object.keys(h).forEach(function(m){f[m]=h[m]}),Object.defineProperty(f,"innerHTML",s)},d.one("sourceset",f.resetSourceWatch_)}},yv=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Jg(se().Element.prototype.getAttribute.call(this,"src")):""},set:function(d){return se().Element.prototype.setAttribute.call(this,"src",d),d}}),bv=function(d,f,h,s){void 0===s&&(s=!0);var u=function(S){return Object.defineProperty(d,f,{value:S,enumerable:!0,writable:!0})},m={configurable:!0,enumerable:!0,get:function(){var S=h();return u(S),S}};return s&&(m.set=u),Object.defineProperty(d,f,m)},wn=function(b){function d(h,s){var u;u=b.call(this,h,s)||this;var m=h.source,T=!1;if(u.featuresVideoFrameCallback=u.featuresVideoFrameCallback&&"VIDEO"===u.el_.tagName,m&&(u.el_.currentSrc!==m.src||h.tag&&3===h.tag.initNetworkState_)?u.setSource(m):u.handleLateInit_(u.el_),h.enableSourceset&&u.setupSourcesetHandling_(),u.isScrubbing_=!1,u.el_.hasChildNodes()){for(var S=u.el_.childNodes,D=S.length,P=[];D--;){var W=S[D];"track"===W.nodeName.toLowerCase()&&(u.featuresNativeTextTracks?(u.remoteTextTrackEls().addTrackElement_(W),u.remoteTextTracks().addTrack(W.track),u.textTracks().addTrack(W.track),!T&&!u.el_.hasAttribute("crossorigin")&&vd(W.src)&&(T=!0)):P.push(W))}for(var te=0;te<P.length;te++)u.el_.removeChild(P[te])}return u.proxyNativeTracks_(),u.featuresNativeTextTracks&&T&&Kt.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),u.restoreMetadataTracksInIOSNativePlayer_(),(Jn||G_||Hu)&&!0===h.nativeControlsForTouch&&u.setControls(!0),u.proxyWebkitFullscreen_(),u.triggerReady(),u}ze(d,b);var f=d.prototype;return f.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),d.disposeMediaElement(this.el_),this.options_=null,b.prototype.dispose.call(this)},f.setupSourcesetHandling_=function(){!function(d){if(d.featuresSourceset){var f=d.el();if(!f.resetSourceset_){var h=function(d){return g0([d.el(),se().HTMLMediaElement.prototype,yv],"src")}(d),s=f.setAttribute,u=f.load;Object.defineProperty(f,"src",Dr(h,{set:function(T){var S=h.set.call(f,T);return d.triggerSourceset(f.src),S}})),f.setAttribute=function(m,T){var S=s.call(f,m,T);return/src/i.test(m)&&d.triggerSourceset(f.src),S},f.load=function(){var m=u.call(f);return m0(d)||(d.triggerSourceset(""),tp(d)),m},f.currentSrc?d.triggerSourceset(f.currentSrc):m0(d)||tp(d),f.resetSourceset_=function(){f.resetSourceset_=null,f.load=u,f.setAttribute=s,Object.defineProperty(f,"src",h),f.resetSourceWatch_&&f.resetSourceWatch_()}}}}(this)},f.restoreMetadataTracksInIOSNativePlayer_=function(){var u,s=this.textTracks(),m=function(){u=[];for(var D=0;D<s.length;D++){var P=s[D];"metadata"===P.kind&&u.push({track:P,storedMode:P.mode})}};m(),s.addEventListener("change",m),this.on("dispose",function(){return s.removeEventListener("change",m)});var T=function S(){for(var D=0;D<u.length;D++){var P=u[D];"disabled"===P.track.mode&&P.track.mode!==P.storedMode&&(P.track.mode=P.storedMode)}s.removeEventListener("change",S)};this.on("webkitbeginfullscreen",function(){s.removeEventListener("change",m),s.removeEventListener("change",T),s.addEventListener("change",T)}),this.on("webkitendfullscreen",function(){s.removeEventListener("change",m),s.addEventListener("change",m),s.removeEventListener("change",T)})},f.overrideNative_=function(s,u){var m=this;if(u===this["featuresNative"+s+"Tracks"]){var T=s.toLowerCase();this[T+"TracksListeners_"]&&Object.keys(this[T+"TracksListeners_"]).forEach(function(S){m.el()[T+"Tracks"].removeEventListener(S,m[T+"TracksListeners_"][S])}),this["featuresNative"+s+"Tracks"]=!u,this[T+"TracksListeners_"]=null,this.proxyNativeTracksForType_(T)}},f.overrideNativeAudioTracks=function(s){this.overrideNative_("Audio",s)},f.overrideNativeVideoTracks=function(s){this.overrideNative_("Video",s)},f.proxyNativeTracksForType_=function(s){var u=this,m=$s[s],T=this.el()[m.getterName],S=this[m.getterName]();if(this["featuresNative"+m.capitalName+"Tracks"]&&T&&T.addEventListener){var D={change:function(H){var te={type:"change",target:S,currentTarget:S,srcElement:S};S.trigger(te),"text"===s&&u[yh.remoteText.getterName]().trigger(te)},addtrack:function(H){S.addTrack(H.track)},removetrack:function(H){S.removeTrack(H.track)}},P=function(){for(var H=[],te=0;te<S.length;te++){for(var le=!1,ce=0;ce<T.length;ce++)if(T[ce]===S[te]){le=!0;break}le||H.push(S[te])}for(;H.length;)S.removeTrack(H.shift())};this[m.getterName+"Listeners_"]=D,Object.keys(D).forEach(function(W){var H=D[W];T.addEventListener(W,H),u.on("dispose",function(te){return T.removeEventListener(W,H)})}),this.on("loadstart",P),this.on("dispose",function(W){return u.off("loadstart",P)})}},f.proxyNativeTracks_=function(){var s=this;$s.names.forEach(function(u){s.proxyNativeTracksForType_(u)})},f.createEl=function(){var s=this.options_.tag;if(!s||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(s){var u=s.cloneNode(!0);s.parentNode&&s.parentNode.insertBefore(u,s),d.disposeMediaElement(s),s=u}else{s=Oe().createElement("video");var T=Dr({},this.options_.tag&&Ol(this.options_.tag));(!Jn||!0!==this.options_.nativeControlsForTouch)&&delete T.controls,Bf(s,zr(T,{id:this.options_.techId,class:"vjs-tech"}))}s.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&dd(s,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(s.disablePictureInPicture=this.options_.disablePictureInPicture);for(var S=["loop","muted","playsinline","autoplay"],D=0;D<S.length;D++){var P=S[D],W=this.options_[P];typeof W<"u"&&(W?dd(s,P,P):Uf(s,P),s[P]=W)}return s},f.handleLateInit_=function(s){if(0!==s.networkState&&3!==s.networkState){if(0===s.readyState){var u=!1,m=function(){u=!0};this.on("loadstart",m);var T=function(){u||this.trigger("loadstart")};return this.on("loadedmetadata",T),void this.ready(function(){this.off("loadstart",m),this.off("loadedmetadata",T),u||this.trigger("loadstart")})}var S=["loadstart"];S.push("loadedmetadata"),s.readyState>=2&&S.push("loadeddata"),s.readyState>=3&&S.push("canplay"),s.readyState>=4&&S.push("canplaythrough"),this.ready(function(){S.forEach(function(D){this.trigger(D)},this)})}},f.setScrubbing=function(s){this.isScrubbing_=s},f.scrubbing=function(){return this.isScrubbing_},f.setCurrentTime=function(s){try{this.isScrubbing_&&this.el_.fastSeek&&Pl?this.el_.fastSeek(s):this.el_.currentTime=s}catch(u){Kt(u,"Video is not ready. (Video.js)")}},f.duration=function(){var s=this;return this.el_.duration===1/0&&ca&&Gu&&0===this.el_.currentTime?(this.on("timeupdate",function m(){s.el_.currentTime>0&&(s.el_.duration===1/0&&s.trigger("durationchange"),s.off("timeupdate",m))}),NaN):this.el_.duration||NaN},f.width=function(){return this.el_.offsetWidth},f.height=function(){return this.el_.offsetHeight},f.proxyWebkitFullscreen_=function(){var s=this;if("webkitDisplayingFullscreen"in this.el_){var u=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},m=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",u),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",m),this.on("dispose",function(){s.off("webkitbeginfullscreen",m),s.off("webkitendfullscreen",u)})}},f.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var s=se().navigator&&se().navigator.userAgent||"";if(/Android/.test(s)||!/Chrome|Mac OS X 10.5/.test(s))return!0}return!1},f.enterFullScreen=function(){var s=this.el_;if(s.paused&&s.networkState<=s.HAVE_METADATA)pu(this.el_.play()),this.setTimeout(function(){s.pause();try{s.webkitEnterFullScreen()}catch(u){this.trigger("fullscreenerror",u)}},0);else try{s.webkitEnterFullScreen()}catch(u){this.trigger("fullscreenerror",u)}},f.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},f.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},f.requestVideoFrameCallback=function(s){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(s):b.prototype.requestVideoFrameCallback.call(this,s)},f.cancelVideoFrameCallback=function(s){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(s):b.prototype.cancelVideoFrameCallback.call(this,s)},f.src=function(s){if(void 0===s)return this.el_.src;this.setSrc(s)},f.reset=function(){d.resetMediaElement(this.el_)},f.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},f.setControls=function(s){this.el_.controls=!!s},f.addTextTrack=function(s,u,m){return this.featuresNativeTextTracks?this.el_.addTextTrack(s,u,m):b.prototype.addTextTrack.call(this,s,u,m)},f.createRemoteTextTrack=function(s){if(!this.featuresNativeTextTracks)return b.prototype.createRemoteTextTrack.call(this,s);var u=Oe().createElement("track");return s.kind&&(u.kind=s.kind),s.label&&(u.label=s.label),(s.language||s.srclang)&&(u.srclang=s.language||s.srclang),s.default&&(u.default=s.default),s.id&&(u.id=s.id),s.src&&(u.src=s.src),u},f.addRemoteTextTrack=function(s,u){var m=b.prototype.addRemoteTextTrack.call(this,s,u);return this.featuresNativeTextTracks&&this.el().appendChild(m),m},f.removeRemoteTextTrack=function(s){if(b.prototype.removeRemoteTextTrack.call(this,s),this.featuresNativeTextTracks)for(var u=this.$$("track"),m=u.length;m--;)(s===u[m]||s===u[m].track)&&this.el().removeChild(u[m])},f.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var s={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(s.droppedVideoFrames=this.el().webkitDroppedFrameCount,s.totalVideoFrames=this.el().webkitDecodedFrameCount),se().performance&&"function"==typeof se().performance.now?s.creationTime=se().performance.now():se().performance&&se().performance.timing&&"number"==typeof se().performance.timing.navigationStart&&(s.creationTime=se().Date.now()-se().performance.timing.navigationStart),s},d}(Nr);bv(wn,"TEST_VID",function(){if(hu()){var b=Oe().createElement("video"),d=Oe().createElement("track");return d.kind="captions",d.srclang="en",d.label="English",b.appendChild(d),b}}),wn.isSupported=function(){try{wn.TEST_VID.volume=.5}catch{return!1}return!(!wn.TEST_VID||!wn.TEST_VID.canPlayType)},wn.canPlayType=function(b){return wn.TEST_VID.canPlayType(b)},wn.canPlaySource=function(b,d){return wn.canPlayType(b.type)},wn.canControlVolume=function(){try{var b=wn.TEST_VID.volume;wn.TEST_VID.volume=b/2+.1;var d=b!==wn.TEST_VID.volume;return d&&Ao?(se().setTimeout(function(){wn&&wn.prototype&&(wn.prototype.featuresVolumeControl=b!==wn.TEST_VID.volume)}),!1):d}catch{return!1}},wn.canMuteVolume=function(){try{var b=wn.TEST_VID.muted;return wn.TEST_VID.muted=!b,wn.TEST_VID.muted?dd(wn.TEST_VID,"muted","muted"):Uf(wn.TEST_VID,"muted"),b!==wn.TEST_VID.muted}catch{return!1}},wn.canControlPlaybackRate=function(){if(ca&&Gu&&Wg<58)return!1;try{var b=wn.TEST_VID.playbackRate;return wn.TEST_VID.playbackRate=b/2+.1,b!==wn.TEST_VID.playbackRate}catch{return!1}},wn.canOverrideAttributes=function(){try{var b=function(){};Object.defineProperty(Oe().createElement("video"),"src",{get:b,set:b}),Object.defineProperty(Oe().createElement("audio"),"src",{get:b,set:b}),Object.defineProperty(Oe().createElement("video"),"innerHTML",{get:b,set:b}),Object.defineProperty(Oe().createElement("audio"),"innerHTML",{get:b,set:b})}catch{return!1}return!0},wn.supportsNativeTextTracks=function(){return Pl||Ao&&Gu},wn.supportsNativeVideoTracks=function(){return!(!wn.TEST_VID||!wn.TEST_VID.videoTracks)},wn.supportsNativeAudioTracks=function(){return!(!wn.TEST_VID||!wn.TEST_VID.audioTracks)},wn.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(b){var f=b[1];bv(wn.prototype,b[0],function(){return wn[f]()},!0)}),wn.prototype.featuresVolumeControl=wn.canControlVolume(),wn.prototype.movingMediaElementInDOM=!Ao,wn.prototype.featuresFullscreenResize=!0,wn.prototype.featuresProgressEvents=!0,wn.prototype.featuresTimeupdateEvents=!0,wn.prototype.featuresVideoFrameCallback=!(!wn.TEST_VID||!wn.TEST_VID.requestVideoFrameCallback),wn.patchCanPlayType=function(){Vu>=4&&!fl&&!Gu&&(xd=wn.TEST_VID&&wn.TEST_VID.constructor.prototype.canPlayType,wn.TEST_VID.constructor.prototype.canPlayType=function(b){return b&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(b)?"maybe":xd.call(this,b)})},wn.unpatchCanPlayType=function(){var b=wn.TEST_VID.constructor.prototype.canPlayType;return xd&&(wn.TEST_VID.constructor.prototype.canPlayType=xd),b},wn.patchCanPlayType(),wn.disposeMediaElement=function(b){if(b){for(b.parentNode&&b.parentNode.removeChild(b);b.hasChildNodes();)b.removeChild(b.firstChild);b.removeAttribute("src"),"function"==typeof b.load&&function(){try{b.load()}catch{}}()}},wn.resetMediaElement=function(b){if(b){for(var d=b.querySelectorAll("source"),f=d.length;f--;)b.removeChild(d[f]);b.removeAttribute("src"),"function"==typeof b.load&&function(){try{b.load()}catch{}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(b){wn.prototype[b]=function(){return this.el_[b]||this.el_.hasAttribute(b)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(b){wn.prototype["set"+Rr(b)]=function(d){this.el_[b]=d,d?this.el_.setAttribute(b,b):this.el_.removeAttribute(b)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(b){wn.prototype[b]=function(){return this.el_[b]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(b){wn.prototype["set"+Rr(b)]=function(d){this.el_[b]=d}}),["pause","load","play"].forEach(function(b){wn.prototype[b]=function(){return this.el_[b]()}}),Nr.withSourceHandlers(wn),wn.nativeSourceHandler={},wn.nativeSourceHandler.canPlayType=function(b){try{return wn.TEST_VID.canPlayType(b)}catch{return""}},wn.nativeSourceHandler.canHandleSource=function(b,d){if(b.type)return wn.nativeSourceHandler.canPlayType(b.type);if(b.src){var f=bm(b.src);return wn.nativeSourceHandler.canPlayType("video/"+f)}return""},wn.nativeSourceHandler.handleSource=function(b,d,f){d.setSrc(b.src)},wn.nativeSourceHandler.dispose=function(){},wn.registerSourceHandler(wn.nativeSourceHandler),Nr.registerTech("Html5",wn);var Pm=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Om={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Lm=["tiny","xsmall","small","medium","large","xlarge","huge"],np={};Lm.forEach(function(b){var d="x"===b.charAt(0)?"x-"+b.substring(1):b;np[b]="vjs-layout-"+d});var Sd={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},ta=function(b){function d(h,s,u){var m;if(h.id=h.id||s.id||"vjs_video_"+ro(),(s=zr(d.getTagSettings(h),s)).initChildren=!1,s.createEl=!1,s.evented=!1,s.reportTouchActivity=!1,!s.language)if("function"==typeof h.closest){var T=h.closest("[lang]");T&&T.getAttribute&&(s.language=T.getAttribute("lang"))}else for(var S=h;S&&1===S.nodeType;){if(Ol(S).hasOwnProperty("lang")){s.language=S.getAttribute("lang");break}S=S.parentNode}if((m=b.call(this,null,s,u)||this).boundDocumentFullscreenChange_=function(H){return m.documentFullscreenChange_(H)},m.boundFullWindowOnEscKey_=function(H){return m.fullWindowOnEscKey(H)},m.boundUpdateStyleEl_=function(H){return m.updateStyleEl_(H)},m.boundApplyInitTime_=function(H){return m.applyInitTime_(H)},m.boundUpdateCurrentBreakpoint_=function(H){return m.updateCurrentBreakpoint_(H)},m.boundHandleTechClick_=function(H){return m.handleTechClick_(H)},m.boundHandleTechDoubleClick_=function(H){return m.handleTechDoubleClick_(H)},m.boundHandleTechTouchStart_=function(H){return m.handleTechTouchStart_(H)},m.boundHandleTechTouchMove_=function(H){return m.handleTechTouchMove_(H)},m.boundHandleTechTouchEnd_=function(H){return m.handleTechTouchEnd_(H)},m.boundHandleTechTap_=function(H){return m.handleTechTap_(H)},m.isFullscreen_=!1,m.log=dl(m.id_),m.fsApi_=io,m.isPosterFromTech_=!1,m.queuedCallbacks_=[],m.isReady_=!1,m.hasStarted_=!1,m.userActive_=!1,m.debugEnabled_=!1,m.audioOnlyMode_=!1,m.audioPosterMode_=!1,m.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!m.options_||!m.options_.techOrder||!m.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(m.tag=h,m.tagAttributes=h&&Ol(h),m.language(m.options_.language),s.languages){var D={};Object.getOwnPropertyNames(s.languages).forEach(function(H){D[H.toLowerCase()]=s.languages[H]}),m.languages_=D}else m.languages_=d.prototype.options_.languages;m.resetCache_(),m.poster_=s.poster||"",m.controls_=!!s.controls,h.controls=!1,h.removeAttribute("controls"),m.changingSrc_=!1,m.playCallbacks_=[],m.playTerminatedQueue_=[],h.hasAttribute("autoplay")?m.autoplay(!0):m.autoplay(m.options_.autoplay),s.plugins&&Object.keys(s.plugins).forEach(function(H){if("function"!=typeof m[H])throw new Error('plugin "'+H+'" does not exist')}),m.scrubbing_=!1,m.el_=m.createEl(),ks(gt(m),{eventBusKey:"el_"}),m.fsApi_.requestFullscreen&&(so(Oe(),m.fsApi_.fullscreenchange,m.boundDocumentFullscreenChange_),m.on(m.fsApi_.fullscreenchange,m.boundDocumentFullscreenChange_)),m.fluid_&&m.on(["playerreset","resize"],m.boundUpdateStyleEl_);var P=Dr(m.options_);s.plugins&&Object.keys(s.plugins).forEach(function(H){m[H](s.plugins[H])}),s.debug&&m.debug(!0),m.options_.playerOptions=P,m.middleware_=[],m.playbackRates(s.playbackRates),m.initChildren(),m.isAudio("audio"===h.nodeName.toLowerCase()),m.controls()?m.addClass("vjs-controls-enabled"):m.addClass("vjs-controls-disabled"),m.el_.setAttribute("role","region"),m.isAudio()?m.el_.setAttribute("aria-label",m.localize("Audio Player")):m.el_.setAttribute("aria-label",m.localize("Video Player")),m.isAudio()&&m.addClass("vjs-audio"),m.flexNotSupported_()&&m.addClass("vjs-no-flex"),Jn&&m.addClass("vjs-touch-enabled"),Ao||m.addClass("vjs-workinghover"),d.players[m.id_]=gt(m);var W="7.20.3".split(".")[0];return m.addClass("vjs-v"+W),m.userActive(!0),m.reportUserActivity(),m.one("play",function(H){return m.listenForUserActivity_(H)}),m.on("stageclick",function(H){return m.handleStageClick_(H)}),m.on("keydown",function(H){return m.handleKeyDown(H)}),m.on("languagechange",function(H){return m.handleLanguagechange(H)}),m.breakpoints(m.options_.breakpoints),m.responsive(m.options_.responsive),m.on("ready",function(){m.audioPosterMode(m.options_.audioPosterMode),m.audioOnlyMode(m.options_.audioOnlyMode)}),m}ze(d,b);var f=d.prototype;return f.dispose=function(){var s=this;this.trigger("dispose"),this.off("dispose"),ft(Oe(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),ft(Oe(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),d.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),function qy(b){bh[b.id()]=null}(this),ha.names.forEach(function(u){var T=s[ha[u].getterName]();T&&T.off&&T.off()}),b.prototype.dispose.call(this,{restoreEl:this.options_.restoreEl})},f.createEl=function(){var u,s=this.tag,m=this.playerElIngest_=s.parentNode&&s.parentNode.hasAttribute&&s.parentNode.hasAttribute("data-vjs-player"),T="video-js"===this.tag.tagName.toLowerCase();m?u=this.el_=s.parentNode:T||(u=this.el_=b.prototype.createEl.call(this,"div"));var S=Ol(s);if(T){for(u=this.el_=s,s=this.tag=Oe().createElement("video");u.children.length;)s.appendChild(u.firstChild);cd(u,"video-js")||hs(u,"video-js"),u.appendChild(s),m=this.playerElIngest_=u,Object.keys(u).forEach(function(le){try{s[le]=u[le]}catch{}})}if(s.setAttribute("tabindex","-1"),S.tabindex="-1",(uh||Gu&&H_)&&(s.setAttribute("role","application"),S.role="application"),s.removeAttribute("width"),s.removeAttribute("height"),"width"in S&&delete S.width,"height"in S&&delete S.height,Object.getOwnPropertyNames(S).forEach(function(le){T&&"class"===le||u.setAttribute(le,S[le]),T&&s.setAttribute(le,S[le])}),s.playerId=s.id,s.id+="_html5_api",s.className="vjs-tech",s.player=u.player=this,this.addClass("vjs-paused"),!0!==se().VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=xo("vjs-styles-dimensions");var D=Ll(".vjs-styles-defaults"),P=Ll("head");P.insertBefore(this.styleEl_,D?D.nextSibling:P.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var W=s.getElementsByTagName("a"),H=0;H<W.length;H++){var te=W.item(H);hs(te,"vjs-hidden"),te.setAttribute("hidden","hidden")}return s.initNetworkState_=s.networkState,s.parentNode&&!m&&s.parentNode.insertBefore(u,s),za(s,u),this.children_.unshift(s),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=u,u},f.crossOrigin=function(s){if(!s)return this.techGet_("crossOrigin");"anonymous"===s||"use-credentials"===s?this.techCall_("setCrossOrigin",s):Kt.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+s+'"')},f.width=function(s){return this.dimension("width",s)},f.height=function(s){return this.dimension("height",s)},f.dimension=function(s,u){var m=s+"_";if(void 0===u)return this[m]||0;if(""===u||"auto"===u)return this[m]=void 0,void this.updateStyleEl_();var T=parseFloat(u);isNaN(T)?Kt.error('Improper value "'+u+'" supplied for for '+s):(this[m]=T,this.updateStyleEl_())},f.fluid=function(s){var u=this;if(void 0===s)return!!this.fluid_;this.fluid_=!!s,Fl(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),s?(this.addClass("vjs-fluid"),this.fill(!1),function(d,f){Fl(d)?f():(d.eventedCallbacks||(d.eventedCallbacks=[]),d.eventedCallbacks.push(f))}(this,function(){u.on(["playerreset","resize"],u.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},f.fill=function(s){if(void 0===s)return!!this.fill_;this.fill_=!!s,s?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},f.aspectRatio=function(s){if(void 0===s)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(s))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=s,this.fluid(!0),this.updateStyleEl_()},f.updateStyleEl_=function(){if(!0!==se().VIDEOJS_NO_DYNAMIC_STYLE){var T,S,P,W=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),H=W[1]/W[0];T=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/H:this.videoWidth()||300,S=void 0!==this.height_?this.height_:T*H,P=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(P),gm(this.styleEl_,"\n      ."+P+" {\n        width: "+T+"px;\n        height: "+S+"px;\n      }\n\n      ."+P+".vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: "+100*H+"%;\n      }\n    ")}else{var s="number"==typeof this.width_?this.width_:this.options_.width,u="number"==typeof this.height_?this.height_:this.options_.height,m=this.tech_&&this.tech_.el();m&&(s>=0&&(m.width=s),u>=0&&(m.height=u))}},f.loadTech_=function(s,u){var m=this;this.tech_&&this.unloadTech_();var T=Rr(s),S=s.charAt(0).toLowerCase()+s.slice(1);"Html5"!==T&&this.tag&&(Nr.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=T,this.isReady_=!1;var D=this.autoplay();("string"==typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay)&&(D=!1);var P={source:u,autoplay:D,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+S+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};ha.names.forEach(function(H){var te=ha[H];P[te.getterName]=m[te.privateName]}),zr(P,this.options_[T]),zr(P,this.options_[S]),zr(P,this.options_[s.toLowerCase()]),this.tag&&(P.tag=this.tag),u&&u.src===this.cache_.src&&this.cache_.currentTime>0&&(P.startTime=this.cache_.currentTime);var W=Nr.getTech(s);if(!W)throw new Error("No Tech named '"+T+"' exists! '"+T+"' should be registered using videojs.registerTech()'");this.tech_=new W(P),this.tech_.ready(hr(this,this.handleTechReady_),!0),function(d,f){d.forEach(function(h){var s=f.addRemoteTextTrack(h).track;!h.src&&h.cues&&h.cues.forEach(function(u){return s.addCue(u)})}),f.textTracks()}(this.textTracksJson_||[],this.tech_),Pm.forEach(function(H){m.on(m.tech_,H,function(te){return m["handleTech"+Rr(H)+"_"](te)})}),Object.keys(Om).forEach(function(H){m.on(m.tech_,H,function(te){0===m.tech_.playbackRate()&&m.tech_.seeking()?m.queuedCallbacks_.push({callback:m["handleTech"+Om[H]+"_"].bind(m),event:te}):m["handleTech"+Om[H]+"_"](te)})}),this.on(this.tech_,"loadstart",function(H){return m.handleTechLoadStart_(H)}),this.on(this.tech_,"sourceset",function(H){return m.handleTechSourceset_(H)}),this.on(this.tech_,"waiting",function(H){return m.handleTechWaiting_(H)}),this.on(this.tech_,"ended",function(H){return m.handleTechEnded_(H)}),this.on(this.tech_,"seeking",function(H){return m.handleTechSeeking_(H)}),this.on(this.tech_,"play",function(H){return m.handleTechPlay_(H)}),this.on(this.tech_,"firstplay",function(H){return m.handleTechFirstPlay_(H)}),this.on(this.tech_,"pause",function(H){return m.handleTechPause_(H)}),this.on(this.tech_,"durationchange",function(H){return m.handleTechDurationChange_(H)}),this.on(this.tech_,"fullscreenchange",function(H,te){return m.handleTechFullscreenChange_(H,te)}),this.on(this.tech_,"fullscreenerror",function(H,te){return m.handleTechFullscreenError_(H,te)}),this.on(this.tech_,"enterpictureinpicture",function(H){return m.handleTechEnterPictureInPicture_(H)}),this.on(this.tech_,"leavepictureinpicture",function(H){return m.handleTechLeavePictureInPicture_(H)}),this.on(this.tech_,"error",function(H){return m.handleTechError_(H)}),this.on(this.tech_,"posterchange",function(H){return m.handleTechPosterChange_(H)}),this.on(this.tech_,"textdata",function(H){return m.handleTechTextData_(H)}),this.on(this.tech_,"ratechange",function(H){return m.handleTechRateChange_(H)}),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&("Html5"!==T||!this.tag)&&za(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},f.unloadTech_=function(){var s=this;ha.names.forEach(function(u){var m=ha[u];s[m.privateName]=s[m.getterName]()}),this.textTracksJson_=function(d){var f=d.$$("track"),h=Array.prototype.map.call(f,function(u){return u.track});return Array.prototype.map.call(f,function(u){var m=Qg(u.track);return u.src&&(m.src=u.src),m}).concat(Array.prototype.filter.call(d.textTracks(),function(u){return-1===h.indexOf(u)}).map(Qg))}(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},f.tech=function(s){return void 0===s&&Kt.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},f.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)},f.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)},f.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},f.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())},f.manualAutoplay_=function(s){var u=this;if(this.tech_&&"string"==typeof s){var T,m=function(){var D=u.muted();u.muted(!0);var P=function(){u.muted(D)};u.playTerminatedQueue_.push(P);var W=u.play();if(jf(W))return W.catch(function(H){throw P(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(H||""))})};if("any"!==s||this.muted()?T="muted"!==s||this.muted()?this.play():m():jf(T=this.play())&&(T=T.catch(m)),jf(T))return T.then(function(){u.trigger({type:"autoplay-success",autoplay:s})}).catch(function(){u.trigger({type:"autoplay-failure",autoplay:s})})}},f.updateSourceCaches_=function(s){void 0===s&&(s="");var u=s,m="";"string"!=typeof u&&(u=s.src,m=s.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],u&&!m&&(m=function(d,f){if(!f)return"";if(d.cache_.source.src===f&&d.cache_.source.type)return d.cache_.source.type;var h=d.cache_.sources.filter(function(T){return T.src===f});if(h.length)return h[0].type;for(var s=d.$$("source"),u=0;u<s.length;u++){var m=s[u];if(m.type&&m.src&&m.src===f)return m.type}return Yf(f)}(this,u)),this.cache_.source=Dr({},s,{src:u,type:m});for(var T=this.cache_.sources.filter(function(te){return te.src&&te.src===u}),S=[],D=this.$$("source"),P=[],W=0;W<D.length;W++){var H=Ol(D[W]);S.push(H),H.src&&H.src===u&&P.push(H.src)}P.length&&!T.length?this.cache_.sources=S:T.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=u},f.handleTechSourceset_=function(s){var u=this;if(!this.changingSrc_){var m=function(P){return u.updateSourceCaches_(P)},T=this.currentSource().src,S=s.src;T&&!/^blob:/.test(T)&&/^blob:/.test(S)&&(!this.lastSource_||this.lastSource_.tech!==S&&this.lastSource_.player!==T)&&(m=function(){}),m(S),s.src||this.tech_.any(["sourceset","loadstart"],function(D){if("sourceset"!==D.type){var P=u.techGet("currentSrc");u.lastSource_.tech=P,u.updateSourceCaches_(P)}})}this.lastSource_={player:this.currentSource().src,tech:s.src},this.trigger({src:s.src,type:"sourceset"})},f.hasStarted=function(s){if(void 0===s)return this.hasStarted_;s!==this.hasStarted_&&(this.hasStarted_=s,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},f.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},f.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(s){return s.callback(s.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},f.handleTechWaiting_=function(){var s=this;this.addClass("vjs-waiting"),this.trigger("waiting");var u=this.currentTime();this.on("timeupdate",function T(){u!==s.currentTime()&&(s.removeClass("vjs-waiting"),s.off("timeupdate",T))})},f.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},f.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},f.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},f.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},f.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},f.handleTechFirstPlay_=function(){this.options_.starttime&&(Kt.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},f.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},f.handleTechEnded_=function(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},f.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},f.handleTechClick_=function(s){!this.controls_||(void 0===this.options_||void 0===this.options_.userActions||void 0===this.options_.userActions.click||!1!==this.options_.userActions.click)&&(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.click?this.options_.userActions.click.call(this,s):this.paused()?pu(this.play()):this.pause())},f.handleTechDoubleClick_=function(s){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(m){return m.contains(s.target)})||(void 0===this.options_||void 0===this.options_.userActions||void 0===this.options_.userActions.doubleClick||!1!==this.options_.userActions.doubleClick)&&(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,s):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},f.handleTechTap_=function(){this.userActive(!this.userActive())},f.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},f.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},f.handleTechTouchEnd_=function(s){s.cancelable&&s.preventDefault()},f.handleStageClick_=function(){this.reportUserActivity()},f.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},f.documentFullscreenChange_=function(s){var u=s.target.player;if(!u||u===this){var m=this.el(),T=Oe()[this.fsApi_.fullscreenElement]===m;!T&&m.matches?T=m.matches(":"+this.fsApi_.fullscreen):!T&&m.msMatchesSelector&&(T=m.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(T)}},f.handleTechFullscreenChange_=function(s,u){var m=this;u&&(u.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",function(){m.removeClass("vjs-ios-native-fs")})),this.isFullscreen(u.isFullscreen))},f.handleTechFullscreenError_=function(s,u){this.trigger("fullscreenerror",u)},f.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},f.handleTechEnterPictureInPicture_=function(s){this.isInPictureInPicture(!0)},f.handleTechLeavePictureInPicture_=function(s){this.isInPictureInPicture(!1)},f.handleTechError_=function(){var s=this.tech_.error();this.error(s)},f.handleTechTextData_=function(){var s=null;arguments.length>1&&(s=arguments[1]),this.trigger("textdata",s)},f.getCache=function(){return this.cache_},f.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}},f.techCall_=function(s,u){this.ready(function(){if(s in $y)return function Wy(b,d,f,h){return d[f](b.reduce(Am(f),h))}(this.middleware_,this.tech_,s,u);if(s in iv)return qf(this.middleware_,this.tech_,s,u);try{this.tech_&&this.tech_[s](u)}catch(m){throw Kt(m),m}},!0)},f.techGet_=function(s){if(this.tech_&&this.tech_.isReady_){if(s in Xf)return function e0(b,d,f){return b.reduceRight(Am(f),d[f]())}(this.middleware_,this.tech_,s);if(s in iv)return qf(this.middleware_,this.tech_,s);try{return this.tech_[s]()}catch(u){throw void 0===this.tech_[s]?(Kt("Video.js: "+s+" method not defined for "+this.techName_+" playback technology.",u),u):"TypeError"===u.name?(Kt("Video.js: "+s+" unavailable on "+this.techName_+" playback technology element.",u),this.tech_.isReady_=!1,u):(Kt(u),u)}}},f.play=function(){var s=this,u=this.options_.Promise||se().Promise;return u?new u(function(m){s.play_(m)}):this.play_()},f.play_=function(s){var u=this;void 0===s&&(s=pu),this.playCallbacks_.push(s);var m=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!m)return this.waitToPlay_=function(S){u.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(!m&&(Pl||Ao)&&this.load());var T=this.techGet_("play");null===T?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(T)},f.runPlayTerminatedQueue_=function(){var s=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],s.forEach(function(u){u()})},f.runPlayCallbacks_=function(s){var u=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],u.forEach(function(m){m(s)})},f.pause=function(){this.techCall_("pause")},f.paused=function(){return!1!==this.techGet_("paused")},f.played=function(){return this.techGet_("played")||gd(0,0)},f.scrubbing=function(s){if(typeof s>"u")return this.scrubbing_;this.scrubbing_=!!s,this.techCall_("setScrubbing",this.scrubbing_),s?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},f.currentTime=function(s){return typeof s<"u"?(s<0&&(s=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",s),void(this.cache_.initTime=0)):(this.cache_.initTime=s,this.off("canplay",this.boundApplyInitTime_),void this.one("canplay",this.boundApplyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},f.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},f.duration=function(s){if(void 0===s)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(s=parseFloat(s))<0&&(s=1/0),s!==this.cache_.duration&&(this.cache_.duration=s,s===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(s)||this.trigger("durationchange"))},f.remainingTime=function(){return this.duration()-this.currentTime()},f.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},f.buffered=function(){var s=this.techGet_("buffered");return(!s||!s.length)&&(s=gd(0,0)),s},f.bufferedPercent=function(){return $a(this.buffered(),this.duration())},f.bufferedEnd=function(){var s=this.buffered(),u=this.duration(),m=s.end(s.length-1);return m>u&&(m=u),m},f.volume=function(s){var u;return void 0!==s?(u=Math.max(0,Math.min(1,parseFloat(s))),this.cache_.volume=u,this.techCall_("setVolume",u),void(u>0&&this.lastVolume_(u))):(u=parseFloat(this.techGet_("volume")),isNaN(u)?1:u)},f.muted=function(s){if(void 0===s)return this.techGet_("muted")||!1;this.techCall_("setMuted",s)},f.defaultMuted=function(s){return void 0!==s?this.techCall_("setDefaultMuted",s):this.techGet_("defaultMuted")||!1},f.lastVolume_=function(s){if(void 0===s||0===s)return this.cache_.lastVolume;this.cache_.lastVolume=s},f.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},f.isFullscreen=function(s){if(void 0!==s){var u=this.isFullscreen_;return this.isFullscreen_=Boolean(s),this.isFullscreen_!==u&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_},f.requestFullscreen=function(s){var u=this.options_.Promise||se().Promise;if(u){var m=this;return new u(function(T,S){function D(){m.off("fullscreenerror",W),m.off("fullscreenchange",P)}function P(){D(),T()}function W(te,le){D(),S(le)}m.one("fullscreenchange",P),m.one("fullscreenerror",W);var H=m.requestFullscreenHelper_(s);H&&(H.then(D,D),H.then(T,S))})}return this.requestFullscreenHelper_()},f.requestFullscreenHelper_=function(s){var m,u=this;if(this.fsApi_.prefixed||(m=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==s&&(m=s)),this.fsApi_.requestFullscreen){var T=this.el_[this.fsApi_.requestFullscreen](m);return T&&T.then(function(){return u.isFullscreen(!0)},function(){return u.isFullscreen(!1)}),T}this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()},f.exitFullscreen=function(){var s=this.options_.Promise||se().Promise;if(s){var u=this;return new s(function(m,T){function S(){u.off("fullscreenerror",P),u.off("fullscreenchange",D)}function D(){S(),m()}function P(H,te){S(),T(te)}u.one("fullscreenchange",D),u.one("fullscreenerror",P);var W=u.exitFullscreenHelper_();W&&(W.then(S,S),W.then(m,T))})}return this.exitFullscreenHelper_()},f.exitFullscreenHelper_=function(){var s=this;if(this.fsApi_.requestFullscreen){var u=Oe()[this.fsApi_.exitFullscreen]();return u&&pu(u.then(function(){return s.isFullscreen(!1)})),u}this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},f.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=Oe().documentElement.style.overflow,so(Oe(),"keydown",this.boundFullWindowOnEscKey_),Oe().documentElement.style.overflow="hidden",hs(Oe().body,"vjs-full-window"),this.trigger("enterFullWindow")},f.fullWindowOnEscKey=function(s){yt().isEventKey(s,"Esc")&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())},f.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,ft(Oe(),"keydown",this.boundFullWindowOnEscKey_),Oe().documentElement.style.overflow=this.docOrigOverflow,Mc(Oe().body,"vjs-full-window"),this.trigger("exitFullWindow")},f.disablePictureInPicture=function(s){if(void 0===s)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",s),this.options_.disablePictureInPicture=s,this.trigger("disablepictureinpicturechanged")},f.isInPictureInPicture=function(s){return void 0!==s?(this.isInPictureInPicture_=!!s,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},f.requestPictureInPicture=function(){if("pictureInPictureEnabled"in Oe()&&!1===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")},f.exitPictureInPicture=function(){if("pictureInPictureEnabled"in Oe())return Oe().exitPictureInPicture()},f.handleKeyDown=function(s){var S,D,u=this.options_.userActions;u&&u.hotkeys&&(D=(S=this.el_.ownerDocument.activeElement).tagName.toLowerCase(),S.isContentEditable||("input"===D?-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(S.type):-1!==["textarea"].indexOf(D))||("function"==typeof u.hotkeys?u.hotkeys.call(this,s):this.handleHotkeys(s)))},f.handleHotkeys=function(s){var u=this.options_.userActions?this.options_.userActions.hotkeys:{},m=u.fullscreenKey,S=u.muteKey,D=void 0===S?function(ce){return yt().isEventKey(ce,"m")}:S,P=u.playPauseKey,W=void 0===P?function(ce){return yt().isEventKey(ce,"k")||yt().isEventKey(ce,"Space")}:P;if((void 0===m?function(ce){return yt().isEventKey(ce,"f")}:m).call(this,s)){s.preventDefault(),s.stopPropagation();var H=Rt.getComponent("FullscreenToggle");!1!==Oe()[this.fsApi_.fullscreenEnabled]&&H.prototype.handleClick.call(this,s)}else D.call(this,s)?(s.preventDefault(),s.stopPropagation(),Rt.getComponent("MuteToggle").prototype.handleClick.call(this,s)):W.call(this,s)&&(s.preventDefault(),s.stopPropagation(),Rt.getComponent("PlayToggle").prototype.handleClick.call(this,s))},f.canPlayType=function(s){for(var u,m=0,T=this.options_.techOrder;m<T.length;m++){var S=T[m],D=Nr.getTech(S);if(D||(D=Rt.getComponent(S)),D){if(D.isSupported()&&(u=D.canPlayType(s)))return u}else Kt.error('The "'+S+'" tech is undefined. Skipped browser support check for that tech.')}return""},f.selectSource=function(s){var H,u=this,m=this.options_.techOrder.map(function(W){return[W,Nr.getTech(W)]}).filter(function(W){var H=W[0],te=W[1];return te?te.isSupported():(Kt.error('The "'+H+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),T=function(H,te,le){var ce;return H.some(function(fe){return te.some(function(ue){if(ce=le(fe,ue))return!0})}),ce},P=function(H,te){var le=H[0];if(H[1].canPlaySource(te,u.options_[le.toLowerCase()]))return{source:te,tech:le}};return(this.options_.sourceOrder?T(s,m,(H=P,function(te,le){return H(le,te)})):T(m,s,P))||!1},f.handleSrc_=function(s,u){var m=this;if(typeof s>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var T=wh(s);if(T.length){if(this.changingSrc_=!0,u||(this.cache_.sources=T),this.updateSourceCaches_(T[0]),Z_(this,T[0],function(P,W){if(m.middleware_=W,u||(m.cache_.sources=T),m.updateSourceCaches_(P),m.src_(P))return T.length>1?m.handleSrc_(T.slice(1)):(m.changingSrc_=!1,m.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),void m.triggerReady());!function J_(b,d){b.forEach(function(f){return f.setTech&&f.setTech(d)})}(W,m.tech_)}),this.options_.retryOnError&&T.length>1){var S=function(){m.error(null),m.handleSrc_(T.slice(1),!0)},D=function(){m.off("error",S)};this.one("error",S),this.one("playing",D),this.resetRetryOnError_=function(){m.off("error",S),m.off("playing",D)}}}else this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0)},f.src=function(s){return this.handleSrc_(s,!1)},f.src_=function(s){var u=this,m=this.selectSource([s]);return!m||(function(d,f){return Rr(d)===Rr(f)}(m.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",s):this.techCall_("src",s.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(m.tech,m.source),this.tech_.ready(function(){u.changingSrc_=!1}),!1))},f.load=function(){this.techCall_("load")},f.reset=function(){var s=this,u=this.options_.Promise||se().Promise;this.paused()||!u?this.doReset_():pu(this.play().then(function(){return s.doReset_()}))},f.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Fl(this)&&this.trigger("playerreset")},f.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},f.resetProgressBar_=function(){this.currentTime(0);var s=this.controlBar||{},u=s.durationDisplay,m=s.remainingTimeDisplay;u&&u.updateContent(),m&&m.updateContent()},f.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},f.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},f.currentSources=function(){var s=this.currentSource(),u=[];return 0!==Object.keys(s).length&&u.push(s),this.cache_.sources||u},f.currentSource=function(){return this.cache_.source||{}},f.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},f.currentType=function(){return this.currentSource()&&this.currentSource().type||""},f.preload=function(s){return void 0!==s?(this.techCall_("setPreload",s),void(this.options_.preload=s)):this.techGet_("preload")},f.autoplay=function(s){if(void 0===s)return this.options_.autoplay||!1;var u;"string"==typeof s&&/(any|play|muted)/.test(s)||!0===s&&this.options_.normalizeAutoplay?(this.options_.autoplay=s,this.manualAutoplay_("string"==typeof s?s:"play"),u=!1):this.options_.autoplay=!!s,u=typeof u>"u"?this.options_.autoplay:u,this.tech_&&this.techCall_("setAutoplay",u)},f.playsinline=function(s){return void 0!==s?(this.techCall_("setPlaysinline",s),this.options_.playsinline=s,this):this.techGet_("playsinline")},f.loop=function(s){return void 0!==s?(this.techCall_("setLoop",s),void(this.options_.loop=s)):this.techGet_("loop")},f.poster=function(s){if(void 0===s)return this.poster_;s||(s=""),s!==this.poster_&&(this.poster_=s,this.techCall_("setPoster",s),this.isPosterFromTech_=!1,this.trigger("posterchange"))},f.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var s=this.tech_.poster()||"";s!==this.poster_&&(this.poster_=s,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},f.controls=function(s){if(void 0===s)return!!this.controls_;this.controls_!==(s=!!s)&&(this.controls_=s,this.usingNativeControls()&&this.techCall_("setControls",s),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},f.usingNativeControls=function(s){if(void 0===s)return!!this.usingNativeControls_;this.usingNativeControls_!==(s=!!s)&&(this.usingNativeControls_=s,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},f.error=function(s){var u=this;if(void 0===s)return this.error_||null;if(Gr("beforeerror").forEach(function(T){var S=T(u,s);Es(S)&&!Array.isArray(S)||"string"==typeof S||"number"==typeof S||null===S?s=S:u.log.error("please return a value that MediaError expects in beforeerror hooks")}),this.options_.suppressNotSupportedError&&s&&4===s.code){var m=function(){this.error(s)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],m),void this.one("loadstart",function(){this.off(["click","touchstart"],m)})}if(null===s)return this.error_=s,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Fs(s),this.addClass("vjs-error"),Kt.error("(CODE:"+this.error_.code+" "+Fs.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),Gr("error").forEach(function(T){return T(u,u.error_)})},f.reportUserActivity=function(s){this.userActivity_=!0},f.userActive=function(s){if(void 0===s)return this.userActive_;if((s=!!s)!==this.userActive_){if(this.userActive_=s,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(u){u.stopPropagation(),u.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},f.listenForUserActivity_=function(){var s,u,m,T=hr(this,this.reportUserActivity),P=function(le){T(),this.clearInterval(s)};this.on("mousedown",function(){T(),this.clearInterval(s),s=this.setInterval(T,250)}),this.on("mousemove",function(le){(le.screenX!==u||le.screenY!==m)&&(u=le.screenX,m=le.screenY,T())}),this.on("mouseup",P),this.on("mouseleave",P);var H,W=this.getChild("controlBar");W&&!Ao&&!ca&&(W.on("mouseenter",function(te){0!==this.player().options_.inactivityTimeout&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),W.on("mouseleave",function(te){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",T),this.on("keyup",T),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(H);var te=this.options_.inactivityTimeout;te<=0||(H=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},te))}},250)},f.playbackRate=function(s){if(void 0===s)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",s)},f.defaultPlaybackRate=function(s){return void 0!==s?this.techCall_("setDefaultPlaybackRate",s):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},f.isAudio=function(s){if(void 0===s)return!!this.isAudio_;this.isAudio_=!!s},f.enableAudioOnlyUI_=function(){var s=this;this.addClass("vjs-audio-only-mode");var u=this.children(),m=this.getChild("ControlBar"),T=m&&m.currentHeight();u.forEach(function(S){S!==m&&S.el_&&!S.hasClass("vjs-hidden")&&(S.hide(),s.audioOnlyCache_.hiddenChildren.push(S))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(T),this.trigger("audioonlymodechange")},f.disableAudioOnlyUI_=function(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(function(s){return s.show()}),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")},f.audioOnlyMode=function(s){var u=this;if("boolean"!=typeof s||s===this.audioOnlyMode_)return this.audioOnlyMode_;this.audioOnlyMode_=s;var m=this.options_.Promise||se().Promise;if(m){if(s){var T=[];return this.isInPictureInPicture()&&T.push(this.exitPictureInPicture()),this.isFullscreen()&&T.push(this.exitFullscreen()),this.audioPosterMode()&&T.push(this.audioPosterMode(!1)),m.all(T).then(function(){return u.enableAudioOnlyUI_()})}return m.resolve().then(function(){return u.disableAudioOnlyUI_()})}s?(this.isInPictureInPicture()&&this.exitPictureInPicture(),this.isFullscreen()&&this.exitFullscreen(),this.enableAudioOnlyUI_()):this.disableAudioOnlyUI_()},f.enablePosterModeUI_=function(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},f.disablePosterModeUI_=function(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},f.audioPosterMode=function(s){var u=this;if("boolean"!=typeof s||s===this.audioPosterMode_)return this.audioPosterMode_;this.audioPosterMode_=s;var m=this.options_.Promise||se().Promise;return m?s?this.audioOnlyMode()?this.audioOnlyMode(!1).then(function(){u.enablePosterModeUI_()}):m.resolve().then(function(){u.enablePosterModeUI_()}):m.resolve().then(function(){u.disablePosterModeUI_()}):s?(this.audioOnlyMode()&&this.audioOnlyMode(!1),void this.enablePosterModeUI_()):void this.disablePosterModeUI_()},f.addTextTrack=function(s,u,m){if(this.tech_)return this.tech_.addTextTrack(s,u,m)},f.addRemoteTextTrack=function(s,u){if(this.tech_)return this.tech_.addRemoteTextTrack(s,u)},f.removeRemoteTextTrack=function(s){void 0===s&&(s={});var m=s.track;if(m||(m=s),this.tech_)return this.tech_.removeRemoteTextTrack(m)},f.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},f.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},f.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},f.language=function(s){if(void 0===s)return this.language_;this.language_!==String(s).toLowerCase()&&(this.language_=String(s).toLowerCase(),Fl(this)&&this.trigger("languagechange"))},f.languages=function(){return Dr(d.prototype.options_.languages,this.languages_)},f.toJSON=function(){var s=Dr(this.options_),u=s.tracks;s.tracks=[];for(var m=0;m<u.length;m++){var T=u[m];(T=Dr(T)).player=void 0,s.tracks[m]=T}return s},f.createModal=function(s,u){var m=this;(u=u||{}).content=s||"";var T=new qu(this,u);return this.addChild(T),T.on("dispose",function(){m.removeChild(T)}),T.open(),T},f.updateCurrentBreakpoint_=function(){if(this.responsive())for(var s=this.currentBreakpoint(),u=this.currentWidth(),m=0;m<Lm.length;m++){var T=Lm[m];if(u<=this.breakpoints_[T]){if(s===T)return;s&&this.removeClass(np[s]),this.addClass(np[T]),this.breakpoint_=T;break}}},f.removeCurrentBreakpoint_=function(){var s=this.currentBreakpointClass();this.breakpoint_="",s&&this.removeClass(s)},f.breakpoints=function(s){return void 0===s||(this.breakpoint_="",this.breakpoints_=zr({},Sd,s),this.updateCurrentBreakpoint_()),zr(this.breakpoints_)},f.responsive=function(s){return void 0===s?this.responsive_:(s=Boolean(s))!==this.responsive_?(this.responsive_=s,s?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),s):void 0},f.currentBreakpoint=function(){return this.breakpoint_},f.currentBreakpointClass=function(){return np[this.breakpoint_]||""},f.loadMedia=function(s,u){var m=this;if(s&&"object"==typeof s){this.reset(),this.cache_.media=Dr(s);var T=this.cache_.media,D=T.poster,P=T.src,W=T.textTracks;!T.artwork&&D&&(this.cache_.media.artwork=[{src:D,type:Yf(D)}]),P&&this.src(P),D&&this.poster(D),Array.isArray(W)&&W.forEach(function(H){return m.addRemoteTextTrack(H,!1)}),this.ready(u)}},f.getMedia=function(){if(!this.cache_.media){var s=this.poster(),T={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(S){return{kind:S.kind,label:S.label,language:S.language,src:S.src}})};return s&&(T.poster=s,T.artwork=[{src:T.poster,type:Yf(T.poster)}]),T}return Dr(this.cache_.media)},d.getTagSettings=function(s){var u={sources:[],tracks:[]},m=Ol(s),T=m["data-setup"];if(cd(s,"vjs-fill")&&(m.fill=!0),cd(s,"vjs-fluid")&&(m.fluid=!0),null!==T){var S=Bt()(T||"{}"),D=S[0],P=S[1];D&&Kt.error(D),zr(m,P)}if(zr(u,m),s.hasChildNodes())for(var W=s.childNodes,H=0,te=W.length;H<te;H++){var le=W[H],ce=le.nodeName.toLowerCase();"source"===ce?u.sources.push(Ol(le)):"track"===ce&&u.tracks.push(Ol(le))}return u},f.flexNotSupported_=function(){var s=Oe().createElement("i");return!("flexBasis"in s.style||"webkitFlexBasis"in s.style||"mozFlexBasis"in s.style||"msFlexBasis"in s.style||"msFlexOrder"in s.style)},f.debug=function(s){if(void 0===s)return this.debugEnabled_;s?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},f.playbackRates=function(s){if(void 0===s)return this.cache_.playbackRates;!Array.isArray(s)||!s.every(function(u){return"number"==typeof u})||(this.cache_.playbackRates=s,this.trigger("playbackrateschange"))},d}(Rt);ha.names.forEach(function(b){var d=ha[b];ta.prototype[d.getterName]=function(){return this.tech_?this.tech_[d.getterName]():(this[d.privateName]=this[d.privateName]||new d.ListClass,this[d.privateName])}}),ta.prototype.crossorigin=ta.prototype.crossOrigin,ta.players={};var ip=se().navigator;ta.prototype.options_={techOrder:Nr.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:ip&&(ip.languages&&ip.languages[0]||ip.userLanguage||ip.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(b){ta.prototype[b]=function(){return this.techGet_(b)}}),Pm.forEach(function(b){ta.prototype["handleTech"+Rr(b)+"_"]=function(){return this.trigger(b)}}),Rt.registerComponent("Player",ta);var km="plugin",Nh="activePlugins_",Ph={},Qa=function(d){return Ph.hasOwnProperty(d)},Xo=function(d){return Qa(d)?Ph[d]:void 0},_0=function(d,f){d[Nh]=d[Nh]||{},d[Nh][f]=!0},Fm=function(d,f,h){var s=(h?"before":"")+"pluginsetup";d.trigger(s,f),d.trigger(s+":"+f.name,f)},y0=function(d,f){return f.prototype.name=d,function(){Fm(this,{name:d,plugin:f,instance:null},!0);for(var h=arguments.length,s=new Array(h),u=0;u<h;u++)s[u]=arguments[u];var m=Xn(f,[this].concat(s));return this[d]=function(){return m},Fm(this,m.getEventHash()),m}},Tu=function(){function b(f){if(this.constructor===b)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=f,this.log||(this.log=this.player.log.createLogger(this.name)),ks(this),delete this.trigger,$u(this,this.constructor.defaultState),_0(f,this.name),this.dispose=this.dispose.bind(this),f.on("dispose",this.dispose)}var d=b.prototype;return d.version=function(){return this.constructor.VERSION},d.getEventHash=function(h){return void 0===h&&(h={}),h.name=this.name,h.plugin=this.constructor,h.instance=this,h},d.trigger=function(h,s){return void 0===s&&(s={}),Vi(this.eventBusEl_,h,this.getEventHash(s))},d.handleStateChanged=function(h){},d.dispose=function(){var h=this.name,s=this.player;this.trigger("dispose"),this.off(),s.off("dispose",this.dispose),s[Nh][h]=!1,this.player=this.state=null,s[h]=y0(h,Ph[h])},b.isBasic=function(h){var s="string"==typeof h?Xo(h):h;return"function"==typeof s&&!b.prototype.isPrototypeOf(s.prototype)},b.registerPlugin=function(h,s){if("string"!=typeof h)throw new Error('Illegal plugin name, "'+h+'", must be a string, was '+typeof h+".");if(Qa(h))Kt.warn('A plugin named "'+h+'" already exists. You may want to avoid re-registering plugins!');else if(ta.prototype.hasOwnProperty(h))throw new Error('Illegal plugin name, "'+h+'", cannot share a name with an existing player method!');if("function"!=typeof s)throw new Error('Illegal plugin for "'+h+'", must be a function, was '+typeof s+".");return Ph[h]=s,h!==km&&(ta.prototype[h]=b.isBasic(s)?function(d,f){var h=function(){Fm(this,{name:d,plugin:f,instance:null},!0);var u=f.apply(this,arguments);return _0(this,d),Fm(this,{name:d,plugin:f,instance:u}),u};return Object.keys(f).forEach(function(s){h[s]=f[s]}),h}(h,s):y0(h,s)),s},b.deregisterPlugin=function(h){if(h===km)throw new Error("Cannot de-register base plugin.");Qa(h)&&(delete Ph[h],delete ta.prototype[h])},b.getPlugins=function(h){var s;return void 0===h&&(h=Object.keys(Ph)),h.forEach(function(u){var m=Xo(u);m&&((s=s||{})[u]=m)}),s},b.getPluginVersion=function(h){var s=Xo(h);return s&&s.VERSION||""},b}();Tu.getPlugin=Xo,Tu.BASE_PLUGIN_NAME=km,Tu.registerPlugin(km,Tu),ta.prototype.usingPlugin=function(b){return!!this[Nh]&&!0===this[Nh][b]},ta.prototype.hasPlugin=function(b){return!!Qa(b)};var Tv=function(d){return 0===d.indexOf("#")?d.slice(1):d};function Be(b,d,f){var h=Be.getPlayer(b);if(h)return d&&Kt.warn('Player "'+b+'" is already initialised. Options will not be applied.'),f&&h.ready(f),h;var s="string"==typeof b?Ll("#"+Tv(b)):b;if(!fu(s))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!s.ownerDocument.defaultView||!s.ownerDocument.body.contains(s))&&Kt.warn("The element supplied is not included in the DOM"),!0===(d=d||{}).restoreEl&&(d.restoreEl=(s.parentNode&&s.parentNode.hasAttribute("data-vjs-player")?s.parentNode:s).cloneNode(!0)),Gr("beforesetup").forEach(function(m){var T=m(s,Dr(d));Es(T)&&!Array.isArray(T)?d=Dr(d,T):Kt.error("please return an object in beforesetup hooks")});var u=Rt.getComponent("Player");return h=new u(s,d,f),Gr("setup").forEach(function(m){return m(h)}),h}if(Be.hooks_=ua,Be.hooks=Gr,Be.hook=function(d,f){Gr(d,f)},Be.hookOnce=function(d,f){Gr(d,[].concat(f).map(function(h){return function u(){return jr(d,u),h.apply(void 0,arguments)}}))},Be.removeHook=jr,!0!==se().VIDEOJS_NO_DYNAMIC_STYLE&&hu()){var rp=Ll(".vjs-styles-defaults");if(!rp){rp=xo("vjs-styles-defaults");var Bm=Ll("head");Bm&&Bm.insertBefore(rp,Bm.firstChild),gm(rp,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: 56.25%\n      }\n    ")}}xa(1,Be),Be.VERSION="7.20.3",Be.options=ta.prototype.options_,Be.getPlayers=function(){return ta.players},Be.getPlayer=function(b){var f,d=ta.players;if("string"==typeof b){var h=Tv(b),s=d[h];if(s)return s;f=Ll("#"+h)}else f=b;if(fu(f)){var m=f.player,T=f.playerId;if(m||d[T])return m||d[T]}},Be.getAllPlayers=function(){return Object.keys(ta.players).map(function(b){return ta.players[b]}).filter(Boolean)},Be.players=ta.players,Be.getComponent=Rt.getComponent,Be.registerComponent=function(b,d){Nr.isTech(d)&&Kt.warn("The "+b+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Rt.registerComponent.call(Rt,b,d)},Be.getTech=Nr.getTech,Be.registerTech=Nr.registerTech,Be.use=function K_(b,d){gu[b]=gu[b]||[],gu[b].push(d)},Object.defineProperty(Be,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Be.middleware,"TERMINATOR",{value:wm,writeable:!1,enumerable:!0}),Be.browser=du,Be.TOUCH_ENABLED=Jn,Be.extend=function(d,f){void 0===f&&(f={});var h=function(){d.apply(this,arguments)},s={};for(var u in"object"==typeof f?(f.constructor!==Object.prototype.constructor&&(h=f.constructor),s=f):"function"==typeof f&&(h=f),function yn(b,d){if("function"!=typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(d&&d.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),Object.defineProperty(b,"prototype",{writable:!1}),d&&Nt(b,d)}(h,d),d&&(h.super_=d),s)s.hasOwnProperty(u)&&(h.prototype[u]=s[u]);return h},Be.mergeOptions=Dr,Be.bind=hr,Be.registerPlugin=Tu.registerPlugin,Be.deregisterPlugin=Tu.deregisterPlugin,Be.plugin=function(b,d){return Kt.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Tu.registerPlugin(b,d)},Be.getPlugins=Tu.getPlugins,Be.getPlugin=Tu.getPlugin,Be.getPluginVersion=Tu.getPluginVersion,Be.addLanguage=function(b,d){var f;return b=(""+b).toLowerCase(),(Be.options.languages=Dr(Be.options.languages,((f={})[b]=d,f)))[b]},Be.log=Kt,Be.createLogger=dl,Be.createTimeRange=Be.createTimeRanges=gd,Be.formatTime=Oc,Be.setFormatTime=function cT(b){n0=b},Be.resetFormatTime=function fa(){n0=xh},Be.parseUrl=vh,Be.isCrossOrigin=vd,Be.EventTarget=Cs,Be.on=so,Be.one=Wa,Be.off=ft,Be.trigger=Vi,Be.xhr=wi(),Be.TextTrack=Wf,Be.AudioTrack=yd,Be.VideoTrack=Tm,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(b){Be[b]=function(){return Kt.warn("videojs."+b+"() is deprecated; use videojs.dom."+b+"() instead"),zi[b].apply(null,arguments)}}),Be.computedStyle=Uu,Be.dom=zi,Be.url=Y_,Be.defineLazyProperty=bv,Be.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});var Yo=Yn,Qu=function(d,f,h){return d&&h&&h.responseURL&&f!==h.responseURL?h.responseURL:f},ml=function(d){return Be.log.debug?Be.log.debug.bind(Be,"VHS:",d+" >"):function(){}},_s=1/30,oo=.1,wv=function(d,f){var s,h=[];if(d&&d.length)for(s=0;s<d.length;s++)f(d.start(s),d.end(s))&&h.push([d.start(s),d.end(s)]);return Be.createTimeRanges(h)},Ed=function(d,f){return wv(d,function(h,s){return h-oo<=f&&s+oo>=f})},Oh=function(d,f){return wv(d,function(h){return h-_s>=f})},fb=function(d){var f=[];if(!d||!d.length)return"";for(var h=0;h<d.length;h++)f.push(d.start(h)+" => "+d.end(h));return f.join(", ")},Ku=function(d){for(var f=[],h=0;h<d.length;h++)f.push({start:d.start(h),end:d.end(h)});return f},pb=function(d){if(d&&d.length&&d.end)return d.end(d.length-1)},Lh=function(d,f){var h=0;if(!d||!d.length)return h;for(var s=0;s<d.length;s++){var u=d.start(s),m=d.end(s);if(!(f>m)){if(f>u&&f<=m){h+=m-f;continue}h+=m-u}}return h},Vm=Be.createTimeRange,Hm=function(d,f){if(!f.preload)return f.duration;var h=0;return(f.parts||[]).forEach(function(s){h+=s.duration}),(f.preloadHints||[]).forEach(function(s){"PART"===s.type&&(h+=d.partTargetDuration)}),h},Sv=function(d){return(d.segments||[]).reduce(function(f,h,s){return h.parts?h.parts.forEach(function(u,m){f.push({duration:u.duration,segmentIndex:s,partIndex:m,part:u,segment:h})}):f.push({duration:h.duration,segmentIndex:s,partIndex:null,segment:h,part:null}),f},[])},Gm=function(d){var f=d.segments&&d.segments.length&&d.segments[d.segments.length-1];return f&&f.parts||[]},b0=function(d){var f=d.preloadSegment;if(f){var h=f.parts;return(f.preloadHints||[]).reduce(function(m,T){return m+("PART"===T.type?1:0)},0)+(h&&h.length?h.length:0)}},Ev=function(d,f){if(f.endList)return 0;if(d&&d.suggestedPresentationDelay)return d.suggestedPresentationDelay;var h=Gm(f).length>0;return h&&f.serverControl&&f.serverControl.partHoldBack?f.serverControl.partHoldBack:h&&f.partTargetDuration?3*f.partTargetDuration:f.serverControl&&f.serverControl.holdBack?f.serverControl.holdBack:f.targetDuration?3*f.targetDuration:0},zm=function(d,f,h){if(typeof f>"u"&&(f=d.mediaSequence+d.segments.length),f<d.mediaSequence)return 0;var s=function(d,f){var h=0,s=f-d.mediaSequence,u=d.segments[s];if(u){if(typeof u.start<"u")return{result:u.start,precise:!0};if(typeof u.end<"u")return{result:u.end-u.duration,precise:!0}}for(;s--;){if(typeof(u=d.segments[s]).end<"u")return{result:h+u.end,precise:!0};if(h+=Hm(d,u),typeof u.start<"u")return{result:h+u.start,precise:!0}}return{result:h,precise:!1}}(d,f);if(s.precise)return s.result;var u=function(d,f){for(var s,h=0,u=f-d.mediaSequence;u<d.segments.length;u++){if(typeof(s=d.segments[u]).start<"u")return{result:s.start-h,precise:!0};if(h+=Hm(d,s),typeof s.end<"u")return{result:s.end-h,precise:!0}}return{result:-1,precise:!1}}(d,f);return u.precise?u.result:s.result+h},Dv=function(d,f,h){if(!d)return 0;if("number"!=typeof h&&(h=0),typeof f>"u"){if(d.totalDuration)return d.totalDuration;if(!d.endList)return se()[1/0]}return zm(d,f,h)},er=function(d){var f=d.defaultDuration,h=d.durationList,s=d.startIndex,u=d.endIndex,m=0;if(s>u){var T=[u,s];s=T[0],u=T[1]}if(s<0){for(var S=s;S<Math.min(0,u);S++)m+=f;s=0}for(var D=s;D<u;D++)m+=h[D].duration;return m},T0=function(d,f,h,s){if(!d||!d.segments)return null;if(d.endList)return Dv(d);if(null===f)return null;var u=zm(d,d.mediaSequence+d.segments.length,f=f||0);return h&&(u-=s="number"==typeof s?s:Ev(null,d)),Math.max(0,u)},Iv=function(d){return d.excludeUntil&&d.excludeUntil>Date.now()},Rv=function(d){return d.excludeUntil&&d.excludeUntil===1/0},Wm=function(d){var f=Iv(d);return!d.disabled&&!f},w0=function(d,f){return f.attributes&&f.attributes[d]},A0=function(d,f){if(1===d.playlists.length)return!0;var h=f.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===d.playlists.filter(function(s){return!!Wm(s)&&(s.attributes.BANDWIDTH||0)<h}).length},Cd=function(d,f){return!(!d&&!f||!d&&f||d&&!f||!(d===f||d.id&&f.id&&d.id===f.id||d.resolvedUri&&f.resolvedUri&&d.resolvedUri===f.resolvedUri||d.uri&&f.uri&&d.uri===f.uri))},$m=function(d,f){var h=d&&d.mediaGroups&&d.mediaGroups.AUDIO||{},s=!1;for(var u in h){for(var m in h[u])if(s=f(h[u][m]))break;if(s)break}return!!s},kh=function(d){if(!d||!d.playlists||!d.playlists.length)return $m(d,function(m){return m.playlists&&m.playlists.length||m.uri});for(var h=function(T){var S=d.playlists[T],D=S.attributes&&S.attributes.CODECS;return D&&D.split(",").every(function(W){return _o(W)})||$m(d,function(W){return Cd(S,W)})?"continue":{v:!1}},s=0;s<d.playlists.length;s++){var u=h(s);if("continue"!==u&&"object"==typeof u)return u.v}return!0},lo={liveEdgeDelay:Ev,duration:Dv,seekable:function(d,f,h){var u=f||0,m=T0(d,f,!0,h);return null===m?Vm():Vm(u,m)},getMediaInfoForTime:function(d){for(var f=d.playlist,h=d.currentTime,s=d.startingSegmentIndex,u=d.startingPartIndex,m=d.startTime,T=d.experimentalExactManifestTimings,S=h-m,D=Sv(f),P=0,W=0;W<D.length;W++){var H=D[W];if(s===H.segmentIndex&&("number"!=typeof u||"number"!=typeof H.partIndex||u===H.partIndex)){P=W;break}}if(S<0){if(P>0)for(var te=P-1;te>=0;te--){var le=D[te];if(S+=le.duration,T){if(S<0)continue}else if(S+_s<=0)continue;return{partIndex:le.partIndex,segmentIndex:le.segmentIndex,startTime:m-er({defaultDuration:f.targetDuration,durationList:D,startIndex:P,endIndex:te})}}return{partIndex:D[0]&&D[0].partIndex||null,segmentIndex:D[0]&&D[0].segmentIndex||0,startTime:h}}if(P<0){for(var ce=P;ce<0;ce++)if((S-=f.targetDuration)<0)return{partIndex:D[0]&&D[0].partIndex||null,segmentIndex:D[0]&&D[0].segmentIndex||0,startTime:h};P=0}for(var fe=P;fe<D.length;fe++){var ue=D[fe];if(S-=ue.duration,T){if(S>0)continue}else if(S-_s>=0)continue;return{partIndex:ue.partIndex,segmentIndex:ue.segmentIndex,startTime:m+er({defaultDuration:f.targetDuration,durationList:D,startIndex:P,endIndex:fe})}}return{segmentIndex:D[D.length-1].segmentIndex,partIndex:D[D.length-1].partIndex,startTime:h}},isEnabled:Wm,isDisabled:function(d){return d.disabled},isBlacklisted:Iv,isIncompatible:Rv,playlistEnd:T0,isAes:function(d){for(var f=0;f<d.segments.length;f++)if(d.segments[f].key)return!0;return!1},hasAttribute:w0,estimateSegmentRequestTime:function(d,f,h,s){return void 0===s&&(s=0),w0("BANDWIDTH",h)?(d*h.attributes.BANDWIDTH-8*s)/f:NaN},isLowestEnabledRendition:A0,isAudioOnly:kh,playlistMatch:Cd,segmentDurationWithParts:Hm},Nv=Be.log,qm=function(d,f){return d+"-"+f},gl=function(d,f){!d.mediaGroups||["AUDIO","SUBTITLES"].forEach(function(h){if(d.mediaGroups[h])for(var s in d.mediaGroups[h])for(var u in d.mediaGroups[h][s])f(d.mediaGroups[h][s][u],h,s,u)})},wu=function(d){var f=d.playlist,h=d.uri;f.id=d.id,f.playlistErrors_=0,h&&(f.uri=h),f.attributes=f.attributes||{}},Pv=function(d,f){d.uri=f;for(var h=0;h<d.playlists.length;h++)d.playlists[h].uri||(d.playlists[h].uri="placeholder-uri-"+h);var u=kh(d);gl(d,function(m,T,S,D){var P="placeholder-uri-"+T+"-"+S+"-"+D;if(!m.playlists||!m.playlists.length){if(u&&"AUDIO"===T&&!m.uri)for(var W=0;W<d.playlists.length;W++){var H=d.playlists[W];if(H.attributes&&H.attributes.AUDIO&&H.attributes.AUDIO===S)return}m.playlists=[Mt({},m)]}m.playlists.forEach(function(te,le){var ce=qm(le,P);te.uri?te.resolvedUri=te.resolvedUri||Yo(d.uri,te.uri):(te.uri=0===le?P:ce,te.resolvedUri=te.uri),te.id=te.id||ce,te.attributes=te.attributes||{},d.playlists[te.id]=te,d.playlists[te.uri]=te})}),function(d){for(var f=d.playlists.length;f--;){var h=d.playlists[f];wu({playlist:h,id:qm(f,h.uri)}),h.resolvedUri=Yo(d.uri,h.uri),d.playlists[h.id]=h,d.playlists[h.uri]=h,h.attributes.BANDWIDTH||Nv.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}(d),function(d){gl(d,function(f){f.uri&&(f.resolvedUri=Yo(d.uri,f.uri))})}(d)},sp=Be.mergeOptions,Bc=function(d,f){if(!d)return f;var h=sp(d,f);if(d.preloadHints&&!f.preloadHints&&delete h.preloadHints,d.parts&&!f.parts)delete h.parts;else if(d.parts&&f.parts)for(var s=0;s<f.parts.length;s++)d.parts&&d.parts[s]&&(h.parts[s]=sp(d.parts[s],f.parts[s]));return!d.skipped&&f.skipped&&(h.skipped=!1),d.preload&&!f.preload&&(h.preload=!1),h},Lv=function(d,f){!d.resolvedUri&&d.uri&&(d.resolvedUri=Yo(f,d.uri)),d.key&&!d.key.resolvedUri&&(d.key.resolvedUri=Yo(f,d.key.uri)),d.map&&!d.map.resolvedUri&&(d.map.resolvedUri=Yo(f,d.map.uri)),d.map&&d.map.key&&!d.map.key.resolvedUri&&(d.map.key.resolvedUri=Yo(f,d.map.key.uri)),d.parts&&d.parts.length&&d.parts.forEach(function(h){h.resolvedUri||(h.resolvedUri=Yo(f,h.uri))}),d.preloadHints&&d.preloadHints.length&&d.preloadHints.forEach(function(h){h.resolvedUri||(h.resolvedUri=Yo(f,h.uri))})},Ym=function(d){var f=d.segments||[],h=d.preloadSegment;if(h&&h.parts&&h.parts.length){if(h.preloadHints)for(var s=0;s<h.preloadHints.length;s++)if("MAP"===h.preloadHints[s].type)return f;h.duration=d.targetDuration,h.preload=!0,f.push(h)}return f},ap=function(d,f){return d===f||d.segments&&f.segments&&d.segments.length===f.segments.length&&d.endList===f.endList&&d.mediaSequence===f.mediaSequence&&d.preloadSegment===f.preloadSegment},Do=function(d,f,h){void 0===h&&(h=ap);var s=sp(d,{}),u=s.playlists[f.id];if(!u||h(u,f))return null;f.segments=Ym(f);var m=sp(u,f);if(m.preloadSegment&&!f.preloadSegment&&delete m.preloadSegment,u.segments){if(f.skip){f.segments=f.segments||[];for(var T=0;T<f.skip.skippedSegments;T++)f.segments.unshift({skipped:!0})}m.segments=function(d,f,h){var s=d.slice(),u=f.slice();h=h||0;for(var T,m=[],S=0;S<u.length;S++){var D=s[S+h],P=u[S];D?(T=D.map||T,m.push(Bc(D,P))):(T&&!P.map&&(P.map=T),m.push(P))}return m}(u.segments,f.segments,f.mediaSequence-u.mediaSequence)}m.segments.forEach(function(D){Lv(D,m.resolvedUri)});for(var S=0;S<s.playlists.length;S++)s.playlists[S].id===f.id&&(s.playlists[S]=m);return s.playlists[f.id]=m,s.playlists[f.uri]=m,gl(d,function(D,P,W,H){if(D.playlists)for(var te=0;te<D.playlists.length;te++)f.id===D.playlists[te].id&&(D.playlists[te]=m)}),s},op=function(d,f){var h=d.segments||[],s=h[h.length-1],u=s&&s.parts&&s.parts[s.parts.length-1],m=u&&u.duration||s&&s.duration;return f&&m?1e3*m:500*(d.partTargetDuration||d.targetDuration||10)},Zu=function(b){function d(h,s,u){var m;if(void 0===u&&(u={}),m=b.call(this)||this,!h)throw new Error("A non-empty playlist URL or object is required");m.logger_=ml("PlaylistLoader");var S=u.withCredentials,D=void 0!==S&&S,P=u.handleManifestRedirects,W=void 0!==P&&P;m.src=h,m.vhs_=s,m.withCredentials=D,m.handleManifestRedirects=W;var H=s.options_;return m.customTagParsers=H&&H.customTagParsers||[],m.customTagMappers=H&&H.customTagMappers||[],m.experimentalLLHLS=H&&H.experimentalLLHLS||!1,Be.browser.IE_VERSION&&(m.experimentalLLHLS=!1),m.state="HAVE_NOTHING",m.handleMediaupdatetimeout_=m.handleMediaupdatetimeout_.bind(gt(m)),m.on("mediaupdatetimeout",m.handleMediaupdatetimeout_),m}ze(d,b);var f=d.prototype;return f.handleMediaupdatetimeout_=function(){var s=this;if("HAVE_METADATA"===this.state){var u=this.media(),m=Yo(this.master.uri,u.uri);this.experimentalLLHLS&&(m=function(d,f){if(f.endList||!f.serverControl)return d;var h={};if(f.serverControl.canBlockReload){var s=f.preloadSegment,u=f.mediaSequence+f.segments.length;if(s){var m=s.parts||[],T=b0(f)-1;T>-1&&T!==m.length-1&&(h._HLS_part=T),(T>-1||m.length)&&u--}h._HLS_msn=u}if(f.serverControl&&f.serverControl.canSkipUntil&&(h._HLS_skip=f.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(h).length){var S=new(se().URL)(d);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(D){!h.hasOwnProperty(D)||S.searchParams.set(D,h[D])}),d=S.toString()}return d}(m,u)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:m,withCredentials:this.withCredentials},function(T,S){if(s.request){if(T)return s.playlistRequestError(s.request,s.media(),"HAVE_METADATA");s.haveMetadata({playlistString:s.request.responseText,url:s.media().uri,id:s.media().id})}})}},f.playlistRequestError=function(s,u,m){var T=u.uri,S=u.id;this.request=null,m&&(this.state=m),this.error={playlist:this.master.playlists[S],status:s.status,message:"HLS playlist request error at URL: "+T+".",responseText:s.responseText,code:s.status>=500?4:2},this.trigger("error")},f.parseManifest_=function(s){var u=this,m=s.url;return function(d){var f=d.onwarn,h=d.oninfo,s=d.manifestString,u=d.customTagParsers,m=void 0===u?[]:u,T=d.customTagMappers,S=void 0===T?[]:T,D=d.experimentalLLHLS,P=new Jt;f&&P.on("warn",f),h&&P.on("info",h),m.forEach(function(ce){return P.addParser(ce)}),S.forEach(function(ce){return P.addTagMapper(ce)}),P.push(s),P.end();var W=P.manifest;if(D||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(ce){W.hasOwnProperty(ce)&&delete W[ce]}),W.segments&&W.segments.forEach(function(ce){["parts","preloadHints"].forEach(function(fe){ce.hasOwnProperty(fe)&&delete ce[fe]})})),!W.targetDuration){var H=10;W.segments&&W.segments.length&&(H=W.segments.reduce(function(ce,fe){return Math.max(ce,fe.duration)},0)),f&&f("manifest has no targetDuration defaulting to "+H),W.targetDuration=H}var te=Gm(W);if(te.length&&!W.partTargetDuration){var le=te.reduce(function(ce,fe){return Math.max(ce,fe.duration)},0);f&&(f("manifest has no partTargetDuration defaulting to "+le),Nv.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),W.partTargetDuration=le}return W}({onwarn:function(D){return u.logger_("m3u8-parser warn for "+m+": "+D.message)},oninfo:function(D){return u.logger_("m3u8-parser info for "+m+": "+D.message)},manifestString:s.manifestString,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})},f.haveMetadata=function(s){var u=s.playlistString,m=s.playlistObject,T=s.url,S=s.id;this.request=null,this.state="HAVE_METADATA";var D=m||this.parseManifest_({url:T,manifestString:u});D.lastRequest=Date.now(),wu({playlist:D,uri:T,id:S});var P=Do(this.master,D);this.targetDuration=D.partTargetDuration||D.targetDuration,this.pendingMedia_=null,P?(this.master=P,this.media_=this.master.playlists[S]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(op(this.media(),!!P)),this.trigger("loadedplaylist")},f.dispose=function(){this.trigger("dispose"),this.stopRequest(),se().clearTimeout(this.mediaUpdateTimeout),se().clearTimeout(this.finalRenditionTimeout),this.off()},f.stopRequest=function(){if(this.request){var s=this.request;this.request=null,s.onreadystatechange=null,s.abort()}},f.media=function(s,u){var m=this;if(!s)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof s){if(!this.master.playlists[s])throw new Error("Unknown playlist URI: "+s);s=this.master.playlists[s]}if(se().clearTimeout(this.finalRenditionTimeout),u){var T=(s.partTargetDuration||s.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=se().setTimeout(this.media.bind(this,s,!1),T)}else{var S=this.state,D=!this.media_||s.id!==this.media_.id,P=this.master.playlists[s.id];if(P&&P.endList||s.endList&&s.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=s,void(D&&(this.trigger("mediachanging"),this.trigger("HAVE_MASTER"===S?"loadedmetadata":"mediachange")));if(this.updateMediaUpdateTimeout_(op(s,!0)),D){if(this.state="SWITCHING_MEDIA",this.request){if(s.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=s,this.request=this.vhs_.xhr({uri:s.resolvedUri,withCredentials:this.withCredentials},function(W,H){if(m.request){if(s.lastRequest=Date.now(),s.resolvedUri=Qu(m.handleManifestRedirects,s.resolvedUri,H),W)return m.playlistRequestError(m.request,s,S);m.haveMetadata({playlistString:H.responseText,url:s.uri,id:s.id}),m.trigger("HAVE_MASTER"===S?"loadedmetadata":"mediachange")}})}}},f.pause=function(){this.mediaUpdateTimeout&&(se().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.state=this.media_?"HAVE_METADATA":"HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")},f.load=function(s){var u=this;this.mediaUpdateTimeout&&(se().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var m=this.media();if(s){var T=m?(m.partTargetDuration||m.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=se().setTimeout(function(){u.mediaUpdateTimeout=null,u.load()},T)}else this.started?this.trigger(m&&!m.endList?"mediaupdatetimeout":"loadedplaylist"):this.start()},f.updateMediaUpdateTimeout_=function(s){var u=this;this.mediaUpdateTimeout&&(se().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=se().setTimeout(function(){u.mediaUpdateTimeout=null,u.trigger("mediaupdatetimeout"),u.updateMediaUpdateTimeout_(s)},s))},f.start=function(){var s=this;if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=se().location.href),this.src.resolvedUri=this.src.uri,void setTimeout(function(){s.setupInitialPlaylist(s.src)},0);this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(u,m){if(s.request){if(s.request=null,u)return s.error={status:m.status,message:"HLS playlist request error at URL: "+s.src+".",responseText:m.responseText,code:2},"HAVE_NOTHING"===s.state&&(s.started=!1),s.trigger("error");s.src=Qu(s.handleManifestRedirects,s.src,m);var T=s.parseManifest_({manifestString:m.responseText,url:s.src});s.setupInitialPlaylist(T)}})},f.srcUri=function(){return"string"==typeof this.src?this.src:this.src.uri},f.setupInitialPlaylist=function(s){if(this.state="HAVE_MASTER",s.playlists)return this.master=s,Pv(this.master,this.srcUri()),s.playlists.forEach(function(m){m.segments=Ym(m),m.segments.forEach(function(T){Lv(T,m.resolvedUri)})}),this.trigger("loadedplaylist"),void(this.request||this.media(this.master.playlists[0]));var u=this.srcUri()||se().location.href;this.master=function(d,f){var h=qm(0,f),s={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:se().location.href,resolvedUri:se().location.href,playlists:[{uri:f,id:h,resolvedUri:f,attributes:{}}]};return s.playlists[h]=s.playlists[0],s.playlists[f]=s.playlists[0],s}(0,u),this.haveMetadata({playlistObject:s,url:u,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},d}(Be.EventTarget),vl=Be.xhr,Md=Be.mergeOptions,Au=function(d,f,h,s){var u="arraybuffer"===d.responseType?d.response:d.responseText;!f&&u&&(d.responseTime=Date.now(),d.roundTripTime=d.responseTime-d.requestTime,d.bytesReceived=u.byteLength||u.length,d.bandwidth||(d.bandwidth=Math.floor(d.bytesReceived/d.roundTripTime*8*1e3))),h.headers&&(d.responseHeaders=h.headers),f&&"ETIMEDOUT"===f.code&&(d.timedout=!0),!f&&!d.aborted&&200!==h.statusCode&&206!==h.statusCode&&0!==h.statusCode&&(f=new Error("XHR Failed with a response of: "+(d&&(u||d.responseText)))),s(f,d)},Qo=function(){var d=function f(h,s){h=Md({timeout:45e3},h);var u=f.beforeRequest||Be.Vhs.xhr.beforeRequest;if(u&&"function"==typeof u){var m=u(h);m&&(h=m)}var S=(!0===Be.Vhs.xhr.original?vl:Be.Vhs.xhr)(h,function(P,W){return Au(S,P,W,s)}),D=S.abort;return S.abort=function(){return S.aborted=!0,D.apply(S,arguments)},S.uri=h.uri,S.requestTime=Date.now(),S};return d.original=!0,d},Id=function(d){var f={};return d.byterange&&(f.Range=function(d){return"bytes="+d.offset+"-"+("bigint"==typeof d.offset||"bigint"==typeof d.length?se().BigInt(d.offset)+se().BigInt(d.length)-se().BigInt(1):d.offset+d.length-1)}(d.byterange)),f},Bh=function(d,f){return d.start(f)+"-"+d.end(f)},Uh=function(d,f){var h=d.toString(16);return"00".substring(0,2-h.length)+h+(f%2?" ":"")},Vc=function(d){return d>=32&&d<126?String.fromCharCode(d):"."},Vh=function(d){var f={};return Object.keys(d).forEach(function(h){var s=d[h];f[h]=ya(s)?{bytes:s.buffer,byteOffset:s.byteOffset,byteLength:s.byteLength}:s}),f},Hh=function(d){var f=d.byterange||{length:1/0,offset:0};return[f.length,f.offset,d.resolvedUri].join(",")},lp=function(d){return d.resolvedUri},Rd=function(d){for(var f=Array.prototype.slice.call(d),h=16,s="",T=0;T<f.length/h;T++)s+=f.slice(T*h,T*h+h).map(Uh).join("")+" "+f.slice(T*h,T*h+h).map(Vc).join("")+"\n";return s},Nd=Object.freeze({__proto__:null,createTransferableMessage:Vh,initSegmentId:Hh,segmentKeyId:lp,hexDump:Rd,tagDump:function(d){return Rd(d.bytes)},textRanges:function(d){var h,f="";for(h=0;h<d.length;h++)f+=Bh(d,h)+" ";return f}}),C0=function b(d){var f=d.programTime,h=d.playlist,s=d.retryCount,u=void 0===s?2:s,m=d.seekTo,T=d.pauseAfterSeek,S=void 0===T||T,D=d.tech,P=d.callback;if(!P)throw new Error("seekToProgramTime: callback must be provided");if(typeof f>"u"||!h||!m)return P({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!h.endList&&!D.hasStarted_)return P({message:"player must be playing a live stream to start buffering"});if(!function(d){if(!d.segments||0===d.segments.length)return!1;for(var f=0;f<d.segments.length;f++)if(!d.segments[f].dateTimeObject)return!1;return!0}(h))return P({message:"programDateTime tags must be provided in the manifest "+h.resolvedUri});var W=function(d,f){var h;try{h=new Date(d)}catch{return null}if(!f||!f.segments||0===f.segments.length)return null;var s=f.segments[0];if(h<s.dateTimeObject)return null;for(var u=0;u<f.segments.length-1&&(s=f.segments[u],!(h<f.segments[u+1].dateTimeObject));u++);var T=f.segments[f.segments.length-1],S=T.dateTimeObject,D=T.videoTimingInfo?function(d){return d.transmuxedPresentationEnd-d.transmuxedPresentationStart-d.transmuxerPrependedSeconds}(T.videoTimingInfo):T.duration+.25*T.duration;return h>new Date(S.getTime()+1e3*D)?null:(h>S&&(s=T),{segment:s,estimatedStart:s.videoTimingInfo?s.videoTimingInfo.transmuxedPresentationStart:lo.duration(f,f.mediaSequence+f.segments.indexOf(s)),type:s.videoTimingInfo?"accurate":"estimate"})}(f,h);if(!W)return P({message:f+" was not found in the stream"});var H=W.segment,te=function(d,f){var h,s;try{h=new Date(d),s=new Date(f)}catch{}var u=h.getTime();return(s.getTime()-u)/1e3}(H.dateTimeObject,f);if("estimate"===W.type)return 0===u?P({message:f+" is not buffered yet. Try again"}):(m(W.estimatedStart+te),void D.one("seeked",function(){b({programTime:f,playlist:h,retryCount:u-1,seekTo:m,pauseAfterSeek:S,tech:D,callback:P})}));var le=H.start+te;D.one("seeked",function(){return P(null,D.currentTime())}),S&&D.pause(),m(le)},Ju=function(d,f){if(4===d.readyState)return f()},Km=Be.mergeOptions,Bv=function(d,f){if(!ap(d,f)||d.sidx&&f.sidx&&(d.sidx.offset!==f.sidx.offset||d.sidx.length!==f.sidx.length))return!1;if(!d.sidx&&f.sidx||d.sidx&&!f.sidx||d.segments&&!f.segments||!d.segments&&f.segments)return!1;if(!d.segments&&!f.segments)return!0;for(var h=0;h<d.segments.length;h++){var s=d.segments[h],u=f.segments[h];if(s.uri!==u.uri)return!1;if(s.byterange||u.byterange){var m=s.byterange,T=u.byterange;if(m&&!T||!m&&T||m.offset!==T.offset||m.length!==T.length)return!1}}return!0},Tb=function(d,f){return(Boolean(!d.map&&!f.map)||Boolean(d.map&&f.map&&d.map.byterange.offset===f.map.byterange.offset&&d.map.byterange.length===f.map.byterange.length))&&d.uri===f.uri&&d.byterange.offset===f.byterange.offset&&d.byterange.length===f.byterange.length},cp=function(d,f){var h={};for(var s in d){var m=d[s].sidx;if(m){var T=ah(m);if(!f[T])break;Tb(f[T].sidxInfo,m)&&(h[T]=f[T])}}return h},Gh=function(b){function d(h,s,u,m){var T;void 0===u&&(u={}),(T=b.call(this)||this).masterPlaylistLoader_=m||gt(T),m||(T.isMaster_=!0);var D=u.withCredentials,P=void 0!==D&&D,W=u.handleManifestRedirects,H=void 0!==W&&W;if(T.vhs_=s,T.withCredentials=P,T.handleManifestRedirects=H,!h)throw new Error("A non-empty playlist URL or object is required");return T.on("minimumUpdatePeriod",function(){T.refreshXml_()}),T.on("mediaupdatetimeout",function(){T.refreshMedia_(T.media().id)}),T.state="HAVE_NOTHING",T.loadedPlaylists_={},T.logger_=ml("DashPlaylistLoader"),T.isMaster_?(T.masterPlaylistLoader_.srcUrl=h,T.masterPlaylistLoader_.sidxMapping_={}):T.childPlaylist_=h,T}ze(d,b);var f=d.prototype;return f.requestErrored_=function(s,u,m){return!this.request||(this.request=null,s?(this.error="object"!=typeof s||s instanceof Error?{status:u.status,message:"DASH request error at URL: "+u.uri,response:u.response,code:2}:s,m&&(this.state=m),this.trigger("error"),!0):void 0)},f.addSidxSegments_=function(s,u,m){var T=this,S=s.sidx&&ah(s.sidx);if(s.sidx&&S&&!this.masterPlaylistLoader_.sidxMapping_[S]){var D=Qu(this.handleManifestRedirects,s.sidx.resolvedUri),P=function(H,te){if(!T.requestErrored_(H,te,u)){var ce,le=T.masterPlaylistLoader_.sidxMapping_;try{ce=Gg()(zn(te.response).subarray(8))}catch(fe){return void T.requestErrored_(fe,te,u)}return le[S]={sidxInfo:s.sidx,sidx:ce},Fo(s,ce,s.sidx.resolvedUri),m(!0)}};this.request=function(d,f,h){var u,s=[],m=!1,T=function(H,te,le,ce){return te.abort(),m=!0,h(H,te,le,ce)},S=function(H,te){if(!m){if(H)return T(H,te,"",s);var le=te.responseText.substring(s&&s.byteLength||0,te.responseText.length);if(s=function(){for(var d=arguments.length,f=new Array(d),h=0;h<d;h++)f[h]=arguments[h];if((f=f.filter(function(T){return T&&(T.byteLength||T.length)&&"string"!=typeof T})).length<=1)return zn(f[0]);var s=f.reduce(function(T,S,D){return T+(S.byteLength||S.length)},0),u=new Uint8Array(s),m=0;return f.forEach(function(T){T=zn(T),u.set(T,m),m+=T.byteLength}),u}(s,Fu(le,!0)),u=u||Il(s),s.length<10||u&&s.length<u+2)return Ju(te,function(){return T(H,te,"",s)});var ce=dn(s);return"ts"===ce&&s.length<188||!ce&&s.length<376?Ju(te,function(){return T(H,te,"",s)}):T(null,te,ce,s)}},P=f({uri:d,beforeSend:function(H){H.overrideMimeType("text/plain; charset=x-user-defined"),H.addEventListener("progress",function(te){return Au(H,null,{statusCode:H.status},S)})}},function(W,H){return Au(P,W,H,S)});return P}(D,this.vhs_.xhr,function(W,H,te,le){if(W)return P(W,H);if(!te||"mp4"!==te)return P({status:H.status,message:"Unsupported "+(te||"unknown")+" container type for sidx segment at URL: "+D,response:"",playlist:s,internal:!0,blacklistDuration:1/0,code:2},H);var ce=s.sidx.byterange,fe=ce.offset,ue=ce.length;if(le.length>=ue+fe)return P(W,{response:le.subarray(fe,fe+ue),status:H.status,uri:H.uri});T.request=T.vhs_.xhr({uri:D,responseType:"arraybuffer",headers:Id({byterange:s.sidx.byterange})},P)})}else this.mediaRequest_=se().setTimeout(function(){return m(!1)},0)},f.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},se().clearTimeout(this.minimumUpdatePeriodTimeout_),se().clearTimeout(this.mediaRequest_),se().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.off()},f.hasPendingRequest=function(){return this.request||this.mediaRequest_},f.stopRequest=function(){if(this.request){var s=this.request;this.request=null,s.onreadystatechange=null,s.abort()}},f.media=function(s){var u=this;if(!s)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var m=this.state;if("string"==typeof s){if(!this.masterPlaylistLoader_.master.playlists[s])throw new Error("Unknown playlist URI: "+s);s=this.masterPlaylistLoader_.master.playlists[s]}var T=!this.media_||s.id!==this.media_.id;if(T&&this.loadedPlaylists_[s.id]&&this.loadedPlaylists_[s.id].endList)return this.state="HAVE_METADATA",this.media_=s,void(T&&(this.trigger("mediachanging"),this.trigger("mediachange")));!T||(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(s,m,function(S){u.haveMetadata({startingState:m,playlist:s})}))},f.haveMetadata=function(s){var u=s.startingState,m=s.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[m.id]=m,this.mediaRequest_=null,this.refreshMedia_(m.id),this.trigger("HAVE_MASTER"===u?"loadedmetadata":"mediachange")},f.pause=function(){this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),se().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMaster_&&(se().clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_),this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)},f.load=function(s){var u=this;se().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var m=this.media();if(s){var T=m?m.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=se().setTimeout(function(){return u.load()},T)}else this.started?m&&!m.endList?(this.isMaster_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()},f.start=function(){var s=this;this.started=!0,this.isMaster_?this.requestMaster_(function(u,m){s.haveMaster_(),!s.hasPendingRequest()&&!s.media_&&s.media(s.masterPlaylistLoader_.master.playlists[0])}):this.mediaRequest_=se().setTimeout(function(){return s.haveMaster_()},0)},f.requestMaster_=function(s){var u=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},function(m,T){if(!u.requestErrored_(m,T)){var S=T.responseText!==u.masterPlaylistLoader_.masterXml_;return u.masterPlaylistLoader_.masterXml_=T.responseText,u.masterLoaded_=T.responseHeaders&&T.responseHeaders.date?Date.parse(T.responseHeaders.date):Date.now(),u.masterPlaylistLoader_.srcUrl=Qu(u.handleManifestRedirects,u.masterPlaylistLoader_.srcUrl,T),S?(u.handleMaster_(),void u.syncClientServerClock_(function(){return s(T,S)})):s(T,S)}"HAVE_NOTHING"===u.state&&(u.started=!1)})},f.syncClientServerClock_=function(s){var u=this,m=function(d){return function(d){var f=Zs(d,"UTCTiming")[0];if(!f)return null;var h=to(f);switch(h.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":h.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":h.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":h.method="DIRECT",h.value=Date.parse(h.value);break;default:throw new Error("UNSUPPORTED_UTC_TIMING_SCHEME")}return h}(rm(d))}(this.masterPlaylistLoader_.masterXml_);return null===m?(this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),s()):"DIRECT"===m.method?(this.masterPlaylistLoader_.clientOffset_=m.value-Date.now(),s()):void(this.request=this.vhs_.xhr({uri:Yo(this.masterPlaylistLoader_.srcUrl,m.value),method:m.method,withCredentials:this.withCredentials},function(T,S){if(u.request){if(T)return u.masterPlaylistLoader_.clientOffset_=u.masterLoaded_-Date.now(),s();var D;D="HEAD"===m.method?S.responseHeaders&&S.responseHeaders.date?Date.parse(S.responseHeaders.date):u.masterLoaded_:Date.parse(S.responseText),u.masterPlaylistLoader_.clientOffset_=D-Date.now(),s()}}))},f.haveMaster_=function(){this.state="HAVE_MASTER",this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},f.handleMaster_=function(){this.mediaRequest_=null;var s=this.masterPlaylistLoader_.master,u=function(d){var h=d.srcUrl,T=function(d,f){void 0===f&&(f={});var h=function(d,f){void 0===f&&(f={});var h=f,s=h.manifestUri,u=void 0===s?"":s,m=h.NOW,T=void 0===m?Date.now():m,S=h.clientOffset,D=void 0===S?0:S,P=Zs(d,"Period");if(!P.length)throw new Error("INVALID_NUMBER_OF_PERIOD");var W=Zs(d,"Location"),H=to(d),te=Vg([u],Zs(d,"BaseURL"));H.type=H.type||"static",H.sourceDuration=H.mediaPresentationDuration||0,H.NOW=T,H.clientOffset=D,W.length&&(H.locations=W.map(Ml));var le=[];return P.forEach(function(ce,fe){var ue=to(ce),At=le[fe-1];ue.start=function(d){var f=d.attributes,h=d.priorPeriodAttributes;return"number"==typeof f.start?f.start:h&&"number"==typeof h.start&&"number"==typeof h.duration?h.start+h.duration:h||"static"!==d.mpdType?null:0}({attributes:ue,priorPeriodAttributes:At?At.attributes:null,mpdType:H.type}),le.push({node:ce,attributes:ue})}),{locations:H.locations,representationInfo:rs(le.map(eT(H,te)))}}(rm(d),f),s=function(d){return d.map(Q1)}(h.representationInfo);return X1({dashPlaylists:s,locations:h.locations,sidxMapping:f.sidxMapping,previousManifest:f.previousManifest})}(d.masterXml,{manifestUri:h,clientOffset:d.clientOffset,sidxMapping:d.sidxMapping,previousManifest:d.previousManifest});return Pv(T,h),T}({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_,previousManifest:s});s&&(u=function(d,f,h){for(var s=!0,u=Km(d,{duration:f.duration,minimumUpdatePeriod:f.minimumUpdatePeriod,timelineStarts:f.timelineStarts}),m=0;m<f.playlists.length;m++){var T=f.playlists[m];if(T.sidx){var S=ah(T.sidx);h&&h[S]&&h[S].sidx&&Fo(T,h[S].sidx,T.sidx.resolvedUri)}var D=Do(u,T,Bv);D&&(u=D,s=!1)}return gl(f,function(P,W,H,te){if(P.playlists&&P.playlists.length){var le=P.playlists[0].id,ce=Do(u,P.playlists[0],Bv);ce&&((u=ce).mediaGroups[W][H][te].playlists[0]=u.playlists[le],s=!1)}}),f.minimumUpdatePeriod!==d.minimumUpdatePeriod&&(s=!1),s?null:u}(s,u,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=u||s;var m=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];return m&&m!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=m),(!s||u&&u.minimumUpdatePeriod!==s.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(u)},f.updateMinimumUpdatePeriodTimeout_=function(){var s=this.masterPlaylistLoader_;s.createMupOnMedia_&&(s.off("loadedmetadata",s.createMupOnMedia_),s.createMupOnMedia_=null),s.minimumUpdatePeriodTimeout_&&(se().clearTimeout(s.minimumUpdatePeriodTimeout_),s.minimumUpdatePeriodTimeout_=null);var u=s.master&&s.master.minimumUpdatePeriod;0===u&&(s.media()?u=1e3*s.media().targetDuration:(s.createMupOnMedia_=s.updateMinimumUpdatePeriodTimeout_,s.one("loadedmetadata",s.createMupOnMedia_))),"number"!=typeof u||u<=0?u<0&&this.logger_("found invalid minimumUpdatePeriod of "+u+", not setting a timeout"):this.createMUPTimeout_(u)},f.createMUPTimeout_=function(s){var u=this.masterPlaylistLoader_;u.minimumUpdatePeriodTimeout_=se().setTimeout(function(){u.minimumUpdatePeriodTimeout_=null,u.trigger("minimumUpdatePeriod"),u.createMUPTimeout_(s)},s)},f.refreshXml_=function(){var s=this;this.requestMaster_(function(u,m){!m||(s.media_&&(s.media_=s.masterPlaylistLoader_.master.playlists[s.media_.id]),s.masterPlaylistLoader_.sidxMapping_=function(d,f){var s=cp(d.playlists,f);return gl(d,function(u,m,T,S){u.playlists&&u.playlists.length&&(s=Km(s,cp(u.playlists,f)))}),s}(s.masterPlaylistLoader_.master,s.masterPlaylistLoader_.sidxMapping_),s.addSidxSegments_(s.media(),s.state,function(T){s.refreshMedia_(s.media().id)}))})},f.refreshMedia_=function(s){var u=this;if(!s)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();var m=this.masterPlaylistLoader_.master.playlists,T=!this.media_||this.media_!==m[s];T?this.media_=m[s]:this.trigger("playlistunchanged"),this.mediaUpdateTimeout||function D(){u.media().endList||(u.mediaUpdateTimeout=se().setTimeout(function(){u.trigger("mediaupdatetimeout"),D()},op(u.media(),Boolean(T))))}(),this.trigger("loadedplaylist")},d}(Be.EventTarget),Sa={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},I0=function(d){return d.on=d.addEventListener,d.off=d.removeEventListener,d},Zm=function(d){return function(){var f=function(d){try{return URL.createObjectURL(new Blob([d],{type:"application/javascript"}))}catch{var f=new BlobBuilder;return f.append(d),URL.createObjectURL(f.getBlob())}}(d),h=I0(new Worker(f));h.objURL=f;var s=h.terminate;return h.on=h.addEventListener,h.off=h.removeEventListener,h.terminate=function(){return URL.revokeObjectURL(f),s.call(this)},h}},jh=function(d){return"var browserWorkerPolyFill = "+I0.toString()+";\nbrowserWorkerPolyFill(self);\n"+d},zh=function(d){return d.toString().replace(/^function.+?{/,"").slice(0,-1)},Od=jh(zh(function(){var b=function(){this.init=function(){var M={};this.on=function(O,N){M[O]||(M[O]=[]),M[O]=M[O].concat(N)},this.off=function(O,N){var B;return!!M[O]&&(B=M[O].indexOf(N),M[O]=M[O].slice(),M[O].splice(B,1),B>-1)},this.trigger=function(O){var N,B,X,Q;if(N=M[O])if(2===arguments.length)for(X=N.length,B=0;B<X;++B)N[B].call(this,arguments[1]);else{for(Q=[],B=arguments.length,B=1;B<arguments.length;++B)Q.push(arguments[B]);for(X=N.length,B=0;B<X;++B)N[B].apply(this,Q)}},this.dispose=function(){M={}}}};b.prototype.pipe=function(ee){return this.on("data",function(M){ee.push(M)}),this.on("done",function(M){ee.flush(M)}),this.on("partialdone",function(M){ee.partialFlush(M)}),this.on("endedtimeline",function(M){ee.endTimeline(M)}),this.on("reset",function(M){ee.reset(M)}),ee},b.prototype.push=function(ee){this.trigger("data",ee)},b.prototype.flush=function(ee){this.trigger("done",ee)},b.prototype.partialFlush=function(ee){this.trigger("partialdone",ee)},b.prototype.endTimeline=function(ee){this.trigger("endedtimeline",ee)},b.prototype.reset=function(ee){this.trigger("reset",ee)};var m,T,S,D,P,W,H,te,le,ce,fe,ue,At,sn,rt,et,Ft,pt,lt,St,st,Wn,pn,yi,Or,ms,gs,ys,ns,na,fr,hg,bl,Mu,Yl,jd,ee,M,d=b,f=Math.pow(2,32),s={getUint64:function(M){var N,O=new DataView(M.buffer,M.byteOffset,M.byteLength);return O.getBigUint64?(N=O.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(N):N:O.getUint32(0)*f+O.getUint32(4)},MAX_UINT32:f},u=s.MAX_UINT32;(function(){var ee;if(pn={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(ee in pn)pn.hasOwnProperty(ee)&&(pn[ee]=[ee.charCodeAt(0),ee.charCodeAt(1),ee.charCodeAt(2),ee.charCodeAt(3)]);yi=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),ms=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),Or=new Uint8Array([0,0,0,1]),gs=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),ys=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),ns={video:gs,audio:ys},hg=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),fr=new Uint8Array([0,0,0,0,0,0,0,0]),bl=new Uint8Array([0,0,0,0,0,0,0,0]),Mu=bl,Yl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),jd=bl,na=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),m=function(M){var B,X,O=[],N=0;for(B=1;B<arguments.length;B++)O.push(arguments[B]);for(B=O.length;B--;)N+=O[B].byteLength;for(X=new Uint8Array(N+8),new DataView(X.buffer,X.byteOffset,X.byteLength).setUint32(0,X.byteLength),X.set(M,4),B=0,N=8;B<O.length;B++)X.set(O[B],N),N+=O[B].byteLength;return X},T=function(){return m(pn.dinf,m(pn.dref,hg))},S=function(M){return m(pn.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,M.audioobjecttype<<3|M.samplingfrequencyindex>>>1,M.samplingfrequencyindex<<7|M.channelcount<<3,6,1,2]))},D=function(){return m(pn.ftyp,yi,Or,yi,ms)},et=function(M){return m(pn.hdlr,ns[M])},P=function(M){return m(pn.mdat,M)},rt=function(M){var O=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,M.duration>>>24&255,M.duration>>>16&255,M.duration>>>8&255,255&M.duration,85,196,0,0]);return M.samplerate&&(O[12]=M.samplerate>>>24&255,O[13]=M.samplerate>>>16&255,O[14]=M.samplerate>>>8&255,O[15]=255&M.samplerate),m(pn.mdhd,O)},sn=function(M){return m(pn.mdia,rt(M),et(M.type),H(M))},W=function(M){return m(pn.mfhd,new Uint8Array([0,0,0,0,(4278190080&M)>>24,(16711680&M)>>16,(65280&M)>>8,255&M]))},H=function(M){return m(pn.minf,"video"===M.type?m(pn.vmhd,na):m(pn.smhd,fr),T(),pt(M))},te=function(M,O){for(var N=[],B=O.length;B--;)N[B]=St(O[B]);return m.apply(null,[pn.moof,W(M)].concat(N))},le=function(M){for(var O=M.length,N=[];O--;)N[O]=ue(M[O]);return m.apply(null,[pn.moov,fe(4294967295)].concat(N).concat(ce(M)))},ce=function(M){for(var O=M.length,N=[];O--;)N[O]=st(M[O]);return m.apply(null,[pn.mvex].concat(N))},fe=function(M){var O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&M)>>24,(16711680&M)>>16,(65280&M)>>8,255&M,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return m(pn.mvhd,O)},Ft=function(M){var B,X,O=M.samples||[],N=new Uint8Array(4+O.length);for(X=0;X<O.length;X++)N[X+4]=(B=O[X].flags).dependsOn<<4|B.isDependedOn<<2|B.hasRedundancy;return m(pn.sdtp,N)},pt=function(M){return m(pn.stbl,lt(M),m(pn.stts,jd),m(pn.stsc,Mu),m(pn.stsz,Yl),m(pn.stco,bl))},lt=function(N){return m(pn.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===N.type?ee(N):M(N))},ee=function(N){var ye,Ne,B=N.sps||[],X=N.pps||[],Q=[],de=[];for(ye=0;ye<B.length;ye++)Q.push((65280&B[ye].byteLength)>>>8),Q.push(255&B[ye].byteLength),Q=Q.concat(Array.prototype.slice.call(B[ye]));for(ye=0;ye<X.length;ye++)de.push((65280&X[ye].byteLength)>>>8),de.push(255&X[ye].byteLength),de=de.concat(Array.prototype.slice.call(X[ye]));if(Ne=[pn.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&N.width)>>8,255&N.width,(65280&N.height)>>8,255&N.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),m(pn.avcC,new Uint8Array([1,N.profileIdc,N.profileCompatibility,N.levelIdc,255].concat([B.length],Q,[X.length],de))),m(pn.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],N.sarRatio){var Me=N.sarRatio[0],Ue=N.sarRatio[1];Ne.push(m(pn.pasp,new Uint8Array([(4278190080&Me)>>24,(16711680&Me)>>16,(65280&Me)>>8,255&Me,(4278190080&Ue)>>24,(16711680&Ue)>>16,(65280&Ue)>>8,255&Ue])))}return m.apply(null,Ne)},M=function(N){return m(pn.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&N.channelcount)>>8,255&N.channelcount,(65280&N.samplesize)>>8,255&N.samplesize,0,0,0,0,(65280&N.samplerate)>>8,255&N.samplerate,0,0]),S(N))},At=function(M){var O=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&M.id)>>24,(16711680&M.id)>>16,(65280&M.id)>>8,255&M.id,0,0,0,0,(4278190080&M.duration)>>24,(16711680&M.duration)>>16,(65280&M.duration)>>8,255&M.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&M.width)>>8,255&M.width,0,0,(65280&M.height)>>8,255&M.height,0,0]);return m(pn.tkhd,O)},St=function(M){var O,N,B,X,de,ye;return O=m(pn.tfhd,new Uint8Array([0,0,0,58,(4278190080&M.id)>>24,(16711680&M.id)>>16,(65280&M.id)>>8,255&M.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),de=Math.floor(M.baseMediaDecodeTime/u),ye=Math.floor(M.baseMediaDecodeTime%u),N=m(pn.tfdt,new Uint8Array([1,0,0,0,de>>>24&255,de>>>16&255,de>>>8&255,255&de,ye>>>24&255,ye>>>16&255,ye>>>8&255,255&ye])),"audio"===M.type?(B=Wn(M,92),m(pn.traf,O,N,B)):(X=Ft(M),B=Wn(M,X.length+92),m(pn.traf,O,N,B,X))},ue=function(M){return M.duration=M.duration||4294967295,m(pn.trak,At(M),sn(M))},st=function(M){var O=new Uint8Array([0,0,0,0,(4278190080&M.id)>>24,(16711680&M.id)>>16,(65280&M.id)>>8,255&M.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==M.type&&(O[O.length-1]=0),m(pn.trex,O)},function(){var ee,M,O;O=function(B,X){var Q=0,de=0,ye=0,Ne=0;return B.length&&(void 0!==B[0].duration&&(Q=1),void 0!==B[0].size&&(de=2),void 0!==B[0].flags&&(ye=4),void 0!==B[0].compositionTimeOffset&&(Ne=8)),[0,0,Q|de|ye|Ne,1,(4278190080&B.length)>>>24,(16711680&B.length)>>>16,(65280&B.length)>>>8,255&B.length,(4278190080&X)>>>24,(16711680&X)>>>16,(65280&X)>>>8,255&X]},M=function(B,X){var Q,de,ye,Ne,Me,Ue;for(ye=O(Ne=B.samples||[],X+=20+16*Ne.length),(de=new Uint8Array(ye.length+16*Ne.length)).set(ye),Q=ye.length,Ue=0;Ue<Ne.length;Ue++)de[Q++]=(4278190080&(Me=Ne[Ue]).duration)>>>24,de[Q++]=(16711680&Me.duration)>>>16,de[Q++]=(65280&Me.duration)>>>8,de[Q++]=255&Me.duration,de[Q++]=(4278190080&Me.size)>>>24,de[Q++]=(16711680&Me.size)>>>16,de[Q++]=(65280&Me.size)>>>8,de[Q++]=255&Me.size,de[Q++]=Me.flags.isLeading<<2|Me.flags.dependsOn,de[Q++]=Me.flags.isDependedOn<<6|Me.flags.hasRedundancy<<4|Me.flags.paddingValue<<1|Me.flags.isNonSyncSample,de[Q++]=61440&Me.flags.degradationPriority,de[Q++]=15&Me.flags.degradationPriority,de[Q++]=(4278190080&Me.compositionTimeOffset)>>>24,de[Q++]=(16711680&Me.compositionTimeOffset)>>>16,de[Q++]=(65280&Me.compositionTimeOffset)>>>8,de[Q++]=255&Me.compositionTimeOffset;return m(pn.trun,de)},ee=function(B,X){var Q,de,ye,Ne,Me,Ue;for(ye=O(Ne=B.samples||[],X+=20+8*Ne.length),(Q=new Uint8Array(ye.length+8*Ne.length)).set(ye),de=ye.length,Ue=0;Ue<Ne.length;Ue++)Q[de++]=(4278190080&(Me=Ne[Ue]).duration)>>>24,Q[de++]=(16711680&Me.duration)>>>16,Q[de++]=(65280&Me.duration)>>>8,Q[de++]=255&Me.duration,Q[de++]=(4278190080&Me.size)>>>24,Q[de++]=(16711680&Me.size)>>>16,Q[de++]=(65280&Me.size)>>>8,Q[de++]=255&Me.size;return m(pn.trun,Q)},Wn=function(B,X){return"audio"===B.type?ee(B,X):M(B,X)}}();var Z0,wl,Ep,mg,gg,vg,i_,_g,Ro_mdat=P,Ro_moof=te,fg=function(M,O){var N={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return N.dataOffset=O,N.compositionTimeOffset=M.pts-M.dts,N.duration=M.duration,N.size=4*M.length,N.size+=M.byteLength,M.keyFrame&&(N.flags.dependsOn=2,N.flags.isNonSyncSample=0),N},Wd=[33,16,5,32,164,27],sf=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Wr=function(M){for(var O=[];M--;)O.push(0);return O};wl=function(M){return 9e4*M},Ep=function(M,O){return M*O},mg=function(M){return M/9e4},gg=function(M,O){return M/O},vg=function(M,O){return wl(gg(M,O))},i_=function(M,O){return Ep(mg(M),O)},_g=function(M,O,N){return mg(N?M:M-O)};var pr_secondsToVideoTs=wl,pr_videoTsToSeconds=mg,pr_audioTsToVideoTs=vg,pr_videoTsToAudioTs=i_,pr_metadataTsToSeconds=_g,Cp_prefixWithSilence=function(M,O,N,B){var X,Me,Ue,ct,Q=0,de=0,ye=0,Ne=0;if(O.length&&(X=pr_audioTsToVideoTs(M.baseMediaDecodeTime,M.samplerate),Q=Math.ceil(9e4/(M.samplerate/1024)),N&&B&&(de=X-Math.max(N,B),Ne=(ye=Math.floor(de/Q))*Q),!(ye<1||Ne>45e3))){for((Me=function(){if(!Z0){var M={96e3:[Wd,[227,64],Wr(154),[56]],88200:[Wd,[231],Wr(170),[56]],64e3:[Wd,[248,192],Wr(240),[56]],48e3:[Wd,[255,192],Wr(268),[55,148,128],Wr(54),[112]],44100:[Wd,[255,192],Wr(268),[55,163,128],Wr(84),[112]],32e3:[Wd,[255,192],Wr(268),[55,234],Wr(226),[112]],24e3:[Wd,[255,192],Wr(268),[55,255,128],Wr(268),[111,112],Wr(126),[224]],16e3:[Wd,[255,192],Wr(268),[55,255,128],Wr(268),[111,255],Wr(269),[223,108],Wr(195),[1,192]],12e3:[sf,Wr(268),[3,127,248],Wr(268),[6,255,240],Wr(268),[13,255,224],Wr(268),[27,253,128],Wr(259),[56]],11025:[sf,Wr(268),[3,127,248],Wr(268),[6,255,240],Wr(268),[13,255,224],Wr(268),[27,255,192],Wr(268),[55,175,128],Wr(108),[112]],8e3:[sf,Wr(268),[3,121,16],Wr(47),[7]]};Z0=function(M){return Object.keys(M).reduce(function(O,N){return O[N]=new Uint8Array(M[N].reduce(function(B,X){return B.concat(X)},[])),O},{})}(M)}return Z0}()[M.samplerate])||(Me=O[0].data),Ue=0;Ue<ye;Ue++)O.splice(0,0,{data:Me,dts:(ct=O[0]).dts-Q,pts:ct.pts-Q});return M.baseMediaDecodeTime-=Math.floor(pr_videoTsToAudioTs(Ne,M.samplerate)),Ne}},p_clearDtsInfo=function(M){delete M.minSegmentDts,delete M.maxSegmentDts,delete M.minSegmentPts,delete M.maxSegmentPts},p_calculateTrackBaseMediaDecodeTime=function(M,O){var N,X=M.minSegmentDts;return O||(X-=M.timelineStartInfo.dts),N=M.timelineStartInfo.baseMediaDecodeTime,N+=X,N=Math.max(0,N),"audio"===M.type&&(N*=M.samplerate/9e4,N=Math.floor(N)),N},p_collectDtsInfo=function(M,O){"number"==typeof O.pts&&(void 0===M.timelineStartInfo.pts&&(M.timelineStartInfo.pts=O.pts),M.minSegmentPts=void 0===M.minSegmentPts?O.pts:Math.min(M.minSegmentPts,O.pts),M.maxSegmentPts=void 0===M.maxSegmentPts?O.pts:Math.max(M.maxSegmentPts,O.pts)),"number"==typeof O.dts&&(void 0===M.timelineStartInfo.dts&&(M.timelineStartInfo.dts=O.dts),M.minSegmentDts=void 0===M.minSegmentDts?O.dts:Math.min(M.minSegmentDts,O.dts),M.maxSegmentDts=void 0===M.maxSegmentDts?O.dts:Math.max(M.maxSegmentDts,O.dts))},k=function ee(M){M=M||{},ee.prototype.init.call(this),this.parse708captions_="boolean"!=typeof M.parse708captions||M.parse708captions,this.captionPackets_=[],this.ccStreams_=[new De(0,0),new De(0,1),new De(1,0),new De(1,1)],this.parse708captions_&&(this.cc708Stream_=new $({captionServices:M.captionServices})),this.reset(),this.ccStreams_.forEach(function(O){O.on("data",this.trigger.bind(this,"data")),O.on("partialdone",this.trigger.bind(this,"partialdone")),O.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};(k.prototype=new d).push=function(ee){var M,O,N;if("sei_rbsp"===ee.nalUnitType&&(M=function(M){for(var O=0,N={payloadType:-1,payloadSize:0},B=0,X=0;O<M.byteLength&&128!==M[O];){for(;255===M[O];)B+=255,O++;for(B+=M[O++];255===M[O];)X+=255,O++;if(X+=M[O++],!N.payload&&4===B){if("GA94"===String.fromCharCode(M[O+3],M[O+4],M[O+5],M[O+6])){N.payloadType=B,N.payloadSize=X,N.payload=M.subarray(O,O+X);break}N.payload=void 0}O+=X,B=0,X=0}return N}(ee.escapedRBSP)).payload&&4===M.payloadType&&(O=function(M){return 181!==M.payload[0]||49!=(M.payload[1]<<8|M.payload[2])||"GA94"!==String.fromCharCode(M.payload[3],M.payload[4],M.payload[5],M.payload[6])||3!==M.payload[7]?null:M.payload.subarray(8,M.payload.length-1)}(M))){if(ee.dts<this.latestDts_)return void(this.ignoreNextEqualDts_=!0);if(ee.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));N=function(M,O){var B,X,Q,de,N=[];if(!(64&O[0]))return N;for(X=31&O[0],B=0;B<X;B++)de={type:3&O[2+(Q=3*B)],pts:M},4&O[Q+2]&&(de.ccData=O[Q+3]<<8|O[Q+4],N.push(de));return N}(ee.pts,O),this.captionPackets_=this.captionPackets_.concat(N),this.latestDts_!==ee.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=ee.dts}},k.prototype.flushCCStreams=function(ee){this.ccStreams_.forEach(function(M){return"flush"===ee?M.flush():M.partialFlush()},this)},k.prototype.flushStream=function(ee){this.captionPackets_.length?(this.captionPackets_.forEach(function(M,O){M.presortIndex=O}),this.captionPackets_.sort(function(M,O){return M.pts===O.pts?M.presortIndex-O.presortIndex:M.pts-O.pts}),this.captionPackets_.forEach(function(M){M.type<2?this.dispatchCea608Packet(M):this.dispatchCea708Packet(M)},this),this.captionPackets_.length=0,this.flushCCStreams(ee)):this.flushCCStreams(ee)},k.prototype.flush=function(){return this.flushStream("flush")},k.prototype.partialFlush=function(){return this.flushStream("partialFlush")},k.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(ee){ee.reset()})},k.prototype.dispatchCea608Packet=function(ee){this.setsTextOrXDSActive(ee)?this.activeCea608Channel_[ee.type]=null:this.setsChannel1Active(ee)?this.activeCea608Channel_[ee.type]=0:this.setsChannel2Active(ee)&&(this.activeCea608Channel_[ee.type]=1),null!==this.activeCea608Channel_[ee.type]&&this.ccStreams_[(ee.type<<1)+this.activeCea608Channel_[ee.type]].push(ee)},k.prototype.setsChannel1Active=function(ee){return 4096==(30720&ee.ccData)},k.prototype.setsChannel2Active=function(ee){return 6144==(30720&ee.ccData)},k.prototype.setsTextOrXDSActive=function(ee){return 256==(28928&ee.ccData)||4138==(30974&ee.ccData)||6186==(30974&ee.ccData)},k.prototype.dispatchCea708Packet=function(ee){this.parse708captions_&&this.cc708Stream_.push(ee)};var U={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Y=function(M){return 32<=M&&M<=127||160<=M&&M<=255},re=function(M){this.windowNum=M,this.reset()};re.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},re.prototype.getText=function(){return this.rows.join("\n")},re.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},re.prototype.newLine=function(ee){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(ee),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},re.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},re.prototype.addText=function(ee){this.rows[this.rowIdx]+=ee},re.prototype.backspace=function(){if(!this.isEmpty()){var ee=this.rows[this.rowIdx];this.rows[this.rowIdx]=ee.substr(0,ee.length-1)}};var ie=function(M,O,N){this.serviceNum=M,this.text="",this.currentWindow=new re(-1),this.windows=[],this.stream=N,"string"==typeof O&&this.createTextDecoder(O)};ie.prototype.init=function(ee,M){this.startPts=ee;for(var O=0;O<8;O++)this.windows[O]=new re(O),"function"==typeof M&&(this.windows[O].beforeRowOverflow=M)},ie.prototype.setCurrentWindow=function(ee){this.currentWindow=this.windows[ee]},ie.prototype.createTextDecoder=function(ee){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(ee)}catch(M){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+ee+" encoding. "+M})}};var $=function ee(M){M=M||{},ee.prototype.init.call(this);var X,O=this,N=M.captionServices||{},B={};Object.keys(N).forEach(function(Q){X=N[Q],/^SERVICE/.test(Q)&&(B[Q]=X.encoding)}),this.serviceEncodings=B,this.current708Packet=null,this.services={},this.push=function(Q){3===Q.type?(O.new708Packet(),O.add708Bytes(Q)):(null===O.current708Packet&&O.new708Packet(),O.add708Bytes(Q))}};$.prototype=new d,$.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},$.prototype.add708Bytes=function(ee){var M=ee.ccData,O=M>>>8,N=255&M;this.current708Packet.ptsVals.push(ee.pts),this.current708Packet.data.push(O),this.current708Packet.data.push(N)},$.prototype.push708Packet=function(){var ee=this.current708Packet,M=ee.data,O=null,N=null,B=0,X=M[B++];for(ee.seq=X>>6,ee.sizeCode=63&X;B<M.length;B++)N=31&(X=M[B++]),7==(O=X>>5)&&N>0&&(O=X=M[B++]),this.pushServiceBlock(O,B,N),N>0&&(B+=N-1)},$.prototype.pushServiceBlock=function(ee,M,O){var N,B=M,X=this.current708Packet.data,Q=this.services[ee];for(Q||(Q=this.initService(ee,B));B<M+O&&B<X.length;B++)Y(N=X[B])?B=this.handleText(B,Q):24===N?B=this.multiByteCharacter(B,Q):16===N?B=this.extendedCommands(B,Q):128<=N&&N<=135?B=this.setCurrentWindow(B,Q):152<=N&&N<=159?B=this.defineWindow(B,Q):136===N?B=this.clearWindows(B,Q):140===N?B=this.deleteWindows(B,Q):137===N?B=this.displayWindows(B,Q):138===N?B=this.hideWindows(B,Q):139===N?B=this.toggleWindows(B,Q):151===N?B=this.setWindowAttributes(B,Q):144===N?B=this.setPenAttributes(B,Q):145===N?B=this.setPenColor(B,Q):146===N?B=this.setPenLocation(B,Q):143===N?Q=this.reset(B,Q):8===N?Q.currentWindow.backspace():12===N?Q.currentWindow.clearText():13===N?Q.currentWindow.pendingNewLine=!0:14===N?Q.currentWindow.clearText():141===N&&B++},$.prototype.extendedCommands=function(ee,M){var N=this.current708Packet.data[++ee];return Y(N)&&(ee=this.handleText(ee,M,{isExtended:!0})),ee},$.prototype.getPts=function(ee){return this.current708Packet.ptsVals[Math.floor(ee/2)]},$.prototype.initService=function(ee,M){var N,B,O=this;return(N="SERVICE"+ee)in this.serviceEncodings&&(B=this.serviceEncodings[N]),this.services[ee]=new ie(ee,B,O),this.services[ee].init(this.getPts(M),function(X){O.flushDisplayed(X,O.services[ee])}),this.services[ee]},$.prototype.handleText=function(ee,M,O){var Me,Ue,N=O&&O.isExtended,X=this.current708Packet.data,Q=N?4096:0,de=X[ee],Ne=M.currentWindow;return M.textDecoder_&&!N?(O&&O.isMultiByte?(Ue=[de,X[ee+1]],ee++):Ue=[de],Me=M.textDecoder_.decode(new Uint8Array(Ue))):Me=function(M){var O=U[M]||M;return 4096&M&&M===O?"":String.fromCharCode(O)}(Q|de),Ne.pendingNewLine&&!Ne.isEmpty()&&Ne.newLine(this.getPts(ee)),Ne.pendingNewLine=!1,Ne.addText(Me),ee},$.prototype.multiByteCharacter=function(ee,M){var O=this.current708Packet.data,B=O[ee+2];return Y(O[ee+1])&&Y(B)&&(ee=this.handleText(++ee,M,{isMultiByte:!0})),ee},$.prototype.setCurrentWindow=function(ee,M){return M.setCurrentWindow(7&this.current708Packet.data[ee]),ee},$.prototype.defineWindow=function(ee,M){var O=this.current708Packet.data,N=O[ee];M.setCurrentWindow(7&N);var X=M.currentWindow;return N=O[++ee],X.visible=(32&N)>>5,X.rowLock=(16&N)>>4,X.columnLock=(8&N)>>3,X.priority=7&N,N=O[++ee],X.relativePositioning=(128&N)>>7,X.anchorVertical=127&N,N=O[++ee],X.anchorHorizontal=N,N=O[++ee],X.anchorPoint=(240&N)>>4,X.rowCount=15&N,N=O[++ee],X.columnCount=63&N,N=O[++ee],X.windowStyle=(56&N)>>3,X.penStyle=7&N,X.virtualRowCount=X.rowCount+1,ee},$.prototype.setWindowAttributes=function(ee,M){var O=this.current708Packet.data,N=O[ee],B=M.currentWindow.winAttr;return N=O[++ee],B.fillOpacity=(192&N)>>6,B.fillRed=(48&N)>>4,B.fillGreen=(12&N)>>2,B.fillBlue=3&N,N=O[++ee],B.borderType=(192&N)>>6,B.borderRed=(48&N)>>4,B.borderGreen=(12&N)>>2,B.borderBlue=3&N,N=O[++ee],B.borderType+=(128&N)>>5,B.wordWrap=(64&N)>>6,B.printDirection=(48&N)>>4,B.scrollDirection=(12&N)>>2,B.justify=3&N,N=O[++ee],B.effectSpeed=(240&N)>>4,B.effectDirection=(12&N)>>2,B.displayEffect=3&N,ee},$.prototype.flushDisplayed=function(ee,M){for(var O=[],N=0;N<8;N++)M.windows[N].visible&&!M.windows[N].isEmpty()&&O.push(M.windows[N].getText());M.endPts=ee,M.text=O.join("\n\n"),this.pushCaption(M),M.startPts=ee},$.prototype.pushCaption=function(ee){""!==ee.text&&(this.trigger("data",{startPts:ee.startPts,endPts:ee.endPts,text:ee.text,stream:"cc708_"+ee.serviceNum}),ee.text="",ee.startPts=ee.endPts)},$.prototype.displayWindows=function(ee,M){var N=this.current708Packet.data[++ee],B=this.getPts(ee);this.flushDisplayed(B,M);for(var X=0;X<8;X++)N&1<<X&&(M.windows[X].visible=1);return ee},$.prototype.hideWindows=function(ee,M){var N=this.current708Packet.data[++ee],B=this.getPts(ee);this.flushDisplayed(B,M);for(var X=0;X<8;X++)N&1<<X&&(M.windows[X].visible=0);return ee},$.prototype.toggleWindows=function(ee,M){var N=this.current708Packet.data[++ee],B=this.getPts(ee);this.flushDisplayed(B,M);for(var X=0;X<8;X++)N&1<<X&&(M.windows[X].visible^=1);return ee},$.prototype.clearWindows=function(ee,M){var N=this.current708Packet.data[++ee],B=this.getPts(ee);this.flushDisplayed(B,M);for(var X=0;X<8;X++)N&1<<X&&M.windows[X].clearText();return ee},$.prototype.deleteWindows=function(ee,M){var N=this.current708Packet.data[++ee],B=this.getPts(ee);this.flushDisplayed(B,M);for(var X=0;X<8;X++)N&1<<X&&M.windows[X].reset();return ee},$.prototype.setPenAttributes=function(ee,M){var O=this.current708Packet.data,N=O[ee],B=M.currentWindow.penAttr;return N=O[++ee],B.textTag=(240&N)>>4,B.offset=(12&N)>>2,B.penSize=3&N,N=O[++ee],B.italics=(128&N)>>7,B.underline=(64&N)>>6,B.edgeType=(56&N)>>3,B.fontStyle=7&N,ee},$.prototype.setPenColor=function(ee,M){var O=this.current708Packet.data,N=O[ee],B=M.currentWindow.penColor;return N=O[++ee],B.fgOpacity=(192&N)>>6,B.fgRed=(48&N)>>4,B.fgGreen=(12&N)>>2,B.fgBlue=3&N,N=O[++ee],B.bgOpacity=(192&N)>>6,B.bgRed=(48&N)>>4,B.bgGreen=(12&N)>>2,B.bgBlue=3&N,N=O[++ee],B.edgeRed=(48&N)>>4,B.edgeGreen=(12&N)>>2,B.edgeBlue=3&N,ee},$.prototype.setPenLocation=function(ee,M){var O=this.current708Packet.data,N=O[ee],B=M.currentWindow.penLoc;return M.currentWindow.pendingNewLine=!0,N=O[++ee],B.row=15&N,N=O[++ee],B.column=63&N,ee},$.prototype.reset=function(ee,M){var O=this.getPts(ee);return this.flushDisplayed(O,M),this.initService(M.serviceNum,ee)};var q={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ae=function(M){return null===M?"":(M=q[M]||M,String.fromCharCode(M))},Se=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],he=function(){for(var M=[],O=15;O--;)M.push("");return M},De=function ee(M,O){ee.prototype.init.call(this),this.field_=M||0,this.dataChannel_=O||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(N){var B,X,Q,de,ye;if((B=32639&N.ccData)!==this.lastControlCode_){if(4096==(61440&B)?this.lastControlCode_=B:B!==this.PADDING_&&(this.lastControlCode_=null),Q=B>>>8,de=255&B,B!==this.PADDING_)if(B===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(B===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(N.pts),this.flushDisplayed(N.pts),X=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=X,this.startPts_=N.pts;else if(B===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(N.pts);else if(B===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(N.pts);else if(B===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(N.pts);else if(B===this.CARRIAGE_RETURN_)this.clearFormatting(N.pts),this.flushDisplayed(N.pts),this.shiftRowsUp_(),this.startPts_=N.pts;else if(B===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(B===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(N.pts),this.displayed_=he();else if(B===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=he();else if(B===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(N.pts),this.displayed_=he()),this.mode_="paintOn",this.startPts_=N.pts;else if(this.isSpecialCharacter(Q,de))ye=Ae((Q=(3&Q)<<8)|de),this[this.mode_](N.pts,ye),this.column_++;else if(this.isExtCharacter(Q,de))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),ye=Ae((Q=(3&Q)<<8)|de),this[this.mode_](N.pts,ye),this.column_++;else if(this.isMidRowCode(Q,de))this.clearFormatting(N.pts),this[this.mode_](N.pts," "),this.column_++,14==(14&de)&&this.addFormatting(N.pts,["i"]),1==(1&de)&&this.addFormatting(N.pts,["u"]);else if(this.isOffsetControlCode(Q,de))this.column_+=3&de;else if(this.isPAC(Q,de)){var Ne=Se.indexOf(7968&B);"rollUp"===this.mode_&&(Ne-this.rollUpRows_+1<0&&(Ne=this.rollUpRows_-1),this.setRollUp(N.pts,Ne)),Ne!==this.row_&&(this.clearFormatting(N.pts),this.row_=Ne),1&de&&-1===this.formatting_.indexOf("u")&&this.addFormatting(N.pts,["u"]),16==(16&B)&&(this.column_=4*((14&B)>>1)),this.isColorPAC(de)&&14==(14&de)&&this.addFormatting(N.pts,["i"])}else this.isNormalChar(Q)&&(0===de&&(de=null),ye=Ae(Q),ye+=Ae(de),this[this.mode_](N.pts,ye),this.column_+=ye.length)}else this.lastControlCode_=null}};De.prototype=new d,De.prototype.flushDisplayed=function(ee){var M=this.displayed_.map(function(O,N){try{return O.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+N+"."}),""}},this).join("\n").replace(/^\n+|\n+$/g,"");M.length&&this.trigger("data",{startPts:this.startPts_,endPts:ee,text:M,stream:this.name_})},De.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=he(),this.nonDisplayed_=he(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},De.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},De.prototype.isSpecialCharacter=function(ee,M){return ee===this.EXT_&&M>=48&&M<=63},De.prototype.isExtCharacter=function(ee,M){return(ee===this.EXT_+1||ee===this.EXT_+2)&&M>=32&&M<=63},De.prototype.isMidRowCode=function(ee,M){return ee===this.EXT_&&M>=32&&M<=47},De.prototype.isOffsetControlCode=function(ee,M){return ee===this.OFFSET_&&M>=33&&M<=35},De.prototype.isPAC=function(ee,M){return ee>=this.BASE_&&ee<this.BASE_+8&&M>=64&&M<=127},De.prototype.isColorPAC=function(ee){return ee>=64&&ee<=79||ee>=96&&ee<=127},De.prototype.isNormalChar=function(ee){return ee>=32&&ee<=127},De.prototype.setRollUp=function(ee,M){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(ee),this.nonDisplayed_=he(),this.displayed_=he()),void 0!==M&&M!==this.row_)for(var O=0;O<this.rollUpRows_;O++)this.displayed_[M-O]=this.displayed_[this.row_-O],this.displayed_[this.row_-O]="";void 0===M&&(M=this.row_),this.topRow_=M-this.rollUpRows_+1},De.prototype.addFormatting=function(ee,M){this.formatting_=this.formatting_.concat(M);var O=M.reduce(function(N,B){return N+"<"+B+">"},"");this[this.mode_](ee,O)},De.prototype.clearFormatting=function(ee){if(this.formatting_.length){var M=this.formatting_.reverse().reduce(function(O,N){return O+"</"+N+">"},"");this.formatting_=[],this[this.mode_](ee,M)}},De.prototype.popOn=function(ee,M){var O=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=O+=M},De.prototype.rollUp=function(ee,M){var O=this.displayed_[this.row_];this.displayed_[this.row_]=O+=M},De.prototype.shiftRowsUp_=function(){var ee;for(ee=0;ee<this.topRow_;ee++)this.displayed_[ee]="";for(ee=this.row_+1;ee<15;ee++)this.displayed_[ee]="";for(ee=this.topRow_;ee<this.row_;ee++)this.displayed_[ee]=this.displayed_[ee+1];this.displayed_[this.row_]=""},De.prototype.paintOn=function(ee,M){var O=this.displayed_[this.row_];this.displayed_[this.row_]=O+=M};var vt={CaptionStream:k,Cea608Stream:De,Cea708Stream:$},ke={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Ze=function(M,O){var N=1;for(M>O&&(N=-1);Math.abs(O-M)>4294967296;)M+=8589934592*N;return M},Ce=function ee(M){var O,N;ee.prototype.init.call(this),this.type_=M||"shared",this.push=function(B){"shared"!==this.type_&&B.type!==this.type_||(void 0===N&&(N=B.dts),B.dts=Ze(B.dts,N),B.pts=Ze(B.pts,N),O=B.dts,this.trigger("data",B))},this.flush=function(){N=O,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){N=void 0,O=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Ce.prototype=new d;var qt,Fe_TimestampRolloverStream=Ce,Fe_handleRollover=Ze,je=function(M,O,N){var B,X="";for(B=O;B<N;B++)X+="%"+("00"+M[B].toString(16)).slice(-2);return X},at=function(M,O,N){return decodeURIComponent(je(M,O,N))},Pt=function(M,O,N){return unescape(je(M,O,N))},xt=function(M){return M[0]<<21|M[1]<<14|M[2]<<7|M[3]},Ut={TXXX:function(M){var O;if(3===M.data[0]){for(O=1;O<M.data.length;O++)if(0===M.data[O]){M.description=at(M.data,1,O),M.value=at(M.data,O+1,M.data.length).replace(/\0*$/,"");break}M.data=M.value}},WXXX:function(M){var O;if(3===M.data[0])for(O=1;O<M.data.length;O++)if(0===M.data[O]){M.description=at(M.data,1,O),M.url=at(M.data,O+1,M.data.length);break}},PRIV:function(M){var O;for(O=0;O<M.data.length;O++)if(0===M.data[O]){M.owner=Pt(M.data,0,O);break}M.privateData=M.data.subarray(O+1),M.data=M.privateData}};qt=function(M){var Q,O={descriptor:M&&M.descriptor},N=0,B=[],X=0;if(qt.prototype.init.call(this),this.dispatchType=ke.METADATA_STREAM_TYPE.toString(16),O.descriptor)for(Q=0;Q<O.descriptor.length;Q++)this.dispatchType+=("00"+O.descriptor[Q].toString(16)).slice(-2);this.push=function(de){var ye,Ne,Me,Ue,ct;if("timed-metadata"===de.type){if(de.dataAlignmentIndicator&&(X=0,B.length=0),0===B.length&&(de.data.length<10||de.data[0]!=="I".charCodeAt(0)||de.data[1]!=="D".charCodeAt(0)||de.data[2]!=="3".charCodeAt(0)))return void this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});if(B.push(de),X+=de.data.byteLength,1===B.length&&(N=xt(de.data.subarray(6,10)),N+=10),!(X<N)){for(ye={data:new Uint8Array(N),frames:[],pts:B[0].pts,dts:B[0].dts},ct=0;ct<N;)ye.data.set(B[0].data.subarray(0,N-ct),ct),ct+=B[0].data.byteLength,X-=B[0].data.byteLength,B.shift();Ne=10,64&ye.data[5]&&(Ne+=4,Ne+=xt(ye.data.subarray(10,14)),N-=xt(ye.data.subarray(16,20)));do{if((Me=xt(ye.data.subarray(Ne+4,Ne+8)))<1)return void this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});if((Ue={id:String.fromCharCode(ye.data[Ne],ye.data[Ne+1],ye.data[Ne+2],ye.data[Ne+3]),data:ye.data.subarray(Ne+10,Ne+Me+10)}).key=Ue.id,Ut[Ue.id]&&(Ut[Ue.id](Ue),"com.apple.streaming.transportStreamTimestamp"===Ue.owner)){var Mn=Ue.data,en=(1&Mn[3])<<30|Mn[4]<<22|Mn[5]<<14|Mn[6]<<6|Mn[7]>>>2;en*=4,Ue.timeStamp=en+=3&Mn[7],void 0===ye.pts&&void 0===ye.dts&&(ye.pts=Ue.timeStamp,ye.dts=Ue.timeStamp),this.trigger("timestamp",Ue)}ye.frames.push(Ue),Ne+=10,Ne+=Me}while(Ne<N);this.trigger("data",ye)}}}},qt.prototype=new d;var ki,mt,is,Qn=qt,Un=Fe_TimestampRolloverStream;ki=function(){var M=new Uint8Array(188),O=0;ki.prototype.init.call(this),this.push=function(N){var Q,B=0,X=188;for(O?((Q=new Uint8Array(N.byteLength+O)).set(M.subarray(0,O)),Q.set(N,O),O=0):Q=N;X<Q.byteLength;)71!==Q[B]||71!==Q[X]?(B++,X++):(this.trigger("data",Q.subarray(B,X)),B+=188,X+=188);B<Q.byteLength&&(M.set(Q.subarray(B),0),O=Q.byteLength-B)},this.flush=function(){188===O&&71===M[0]&&(this.trigger("data",M),O=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){O=0,this.trigger("reset")}},ki.prototype=new d,mt=function(){var M,O,N,B;mt.prototype.init.call(this),B=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,M=function(Q,de){var ye=0;de.payloadUnitStartIndicator&&(ye+=Q[ye]+1),"pat"===de.type?O(Q.subarray(ye),de):N(Q.subarray(ye),de)},O=function(Q,de){de.section_number=Q[7],de.last_section_number=Q[8],B.pmtPid=(31&Q[10])<<8|Q[11],de.pmtPid=B.pmtPid},N=function(Q,de){var Ne,Ue;if(1&Q[5]){for(B.programMapTable={video:null,audio:null,"timed-metadata":{}},Ne=3+((15&Q[1])<<8|Q[2])-4,Ue=12+((15&Q[10])<<8|Q[11]);Ue<Ne;){var ct=Q[Ue],cn=(31&Q[Ue+1])<<8|Q[Ue+2];ct===ke.H264_STREAM_TYPE&&null===B.programMapTable.video?B.programMapTable.video=cn:ct===ke.ADTS_STREAM_TYPE&&null===B.programMapTable.audio?B.programMapTable.audio=cn:ct===ke.METADATA_STREAM_TYPE&&(B.programMapTable["timed-metadata"][cn]=ct),Ue+=5+((15&Q[Ue+3])<<8|Q[Ue+4])}de.programMapTable=B.programMapTable}},this.push=function(X){var Q={},de=4;if(Q.payloadUnitStartIndicator=!!(64&X[1]),Q.pid=31&X[1],Q.pid<<=8,Q.pid|=X[2],(48&X[3])>>>4>1&&(de+=X[de]+1),0===Q.pid)Q.type="pat",M(X.subarray(de),Q),this.trigger("data",Q);else if(Q.pid===this.pmtPid)for(Q.type="pmt",M(X.subarray(de),Q),this.trigger("data",Q);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([X,de,Q]):this.processPes_(X,de,Q)},this.processPes_=function(X,Q,de){de.streamType=de.pid===this.programMapTable.video?ke.H264_STREAM_TYPE:de.pid===this.programMapTable.audio?ke.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][de.pid],de.type="pes",de.data=X.subarray(Q),this.trigger("data",de)}},mt.prototype=new d,mt.STREAM_TYPES={h264:27,adts:15},is=function(){var Q,M=this,O=!1,N={data:[],size:0},B={data:[],size:0},X={data:[],size:0},ye=function(Me,Ue,ct){var sl,cn=new Uint8Array(Me.size),Mn={type:Ue},en=0,Nn=0,Ca=!1;if(Me.data.length&&!(Me.size<9)){for(Mn.trackId=Me.data[0].pid,en=0;en<Me.data.length;en++)cn.set((sl=Me.data[en]).data,Nn),Nn+=sl.data.byteLength;(function(Me,Ue){var ct,cn=Me[0]<<16|Me[1]<<8|Me[2];Ue.data=new Uint8Array,1===cn&&(Ue.packetLength=6+(Me[4]<<8|Me[5]),Ue.dataAlignmentIndicator=0!=(4&Me[6]),192&(ct=Me[7])&&(Ue.pts=(14&Me[9])<<27|(255&Me[10])<<20|(254&Me[11])<<12|(255&Me[12])<<5|(254&Me[13])>>>3,Ue.pts*=4,Ue.pts+=(6&Me[13])>>>1,Ue.dts=Ue.pts,64&ct&&(Ue.dts=(14&Me[14])<<27|(255&Me[15])<<20|(254&Me[16])<<12|(255&Me[17])<<5|(254&Me[18])>>>3,Ue.dts*=4,Ue.dts+=(6&Me[18])>>>1)),Ue.data=Me.subarray(9+Me[8]))})(cn,Mn),Ca="video"===Ue||Mn.packetLength<=Me.size,(ct||Ca)&&(Me.size=0,Me.data.length=0),Ca&&M.trigger("data",Mn)}};is.prototype.init.call(this),this.push=function(Ne){({pat:function(){},pes:function(){var Ue,ct;switch(Ne.streamType){case ke.H264_STREAM_TYPE:Ue=N,ct="video";break;case ke.ADTS_STREAM_TYPE:Ue=B,ct="audio";break;case ke.METADATA_STREAM_TYPE:Ue=X,ct="timed-metadata";break;default:return}Ne.payloadUnitStartIndicator&&ye(Ue,ct,!0),Ue.data.push(Ne),Ue.size+=Ne.data.byteLength},pmt:function(){var Ue={type:"metadata",tracks:[]};null!==(Q=Ne.programMapTable).video&&Ue.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Q.video,codec:"avc",type:"video"}),null!==Q.audio&&Ue.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Q.audio,codec:"adts",type:"audio"}),O=!0,M.trigger("data",Ue)}})[Ne.type]()},this.reset=function(){N.size=0,N.data.length=0,B.size=0,B.data.length=0,this.trigger("reset")},this.flushStreams_=function(){ye(N,"video"),ye(B,"audio"),ye(X,"timed-metadata")},this.flush=function(){if(!O&&Q){var Ne={type:"metadata",tracks:[]};null!==Q.video&&Ne.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Q.video,codec:"avc",type:"video"}),null!==Q.audio&&Ne.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Q.audio,codec:"adts",type:"audio"}),M.trigger("data",Ne)}O=!1,this.flushStreams_(),this.trigger("done")}},is.prototype=new d;var ri={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:ki,TransportParseStream:mt,ElementaryStream:is,TimestampRolloverStream:Un,CaptionStream:vt.CaptionStream,Cea608Stream:vt.Cea608Stream,Cea708Stream:vt.Cea708Stream,MetadataStream:Qn};for(var Hi in ke)ke.hasOwnProperty(Hi)&&(ri[Hi]=ke[Hi]);var Zt,si=ri,un=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Zt=function(M){var O,N=0;Zt.prototype.init.call(this),this.skipWarn_=function(B,X){this.trigger("log",{level:"warn",message:"adts skiping bytes "+B+" to "+X+" in frame "+N+" outside syncword"})},this.push=function(B){var Q,de,ye,Ne,Me,X=0;if(M||(N=0),"audio"===B.type){O&&O.length?(ye=O,(O=new Uint8Array(ye.byteLength+B.data.byteLength)).set(ye),O.set(B.data,ye.byteLength)):O=B.data;for(var Ue;X+7<O.length;)if(255===O[X]&&240==(246&O[X+1])){if("number"==typeof Ue&&(this.skipWarn_(Ue,X),Ue=null),de=2*(1&~O[X+1]),Me=9e4*(Ne=1024*(1+(3&O[X+6])))/un[(60&O[X+2])>>>2],O.byteLength-X<(Q=(3&O[X+3])<<11|O[X+4]<<3|(224&O[X+5])>>5))break;this.trigger("data",{pts:B.pts+N*Me,dts:B.dts+N*Me,sampleCount:Ne,audioobjecttype:1+(O[X+2]>>>6&3),channelcount:(1&O[X+2])<<2|(192&O[X+3])>>>6,samplerate:un[(60&O[X+2])>>>2],samplingfrequencyindex:(60&O[X+2])>>>2,samplesize:16,data:O.subarray(X+7+de,X+Q)}),N++,X+=Q}else"number"!=typeof Ue&&(Ue=X),X++;"number"==typeof Ue&&(this.skipWarn_(Ue,X),Ue=null),O=O.subarray(X)}},this.flush=function(){N=0,this.trigger("done")},this.reset=function(){O=void 0,this.trigger("reset")},this.endTimeline=function(){O=void 0,this.trigger("endedtimeline")}},Zt.prototype=new d;var Ve,On=Zt;Ve=function(M){var O=M.byteLength,N=0,B=0;this.length=function(){return 8*O},this.bitsAvailable=function(){return 8*O+B},this.loadWord=function(){var X=M.byteLength-O,Q=new Uint8Array(4),de=Math.min(4,O);if(0===de)throw new Error("no bytes available");Q.set(M.subarray(X,X+de)),N=new DataView(Q.buffer).getUint32(0),B=8*de,O-=de},this.skipBits=function(X){var Q;B>X?(N<<=X,B-=X):(X-=B,X-=8*(Q=Math.floor(X/8)),O-=Q,this.loadWord(),N<<=X,B-=X)},this.readBits=function(X){var Q=Math.min(B,X),de=N>>>32-Q;return(B-=Q)>0?N<<=Q:O>0&&this.loadWord(),(Q=X-Q)>0?de<<Q|this.readBits(Q):de},this.skipLeadingZeros=function(){var X;for(X=0;X<B;++X)if(0!=(N&2147483648>>>X))return N<<=X,B-=X,X;return this.loadWord(),X+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var X=this.skipLeadingZeros();return this.readBits(X+1)-1},this.readExpGolomb=function(){var X=this.readUnsignedExpGolomb();return 1&X?1+X>>>1:-1*(X>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var me,Et,_t,_e=Ve;Et=function(){var O,N,M=0;Et.prototype.init.call(this),this.push=function(B){var X;N?((X=new Uint8Array(N.byteLength+B.data.byteLength)).set(N),X.set(B.data,N.byteLength),N=X):N=B.data;for(var Q=N.byteLength;M<Q-3;M++)if(1===N[M+2]){O=M+5;break}for(;O<Q;)switch(N[O]){case 0:if(0!==N[O-1]){O+=2;break}if(0!==N[O-2]){O++;break}M+3!==O-2&&this.trigger("data",N.subarray(M+3,O-2));do{O++}while(1!==N[O]&&O<Q);M=O-2,O+=3;break;case 1:if(0!==N[O-1]||0!==N[O-2]){O+=3;break}this.trigger("data",N.subarray(M+3,O-2)),M=O-2,O+=3;break;default:O+=3}N=N.subarray(M),O-=M,M=0},this.reset=function(){N=null,M=0,this.trigger("reset")},this.flush=function(){N&&N.byteLength>3&&this.trigger("data",N.subarray(M+3)),N=null,M=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},Et.prototype=new d,_t={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},me=function(){var O,N,B,X,Q,de,ye,M=new Et;me.prototype.init.call(this),O=this,this.push=function(Ne){"video"===Ne.type&&(N=Ne.trackId,B=Ne.pts,X=Ne.dts,M.push(Ne))},M.on("data",function(Ne){var Me={trackId:N,pts:B,dts:X,data:Ne,nalUnitTypeCode:31&Ne[0]};switch(Me.nalUnitTypeCode){case 5:Me.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:Me.nalUnitType="sei_rbsp",Me.escapedRBSP=Q(Ne.subarray(1));break;case 7:Me.nalUnitType="seq_parameter_set_rbsp",Me.escapedRBSP=Q(Ne.subarray(1)),Me.config=de(Me.escapedRBSP);break;case 8:Me.nalUnitType="pic_parameter_set_rbsp";break;case 9:Me.nalUnitType="access_unit_delimiter_rbsp"}O.trigger("data",Me)}),M.on("done",function(){O.trigger("done")}),M.on("partialdone",function(){O.trigger("partialdone")}),M.on("reset",function(){O.trigger("reset")}),M.on("endedtimeline",function(){O.trigger("endedtimeline")}),this.flush=function(){M.flush()},this.partialFlush=function(){M.partialFlush()},this.reset=function(){M.reset()},this.endTimeline=function(){M.endTimeline()},ye=function(Me,Ue){var Mn,ct=8,cn=8;for(Mn=0;Mn<Me;Mn++)0!==cn&&(cn=(ct+Ue.readExpGolomb()+256)%256),ct=0===cn?ct:cn},Q=function(Me){for(var Mn,en,Ue=Me.byteLength,ct=[],cn=1;cn<Ue-2;)0===Me[cn]&&0===Me[cn+1]&&3===Me[cn+2]?(ct.push(cn+2),cn+=2):cn++;if(0===ct.length)return Me;Mn=Ue-ct.length,en=new Uint8Array(Mn);var Nn=0;for(cn=0;cn<Mn;Nn++,cn++)Nn===ct[0]&&(Nn++,ct.shift()),en[cn]=Me[Nn];return en},de=function(Me){var en,Nn,Ca,sl,Op,ty,_T,Vb,Hb,vf,yT,Lp,Ue=0,ct=0,cn=0,Mn=0,ma=[1,1];if(Nn=(en=new _e(Me)).readUnsignedByte(),sl=en.readUnsignedByte(),Ca=en.readUnsignedByte(),en.skipUnsignedExpGolomb(),_t[Nn]&&(3===(Op=en.readUnsignedExpGolomb())&&en.skipBits(1),en.skipUnsignedExpGolomb(),en.skipUnsignedExpGolomb(),en.skipBits(1),en.readBoolean()))for(yT=3!==Op?8:12,Lp=0;Lp<yT;Lp++)en.readBoolean()&&ye(Lp<6?16:64,en);if(en.skipUnsignedExpGolomb(),0===(ty=en.readUnsignedExpGolomb()))en.readUnsignedExpGolomb();else if(1===ty)for(en.skipBits(1),en.skipExpGolomb(),en.skipExpGolomb(),_T=en.readUnsignedExpGolomb(),Lp=0;Lp<_T;Lp++)en.skipExpGolomb();if(en.skipUnsignedExpGolomb(),en.skipBits(1),Vb=en.readUnsignedExpGolomb(),Hb=en.readUnsignedExpGolomb(),0===(vf=en.readBits(1))&&en.skipBits(1),en.skipBits(1),en.readBoolean()&&(Ue=en.readUnsignedExpGolomb(),ct=en.readUnsignedExpGolomb(),cn=en.readUnsignedExpGolomb(),Mn=en.readUnsignedExpGolomb()),en.readBoolean()&&en.readBoolean())switch(en.readUnsignedByte()){case 1:ma=[1,1];break;case 2:ma=[12,11];break;case 3:ma=[10,11];break;case 4:ma=[16,11];break;case 5:ma=[40,33];break;case 6:ma=[24,11];break;case 7:ma=[20,11];break;case 8:ma=[32,11];break;case 9:ma=[80,33];break;case 10:ma=[18,11];break;case 11:ma=[15,11];break;case 12:ma=[64,33];break;case 13:ma=[160,99];break;case 14:ma=[4,3];break;case 15:ma=[3,2];break;case 16:ma=[2,1];break;case 255:ma=[en.readUnsignedByte()<<8|en.readUnsignedByte(),en.readUnsignedByte()<<8|en.readUnsignedByte()]}return{profileIdc:Nn,levelIdc:Ca,profileCompatibility:sl,width:16*(Vb+1)-2*Ue-2*ct,height:(2-vf)*(Hb+1)*16-2*cn-2*Mn,sarRatio:ma}}},me.prototype=new d;var Ql,Le={H264Stream:me,NalByteStream:Et},Gt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],An=function(M,O){var N=M[O+6]<<21|M[O+7]<<14|M[O+8]<<7|M[O+9];return N=N>=0?N:0,(16&M[O+5])>>4?N+20:N+10},Gn=function ee(M,O){return M.length-O<10||M[O]!=="I".charCodeAt(0)||M[O+1]!=="D".charCodeAt(0)||M[O+2]!=="3".charCodeAt(0)?O:ee(M,O+=An(M,O))},Vn=function(M){return M[0]<<21|M[1]<<14|M[2]<<7|M[3]},Si=function(M,O,N){return unescape(function(M,O,N){var B,X="";for(B=O;B<N;B++)X+="%"+("00"+M[B].toString(16)).slice(-2);return X}(M,O,N))},nl={isLikelyAacData:function(M){var O=Gn(M,0);return M.length>=O+2&&255==(255&M[O])&&240==(240&M[O+1])&&16==(22&M[O+1])},parseId3TagSize:An,parseAdtsSize:function(M,O){return 6144&M[O+3]|M[O+4]<<3|(224&M[O+5])>>5},parseType:function(M,O){return M[O]==="I".charCodeAt(0)&&M[O+1]==="D".charCodeAt(0)&&M[O+2]==="3".charCodeAt(0)?"timed-metadata":!0&M[O]&&240==(240&M[O+1])?"audio":null},parseSampleRate:function(M){for(var O=0;O+5<M.length;){if(255===M[O]&&240==(246&M[O+1]))return Gt[(60&M[O+2])>>>2];O++}return null},parseAacTimestamp:function(M){var O,N,B;O=10,64&M[5]&&(O+=4,O+=Vn(M.subarray(10,14)));do{if((N=Vn(M.subarray(O+4,O+8)))<1)return null;if("PRIV"===String.fromCharCode(M[O],M[O+1],M[O+2],M[O+3])){B=M.subarray(O+10,O+N+10);for(var Q=0;Q<B.byteLength;Q++)if(0===B[Q]){if("com.apple.streaming.transportStreamTimestamp"===Si(B,0,Q)){var ye=B.subarray(Q+1),Ne=(1&ye[3])<<30|ye[4]<<22|ye[5]<<14|ye[6]<<6|ye[7]>>>2;return(Ne*=4)+(3&ye[7])}break}}O+=10,O+=N}while(O<M.byteLength);return null}};Ql=function(){var M=new Uint8Array,O=0;Ql.prototype.init.call(this),this.setTimestamp=function(N){O=N},this.push=function(N){var de,ye,Ne,B=0,X=0;for(M.length?(Ne=M.length,(M=new Uint8Array(N.byteLength+Ne)).set(M.subarray(0,Ne)),M.set(N,Ne)):M=N;M.length-X>=3;)if(M[X]!=="I".charCodeAt(0)||M[X+1]!=="D".charCodeAt(0)||M[X+2]!=="3".charCodeAt(0))if(255!=(255&M[X])||240!=(240&M[X+1]))X++;else{if(M.length-X<7||X+(B=nl.parseAdtsSize(M,X))>M.length)break;ye={type:"audio",data:M.subarray(X,X+B),pts:O,dts:O},this.trigger("data",ye),X+=B}else{if(M.length-X<10||X+(B=nl.parseId3TagSize(M,X))>M.length)break;de={type:"timed-metadata",data:M.subarray(X,X+B)},this.trigger("data",de),X+=B}M=M.length-X>0?M.subarray(X):new Uint8Array},this.reset=function(){M=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){M=new Uint8Array,this.trigger("endedtimeline")}},Ql.prototype=new d;var ur,Zl,af,fc,No=Ql,$r=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Kl=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],s_=Le.H264Stream,yg=nl.isLikelyAacData,be=function(M,O){O.stream=M,this.trigger("log",O)},Xe=function(M,O){for(var N=Object.keys(O),B=0;B<N.length;B++){var X=N[B];"headOfPipeline"===X||!O[X].on||O[X].on("log",be.bind(M,X))}},nt=function(M,O){var N;if(M.length!==O.length)return!1;for(N=0;N<M.length;N++)if(M[N]!==O[N])return!1;return!0},bt=function(M,O,N,B,X,Q){return{start:{dts:M,pts:M+(N-O)},end:{dts:M+(B-O),pts:M+(X-N)},prependedContentDuration:Q,baseMediaDecodeTime:M}};Zl=function(M,O){var B,N=[],X=0,Q=0,de=1/0;B=(O=O||{}).firstSequenceNumber||0,Zl.prototype.init.call(this),this.push=function(ye){p_collectDtsInfo(M,ye),M&&$r.forEach(function(Ne){M[Ne]=ye[Ne]}),N.push(ye)},this.setEarliestDts=function(ye){X=ye},this.setVideoBaseMediaDecodeTime=function(ye){de=ye},this.setAudioAppendStart=function(ye){Q=ye},this.flush=function(){var ye,Ne,Me,Ue,ct,cn,Mn;0!==N.length?(ye=function(M,O,N){return O.minSegmentDts>=N?M:(O.minSegmentDts=1/0,M.filter(function(B){return B.dts>=N&&(O.minSegmentDts=Math.min(O.minSegmentDts,B.dts),O.minSegmentPts=O.minSegmentDts,!0)}))}(N,M,X),M.baseMediaDecodeTime=p_calculateTrackBaseMediaDecodeTime(M,O.keepOriginalTimestamps),Mn=Cp_prefixWithSilence(M,ye,Q,de),M.samples=function(M){var O,B=[];for(O=0;O<M.length;O++)B.push({size:M[O].data.byteLength,duration:1024});return B}(ye),Me=Ro_mdat(function(M){var O,N,B=0,X=new Uint8Array(function(M){var O,B=0;for(O=0;O<M.length;O++)B+=M[O].data.byteLength;return B}(M));for(O=0;O<M.length;O++)X.set((N=M[O]).data,B),B+=N.data.byteLength;return X}(ye)),N=[],Ne=Ro_moof(B,[M]),Ue=new Uint8Array(Ne.byteLength+Me.byteLength),B++,Ue.set(Ne),Ue.set(Me,Ne.byteLength),p_clearDtsInfo(M),ct=Math.ceil(9216e4/M.samplerate),ye.length&&(cn=ye.length*ct,this.trigger("segmentTimingInfo",bt(pr_audioTsToVideoTs(M.baseMediaDecodeTime,M.samplerate),ye[0].dts,ye[0].pts,ye[0].dts+cn,ye[0].pts+cn,Mn||0)),this.trigger("timingInfo",{start:ye[0].pts,end:ye[0].pts+cn})),this.trigger("data",{track:M,boxes:Ue}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){p_clearDtsInfo(M),N=[],this.trigger("reset")}},Zl.prototype=new d,ur=function(M,O){var N,Q,de,B=[],X=[];N=(O=O||{}).firstSequenceNumber||0,ur.prototype.init.call(this),delete M.minPTS,this.gopCache_=[],this.push=function(ye){p_collectDtsInfo(M,ye),"seq_parameter_set_rbsp"===ye.nalUnitType&&!Q&&(Q=ye.config,M.sps=[ye.data],Kl.forEach(function(Ne){M[Ne]=Q[Ne]},this)),"pic_parameter_set_rbsp"===ye.nalUnitType&&!de&&(de=ye.data,M.pps=[ye.data]),B.push(ye)},this.flush=function(){for(var ye,Ne,Me,Ue,ct,cn,en,Nn,Mn=0;B.length&&"access_unit_delimiter_rbsp"!==B[0].nalUnitType;)B.shift();if(0===B.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(ye=function(M){var O,N,B=[],X=[];for(X.byteLength=0,X.nalCount=0,X.duration=0,B.byteLength=0,O=0;O<M.length;O++)"access_unit_delimiter_rbsp"===(N=M[O]).nalUnitType?(B.length&&(B.duration=N.dts-B.dts,X.byteLength+=B.byteLength,X.nalCount+=B.length,X.duration+=B.duration,X.push(B)),(B=[N]).byteLength=N.data.byteLength,B.pts=N.pts,B.dts=N.dts):("slice_layer_without_partitioning_rbsp_idr"===N.nalUnitType&&(B.keyFrame=!0),B.duration=N.dts-B.dts,B.byteLength+=N.data.byteLength,B.push(N));return X.length&&(!B.duration||B.duration<=0)&&(B.duration=X[X.length-1].duration),X.byteLength+=B.byteLength,X.nalCount+=B.length,X.duration+=B.duration,X.push(B),X}(B),(Me=function(M){var O,N,B=[],X=[];for(B.byteLength=0,B.nalCount=0,B.duration=0,B.pts=M[0].pts,B.dts=M[0].dts,X.byteLength=0,X.nalCount=0,X.duration=0,X.pts=M[0].pts,X.dts=M[0].dts,O=0;O<M.length;O++)(N=M[O]).keyFrame?(B.length&&(X.push(B),X.byteLength+=B.byteLength,X.nalCount+=B.nalCount,X.duration+=B.duration),(B=[N]).nalCount=N.length,B.byteLength=N.byteLength,B.pts=N.pts,B.dts=N.dts,B.duration=N.duration):(B.duration+=N.duration,B.nalCount+=N.length,B.byteLength+=N.byteLength,B.push(N));return X.length&&B.duration<=0&&(B.duration=X[X.length-1].duration),X.byteLength+=B.byteLength,X.nalCount+=B.nalCount,X.duration+=B.duration,X.push(B),X}(ye))[0][0].keyFrame||((Ne=this.getGopForFusion_(B[0],M))?(Mn=Ne.duration,Me.unshift(Ne),Me.byteLength+=Ne.byteLength,Me.nalCount+=Ne.nalCount,Me.pts=Ne.pts,Me.dts=Ne.dts,Me.duration+=Ne.duration):Me=function(M){var O;return!M[0][0].keyFrame&&M.length>1&&(O=M.shift(),M.byteLength-=O.byteLength,M.nalCount-=O.nalCount,M[0][0].dts=O.dts,M[0][0].pts=O.pts,M[0][0].duration+=O.duration),M}(Me)),X.length){var Ca;if(!(Ca=O.alignGopsAtEnd?this.alignGopsAtEnd_(Me):this.alignGopsAtStart_(Me)))return this.gopCache_.unshift({gop:Me.pop(),pps:M.pps,sps:M.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),B=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");p_clearDtsInfo(M),Me=Ca}p_collectDtsInfo(M,Me),M.samples=function(M,O){var N,B,X,Q,ye=O||0,Ne=[];for(N=0;N<M.length;N++)for(Q=M[N],B=0;B<Q.length;B++)ye+=(X=fg(Q[B],ye)).size,Ne.push(X);return Ne}(Me),ct=Ro_mdat(function(M){var O,N,B,X,Q,de,ye=0,ct=new Uint8Array(M.byteLength+4*M.nalCount),cn=new DataView(ct.buffer);for(O=0;O<M.length;O++)for(X=M[O],N=0;N<X.length;N++)for(Q=X[N],B=0;B<Q.length;B++)cn.setUint32(ye,(de=Q[B]).data.byteLength),ct.set(de.data,ye+=4),ye+=de.data.byteLength;return ct}(Me)),M.baseMediaDecodeTime=p_calculateTrackBaseMediaDecodeTime(M,O.keepOriginalTimestamps),this.trigger("processedGopsInfo",Me.map(function(sl){return{pts:sl.pts,dts:sl.dts,byteLength:sl.byteLength}})),this.trigger("segmentTimingInfo",bt(M.baseMediaDecodeTime,(en=Me[0]).dts,en.pts,(Nn=Me[Me.length-1]).dts+Nn.duration,Nn.pts+Nn.duration,Mn)),this.trigger("timingInfo",{start:Me[0].pts,end:Me[Me.length-1].pts+Me[Me.length-1].duration}),this.gopCache_.unshift({gop:Me.pop(),pps:M.pps,sps:M.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),B=[],this.trigger("baseMediaDecodeTime",M.baseMediaDecodeTime),this.trigger("timelineStartInfo",M.timelineStartInfo),Ue=Ro_moof(N,[M]),cn=new Uint8Array(Ue.byteLength+ct.byteLength),N++,cn.set(Ue),cn.set(ct,Ue.byteLength),this.trigger("data",{track:M,boxes:cn}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),B=[],this.gopCache_.length=0,X.length=0,this.trigger("reset")},this.resetStream_=function(){p_clearDtsInfo(M),Q=void 0,de=void 0},this.getGopForFusion_=function(ye){var ct,cn,Mn,en,Nn,Ue=1/0;for(Nn=0;Nn<this.gopCache_.length;Nn++)Mn=(en=this.gopCache_[Nn]).gop,M.pps&&nt(M.pps[0],en.pps[0])&&M.sps&&nt(M.sps[0],en.sps[0])&&(Mn.dts<M.timelineStartInfo.dts||(ct=ye.dts-Mn.dts-Mn.duration)>=-1e4&&ct<=45e3&&(!cn||Ue>ct)&&(cn=en,Ue=ct));return cn?cn.gop:null},this.alignGopsAtStart_=function(ye){var Ne,Me,Ue,ct,cn,Mn,en,Nn;for(cn=ye.byteLength,Mn=ye.nalCount,en=ye.duration,Ne=Me=0;Ne<X.length&&Me<ye.length&&(Ue=X[Ne]).pts!==(ct=ye[Me]).pts;)ct.pts>Ue.pts?Ne++:(Me++,cn-=ct.byteLength,Mn-=ct.nalCount,en-=ct.duration);return 0===Me?ye:Me===ye.length?null:((Nn=ye.slice(Me)).byteLength=cn,Nn.duration=en,Nn.nalCount=Mn,Nn.pts=Nn[0].pts,Nn.dts=Nn[0].dts,Nn)},this.alignGopsAtEnd_=function(ye){var Ne,Me,Ue,ct,cn,Mn,en;for(Ne=X.length-1,Me=ye.length-1,cn=null,Mn=!1;Ne>=0&&Me>=0;){if((Ue=X[Ne]).pts===(ct=ye[Me]).pts){Mn=!0;break}Ue.pts>ct.pts?Ne--:(Ne===X.length-1&&(cn=Me),Me--)}if(!Mn&&null===cn)return null;if(0===(en=Mn?Me:cn))return ye;var Nn=ye.slice(en),Ca=Nn.reduce(function(sl,Op){return sl.byteLength+=Op.byteLength,sl.duration+=Op.duration,sl.nalCount+=Op.nalCount,sl},{byteLength:0,duration:0,nalCount:0});return Nn.byteLength=Ca.byteLength,Nn.duration=Ca.duration,Nn.nalCount=Ca.nalCount,Nn.pts=Nn[0].pts,Nn.dts=Nn[0].dts,Nn},this.alignGopsWith=function(ye){X=ye}},ur.prototype=new d,fc=function(M,O){this.numberOfTracks=0,this.metadataStream=O,this.remuxTracks=!(typeof(M=M||{}).remux<"u"&&!M.remux),this.keepOriginalTimestamps="boolean"==typeof M.keepOriginalTimestamps&&M.keepOriginalTimestamps,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,fc.prototype.init.call(this),this.push=function(N){return N.text?this.pendingCaptions.push(N):N.frames?this.pendingMetadata.push(N):(this.pendingTracks.push(N.track),this.pendingBytes+=N.boxes.byteLength,"video"===N.track.type&&(this.videoTrack=N.track,this.pendingBoxes.push(N.boxes)),void("audio"===N.track.type&&(this.audioTrack=N.track,this.pendingBoxes.unshift(N.boxes))))}},fc.prototype=new d,fc.prototype.flush=function(ee){var N,B,X,de,M=0,O={captions:[],captionStreams:{},metadata:[],info:{}},Q=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==ee&&"AudioSegmentStream"!==ee)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(Q=this.videoTrack.timelineStartInfo.pts,Kl.forEach(function(ye){O.info[ye]=this.videoTrack[ye]},this)):this.audioTrack&&(Q=this.audioTrack.timelineStartInfo.pts,$r.forEach(function(ye){O.info[ye]=this.audioTrack[ye]},this)),this.videoTrack||this.audioTrack){for(O.type=1===this.pendingTracks.length?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,X=function(M){var B,O=D(),N=le(M);return(B=new Uint8Array(O.byteLength+N.byteLength)).set(O),B.set(N,O.byteLength),B}(this.pendingTracks),O.initSegment=new Uint8Array(X.byteLength),O.initSegment.set(X),O.data=new Uint8Array(this.pendingBytes),de=0;de<this.pendingBoxes.length;de++)O.data.set(this.pendingBoxes[de],M),M+=this.pendingBoxes[de].byteLength;for(de=0;de<this.pendingCaptions.length;de++)(N=this.pendingCaptions[de]).startTime=pr_metadataTsToSeconds(N.startPts,Q,this.keepOriginalTimestamps),N.endTime=pr_metadataTsToSeconds(N.endPts,Q,this.keepOriginalTimestamps),O.captionStreams[N.stream]=!0,O.captions.push(N);for(de=0;de<this.pendingMetadata.length;de++)(B=this.pendingMetadata[de]).cueTime=pr_metadataTsToSeconds(B.pts,Q,this.keepOriginalTimestamps),O.metadata.push(B);for(O.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",O),de=0;de<O.captions.length;de++)this.trigger("caption",N=O.captions[de]);for(de=0;de<O.metadata.length;de++)this.trigger("id3Frame",B=O.metadata[de])}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},fc.prototype.setRemux=function(ee){this.remuxTracks=ee},af=function(M){var B,X,O=this,N=!0;af.prototype.init.call(this),this.baseMediaDecodeTime=(M=M||{}).baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var Q={};this.transmuxPipeline_=Q,Q.type="aac",Q.metadataStream=new si.MetadataStream,Q.aacStream=new No,Q.audioTimestampRolloverStream=new si.TimestampRolloverStream("audio"),Q.timedMetadataTimestampRolloverStream=new si.TimestampRolloverStream("timed-metadata"),Q.adtsStream=new On,Q.coalesceStream=new fc(M,Q.metadataStream),Q.headOfPipeline=Q.aacStream,Q.aacStream.pipe(Q.audioTimestampRolloverStream).pipe(Q.adtsStream),Q.aacStream.pipe(Q.timedMetadataTimestampRolloverStream).pipe(Q.metadataStream).pipe(Q.coalesceStream),Q.metadataStream.on("timestamp",function(de){Q.aacStream.setTimestamp(de.timeStamp)}),Q.aacStream.on("data",function(de){"timed-metadata"!==de.type&&"audio"!==de.type||Q.audioSegmentStream||(X=X||{timelineStartInfo:{baseMediaDecodeTime:O.baseMediaDecodeTime},codec:"adts",type:"audio"},Q.coalesceStream.numberOfTracks++,Q.audioSegmentStream=new Zl(X,M),Q.audioSegmentStream.on("log",O.getLogTrigger_("audioSegmentStream")),Q.audioSegmentStream.on("timingInfo",O.trigger.bind(O,"audioTimingInfo")),Q.adtsStream.pipe(Q.audioSegmentStream).pipe(Q.coalesceStream),O.trigger("trackinfo",{hasAudio:!!X,hasVideo:!!B}))}),Q.coalesceStream.on("data",this.trigger.bind(this,"data")),Q.coalesceStream.on("done",this.trigger.bind(this,"done")),Xe(this,Q)},this.setupTsPipeline=function(){var Q={};this.transmuxPipeline_=Q,Q.type="ts",Q.metadataStream=new si.MetadataStream,Q.packetStream=new si.TransportPacketStream,Q.parseStream=new si.TransportParseStream,Q.elementaryStream=new si.ElementaryStream,Q.timestampRolloverStream=new si.TimestampRolloverStream,Q.adtsStream=new On,Q.h264Stream=new s_,Q.captionStream=new si.CaptionStream(M),Q.coalesceStream=new fc(M,Q.metadataStream),Q.headOfPipeline=Q.packetStream,Q.packetStream.pipe(Q.parseStream).pipe(Q.elementaryStream).pipe(Q.timestampRolloverStream),Q.timestampRolloverStream.pipe(Q.h264Stream),Q.timestampRolloverStream.pipe(Q.adtsStream),Q.timestampRolloverStream.pipe(Q.metadataStream).pipe(Q.coalesceStream),Q.h264Stream.pipe(Q.captionStream).pipe(Q.coalesceStream),Q.elementaryStream.on("data",function(de){var ye;if("metadata"===de.type){for(ye=de.tracks.length;ye--;)B||"video"!==de.tracks[ye].type?!X&&"audio"===de.tracks[ye].type&&((X=de.tracks[ye]).timelineStartInfo.baseMediaDecodeTime=O.baseMediaDecodeTime):(B=de.tracks[ye]).timelineStartInfo.baseMediaDecodeTime=O.baseMediaDecodeTime;B&&!Q.videoSegmentStream&&(Q.coalesceStream.numberOfTracks++,Q.videoSegmentStream=new ur(B,M),Q.videoSegmentStream.on("log",O.getLogTrigger_("videoSegmentStream")),Q.videoSegmentStream.on("timelineStartInfo",function(Ne){X&&!M.keepOriginalTimestamps&&(X.timelineStartInfo=Ne,Q.audioSegmentStream.setEarliestDts(Ne.dts-O.baseMediaDecodeTime))}),Q.videoSegmentStream.on("processedGopsInfo",O.trigger.bind(O,"gopInfo")),Q.videoSegmentStream.on("segmentTimingInfo",O.trigger.bind(O,"videoSegmentTimingInfo")),Q.videoSegmentStream.on("baseMediaDecodeTime",function(Ne){X&&Q.audioSegmentStream.setVideoBaseMediaDecodeTime(Ne)}),Q.videoSegmentStream.on("timingInfo",O.trigger.bind(O,"videoTimingInfo")),Q.h264Stream.pipe(Q.videoSegmentStream).pipe(Q.coalesceStream)),X&&!Q.audioSegmentStream&&(Q.coalesceStream.numberOfTracks++,Q.audioSegmentStream=new Zl(X,M),Q.audioSegmentStream.on("log",O.getLogTrigger_("audioSegmentStream")),Q.audioSegmentStream.on("timingInfo",O.trigger.bind(O,"audioTimingInfo")),Q.audioSegmentStream.on("segmentTimingInfo",O.trigger.bind(O,"audioSegmentTimingInfo")),Q.adtsStream.pipe(Q.audioSegmentStream).pipe(Q.coalesceStream)),O.trigger("trackinfo",{hasAudio:!!X,hasVideo:!!B})}}),Q.coalesceStream.on("data",this.trigger.bind(this,"data")),Q.coalesceStream.on("id3Frame",function(de){de.dispatchType=Q.metadataStream.dispatchType,O.trigger("id3Frame",de)}),Q.coalesceStream.on("caption",this.trigger.bind(this,"caption")),Q.coalesceStream.on("done",this.trigger.bind(this,"done")),Xe(this,Q)},this.setBaseMediaDecodeTime=function(Q){var de=this.transmuxPipeline_;M.keepOriginalTimestamps||(this.baseMediaDecodeTime=Q),X&&(X.timelineStartInfo.dts=void 0,X.timelineStartInfo.pts=void 0,p_clearDtsInfo(X),de.audioTimestampRolloverStream&&de.audioTimestampRolloverStream.discontinuity()),B&&(de.videoSegmentStream&&(de.videoSegmentStream.gopCache_=[]),B.timelineStartInfo.dts=void 0,B.timelineStartInfo.pts=void 0,p_clearDtsInfo(B),de.captionStream.reset()),de.timestampRolloverStream&&de.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(Q){X&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(Q)},this.setRemux=function(Q){var de=this.transmuxPipeline_;M.remux=Q,de&&de.coalesceStream&&de.coalesceStream.setRemux(Q)},this.alignGopsWith=function(Q){B&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(Q)},this.getLogTrigger_=function(Q){var de=this;return function(ye){ye.stream=Q,de.trigger("log",ye)}},this.push=function(Q){if(N){var de=yg(Q);de&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():!de&&"ts"!==this.transmuxPipeline_.type&&this.setupTsPipeline(),N=!1}this.transmuxPipeline_.headOfPipeline.push(Q)},this.flush=function(){N=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},af.prototype=new d;var ve,It,Dt,vn={Transmuxer:af,VideoSegmentStream:ur,AudioSegmentStream:Zl,AUDIO_PROPERTIES:$r,VIDEO_PROPERTIES:Kl,generateSegmentTimingInfo:bt},hi_toUnsigned=function(M){return M>>>0},qr=function(M){var O="";return O+=String.fromCharCode(M[0]),O+=String.fromCharCode(M[1]),(O+=String.fromCharCode(M[2]))+String.fromCharCode(M[3])},os=hi_toUnsigned,ai=function ee(M,O){var B,X,Q,de,ye,N=[];if(!O.length)return null;for(B=0;B<M.byteLength;)X=os(M[B]<<24|M[B+1]<<16|M[B+2]<<8|M[B+3]),Q=qr(M.subarray(B+4,B+8)),de=X>1?B+X:M.byteLength,Q===O[0]&&(1===O.length?N.push(M.subarray(B+8,de)):(ye=ee(M.subarray(B+8,de),O.slice(1))).length&&(N=N.concat(ye))),B=de;return N},fo=hi_toUnsigned,mr=s.getUint64,Qi=function(M){return{isLeading:(12&M[0])>>>2,dependsOn:3&M[0],isDependedOn:(192&M[1])>>>6,hasRedundancy:(48&M[1])>>>4,paddingValue:(14&M[1])>>>1,isNonSyncSample:1&M[1],degradationPriority:M[2]<<8|M[3]}},rl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Iu=typeof window<"u"?window:typeof rl<"u"?rl:typeof self<"u"?self:{},lf=function(M){for(var X,Q,O=M.byteLength,N=[],B=1;B<O-2;)0===M[B]&&0===M[B+1]&&3===M[B+2]?(N.push(B+2),B+=2):B++;if(0===N.length)return M;X=O-N.length,Q=new Uint8Array(X);var de=0;for(B=0;B<X;de++,B++)de===N[0]&&(de++,N.shift()),Q[B]=M[de];return Q},uf=vt.CaptionStream,cf=function(M,O){for(var N=M,B=0;B<O.length;B++){var X=O[B];if(N<X.size)return X;N-=X.size}return null},Lr=function(M,O){var N=ai(M,["moof","traf"]),B=ai(M,["mdat"]),X={},Q=[];return B.forEach(function(de,ye){Q.push({mdat:de,traf:N[ye]})}),Q.forEach(function(de){var Nn,Ca,ye=de.mdat,Ne=de.traf,Ue=function(M){var Ue,O=new DataView(M.buffer,M.byteOffset,M.byteLength),N={version:M[0],flags:new Uint8Array(M.subarray(1,4)),trackId:O.getUint32(4)},B=1&N.flags[2],X=2&N.flags[2],Q=8&N.flags[2],de=16&N.flags[2],ye=32&N.flags[2],Ne=65536&N.flags[0],Me=131072&N.flags[0];return Ue=8,B&&(Ue+=4,N.baseDataOffset=O.getUint32(12),Ue+=4),X&&(N.sampleDescriptionIndex=O.getUint32(Ue),Ue+=4),Q&&(N.defaultSampleDuration=O.getUint32(Ue),Ue+=4),de&&(N.defaultSampleSize=O.getUint32(Ue),Ue+=4),ye&&(N.defaultSampleFlags=O.getUint32(Ue)),Ne&&(N.durationIsEmpty=!0),!B&&Me&&(N.baseDataOffsetIsMoof=!0),N}(ai(Ne,["tfhd"])[0]),ct=Ue.trackId,cn=ai(Ne,["tfdt"]),Mn=cn.length>0?function(M){var O={version:M[0],flags:new Uint8Array(M.subarray(1,4))};return O.baseMediaDecodeTime=1===O.version?mr(M.subarray(4)):fo(M[4]<<24|M[5]<<16|M[6]<<8|M[7]),O}(cn[0]).baseMediaDecodeTime:0,en=ai(Ne,["trun"]);O===ct&&en.length>0&&(Nn=function(M,O,N){var B=O,X=N.defaultSampleDuration||0,Q=N.defaultSampleSize||0,de=N.trackId,ye=[];return M.forEach(function(Ne){var Ue=function(M){var ct,O={version:M[0],flags:new Uint8Array(M.subarray(1,4)),samples:[]},N=new DataView(M.buffer,M.byteOffset,M.byteLength),B=1&O.flags[2],X=4&O.flags[2],Q=1&O.flags[1],de=2&O.flags[1],ye=4&O.flags[1],Ne=8&O.flags[1],Me=N.getUint32(4),Ue=8;for(B&&(O.dataOffset=N.getInt32(Ue),Ue+=4),X&&Me&&(ct={flags:Qi(M.subarray(Ue,Ue+4))},Ue+=4,Q&&(ct.duration=N.getUint32(Ue),Ue+=4),de&&(ct.size=N.getUint32(Ue),Ue+=4),Ne&&(ct.compositionTimeOffset=1===O.version?N.getInt32(Ue):N.getUint32(Ue),Ue+=4),O.samples.push(ct),Me--);Me--;)ct={},Q&&(ct.duration=N.getUint32(Ue),Ue+=4),de&&(ct.size=N.getUint32(Ue),Ue+=4),ye&&(ct.flags=Qi(M.subarray(Ue,Ue+4)),Ue+=4),Ne&&(ct.compositionTimeOffset=1===O.version?N.getInt32(Ue):N.getUint32(Ue),Ue+=4),O.samples.push(ct);return O}(Ne).samples;Ue.forEach(function(ct){void 0===ct.duration&&(ct.duration=X),void 0===ct.size&&(ct.size=Q),ct.trackId=de,ct.dts=B,void 0===ct.compositionTimeOffset&&(ct.compositionTimeOffset=0),"bigint"==typeof B?(ct.pts=B+Iu.BigInt(ct.compositionTimeOffset),B+=Iu.BigInt(ct.duration)):(ct.pts=B+ct.compositionTimeOffset,B+=ct.duration)}),ye=ye.concat(Ue)}),ye}(en,Mn,Ue),Ca=function(M,O,N){var Q,de,ye,Ne,B=new DataView(M.buffer,M.byteOffset,M.byteLength),X={logs:[],seiNals:[]};for(de=0;de+4<M.length;de+=ye)if(ye=B.getUint32(de),de+=4,!(ye<=0))switch(31&M[de]){case 6:var Me=M.subarray(de+1,de+1+ye),Ue=cf(de,O);if(Q={nalUnitType:"sei_rbsp",size:ye,data:Me,escapedRBSP:lf(Me),trackId:N},Ue)Q.pts=Ue.pts,Q.dts=Ue.dts,Ne=Ue;else{if(!Ne){X.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+de+" for trackId "+N+". See mux.js#223."});break}Q.pts=Ne.pts,Q.dts=Ne.dts}X.seiNals.push(Q)}return X}(ye,Nn,ct),X[ct]||(X[ct]={seiNals:[],logs:[]}),X[ct].seiNals=X[ct].seiNals.concat(Ca.seiNals),X[ct].logs=X[ct].logs.concat(Ca.logs))}),X},ia=function(){var O,N,B,X,Q,de,M=!1;this.isInitialized=function(){return M},this.init=function(ye){O=new uf,M=!0,de=!!ye&&ye.isPartial,O.on("data",function(Ne){Ne.startTime=Ne.startPts/X,Ne.endTime=Ne.endPts/X,Q.captions.push(Ne),Q.captionStreams[Ne.stream]=!0}),O.on("log",function(Ne){Q.logs.push(Ne)})},this.isNewInit=function(ye,Ne){return!(ye&&0===ye.length||Ne&&"object"==typeof Ne&&0===Object.keys(Ne).length||B===ye[0]&&X===Ne[B])},this.parse=function(ye,Ne,Me){var Ue;if(!this.isInitialized())return null;if(!Ne||!Me)return null;if(this.isNewInit(Ne,Me))X=Me[B=Ne[0]];else if(null===B||!X)return N.push(ye),null;for(;N.length>0;){var ct=N.shift();this.parse(ct,Ne,Me)}return Ue=function(M,O,N){if(null===O)return null;var X=Lr(M,O)[O]||{};return{seiNals:X.seiNals,logs:X.logs,timescale:N}}(ye,B,X),Ue&&Ue.logs&&(Q.logs=Q.logs.concat(Ue.logs)),null!==Ue&&Ue.seiNals?(this.pushNals(Ue.seiNals),this.flushStream(),Q):Q.logs.length?{logs:Q.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(ye){if(!this.isInitialized()||!ye||0===ye.length)return null;ye.forEach(function(Ne){O.push(Ne)})},this.flushStream=function(){if(!this.isInitialized())return null;de?O.partialFlush():O.flush()},this.clearParsedCaptions=function(){Q.captions=[],Q.captionStreams={},Q.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;O.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){N=[],B=null,X=null,Q?this.clearParsedCaptions():Q={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},V=hi_toUnsigned,j=function(M){return("00"+M.toString(16)).slice(-2)},K=s.getUint64;ve=function(M,O){var B=ai(O,["moof","traf"]).reduce(function(X,Q){var ct,cn,de=ai(Q,["tfhd"])[0],ye=V(de[4]<<24|de[5]<<16|de[6]<<8|de[7]),Ne=M[ye]||9e4,Me=ai(Q,["tfdt"])[0],Ue=new DataView(Me.buffer,Me.byteOffset,Me.byteLength);return"bigint"==typeof(ct=1===Me[0]?K(Me.subarray(4,12)):Ue.getUint32(4))?cn=ct/Iu.BigInt(Ne):"number"==typeof ct&&!isNaN(ct)&&(cn=ct/Ne),cn<Number.MAX_SAFE_INTEGER&&(cn=Number(cn)),cn<X&&(X=cn),X},1/0);return"bigint"==typeof B||isFinite(B)?B:0},Dt=function(M){var N=0===M[0]?12:20;return V(M[N]<<24|M[N+1]<<16|M[N+2]<<8|M[N+3])},It=function(M){var O=ai(M,["moov","trak"]),N=[];return O.forEach(function(B){var de,ye,X={},Q=ai(B,["tkhd"])[0];Q&&(ye=(de=new DataView(Q.buffer,Q.byteOffset,Q.byteLength)).getUint8(0),X.id=de.getUint32(0===ye?12:20));var Ne=ai(B,["mdia","hdlr"])[0];if(Ne){var Me=qr(Ne.subarray(8,12));X.type="vide"===Me?"video":"soun"===Me?"audio":Me}var Ue=ai(B,["mdia","minf","stbl","stsd"])[0];if(Ue){var ct=Ue.subarray(8);X.codec=qr(ct.subarray(4,8));var Mn,cn=ai(ct,[X.codec])[0];cn&&(/^[asm]vc[1-9]$/i.test(X.codec)?(Mn=cn.subarray(78),"avcC"===qr(Mn.subarray(4,8))&&Mn.length>11?(X.codec+=".",X.codec+=j(Mn[9]),X.codec+=j(Mn[10]),X.codec+=j(Mn[11])):X.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(X.codec)?(Mn=cn.subarray(28),"esds"===qr(Mn.subarray(4,8))&&Mn.length>20&&0!==Mn[19]?(X.codec+="."+j(Mn[19]),X.codec+="."+j(Mn[20]>>>2&63).replace(/^0/,"")):X.codec="mp4a.40.2"):X.codec=X.codec.toLowerCase())}var Nn=ai(B,["mdia","mdhd"])[0];Nn&&(X.timescale=Dt(Nn)),N.push(X)}),N};var $e_startTime=ve,$e_tracks=It,We=function(M){var O=31&M[1];return(O<<=8)|M[2]},Xt=function(M){return!!(64&M[1])},Sn=function(M){var O=0;return(48&M[3])>>>4>1&&(O+=M[4]+1),O},qi=function(M){switch(M){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},sa={parseType:function(M,O){var N=We(M);return 0===N?"pat":N===O?"pmt":O?"pes":null},parsePat:function(M){var O=Xt(M),N=4+Sn(M);return O&&(N+=M[N]+1),(31&M[N+10])<<8|M[N+11]},parsePmt:function(M){var O={},N=Xt(M),B=4+Sn(M);if(N&&(B+=M[B]+1),1&M[B+5]){var Q;Q=3+((15&M[B+1])<<8|M[B+2])-4;for(var ye=12+((15&M[B+10])<<8|M[B+11]);ye<Q;){var Ne=B+ye;O[(31&M[Ne+1])<<8|M[Ne+2]]=M[Ne],ye+=5+((15&M[Ne+3])<<8|M[Ne+4])}return O}},parsePayloadUnitStartIndicator:Xt,parsePesType:function(M,O){switch(O[We(M)]){case ke.H264_STREAM_TYPE:return"video";case ke.ADTS_STREAM_TYPE:return"audio";case ke.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(M){if(!Xt(M))return null;var N=4+Sn(M);if(N>=M.byteLength)return null;var X,B=null;return 192&(X=M[N+7])&&((B={}).pts=(14&M[N+9])<<27|(255&M[N+10])<<20|(254&M[N+11])<<12|(255&M[N+12])<<5|(254&M[N+13])>>>3,B.pts*=4,B.pts+=(6&M[N+13])>>>1,B.dts=B.pts,64&X&&(B.dts=(14&M[N+14])<<27|(255&M[N+15])<<20|(254&M[N+16])<<12|(255&M[N+17])<<5|(254&M[N+18])>>>3,B.dts*=4,B.dts+=(6&M[N+18])>>>1)),B},videoPacketContainsKeyFrame:function(M){for(var O=4+Sn(M),N=M.subarray(O),B=0,X=0,Q=!1;X<N.byteLength-3;X++)if(1===N[X+2]){B=X+5;break}for(;B<N.byteLength;)switch(N[B]){case 0:if(0!==N[B-1]){B+=2;break}if(0!==N[B-2]){B++;break}X+3!==B-2&&"slice_layer_without_partitioning_rbsp_idr"===qi(31&N[X+3])&&(Q=!0);do{B++}while(1!==N[B]&&B<N.length);X=B-2,B+=3;break;case 1:if(0!==N[B-1]||0!==N[B-2]){B+=3;break}"slice_layer_without_partitioning_rbsp_idr"===qi(31&N[X+3])&&(Q=!0),X=B-2,B+=3;break;default:B+=3}return N=N.subarray(X),B-=X,X=0,N&&N.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===qi(31&N[X+3])&&(Q=!0),Q}},kr=Fe_handleRollover,Ci={};Ci.ts=sa,Ci.aac=nl;var Xr=9e4,xr=188,ji=function(M,O,N){for(var Q,ye,Ne,Me,B=0,X=xr,Ue=!1;X<=M.byteLength;)if(71!==M[B]||71!==M[X]&&X!==M.byteLength)B++,X++;else{if("pes"===(Q=M.subarray(B,X),Ci.ts.parseType(Q,O.pid))&&(ye=Ci.ts.parsePesType(Q,O.table),Ne=Ci.ts.parsePayloadUnitStartIndicator(Q),"audio"===ye&&Ne&&(Me=Ci.ts.parsePesTime(Q))&&(Me.type="audio",N.audio.push(Me),Ue=!0)),Ue)break;B+=xr,X+=xr}for(B=(X=M.byteLength)-xr,Ue=!1;B>=0;)if(71!==M[B]||71!==M[X]&&X!==M.byteLength)B--,X--;else{if("pes"===(Q=M.subarray(B,X),Ci.ts.parseType(Q,O.pid))&&(ye=Ci.ts.parsePesType(Q,O.table),Ne=Ci.ts.parsePayloadUnitStartIndicator(Q),"audio"===ye&&Ne&&(Me=Ci.ts.parsePesTime(Q))&&(Me.type="audio",N.audio.push(Me),Ue=!0)),Ue)break;B-=xr,X-=xr}},ff=function(M,O,N){for(var Q,ye,Ne,Me,Ue,ct,cn,B=0,X=xr,Mn=!1,en={data:[],size:0};X<M.byteLength;)if(71!==M[B]||71!==M[X])B++,X++;else{if("pes"===(Q=M.subarray(B,X),Ci.ts.parseType(Q,O.pid))&&(ye=Ci.ts.parsePesType(Q,O.table),Ne=Ci.ts.parsePayloadUnitStartIndicator(Q),"video"===ye&&(Ne&&!Mn&&(Me=Ci.ts.parsePesTime(Q))&&(Me.type="video",N.video.push(Me),Mn=!0),!N.firstKeyFrame))){if(Ne&&0!==en.size){for(Ue=new Uint8Array(en.size),ct=0;en.data.length;)cn=en.data.shift(),Ue.set(cn,ct),ct+=cn.byteLength;if(Ci.ts.videoPacketContainsKeyFrame(Ue)){var Nn=Ci.ts.parsePesTime(Ue);Nn?(N.firstKeyFrame=Nn,N.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}en.size=0}en.data.push(Q),en.size+=Q.byteLength}if(Mn&&N.firstKeyFrame)break;B+=xr,X+=xr}for(B=(X=M.byteLength)-xr,Mn=!1;B>=0;)if(71!==M[B]||71!==M[X])B--,X--;else{if("pes"===(Q=M.subarray(B,X),Ci.ts.parseType(Q,O.pid))&&(ye=Ci.ts.parsePesType(Q,O.table),Ne=Ci.ts.parsePayloadUnitStartIndicator(Q),"video"===ye&&Ne&&(Me=Ci.ts.parsePesTime(Q))&&(Me.type="video",N.video.push(Me),Mn=!0)),Mn)break;B-=xr,X-=xr}},gr_inspect=function(M,O){var B;return B=Ci.aac.isLikelyAacData(M)?function(M){for(var ye,O=!1,N=0,B=null,X=null,Q=0,de=0;M.length-de>=3;){switch(Ci.aac.parseType(M,de)){case"timed-metadata":if(M.length-de<10){O=!0;break}if((Q=Ci.aac.parseId3TagSize(M,de))>M.length){O=!0;break}null===X&&(ye=M.subarray(de,de+Q),X=Ci.aac.parseAacTimestamp(ye)),de+=Q;break;case"audio":if(M.length-de<7){O=!0;break}if((Q=Ci.aac.parseAdtsSize(M,de))>M.length){O=!0;break}null===B&&(ye=M.subarray(de,de+Q),B=Ci.aac.parseSampleRate(ye)),N++,de+=Q;break;default:de++}if(O)return null}if(null===B||null===X)return null;var Me=Xr/B;return{audio:[{type:"audio",dts:X,pts:X},{type:"audio",dts:X+1024*N*Me,pts:X+1024*N*Me}]}}(M):function(M){var O={pid:null,table:null},N={};for(var B in function(M,O){for(var X,N=0,B=xr;B<M.byteLength;)if(71!==M[N]||71!==M[B])N++,B++;else{switch(X=M.subarray(N,B),Ci.ts.parseType(X,O.pid)){case"pat":O.pid=Ci.ts.parsePat(X);break;case"pmt":var de=Ci.ts.parsePmt(X);O.table=O.table||{},Object.keys(de).forEach(function(ye){O.table[ye]=de[ye]})}N+=xr,B+=xr}}(M,O),O.table)if(O.table.hasOwnProperty(B))switch(O.table[B]){case ke.H264_STREAM_TYPE:N.video=[],ff(M,O,N),0===N.video.length&&delete N.video;break;case ke.ADTS_STREAM_TYPE:N.audio=[],ji(M,O,N),0===N.audio.length&&delete N.audio}return N}(M),B&&(B.audio||B.video)?(function(M,O){if(M.audio&&M.audio.length){var N=O;(typeof N>"u"||isNaN(N))&&(N=M.audio[0].dts),M.audio.forEach(function(Q){Q.dts=kr(Q.dts,N),Q.pts=kr(Q.pts,N),Q.dtsTime=Q.dts/Xr,Q.ptsTime=Q.pts/Xr})}if(M.video&&M.video.length){var B=O;if((typeof B>"u"||isNaN(B))&&(B=M.video[0].dts),M.video.forEach(function(Q){Q.dts=kr(Q.dts,B),Q.pts=kr(Q.pts,B),Q.dtsTime=Q.dts/Xr,Q.ptsTime=Q.pts/Xr}),M.firstKeyFrame){var X=M.firstKeyFrame;X.dts=kr(X.dts,B),X.pts=kr(X.pts,B),X.dtsTime=X.dts/Xr,X.ptsTime=X.pts/Xr}}}(B,O),B):null},qc=function(){function ee(O,N){this.options=N||{},this.self=O,this.init()}var M=ee.prototype;return M.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new vn.Transmuxer(this.options),function(M,O){O.on("data",function(N){var B=N.initSegment;N.initSegment={data:B.buffer,byteOffset:B.byteOffset,byteLength:B.byteLength};var X=N.data;N.data=X.buffer,M.postMessage({action:"data",segment:N,byteOffset:X.byteOffset,byteLength:X.byteLength},[N.data])}),O.on("done",function(N){M.postMessage({action:"done"})}),O.on("gopInfo",function(N){M.postMessage({action:"gopInfo",gopInfo:N})}),O.on("videoSegmentTimingInfo",function(N){var B={start:{decode:pr_videoTsToSeconds(N.start.dts),presentation:pr_videoTsToSeconds(N.start.pts)},end:{decode:pr_videoTsToSeconds(N.end.dts),presentation:pr_videoTsToSeconds(N.end.pts)},baseMediaDecodeTime:pr_videoTsToSeconds(N.baseMediaDecodeTime)};N.prependedContentDuration&&(B.prependedContentDuration=pr_videoTsToSeconds(N.prependedContentDuration)),M.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:B})}),O.on("audioSegmentTimingInfo",function(N){var B={start:{decode:pr_videoTsToSeconds(N.start.dts),presentation:pr_videoTsToSeconds(N.start.pts)},end:{decode:pr_videoTsToSeconds(N.end.dts),presentation:pr_videoTsToSeconds(N.end.pts)},baseMediaDecodeTime:pr_videoTsToSeconds(N.baseMediaDecodeTime)};N.prependedContentDuration&&(B.prependedContentDuration=pr_videoTsToSeconds(N.prependedContentDuration)),M.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:B})}),O.on("id3Frame",function(N){M.postMessage({action:"id3Frame",id3Frame:N})}),O.on("caption",function(N){M.postMessage({action:"caption",caption:N})}),O.on("trackinfo",function(N){M.postMessage({action:"trackinfo",trackInfo:N})}),O.on("audioTimingInfo",function(N){M.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:pr_videoTsToSeconds(N.start),end:pr_videoTsToSeconds(N.end)}})}),O.on("videoTimingInfo",function(N){M.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:pr_videoTsToSeconds(N.start),end:pr_videoTsToSeconds(N.end)}})}),O.on("log",function(N){M.postMessage({action:"log",log:N})})}(this.self,this.transmuxer)},M.pushMp4Captions=function(N){this.captionParser||(this.captionParser=new ia,this.captionParser.init());var B=new Uint8Array(N.data,N.byteOffset,N.byteLength),X=this.captionParser.parse(B,N.trackIds,N.timescales);this.self.postMessage({action:"mp4Captions",captions:X&&X.captions||[],logs:X&&X.logs||[],data:B.buffer},[B.buffer])},M.probeMp4StartTime=function(N){var X=N.data,Q=$e_startTime(N.timescales,X);this.self.postMessage({action:"probeMp4StartTime",startTime:Q,data:X},[X.buffer])},M.probeMp4Tracks=function(N){var B=N.data,X=$e_tracks(B);this.self.postMessage({action:"probeMp4Tracks",tracks:X,data:B},[B.buffer])},M.probeTs=function(N){var B=N.data,X=N.baseStartTime,Q="number"!=typeof X||isNaN(X)?void 0:9e4*X,de=gr_inspect(B,Q),ye=null;de&&((ye={hasVideo:de.video&&2===de.video.length||!1,hasAudio:de.audio&&2===de.audio.length||!1}).hasVideo&&(ye.videoStart=de.video[0].ptsTime),ye.hasAudio&&(ye.audioStart=de.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:ye,data:B},[B.buffer])},M.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},M.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},M.push=function(N){var B=new Uint8Array(N.data,N.byteOffset,N.byteLength);this.transmuxer.push(B)},M.reset=function(){this.transmuxer.reset()},M.setTimestampOffset=function(N){this.transmuxer.setBaseMediaDecodeTime(Math.round(pr_secondsToVideoTs(N.timestampOffset||0)))},M.setAudioAppendStart=function(N){this.transmuxer.setAudioAppendStart(Math.ceil(pr_secondsToVideoTs(N.appendStart)))},M.setRemux=function(N){this.transmuxer.setRemux(N.remux)},M.flush=function(N){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})},M.endTimeline=function(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})},M.alignGopsWith=function(N){this.transmuxer.alignGopsWith(N.gopsToAlignWith.slice())},ee}();self.onmessage=function(ee){"init"===ee.data.action&&ee.data.options?this.messageHandlers=new qc(self,ee.data.options):(this.messageHandlers||(this.messageHandlers=new qc(self)),ee.data&&ee.data.action&&"init"!==ee.data.action&&this.messageHandlers[ee.data.action]&&this.messageHandlers[ee.data.action](ee.data))}})),Hv=Zm(Od),uo=function(d){var f=d.transmuxer,h=d.bytes,s=d.audioAppendStart,u=d.gopsToAlignWith,m=d.remux,T=d.onData,S=d.onTrackInfo,D=d.onAudioTimingInfo,P=d.onVideoTimingInfo,W=d.onVideoSegmentTimingInfo,H=d.onAudioSegmentTimingInfo,te=d.onId3,le=d.onCaptions,ce=d.onDone,fe=d.onEndedTimeline,ue=d.onTransmuxerLog,At=d.isEndOfTimeline,sn={buffer:[]},rt=At;if(f.onmessage=function(St){f.currentTransmux===d&&("data"===St.data.action&&function(d,f,h){var s=d.data.segment,u=s.type,m=s.initSegment,P=s.videoFrameDtsTime,W=s.videoFramePtsTime;f.buffer.push({captions:s.captions,captionStreams:s.captionStreams,metadata:s.metadata});var H=d.data.segment.boxes||{data:d.data.segment.data},te={type:u,data:new Uint8Array(H.data,H.data.byteOffset,H.data.byteLength),initSegment:new Uint8Array(m.data,m.byteOffset,m.byteLength)};typeof P<"u"&&(te.videoFrameDtsTime=P),typeof W<"u"&&(te.videoFramePtsTime=W),h(te)}(St,sn,T),"trackinfo"===St.data.action&&S(St.data.trackInfo),"gopInfo"===St.data.action&&function(d,f){f.gopInfo=d.data.gopInfo}(St,sn),"audioTimingInfo"===St.data.action&&D(St.data.audioTimingInfo),"videoTimingInfo"===St.data.action&&P(St.data.videoTimingInfo),"videoSegmentTimingInfo"===St.data.action&&W(St.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===St.data.action&&H(St.data.audioSegmentTimingInfo),"id3Frame"===St.data.action&&te([St.data.id3Frame],St.data.id3Frame.dispatchType),"caption"===St.data.action&&le(St.data.caption),"endedtimeline"===St.data.action&&(rt=!1,fe()),"log"===St.data.action&&ue(St.data.log),"transmuxed"===St.data.type&&(rt||(f.onmessage=null,function(d){var f=d.transmuxedData,h=d.callback;f.buffer=[],h(f)}({transmuxedData:sn,callback:ce}),Gv(f))))},s&&f.postMessage({action:"setAudioAppendStart",appendStart:s}),Array.isArray(u)&&f.postMessage({action:"alignGopsWith",gopsToAlignWith:u}),typeof m<"u"&&f.postMessage({action:"setRemux",remux:m}),h.byteLength){var Ft=h instanceof ArrayBuffer?h:h.buffer,pt=h instanceof ArrayBuffer?0:h.byteOffset;f.postMessage({action:"push",data:Ft,byteOffset:pt,byteLength:h.byteLength},[Ft])}At&&f.postMessage({action:"endTimeline"}),f.postMessage({action:"flush"})},Gv=function(d){d.currentTransmux=null,d.transmuxQueue.length&&(d.currentTransmux=d.transmuxQueue.shift(),"function"==typeof d.currentTransmux?d.currentTransmux():uo(d.currentTransmux))},ng=function(d,f){d.postMessage({action:f}),Gv(d)},Ld_reset=function(d){!function(d,f){if(!f.currentTransmux)return f.currentTransmux=d,void ng(f,d);f.transmuxQueue.push(ng.bind(null,f,d))}("reset",d)},ec=function(d){var f=d.transmuxer,h=d.endAction||d.action,s=d.callback,u=Mt({},d,{endAction:null,transmuxer:null,callback:null});if(f.addEventListener("message",function D(P){P.data.action===h&&(f.removeEventListener("message",D),P.data.data&&(P.data.data=new Uint8Array(P.data.data,d.byteOffset||0,d.byteLength||P.data.data.byteLength),d.data&&(d.data=P.data.data)),s(P.data))}),d.data){var T=d.data instanceof ArrayBuffer;u.byteOffset=T?0:d.data.byteOffset,u.byteLength=d.data.byteLength,f.postMessage(u,[T?d.data:d.data.buffer])}else f.postMessage(u)},P0=function(d){d.forEach(function(f){f.abort()})},O0=function(d,f){return f.timedout?{status:f.status,message:"HLS request timed-out at URL: "+f.uri,code:-101,xhr:f}:f.aborted?{status:f.status,message:"HLS request aborted at URL: "+f.uri,code:-102,xhr:f}:d?{status:f.status,message:"HLS request errored at URL: "+f.uri,code:2,xhr:f}:"arraybuffer"===f.responseType&&0===f.response.byteLength?{status:f.status,message:"Empty HLS response at URL: "+f.uri,code:2,xhr:f}:null},L0=function(d,f,h){return function(s,u){var m=u.response,T=O0(s,u);if(T)return h(T,d);if(16!==m.byteLength)return h({status:u.status,message:"Invalid HLS key at URL: "+u.uri,code:2,xhr:u},d);for(var S=new DataView(m),D=new Uint32Array([S.getUint32(0),S.getUint32(4),S.getUint32(8),S.getUint32(12)]),P=0;P<f.length;P++)f[P].bytes=D;return h(null,d)}},La=function(d,f){var h=dn(d.map.bytes);if("mp4"!==h)return f({internal:!0,message:"Found unsupported "+(h||"unknown")+" container for initialization segment at URL: "+(d.map.resolvedUri||d.map.uri),code:2});ec({action:"probeMp4Tracks",data:d.map.bytes,transmuxer:d.transmuxer,callback:function(m){var T=m.tracks;return d.map.bytes=m.data,T.forEach(function(D){d.map.tracks=d.map.tracks||{},!d.map.tracks[D.type]&&(d.map.tracks[D.type]=D,"number"==typeof D.id&&D.timescale&&(d.map.timescales=d.map.timescales||{},d.map.timescales[D.id]=D.timescale))}),f(null)}})},Wv=function(d){var f=d.segment,h=d.bytes,s=d.trackInfoFn,u=d.timingInfoFn,m=d.videoSegmentTimingInfoFn,T=d.audioSegmentTimingInfoFn,S=d.id3Fn,D=d.captionsFn,P=d.isEndOfTimeline,W=d.endedTimelineFn,H=d.dataFn,te=d.doneFn,le=d.onTransmuxerLog,ce=f.map&&f.map.tracks||{},fe=Boolean(ce.audio&&ce.video),ue=u.bind(null,f,"audio","start"),At=u.bind(null,f,"audio","end"),sn=u.bind(null,f,"video","start"),rt=u.bind(null,f,"video","end");ec({action:"probeTs",transmuxer:f.transmuxer,data:h,baseStartTime:f.baseStartTime,callback:function(pt){f.bytes=h=pt.data;var lt=pt.result;lt&&(s(f,{hasAudio:lt.hasAudio,hasVideo:lt.hasVideo,isMuxed:fe}),s=null,lt.hasAudio&&!fe&&ue(lt.audioStart),lt.hasVideo&&sn(lt.videoStart),ue=null,sn=null),function(d){if(!d.transmuxer.currentTransmux)return d.transmuxer.currentTransmux=d,void uo(d);d.transmuxer.transmuxQueue.push(d)}({bytes:h,transmuxer:f.transmuxer,audioAppendStart:f.audioAppendStart,gopsToAlignWith:f.gopsToAlignWith,remux:fe,onData:function(lt){lt.type="combined"===lt.type?"video":lt.type,H(f,lt)},onTrackInfo:function(lt){s&&(fe&&(lt.isMuxed=!0),s(f,lt))},onAudioTimingInfo:function(lt){ue&&typeof lt.start<"u"&&(ue(lt.start),ue=null),At&&typeof lt.end<"u"&&At(lt.end)},onVideoTimingInfo:function(lt){sn&&typeof lt.start<"u"&&(sn(lt.start),sn=null),rt&&typeof lt.end<"u"&&rt(lt.end)},onVideoSegmentTimingInfo:function(lt){m(lt)},onAudioSegmentTimingInfo:function(lt){T(lt)},onId3:function(lt,St){S(f,lt,St)},onCaptions:function(lt){D(f,[lt])},isEndOfTimeline:P,onEndedTimeline:function(){W()},onTransmuxerLog:le,onDone:function(lt){!te||(lt.type="combined"===lt.type?"video":lt.type,te(null,f,lt))}})}})},ka=function(d){var f=d.segment,h=d.bytes,s=d.trackInfoFn,u=d.timingInfoFn,m=d.videoSegmentTimingInfoFn,T=d.audioSegmentTimingInfoFn,S=d.id3Fn,D=d.captionsFn,P=d.isEndOfTimeline,W=d.endedTimelineFn,H=d.dataFn,te=d.doneFn,le=d.onTransmuxerLog,ce=new Uint8Array(h);if(function(d){return Ho(d,["moof"]).length>0}(ce)){f.isFmp4=!0;var fe=f.map.tracks,ue={isFmp4:!0,hasVideo:!!fe.video,hasAudio:!!fe.audio};fe.audio&&fe.audio.codec&&"enca"!==fe.audio.codec&&(ue.audioCodec=fe.audio.codec),fe.video&&fe.video.codec&&"encv"!==fe.video.codec&&(ue.videoCodec=fe.video.codec),fe.video&&fe.audio&&(ue.isMuxed=!0),s(f,ue);var At=function(rt){H(f,{data:ce,type:ue.hasAudio&&!ue.isMuxed?"audio":"video"}),rt&&rt.length&&D(f,rt),te(null,f,{})};ec({action:"probeMp4StartTime",timescales:f.map.timescales,data:ce,transmuxer:f.transmuxer,callback:function(rt){var et=rt.data,Ft=rt.startTime;h=et.buffer,f.bytes=ce=et,ue.hasAudio&&!ue.isMuxed&&u(f,"audio","start",Ft),ue.hasVideo&&u(f,"video","start",Ft),fe.video&&et.byteLength&&f.transmuxer?ec({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:f.transmuxer,data:ce,timescales:f.map.timescales,trackIds:[fe.video.id],callback:function(lt){h=lt.data.buffer,f.bytes=ce=lt.data,lt.logs.forEach(function(St){le(Be.mergeOptions(St,{stream:"mp4CaptionParser"}))}),At(lt.captions)}}):At()}})}else{if(f.transmuxer)return typeof f.container>"u"&&(f.container=dn(ce)),"ts"!==f.container&&"aac"!==f.container?(s(f,{hasAudio:!1,hasVideo:!1}),void te(null,f,{})):void Wv({segment:f,bytes:h,trackInfoFn:s,timingInfoFn:u,videoSegmentTimingInfoFn:m,audioSegmentTimingInfoFn:T,id3Fn:S,captionsFn:D,isEndOfTimeline:P,endedTimelineFn:W,dataFn:H,doneFn:te,onTransmuxerLog:le});te(null,f,{})}},$h=function(d,f){var S,h=d.id,s=d.key,u=d.encryptedBytes,m=d.decryptionWorker;m.addEventListener("message",function D(P){if(P.data.source===h){m.removeEventListener("message",D);var W=P.data.decrypted;f(new Uint8Array(W.bytes,W.byteOffset,W.byteLength))}}),S=s.bytes.slice?s.bytes.slice():new Uint32Array(Array.prototype.slice.call(s.bytes)),m.postMessage(Vh({source:h,encrypted:u,key:S,iv:s.iv}),[u.buffer,S.buffer])},Sb=function(d){var f=d.xhr,h=d.xhrOptions,u=d.segment,m=d.abortFn,T=d.progressFn,S=d.trackInfoFn,D=d.timingInfoFn,P=d.videoSegmentTimingInfoFn,W=d.audioSegmentTimingInfoFn,H=d.id3Fn,te=d.captionsFn,le=d.isEndOfTimeline,ce=d.endedTimelineFn,fe=d.dataFn,sn=[],rt=function(d){var f=d.activeXhrs,h=d.decryptionWorker,s=d.trackInfoFn,u=d.timingInfoFn,m=d.videoSegmentTimingInfoFn,T=d.audioSegmentTimingInfoFn,S=d.id3Fn,D=d.captionsFn,P=d.isEndOfTimeline,W=d.endedTimelineFn,H=d.dataFn,te=d.doneFn,le=d.onTransmuxerLog,ce=0,fe=!1;return function(ue,At){if(!fe){if(ue)return fe=!0,P0(f),te(ue,At);if((ce+=1)===f.length){var sn=function(){if(At.encryptedBytes)return function(d){var h=d.segment,s=d.trackInfoFn,u=d.timingInfoFn,m=d.videoSegmentTimingInfoFn,T=d.audioSegmentTimingInfoFn,S=d.id3Fn,D=d.captionsFn,P=d.isEndOfTimeline,W=d.endedTimelineFn,H=d.dataFn,te=d.doneFn,le=d.onTransmuxerLog;$h({id:h.requestId,key:h.key,encryptedBytes:h.encryptedBytes,decryptionWorker:d.decryptionWorker},function(ce){h.bytes=ce,ka({segment:h,bytes:h.bytes,trackInfoFn:s,timingInfoFn:u,videoSegmentTimingInfoFn:m,audioSegmentTimingInfoFn:T,id3Fn:S,captionsFn:D,isEndOfTimeline:P,endedTimelineFn:W,dataFn:H,doneFn:te,onTransmuxerLog:le})})}({decryptionWorker:h,segment:At,trackInfoFn:s,timingInfoFn:u,videoSegmentTimingInfoFn:m,audioSegmentTimingInfoFn:T,id3Fn:S,captionsFn:D,isEndOfTimeline:P,endedTimelineFn:W,dataFn:H,doneFn:te,onTransmuxerLog:le});ka({segment:At,bytes:At.bytes,trackInfoFn:s,timingInfoFn:u,videoSegmentTimingInfoFn:m,audioSegmentTimingInfoFn:T,id3Fn:S,captionsFn:D,isEndOfTimeline:P,endedTimelineFn:W,dataFn:H,doneFn:te,onTransmuxerLog:le})};if(At.endOfAllRequests=Date.now(),At.map&&At.map.encryptedBytes&&!At.map.bytes)return $h({decryptionWorker:h,id:At.requestId+"-init",encryptedBytes:At.map.encryptedBytes,key:At.map.key},function(rt){At.map.bytes=rt,La(At,function(et){if(et)return P0(f),te(et,At);sn()})});sn()}}}}({activeXhrs:sn,decryptionWorker:d.decryptionWorker,trackInfoFn:S,timingInfoFn:D,videoSegmentTimingInfoFn:P,audioSegmentTimingInfoFn:W,id3Fn:H,captionsFn:te,isEndOfTimeline:le,endedTimelineFn:ce,dataFn:fe,doneFn:d.doneFn,onTransmuxerLog:d.onTransmuxerLog});if(u.key&&!u.key.bytes){var et=[u.key];u.map&&!u.map.bytes&&u.map.key&&u.map.key.resolvedUri===u.key.resolvedUri&&et.push(u.map.key);var lt=f(Be.mergeOptions(h,{uri:u.key.resolvedUri,responseType:"arraybuffer"}),L0(u,et,rt));sn.push(lt)}if(u.map&&!u.map.bytes){if(u.map.key&&(!u.key||u.key.resolvedUri!==u.map.key.resolvedUri)){var pn=f(Be.mergeOptions(h,{uri:u.map.key.resolvedUri,responseType:"arraybuffer"}),L0(u,[u.map.key],rt));sn.push(pn)}var yi=Be.mergeOptions(h,{uri:u.map.resolvedUri,responseType:"arraybuffer",headers:Id(u.map)}),Or=function(d){var f=d.segment,h=d.finishProcessingFn;return function(s,u){var m=O0(s,u);if(m)return h(m,f);var T=new Uint8Array(u.response);if(f.map.key)return f.map.encryptedBytes=T,h(null,f);f.map.bytes=T,La(f,function(S){if(S)return S.xhr=u,S.status=u.status,h(S,f);h(null,f)})}}({segment:u,finishProcessingFn:rt}),ms=f(yi,Or);sn.push(ms)}var gs=Be.mergeOptions(h,{uri:u.part&&u.part.resolvedUri||u.resolvedUri,responseType:"arraybuffer",headers:Id(u)}),ns=f(gs,function(d){var f=d.segment,h=d.finishProcessingFn,s=d.responseType;return function(u,m){var T=O0(u,m);if(T)return h(T,f);var S="arraybuffer"!==s&&m.responseText?function(d){for(var f=new Uint8Array(new ArrayBuffer(d.length)),h=0;h<d.length;h++)f[h]=d.charCodeAt(h);return f.buffer}(m.responseText.substring(f.lastReachedChar||0)):m.response;return f.stats=function(d){return{bandwidth:d.bandwidth,bytesReceived:d.bytesReceived||0,roundTripTime:d.roundTripTime||0}}(m),f.key?f.encryptedBytes=new Uint8Array(S):f.bytes=new Uint8Array(S),h(null,f)}}({segment:u,finishProcessingFn:rt,responseType:gs.responseType}));ns.addEventListener("progress",function(d){var f=d.segment,h=d.progressFn;return function(s){if(!s.target.aborted)return f.stats=Be.mergeOptions(f.stats,function(d){var f=d.target,s={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-f.requestTime||0};return s.bytesReceived=d.loaded,s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3),s}(s)),!f.stats.firstBytesReceivedAt&&f.stats.bytesReceived&&(f.stats.firstBytesReceivedAt=Date.now()),h(s,f)}}({segment:u,progressFn:T,trackInfoFn:S,timingInfoFn:D,videoSegmentTimingInfoFn:P,audioSegmentTimingInfoFn:W,id3Fn:H,captionsFn:te,isEndOfTimeline:le,endedTimelineFn:ce,dataFn:fe})),sn.push(ns);var na={};return sn.forEach(function(fr){fr.addEventListener("loadend",function(d){var f=d.loadendState,h=d.abortFn;return function(s){s.target.aborted&&h&&!f.calledAbortFn&&(h(),f.calledAbortFn=!0)}}({loadendState:na,abortFn:m}))}),function(){return P0(sn)}},F0=ml("CodecUtils"),qv=function(d,f){var h=f.attributes||{};return d&&d.mediaGroups&&d.mediaGroups.AUDIO&&h.AUDIO&&d.mediaGroups.AUDIO[h.AUDIO]},ig=function(d){var f={};return d.forEach(function(h){var s=h.mediaType,u=h.type,m=h.details;f[s]=f[s]||[],f[s].push(Dn(""+u+m))}),Object.keys(f).forEach(function(h){if(f[h].length>1)return F0("multiple "+h+" codecs found as attributes: "+f[h].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs."),void(f[h]=null);f[h]=f[h][0]}),f},tc=function(d){var f=0;return d.audio&&f++,d.video&&f++,f},fp=function(d,f){var h=f.attributes||{},s=ig(function(d){var f=d.attributes||{};if(f.CODECS)return hn(f.CODECS)}(f)||[]);if(qv(d,f)&&!s.audio&&!function(d,f){if(!qv(d,f))return!0;var s=d.mediaGroups.AUDIO[(f.attributes||{}).AUDIO];for(var u in s)if(!s[u].uri&&!s[u].playlists)return!0;return!1}(d,f)){var u=ig(function(d,f){if(!d.mediaGroups.AUDIO||!f)return null;var h=d.mediaGroups.AUDIO[f];if(!h)return null;for(var s in h){var u=h[s];if(u.default&&u.playlists)return hn(u.playlists[0].attributes.CODECS)}return null}(d,h.AUDIO)||[]);u.audio&&(s.audio=u.audio)}return s},ss=ml("PlaylistSelector"),Su=function(d){if(d&&d.playlist){var f=d.playlist;return JSON.stringify({id:f.id,bandwidth:d.bandwidth,width:d.width,height:d.height,codecs:f.attributes&&f.attributes.CODECS||""})}},Zo=function(d,f){if(!d)return"";var h=se().getComputedStyle(d);return h?h[f]:""},nc=function(d,f){var h=d.slice();d.sort(function(s,u){var m=f(s,u);return 0===m?h.indexOf(s)-h.indexOf(u):m})},qh=function(d,f){var h,s;return d.attributes.BANDWIDTH&&(h=d.attributes.BANDWIDTH),h=h||se().Number.MAX_VALUE,f.attributes.BANDWIDTH&&(s=f.attributes.BANDWIDTH),h-(s||se().Number.MAX_VALUE)},pp=function(d,f,h,s,u,m){if(d){var T={bandwidth:f,width:h,height:s,limitRenditionByPlayerDimensions:u},S=d.playlists;lo.isAudioOnly(d)&&(S=m.getAudioTrackPlaylists_(),T.audioOnly=!0);var D=S.map(function(st){var pn=st.attributes&&st.attributes.RESOLUTION&&st.attributes.RESOLUTION.width,yi=st.attributes&&st.attributes.RESOLUTION&&st.attributes.RESOLUTION.height;return{bandwidth:st.attributes&&st.attributes.BANDWIDTH||se().Number.MAX_VALUE,width:pn,height:yi,playlist:st}});nc(D,function(st,Wn){return st.bandwidth-Wn.bandwidth});var P=(D=D.filter(function(st){return!lo.isIncompatible(st.playlist)})).filter(function(st){return lo.isEnabled(st.playlist)});P.length||(P=D.filter(function(st){return!lo.isDisabled(st.playlist)}));var W=P.filter(function(st){return st.bandwidth*Sa.BANDWIDTH_VARIANCE<f}),H=W[W.length-1],te=W.filter(function(st){return st.bandwidth===H.bandwidth})[0];if(!1===u){var le=te||P[0]||D[0];if(le&&le.playlist){var ce="sortedPlaylistReps";return te&&(ce="bandwidthBestRep"),P[0]&&(ce="enabledPlaylistReps"),ss("choosing "+Su(le)+" using "+ce+" with options",T),le.playlist}return ss("could not choose a playlist with options",T),null}var fe=W.filter(function(st){return st.width&&st.height});nc(fe,function(st,Wn){return st.width-Wn.width});var ue=fe.filter(function(st){return st.width===h&&st.height===s});H=ue[ue.length-1];var sn,rt,et,Ft,At=ue.filter(function(st){return st.bandwidth===H.bandwidth})[0];if(At||(rt=(sn=fe.filter(function(st){return st.width>h||st.height>s})).filter(function(st){return st.width===sn[0].width&&st.height===sn[0].height}),H=rt[rt.length-1],et=rt.filter(function(st){return st.bandwidth===H.bandwidth})[0]),m.experimentalLeastPixelDiffSelector){var pt=fe.map(function(st){return st.pixelDiff=Math.abs(st.width-h)+Math.abs(st.height-s),st});nc(pt,function(st,Wn){return st.pixelDiff===Wn.pixelDiff?Wn.bandwidth-st.bandwidth:st.pixelDiff-Wn.pixelDiff}),Ft=pt[0]}var lt=Ft||et||At||te||P[0]||D[0];if(lt&&lt.playlist){var St="sortedPlaylistReps";return Ft?St="leastPixelDiffRep":et?St="resolutionPlusOneRep":At?St="resolutionBestRep":te?St="bandwidthBestRep":P[0]&&(St="enabledPlaylistReps"),ss("choosing "+Su(lt)+" using "+St+" with options",T),lt.playlist}return ss("could not choose a playlist with options",T),null}},Yv=function(){var d=this.useDevicePixelRatio&&se().devicePixelRatio||1;return pp(this.playlists.master,this.systemBandwidth,parseInt(Zo(this.tech_.el(),"width"),10)*d,parseInt(Zo(this.tech_.el(),"height"),10)*d,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)},gp=function(d,f,h){var s,u;if(h&&h.cues)for(s=h.cues.length;s--;)(u=h.cues[s]).startTime>=d&&u.endTime<=f&&h.removeCue(u)},Gc=function(d){return"number"==typeof d&&isFinite(d)},ac=1/60,zl=function(d){var f=d.startOfSegment,h=d.duration,s=d.segment,u=d.part,m=d.playlist,T=m.mediaSequence,S=m.id,D=m.segments,W=d.mediaIndex,H=d.partIndex,te=d.timeline,le=(void 0===D?[]:D).length-1,ce="mediaIndex/partIndex increment";d.getMediaInfoForTime?ce="getMediaInfoForTime ("+d.getMediaInfoForTime+")":d.isSyncRequest&&(ce="getSyncSegmentCandidate (isSyncRequest)"),d.independent&&(ce+=" with independent "+d.independent);var fe="number"==typeof H,ue=d.segment.uri?"segment":"pre-segment",At=fe?b0({preloadSegment:s})-1:0;return ue+" ["+(T+W)+"/"+(T+le)+"]"+(fe?" part ["+H+"/"+At+"]":"")+" segment start/end ["+s.start+" => "+s.end+"]"+(fe?" part start/end ["+u.start+" => "+u.end+"]":"")+" startOfSegment ["+f+"] duration ["+h+"] timeline ["+te+"] selected by ["+ce+"] playlist ["+S+"]"},Fd=function(d){return d+"TimingInfo"},ts=function(d){var f=d.timelineChangeController,s=d.segmentTimeline,u=d.loaderType,m=d.audioDisabled;if(d.currentTimeline===s)return!1;if("audio"===u){var T=f.lastTimelineChange({type:"main"});return!T||T.to!==s}if("main"===u&&m){var S=f.pendingTimelineChange({type:"audio"});return!(S&&S.to===s)}return!1},Zh=function(d){var f=d.segmentDuration,h=d.maxDuration;return!!f&&Math.round(f)>h+_s},_p=function(b){function d(h,s){var u;if(u=b.call(this)||this,!h)throw new TypeError("Initialization settings are required");if("function"!=typeof h.currentTime)throw new TypeError("No currentTime getter specified");if(!h.mediaSource)throw new TypeError("No MediaSource specified");return u.bandwidth=h.bandwidth,u.throughput={rate:0,count:0},u.roundTrip=NaN,u.resetStats_(),u.mediaIndex=null,u.partIndex=null,u.hasPlayed_=h.hasPlayed,u.currentTime_=h.currentTime,u.seekable_=h.seekable,u.seeking_=h.seeking,u.duration_=h.duration,u.mediaSource_=h.mediaSource,u.vhs_=h.vhs,u.loaderType_=h.loaderType,u.currentMediaInfo_=void 0,u.startingMediaInfo_=void 0,u.segmentMetadataTrack_=h.segmentMetadataTrack,u.goalBufferLength_=h.goalBufferLength,u.sourceType_=h.sourceType,u.sourceUpdater_=h.sourceUpdater,u.inbandTextTracks_=h.inbandTextTracks,u.state_="INIT",u.timelineChangeController_=h.timelineChangeController,u.shouldSaveSegmentTimingInfo_=!0,u.parse708captions_=h.parse708captions,u.useDtsForTimestampOffset_=h.useDtsForTimestampOffset,u.captionServices_=h.captionServices,u.experimentalExactManifestTimings=h.experimentalExactManifestTimings,u.checkBufferTimeout_=null,u.error_=void 0,u.currentTimeline_=-1,u.pendingSegment_=null,u.xhrOptions_=null,u.pendingSegments_=[],u.audioDisabled_=!1,u.isPendingTimestampOffset_=!1,u.gopBuffer_=[],u.timeMapping_=0,u.safeAppend_=Be.browser.IE_VERSION>=11,u.appendInitSegment_={audio:!0,video:!0},u.playlistOfLastInitSegment_={audio:null,video:null},u.callQueue_=[],u.loadQueue_=[],u.metadataQueue_={id3:[],caption:[]},u.waitingOnRemove_=!1,u.quotaExceededErrorRetryTimeout_=null,u.activeInitSegmentId_=null,u.initSegments_={},u.cacheEncryptionKeys_=h.cacheEncryptionKeys,u.keyCache_={},u.decrypter_=h.decrypter,u.syncController_=h.syncController,u.syncPoint_={segmentIndex:0,time:0},u.transmuxer_=u.createTransmuxer_(),u.triggerSyncInfoUpdate_=function(){return u.trigger("syncinfoupdate")},u.syncController_.on("syncinfoupdate",u.triggerSyncInfoUpdate_),u.mediaSource_.addEventListener("sourceopen",function(){u.isEndOfStream_()||(u.ended_=!1)}),u.fetchAtBuffer_=!1,u.logger_=ml("SegmentLoader["+u.loaderType_+"]"),Object.defineProperty(gt(u),"state",{get:function(){return this.state_},set:function(T){T!==this.state_&&(this.logger_(this.state_+" -> "+T),this.state_=T,this.trigger("statechange"))}}),u.sourceUpdater_.on("ready",function(){u.hasEnoughInfoToAppend_()&&u.processCallQueue_()}),"main"===u.loaderType_&&u.timelineChangeController_.on("pendingtimelinechange",function(){u.hasEnoughInfoToAppend_()&&u.processCallQueue_()}),"audio"===u.loaderType_&&u.timelineChangeController_.on("timelinechange",function(){u.hasEnoughInfoToLoad_()&&u.processLoadQueue_(),u.hasEnoughInfoToAppend_()&&u.processCallQueue_()}),u}ze(d,b);var f=d.prototype;return f.createTransmuxer_=function(){return function(d){var f=new Hv;f.currentTransmux=null,f.transmuxQueue=[];var h=f.terminate;return f.terminate=function(){return f.currentTransmux=null,f.transmuxQueue.length=0,h.call(f)},f.postMessage({action:"init",options:d}),f}({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})},f.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0},f.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&se().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},f.setAudio=function(s){this.audioDisabled_=!s,s?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},f.abort=function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)},f.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,se().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null},f.checkForAbort_=function(s){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==s:(this.state="READY",!0)},f.error=function(s){return typeof s<"u"&&(this.logger_("error occurred:",s),this.error_=s),this.pendingSegment_=null,this.error_},f.endOfStream=function(){this.ended_=!0,this.transmuxer_&&Ld_reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},f.buffered_=function(){var s=this.getMediaInfo_();if(!this.sourceUpdater_||!s)return Be.createTimeRanges();if("main"===this.loaderType_){var m=s.hasVideo;if(m&&s.hasAudio&&!this.audioDisabled_&&!s.isMuxed)return this.sourceUpdater_.buffered();if(m)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},f.initSegmentForMap=function(s,u){if(void 0===u&&(u=!1),!s)return null;var m=Hh(s),T=this.initSegments_[m];return u&&!T&&s.bytes&&(this.initSegments_[m]=T={resolvedUri:s.resolvedUri,byterange:s.byterange,bytes:s.bytes,tracks:s.tracks,timescales:s.timescales}),T||s},f.segmentKey=function(s,u){if(void 0===u&&(u=!1),!s)return null;var m=lp(s),T=this.keyCache_[m];this.cacheEncryptionKeys_&&u&&!T&&s.bytes&&(this.keyCache_[m]=T={resolvedUri:s.resolvedUri,bytes:s.bytes});var S={resolvedUri:(T||s).resolvedUri};return T&&(S.bytes=T.bytes),S},f.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},f.load=function(){if(this.monitorBuffer_(),this.playlist_){if("INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}},f.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},f.playlist=function(s,u){if(void 0===u&&(u={}),s){var m=this.playlist_,T=this.pendingSegment_;this.playlist_=s,this.xhrOptions_=u,"INIT"===this.state&&(s.syncInfo={mediaSequence:s.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(s));var S=null;if(m&&(m.id?S=m.id:m.uri&&(S=m.uri)),this.logger_("playlist update ["+S+" => "+(s.id||s.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!m||m.uri!==s.uri)return null!==this.mediaIndex&&(s.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,void this.trigger("playlistupdate");var D=s.mediaSequence-m.mediaSequence;if(this.logger_("live window shift ["+D+"]"),null!==this.mediaIndex)if(this.mediaIndex-=D,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{var P=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!P.parts||!P.parts.length||!P.parts[this.partIndex])){var W=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists."),this.resetLoader(),this.mediaIndex=W}}T&&(T.mediaIndex-=D,T.mediaIndex<0?(T.mediaIndex=null,T.partIndex=null):(T.mediaIndex>=0&&(T.segment=s.segments[T.mediaIndex]),T.partIndex>=0&&T.segment.parts&&(T.part=T.segment.parts[T.partIndex]))),this.syncController_.saveExpiredSegmentInfo(m,s)}},f.pause=function(){this.checkBufferTimeout_&&(se().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},f.paused=function(){return null===this.checkBufferTimeout_},f.resetEverything=function(s){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,s),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))},f.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},f.resyncLoader=function(){this.transmuxer_&&Ld_reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},f.remove=function(s,u,m,T){if(void 0===m&&(m=function(){}),void 0===T&&(T=!1),u===1/0&&(u=this.duration_()),u<=s)this.logger_("skipping remove because end ${end} is <= start ${start}");else if(this.sourceUpdater_&&this.getMediaInfo_()){var S=1,D=function(){0==--S&&m()};for(var P in(T||!this.audioDisabled_)&&(S++,this.sourceUpdater_.removeAudio(s,u,D)),(T||"main"===this.loaderType_)&&(this.gopBuffer_=function(d,f,h,s){for(var u=Math.ceil((f-s)*sr.ONE_SECOND_IN_TS),m=Math.ceil((h-s)*sr.ONE_SECOND_IN_TS),T=d.slice(),S=d.length;S--&&!(d[S].pts<=m););if(-1===S)return T;for(var D=S+1;D--&&!(d[D].pts<=u););return D=Math.max(D,0),T.splice(D,S-D+1),T}(this.gopBuffer_,s,u,this.timeMapping_),S++,this.sourceUpdater_.removeVideo(s,u,D)),this.inbandTextTracks_)gp(s,u,this.inbandTextTracks_[P]);gp(s,u,this.segmentMetadataTrack_),D()}else this.logger_("skipping remove because no source updater or starting media info")},f.monitorBuffer_=function(){this.checkBufferTimeout_&&se().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=se().setTimeout(this.monitorBufferTick_.bind(this),1)},f.monitorBufferTick_=function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&se().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=se().setTimeout(this.monitorBufferTick_.bind(this),500)},f.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){var s=this.chooseNextRequest_();!s||("number"==typeof s.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:s.timeline})),this.loadSegment_(s))}},f.isEndOfStream_=function(s,u,m){if(void 0===s&&(s=this.mediaIndex),void 0===u&&(u=this.playlist_),void 0===m&&(m=this.partIndex),!u||!this.mediaSource_)return!1;var T="number"==typeof s&&u.segments[s];return u.endList&&"open"===this.mediaSource_.readyState&&s+1===u.segments.length&&(!T||!T.parts||m+1===T.parts.length)},f.chooseNextRequest_=function(){var s=this.buffered_(),u=pb(s)||0,m=Lh(s,this.currentTime_()),T=!this.hasPlayed_()&&m>=1,S=m>=this.goalBufferLength_(),D=this.playlist_.segments;if(!D.length||T||S)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var P={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(P.isSyncRequest)P.mediaIndex=function(d,f,h){f=f||[];for(var s=[],u=0,m=0;m<f.length;m++){var T=f[m];if(d===T.timeline&&(s.push(m),(u+=T.duration)>h))return m}return 0===s.length?0:s[s.length-1]}(this.currentTimeline_,D,u);else if(null!==this.mediaIndex){var W=D[this.mediaIndex],H="number"==typeof this.partIndex?this.partIndex:-1;P.startOfSegment=W.end?W.end:u,W.parts&&W.parts[H+1]?(P.mediaIndex=this.mediaIndex,P.partIndex=H+1):P.mediaIndex=this.mediaIndex+1}else{var te=lo.getMediaInfoForTime({experimentalExactManifestTimings:this.experimentalExactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?u:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),le=te.segmentIndex,ce=te.startTime,fe=te.partIndex;P.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+u:"currentTime "+this.currentTime_(),P.mediaIndex=le,P.startOfSegment=ce,P.partIndex=fe}var ue=D[P.mediaIndex],At=ue&&"number"==typeof P.partIndex&&ue.parts&&ue.parts[P.partIndex];if(!ue||"number"==typeof P.partIndex&&!At)return null;if("number"!=typeof P.partIndex&&ue.parts&&(P.partIndex=0,At=ue.parts[0]),!m&&At&&!At.independent)if(0===P.partIndex){var sn=D[P.mediaIndex-1],rt=sn.parts&&sn.parts.length&&sn.parts[sn.parts.length-1];rt&&rt.independent&&(P.mediaIndex-=1,P.partIndex=sn.parts.length-1,P.independent="previous segment")}else ue.parts[P.partIndex-1].independent&&(P.partIndex-=1,P.independent="previous part");return P.mediaIndex>=D.length-1&&this.mediaSource_&&"ended"===this.mediaSource_.readyState&&!this.seeking_()?null:this.generateSegmentInfo_(P)},f.generateSegmentInfo_=function(s){var u=s.independent,m=s.playlist,T=s.mediaIndex,S=s.startOfSegment,D=s.isSyncRequest,P=s.partIndex,W=s.forceTimestampOffset,H=s.getMediaInfoForTime,te=m.segments[T],le="number"==typeof P&&te.parts[P],ce={requestId:"segment-loader-"+Math.random(),uri:le&&le.resolvedUri||te.resolvedUri,mediaIndex:T,partIndex:le?P:null,isSyncRequest:D,startOfSegment:S,playlist:m,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:te.timeline,duration:le&&le.duration||te.duration,segment:te,part:le,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:H,independent:u},fe=typeof W<"u"?W:this.isPendingTimestampOffset_;ce.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:te.timeline,currentTimeline:this.currentTimeline_,startOfSegment:S,buffered:this.buffered_(),overrideCheck:fe});var ue=pb(this.sourceUpdater_.audioBuffered());return"number"==typeof ue&&(ce.audioAppendStart=ue-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(ce.gopsToAlignWith=function(d,f,h){if(typeof f>"u"||null===f||!d.length)return[];var u,s=Math.ceil((f-h+3)*sr.ONE_SECOND_IN_TS);for(u=0;u<d.length&&!(d[u].pts>s);u++);return d.slice(u)}(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),ce},f.timestampOffsetForSegment_=function(s){return function(d){var f=d.segmentTimeline,h=d.currentTimeline,s=d.startOfSegment,u=d.buffered;return d.overrideCheck||f!==h?f<h?s:u.length?u.end(u.length-1):s:null}(s)},f.earlyAbortWhenNeeded_=function(s){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(s.firstBytesReceivedAt||Date.now())<1e3)){var u=this.currentTime_(),m=s.bandwidth,T=this.pendingSegment_.duration,S=lo.estimateSegmentRequestTime(T,m,this.playlist_,s.bytesReceived),D=function(d,f,h){return void 0===h&&(h=1),((d.length?d.end(d.length-1):0)-f)/h}(this.buffered_(),u,this.vhs_.tech_.playbackRate())-1;if(!(S<=D)){var P=function(d){var h=d.currentTime,s=d.bandwidth,u=d.duration,m=d.segmentDuration,T=d.timeUntilRebuffer,S=d.currentTimeline,D=d.syncController,P=d.master.playlists.filter(function(ce){return!lo.isIncompatible(ce)}),W=P.filter(lo.isEnabled);W.length||(W=P.filter(function(ce){return!lo.isDisabled(ce)}));var te=W.filter(lo.hasAttribute.bind(null,"BANDWIDTH")).map(function(ce){var ue=D.getSyncPoint(ce,u,S,h)?1:2;return{playlist:ce,rebufferingImpact:lo.estimateSegmentRequestTime(m,s,ce)*ue-T}}),le=te.filter(function(ce){return ce.rebufferingImpact<=0});return nc(le,function(ce,fe){return qh(fe.playlist,ce.playlist)}),le.length?le[0]:(nc(te,function(ce,fe){return ce.rebufferingImpact-fe.rebufferingImpact}),te[0]||null)}({master:this.vhs_.playlists.master,currentTime:u,bandwidth:m,duration:this.duration_(),segmentDuration:T,timeUntilRebuffer:D,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(P){var te=.5;D<=_s&&(te=1),P.playlist&&P.playlist.uri!==this.playlist_.uri&&!(S-D-P.rebufferingImpact<te)&&(this.bandwidth=P.playlist.attributes.BANDWIDTH*Sa.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}},f.handleAbort_=function(s){this.logger_("Aborting "+zl(s)),this.mediaRequestsAborted+=1},f.handleProgress_=function(s,u){this.earlyAbortWhenNeeded_(u.stats),!this.checkForAbort_(u.requestId)&&this.trigger("progress")},f.handleTrackInfo_=function(s,u){this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId)&&(this.checkForIllegalMediaSwitch(u)||(function(d,f){if(!d&&!f||!d&&f||d&&!f)return!1;if(d===f)return!0;var h=Object.keys(d).sort(),s=Object.keys(f).sort();if(h.length!==s.length)return!1;for(var u=0;u<h.length;u++){var m=h[u];if(m!==s[u]||d[m]!==f[m])return!1}return!0}(this.currentMediaInfo_,u=u||{})||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=u,this.currentMediaInfo_=u,this.logger_("trackinfo update",u),this.trigger("trackinfo")),!this.checkForAbort_(s.requestId)&&(this.pendingSegment_.trackInfo=u,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))},f.handleTimingInfo_=function(s,u,m,T){if(this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId)){var S=this.pendingSegment_,D=Fd(u);S[D]=S[D]||{},S[D][m]=T,this.logger_("timinginfo: "+u+" - "+m+" - "+T),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},f.handleCaptions_=function(s,u){var m=this;if(this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId)){if(0===u.length)return void this.logger_("SegmentLoader received no captions from a caption event");if(!this.pendingSegment_.hasAppendedData_)return void this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,s,u));var S=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),D={};u.forEach(function(P){D[P.stream]=D[P.stream]||{startTime:1/0,captions:[],endTime:0};var W=D[P.stream];W.startTime=Math.min(W.startTime,P.startTime+S),W.endTime=Math.max(W.endTime,P.endTime+S),W.captions.push(P)}),Object.keys(D).forEach(function(P){var W=D[P],H=W.startTime,te=W.endTime,le=W.captions,ce=m.inbandTextTracks_;m.logger_("adding cues from "+H+" -> "+te+" for "+P),function(d,f,h){if(!d[h]){f.trigger({type:"usage",name:"vhs-608"}),f.trigger({type:"usage",name:"hls-608"});var s=h;/^cc708_/.test(h)&&(s="SERVICE"+h.split("_")[1]);var u=f.textTracks().getTrackById(s);if(u)d[h]=u;else{var T=h,S=h,D=!1,P=(f.options_.vhs&&f.options_.vhs.captionServices||{})[s];P&&(T=P.label,S=P.language,D=P.default),d[h]=f.addRemoteTextTrack({kind:"captions",id:s,default:D,label:T,language:S},!1).track}}}(ce,m.vhs_.tech_,P),gp(H,te,ce[P]),function(d){var f=d.inbandTextTracks,h=d.captionArray,s=d.timestampOffset;if(h){var u=se().WebKitDataCue||se().VTTCue;h.forEach(function(m){f[m.stream].addCue(new u(m.startTime+s,m.endTime+s,m.text))})}}({captionArray:le,inbandTextTracks:ce,timestampOffset:S})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}},f.handleId3_=function(s,u,m){if(this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId)){if(!this.pendingSegment_.hasAppendedData_)return void this.metadataQueue_.id3.push(this.handleId3_.bind(this,s,u,m));var S=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();(function(d,f,h){d.metadataTrack_||(d.metadataTrack_=h.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,d.metadataTrack_.inBandMetadataTrackDispatchType=f)})(this.inbandTextTracks_,m,this.vhs_.tech_),function(d){var f=d.inbandTextTracks,h=d.metadataArray,s=d.timestampOffset,u=d.videoDuration;if(h){var m=se().WebKitDataCue||se().VTTCue,T=f.metadataTrack_;if(T&&(h.forEach(function(te){var le=te.cueTime+s;"number"!=typeof le||se().isNaN(le)||le<0||!(le<1/0)||te.frames.forEach(function(ce){var fe=new m(le,le,ce.value||ce.url||ce.data||"");fe.frame=ce,fe.value=ce,function(d){Object.defineProperties(d.frame,{id:{get:function(){return Be.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),d.value.key}},value:{get:function(){return Be.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),d.value.data}},privateData:{get:function(){return Be.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),d.value.data}}})}(fe),T.addCue(fe)})}),T.cues&&T.cues.length)){for(var S=T.cues,D=[],P=0;P<S.length;P++)S[P]&&D.push(S[P]);var W=D.reduce(function(te,le){var ce=te[le.startTime]||[];return ce.push(le),te[le.startTime]=ce,te},{}),H=Object.keys(W).sort(function(te,le){return Number(te)-Number(le)});H.forEach(function(te,le){var ce=W[te],fe=Number(H[le+1])||u;ce.forEach(function(ue){ue.endTime=fe})})}}}({inbandTextTracks:this.inbandTextTracks_,metadataArray:u,timestampOffset:S,videoDuration:this.duration_()})}},f.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(s){return s()}),this.metadataQueue_.caption.forEach(function(s){return s()}),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},f.processCallQueue_=function(){var s=this.callQueue_;this.callQueue_=[],s.forEach(function(u){return u()})},f.processLoadQueue_=function(){var s=this.loadQueue_;this.loadQueue_=[],s.forEach(function(u){return u()})},f.hasEnoughInfoToLoad_=function(){if("audio"!==this.loaderType_)return!0;var s=this.pendingSegment_;return!(!s||this.getCurrentMediaInfo_()&&ts({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:s.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},f.getCurrentMediaInfo_=function(s){return void 0===s&&(s=this.pendingSegment_),s&&s.trackInfo||this.currentMediaInfo_},f.getMediaInfo_=function(s){return void 0===s&&(s=this.pendingSegment_),this.getCurrentMediaInfo_(s)||this.startingMediaInfo_},f.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;var s=this.pendingSegment_,u=this.getCurrentMediaInfo_();return!(!s||!u||u.hasVideo&&!s.videoTimingInfo||u.hasAudio&&!this.audioDisabled_&&!u.isMuxed&&!s.audioTimingInfo||ts({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:s.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},f.handleData_=function(s,u){if(this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId)){if(this.callQueue_.length||!this.hasEnoughInfoToAppend_())return void this.callQueue_.push(this.handleData_.bind(this,s,u));var m=this.pendingSegment_;if(this.setTimeMapping_(m.timeline),this.updateMediaSecondsLoaded_(m.part||m.segment),"closed"!==this.mediaSource_.readyState){if(s.map&&(s.map=this.initSegmentForMap(s.map,!0),m.segment.map=s.map),s.key&&this.segmentKey(s.key,!0),m.isFmp4=s.isFmp4,m.timingInfo=m.timingInfo||{},m.isFmp4)this.trigger("fmp4"),m.timingInfo.start=m[Fd(u.type)].start;else{var D,T=this.getCurrentMediaInfo_(),S="main"===this.loaderType_&&T&&T.hasVideo;S&&(D=m.videoTimingInfo.start),m.timingInfo.start=this.trueSegmentStart_({currentStart:m.timingInfo.start,playlist:m.playlist,mediaIndex:m.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:S,firstVideoFrameTimeForData:D,videoTimingInfo:m.videoTimingInfo,audioTimingInfo:m.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(m,u.type),this.updateSourceBufferTimestampOffset_(m),m.isSyncRequest){this.updateTimingInfoEnd_(m),this.syncController_.saveSegmentTimingInfo({segmentInfo:m,shouldSaveTimelineMapping:"main"===this.loaderType_});var P=this.chooseNextRequest_();if(P.mediaIndex!==m.mediaIndex||P.partIndex!==m.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}m.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(m,u)}}},f.updateAppendInitSegmentStatus=function(s,u){"main"===this.loaderType_&&"number"==typeof s.timestampOffset&&!s.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[u]!==s.playlist&&(this.appendInitSegment_[u]=!0)},f.getInitSegmentAndUpdateState_=function(s){var u=s.type,m=s.initSegment,T=s.map,S=s.playlist;if(T){var D=Hh(T);if(this.activeInitSegmentId_===D)return null;m=this.initSegmentForMap(T,!0).bytes,this.activeInitSegmentId_=D}return m&&this.appendInitSegment_[u]?(this.playlistOfLastInitSegment_[u]=S,this.appendInitSegment_[u]=!1,this.activeInitSegmentId_=null,m):null},f.handleQuotaExceededError_=function(s,u){var m=this,T=s.segmentInfo,S=s.type,D=s.bytes,P=this.sourceUpdater_.audioBuffered(),W=this.sourceUpdater_.videoBuffered();P.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Ku(P).join(", ")),W.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Ku(W).join(", "));var H=P.length?P.start(0):0,te=P.length?P.end(P.length-1):0,le=W.length?W.start(0):0,ce=W.length?W.end(W.length-1):0;if(te-H<=1&&ce-le<=1)return this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: "+D.byteLength+", audio buffer: "+Ku(P).join(", ")+", video buffer: "+Ku(W).join(", ")+", "),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),void this.trigger("error");this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:T,type:S,bytes:D}));var ue=this.currentTime_()-1;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+ue),this.remove(0,ue,function(){m.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),m.waitingOnRemove_=!1,m.quotaExceededErrorRetryTimeout_=se().setTimeout(function(){m.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),m.quotaExceededErrorRetryTimeout_=null,m.processCallQueue_()},1e3)},!0)},f.handleAppendError_=function(s,u){var m=s.segmentInfo,T=s.type,S=s.bytes;if(u){if(22===u.code)return void this.handleQuotaExceededError_({segmentInfo:m,type:T,bytes:S});this.logger_("Received non QUOTA_EXCEEDED_ERR on append",u),this.error(T+" append of "+S.length+"b failed for segment #"+m.mediaIndex+" in playlist "+m.playlist.id),this.trigger("appenderror")}},f.appendToSourceBuffer_=function(s){var u=s.segmentInfo,m=s.type,T=s.initSegment,S=s.data,D=s.bytes;if(!D){var P=[S],W=S.byteLength;T&&(P.unshift(T),W+=T.byteLength),D=function(d){var h,f=0;return d.bytes&&(h=new Uint8Array(d.bytes),d.segments.forEach(function(s){h.set(s,f),f+=s.byteLength})),h}({bytes:W,segments:P})}this.sourceUpdater_.appendBuffer({segmentInfo:u,type:m,bytes:D},this.handleAppendError_.bind(this,{segmentInfo:u,type:m,bytes:D}))},f.handleSegmentTimingInfo_=function(s,u,m){if(this.pendingSegment_&&u===this.pendingSegment_.requestId){var T=this.pendingSegment_.segment,S=s+"TimingInfo";T[S]||(T[S]={}),T[S].transmuxerPrependedSeconds=m.prependedContentDuration||0,T[S].transmuxedPresentationStart=m.start.presentation,T[S].transmuxedDecodeStart=m.start.decode,T[S].transmuxedPresentationEnd=m.end.presentation,T[S].transmuxedDecodeEnd=m.end.decode,T[S].baseMediaDecodeTime=m.baseMediaDecodeTime}},f.appendData_=function(s,u){var m=u.type,T=u.data;if(T&&T.byteLength&&("audio"!==m||!this.audioDisabled_)){var S=this.getInitSegmentAndUpdateState_({type:m,initSegment:u.initSegment,playlist:s.playlist,map:s.isFmp4?s.segment.map:null});this.appendToSourceBuffer_({segmentInfo:s,type:m,initSegment:S,data:T})}},f.loadSegment_=function(s){var u=this;this.state="WAITING",this.pendingSegment_=s,this.trimBackBuffer_(s),"number"==typeof s.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(s):this.loadQueue_.push(function(){var m=Mt({},s,{forceTimestampOffset:!0});Mt(s,u.generateSegmentInfo_(m)),u.isPendingTimestampOffset_=!1,u.updateTransmuxerAndRequestSegment_(s)})},f.updateTransmuxerAndRequestSegment_=function(s){var u=this;this.shouldUpdateTransmuxerTimestampOffset_(s.timestampOffset)&&(this.gopBuffer_.length=0,s.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:s.timestampOffset}));var m=this.createSimplifiedSegmentObj_(s),P=this.isEndOfStream_(s.mediaIndex,s.playlist,s.partIndex)||null!==this.mediaIndex&&s.timeline!==this.currentTimeline_&&s.timeline>0;this.logger_("Requesting "+zl(s)),m.map&&!m.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),s.abortRequests=Sb({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:m,abortFn:this.handleAbort_.bind(this,s),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",s.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",s.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:P,endedTimelineFn:function(){u.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function(H){var te=H.message,le=H.level,ce=H.stream;u.logger_(zl(s)+" logged from transmuxer stream "+ce+" as a "+le+": "+te)}})},f.trimBackBuffer_=function(s){var u=function(d,f,h){var s=f-Sa.BACK_BUFFER_LENGTH;return d.length&&(s=Math.max(s,d.start(0))),Math.min(f-h,s)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);u>0&&this.remove(0,u)},f.createSimplifiedSegmentObj_=function(s){var u=s.segment,m=s.part,T={resolvedUri:m?m.resolvedUri:u.resolvedUri,byterange:m?m.byterange:u.byterange,requestId:s.requestId,transmuxer:s.transmuxer,audioAppendStart:s.audioAppendStart,gopsToAlignWith:s.gopsToAlignWith,part:s.part},S=s.playlist.segments[s.mediaIndex-1];if(S&&S.timeline===u.timeline&&(S.videoTimingInfo?T.baseStartTime=S.videoTimingInfo.transmuxedDecodeEnd:S.audioTimingInfo&&(T.baseStartTime=S.audioTimingInfo.transmuxedDecodeEnd)),u.key){var D=u.key.iv||new Uint32Array([0,0,0,s.mediaIndex+s.playlist.mediaSequence]);T.key=this.segmentKey(u.key),T.key.iv=D}return u.map&&(T.map=this.initSegmentForMap(u.map)),T},f.saveTransferStats_=function(s){this.mediaRequests+=1,s&&(this.mediaBytesTransferred+=s.bytesReceived,this.mediaTransferDuration+=s.roundTripTime)},f.saveBandwidthRelatedStats_=function(s,u){this.pendingSegment_.byteLength=u.bytesReceived,s<ac?this.logger_("Ignoring segment's bandwidth because its duration of "+s+" is less than the min to record "+ac):(this.bandwidth=u.bandwidth,this.roundTrip=u.roundTripTime)},f.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate")},f.segmentRequestFinished_=function(s,u,m){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,s,u,m));else if(this.saveTransferStats_(u.stats),this.pendingSegment_&&u.requestId===this.pendingSegment_.requestId){if(s){if(this.pendingSegment_=null,this.state="READY",-102===s.code)return;return this.pause(),-101===s.code?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(s),void this.trigger("error"))}var T=this.pendingSegment_;this.saveBandwidthRelatedStats_(T.duration,u.stats),T.endOfAllRequests=u.endOfAllRequests,m.gopInfo&&(this.gopBuffer_=function(d,f,h){if(!f.length)return d;if(h)return f.slice();for(var s=f[0].pts,u=0;u<d.length&&!(d[u].pts>=s);u++);return d.slice(0,u).concat(f)}(this.gopBuffer_,m.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(T)}},f.setTimeMapping_=function(s){var u=this.syncController_.mappingForTimeline(s);null!==u&&(this.timeMapping_=u)},f.updateMediaSecondsLoaded_=function(s){this.mediaSecondsLoaded+="number"==typeof s.start&&"number"==typeof s.end?s.end-s.start:s.duration},f.shouldUpdateTransmuxerTimestampOffset_=function(s){return null!==s&&("main"===this.loaderType_&&s!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&s!==this.sourceUpdater_.audioTimestampOffset())},f.trueSegmentStart_=function(s){var u=s.currentStart,T=s.mediaIndex,S=s.firstVideoFrameTimeForData;if(typeof u<"u")return u;if(!s.useVideoTimingInfo)return s.audioTimingInfo.start;var te=s.playlist.segments[T-1];return 0===T||!te||typeof te.start>"u"||te.end!==S+s.currentVideoTimestampOffset?S:s.videoTimingInfo.start},f.waitForAppendsToComplete_=function(s){var u=this.getCurrentMediaInfo_(s);if(!u)return this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),void this.trigger("error");var D="main"===this.loaderType_&&u.hasVideo,P=!this.audioDisabled_&&u.hasAudio&&!u.isMuxed;if(s.waitingOnAppends=0,!s.hasAppendedData_)return!s.timingInfo&&"number"==typeof s.timestampOffset&&(this.isPendingTimestampOffset_=!0),s.timingInfo={start:0},s.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(s),this.processMetadataQueue_()),void this.checkAppendsDone_(s);D&&s.waitingOnAppends++,P&&s.waitingOnAppends++,D&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,s)),P&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,s))},f.checkAppendsDone_=function(s){this.checkForAbort_(s.requestId)||(s.waitingOnAppends--,0===s.waitingOnAppends&&this.handleAppendsDone_())},f.checkForIllegalMediaSwitch=function(s){var u=function(d,f,h){return"main"===d&&f&&h?h.hasAudio||h.hasVideo?f.hasVideo&&!h.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!f.hasVideo&&h.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.getCurrentMediaInfo_(),s);return!!u&&(this.error({message:u,blacklistDuration:1/0}),this.trigger("error"),!0)},f.updateSourceBufferTimestampOffset_=function(s){if(null!==s.timestampOffset&&"number"==typeof s.timingInfo.start&&!s.changedTimestampOffset&&"main"===this.loaderType_){var u=!1;s.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:s.segment.videoTimingInfo,audioTimingInfo:s.segment.audioTimingInfo,timingInfo:s.timingInfo}),s.changedTimestampOffset=!0,s.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(s.timestampOffset),u=!0),s.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(s.timestampOffset),u=!0),u&&this.trigger("timestampoffset")}},f.getSegmentStartTimeForTimestampOffsetCalculation_=function(s){var u=s.videoTimingInfo,m=s.audioTimingInfo,T=s.timingInfo;return this.useDtsForTimestampOffset_?u&&"number"==typeof u.transmuxedDecodeStart?u.transmuxedDecodeStart:m&&"number"==typeof m.transmuxedDecodeStart?m.transmuxedDecodeStart:T.start:T.start},f.updateTimingInfoEnd_=function(s){s.timingInfo=s.timingInfo||{};var u=this.getMediaInfo_(),T="main"===this.loaderType_&&u&&u.hasVideo&&s.videoTimingInfo?s.videoTimingInfo:s.audioTimingInfo;!T||(s.timingInfo.end="number"==typeof T.end?T.end:T.start+s.duration)},f.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var s=this.pendingSegment_;this.updateTimingInfoEnd_(s),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:s,shouldSaveTimelineMapping:"main"===this.loaderType_});var u=function(d,f){if("hls"!==f)return null;var h=function(d){var f=0;return["video","audio"].forEach(function(h){var s=d[h+"TimingInfo"];if(s){var T,u=s.start,m=s.end;"bigint"==typeof u||"bigint"==typeof m?T=se().BigInt(m)-se().BigInt(u):"number"==typeof u&&"number"==typeof m&&(T=m-u),typeof T<"u"&&T>f&&(f=T)}}),"bigint"==typeof f&&f<Number.MAX_SAFE_INTEGER&&(f=Number(f)),f}({audioTimingInfo:d.audioTimingInfo,videoTimingInfo:d.videoTimingInfo});if(!h)return null;var s=d.playlist.targetDuration,u=Zh({segmentDuration:h,maxDuration:2*s}),m=Zh({segmentDuration:h,maxDuration:s});return u||m?{severity:u?"warn":"info",message:"Segment with index "+d.mediaIndex+" from playlist "+d.playlist.id+" has a duration of "+h+" when the reported duration is "+d.duration+" and the target duration is "+s+". For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1"}:null}(s,this.sourceType_);if(u&&("warn"===u.severity?Be.log.warn(u.message):this.logger_(u.message)),this.recordThroughput_(s),this.pendingSegment_=null,this.state="READY",!s.isSyncRequest||(this.trigger("syncinfoupdate"),s.hasAppendedData_)){this.logger_("Appended "+zl(s)),this.addSegmentMetadataCue_(s),this.fetchAtBuffer_=!0,this.currentTimeline_!==s.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:s.timeline}),"main"===this.loaderType_&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:s.timeline})),this.currentTimeline_=s.timeline,this.trigger("syncinfoupdate");var m=s.segment,T=s.part,S=m.end&&this.currentTime_()-m.end>3*s.playlist.targetDuration,D=T&&T.end&&this.currentTime_()-T.end>3*s.playlist.partTargetDuration;if(S||D)return this.logger_("bad "+(S?"segment":"part")+" "+zl(s)),void this.resetEverything();null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=s.mediaIndex,this.partIndex=s.partIndex,this.isEndOfStream_(s.mediaIndex,s.playlist,s.partIndex)&&this.endOfStream(),this.trigger("appended"),s.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}else this.logger_("Throwing away un-appended sync request "+zl(s))},f.recordThroughput_=function(s){if(s.duration<ac)this.logger_("Ignoring segment's throughput because its duration of "+s.duration+" is less than the min to record "+ac);else{var u=this.throughput.rate,m=Date.now()-s.endOfAllRequests+1,T=Math.floor(s.byteLength/m*8*1e3);this.throughput.rate+=(T-u)/++this.throughput.count}},f.addSegmentMetadataCue_=function(s){if(this.segmentMetadataTrack_){var u=s.segment,m=u.start,T=u.end;if(Gc(m)&&Gc(T)){gp(m,T,this.segmentMetadataTrack_);var S=se().WebKitDataCue||se().VTTCue,D={custom:u.custom,dateTimeObject:u.dateTimeObject,dateTimeString:u.dateTimeString,bandwidth:s.playlist.attributes.BANDWIDTH,resolution:s.playlist.attributes.RESOLUTION,codecs:s.playlist.attributes.CODECS,byteLength:s.byteLength,uri:s.uri,timeline:s.timeline,playlist:s.playlist.id,start:m,end:T},W=new S(m,T,JSON.stringify(D));W.value=D,this.segmentMetadataTrack_.addCue(W)}}},d}(Be.EventTarget);function ps(){}var lc,yp=function(d){return"string"!=typeof d?d:d.replace(/./,function(f){return f.toUpperCase()})},oc=["video","audio"],jc=function(d,f){var h=f[d+"Buffer"];return h&&h.updating||f.queuePending[d]},Jh=function b(d,f){if(0!==f.queue.length){var h=0,s=f.queue[h];if("mediaSource"===s.type)return void(!f.updating()&&"closed"!==f.mediaSource.readyState&&(f.queue.shift(),s.action(f),s.doneFn&&s.doneFn(),b("audio",f),b("video",f)));if("mediaSource"!==d&&f.ready()&&"closed"!==f.mediaSource.readyState&&!jc(d,f)){if(s.type!==d){if(h=function(d,f){for(var h=0;h<f.length;h++){var s=f[h];if("mediaSource"===s.type)return null;if(s.type===d)return h}return null}(d,f.queue),null===h)return;s=f.queue[h]}if(f.queue.splice(h,1),f.queuePending[d]=s,s.action(d,f),!s.doneFn)return f.queuePending[d]=null,void b(d,f)}}},Kv=function(d,f){var h=f[d+"Buffer"],s=yp(d);!h||(h.removeEventListener("updateend",f["on"+s+"UpdateEnd_"]),h.removeEventListener("error",f["on"+s+"Error_"]),f.codecs[d]=null,f[d+"Buffer"]=null)},Fa=function(d,f){return d&&f&&-1!==Array.prototype.indexOf.call(d.sourceBuffers,f)},Ds_appendBuffer=function(d,f,h){return function(s,u){var m=u[s+"Buffer"];if(Fa(u.mediaSource,m)){u.logger_("Appending segment "+f.mediaIndex+"'s "+d.length+" bytes to "+s+"Buffer");try{m.appendBuffer(d)}catch(T){u.logger_("Error with code "+T.code+" "+(22===T.code?"(QUOTA_EXCEEDED_ERR) ":"")+"when appending segment "+f.mediaIndex+" to "+s+"Buffer"),u.queuePending[s]=null,h(T)}}}},Ds_remove=function(d,f){return function(h,s){var u=s[h+"Buffer"];if(Fa(s.mediaSource,u)){s.logger_("Removing "+d+" to "+f+" from "+h+"Buffer");try{u.remove(d,f)}catch{s.logger_("Remove "+d+" to "+f+" from "+h+"Buffer failed")}}}},Ds_timestampOffset=function(d){return function(f,h){var s=h[f+"Buffer"];!Fa(h.mediaSource,s)||(h.logger_("Setting "+f+"timestampOffset to "+d),s.timestampOffset=d)}},Ds_callback=function(d){return function(f,h){d()}},Ds_endOfStream=function(d){return function(f){if("open"===f.mediaSource.readyState){f.logger_("Calling mediaSource endOfStream("+(d||"")+")");try{f.mediaSource.endOfStream(d)}catch(h){Be.log.warn("Failed to call media source endOfStream",h)}}}},Ds_duration=function(d){return function(f){f.logger_("Setting mediaSource duration to "+d);try{f.mediaSource.duration=d}catch(h){Be.log.warn("Failed to set media source duration",h)}}},Ds_addSourceBuffer=function(d,f){return function(h){var s=yp(d),u=As(f);h.logger_("Adding "+d+"Buffer with codec "+f+" to mediaSource");var m=h.mediaSource.addSourceBuffer(u);m.addEventListener("updateend",h["on"+s+"UpdateEnd_"]),m.addEventListener("error",h["on"+s+"Error_"]),h.codecs[d]=f,h[d+"Buffer"]=m}},Ds_removeSourceBuffer=function(d){return function(f){var h=f[d+"Buffer"];if(Kv(d,f),Fa(f.mediaSource,h)){f.logger_("Removing "+d+"Buffer with codec "+f.codecs[d]+" from mediaSource");try{f.mediaSource.removeSourceBuffer(h)}catch(s){Be.log.warn("Failed to removeSourceBuffer "+d+"Buffer",s)}}}},Ds_changeType=function(d){return function(f,h){var s=h[f+"Buffer"],u=As(d);!Fa(h.mediaSource,s)||h.codecs[f]!==d&&(h.logger_("changing "+f+"Buffer codec from "+h.codecs[f]+" to "+d),s.changeType(u),h.codecs[f]=d)}},Mo=function(d){var f=d.type,h=d.sourceUpdater;h.queue.push({type:f,action:d.action,doneFn:d.doneFn,name:d.name}),Jh(f,h)},Zv=function(d,f){return function(h){if(f.queuePending[d]){var s=f.queuePending[d].doneFn;f.queuePending[d]=null,s&&s(f[d+"Error_"])}Jh(d,f)}},zc=function(b){function d(h){var s;return(s=b.call(this)||this).mediaSource=h,s.sourceopenListener_=function(){return Jh("mediaSource",gt(s))},s.mediaSource.addEventListener("sourceopen",s.sourceopenListener_),s.logger_=ml("SourceUpdater"),s.audioTimestampOffset_=0,s.videoTimestampOffset_=0,s.queue=[],s.queuePending={audio:null,video:null},s.delayedAudioAppendQueue_=[],s.videoAppendQueued_=!1,s.codecs={},s.onVideoUpdateEnd_=Zv("video",gt(s)),s.onAudioUpdateEnd_=Zv("audio",gt(s)),s.onVideoError_=function(u){s.videoError_=u},s.onAudioError_=function(u){s.audioError_=u},s.createdSourceBuffers_=!1,s.initializedEme_=!1,s.triggeredReady_=!1,s}ze(d,b);var f=d.prototype;return f.initializedEme=function(){this.initializedEme_=!0,this.triggerReady()},f.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_},f.hasInitializedAnyEme=function(){return this.initializedEme_},f.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},f.createSourceBuffers=function(s){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(s),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},f.triggerReady=function(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},f.addSourceBuffer=function(s,u){Mo({type:"mediaSource",sourceUpdater:this,action:Ds_addSourceBuffer(s,u),name:"addSourceBuffer"})},f.abort=function(s){Mo({type:s,sourceUpdater:this,action:function(d,f){if("open"===f.mediaSource.readyState){var h=f[d+"Buffer"];if(Fa(f.mediaSource,h)){f.logger_("calling abort on "+d+"Buffer");try{h.abort()}catch(s){Be.log.warn("Failed to abort on "+d+"Buffer",s)}}}},name:"abort"})},f.removeSourceBuffer=function(s){this.canRemoveSourceBuffer()?Mo({type:"mediaSource",sourceUpdater:this,action:Ds_removeSourceBuffer(s),name:"removeSourceBuffer"}):Be.log.error("removeSourceBuffer is not supported!")},f.canRemoveSourceBuffer=function(){return!Be.browser.IE_VERSION&&!Be.browser.IS_FIREFOX&&se().MediaSource&&se().MediaSource.prototype&&"function"==typeof se().MediaSource.prototype.removeSourceBuffer},d.canChangeType=function(){return se().SourceBuffer&&se().SourceBuffer.prototype&&"function"==typeof se().SourceBuffer.prototype.changeType},f.canChangeType=function(){return this.constructor.canChangeType()},f.changeType=function(s,u){this.canChangeType()?Mo({type:s,sourceUpdater:this,action:Ds_changeType(u),name:"changeType"}):Be.log.error("changeType is not supported!")},f.addOrChangeSourceBuffers=function(s){var u=this;if(!s||"object"!=typeof s||0===Object.keys(s).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(s).forEach(function(m){var T=s[m];if(!u.hasCreatedSourceBuffers())return u.addSourceBuffer(m,T);u.canChangeType()&&u.changeType(m,T)})},f.appendBuffer=function(s,u){var m=this,T=s.segmentInfo,S=s.type,D=s.bytes;if(this.processedAppend_=!0,"audio"===S&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([s,u]),void this.logger_("delayed audio append of "+D.length+" until video append");if(Mo({type:S,sourceUpdater:this,action:Ds_appendBuffer(D,T||{mediaIndex:-1},u),doneFn:u,name:"appendBuffer"}),"video"===S){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var W=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+W.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,W.forEach(function(H){m.appendBuffer.apply(m,H)})}},f.audioBuffered=function(){return Fa(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Be.createTimeRange()},f.videoBuffered=function(){return Fa(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Be.createTimeRange()},f.buffered=function(){var s=Fa(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,u=Fa(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return u&&!s?this.audioBuffered():s&&!u?this.videoBuffered():function(d,f){var h=null,s=null,u=0,m=[],T=[];if(!(d&&d.length&&f&&f.length))return Be.createTimeRange();for(var S=d.length;S--;)m.push({time:d.start(S),type:"start"}),m.push({time:d.end(S),type:"end"});for(S=f.length;S--;)m.push({time:f.start(S),type:"start"}),m.push({time:f.end(S),type:"end"});for(m.sort(function(D,P){return D.time-P.time}),S=0;S<m.length;S++)"start"===m[S].type?2==++u&&(h=m[S].time):"end"===m[S].type&&1==--u&&(s=m[S].time),null!==h&&null!==s&&(T.push([h,s]),h=null,s=null);return Be.createTimeRanges(T)}(this.audioBuffered(),this.videoBuffered())},f.setDuration=function(s,u){void 0===u&&(u=ps),Mo({type:"mediaSource",sourceUpdater:this,action:Ds_duration(s),name:"duration",doneFn:u})},f.endOfStream=function(s,u){void 0===s&&(s=null),void 0===u&&(u=ps),"string"!=typeof s&&(s=void 0),Mo({type:"mediaSource",sourceUpdater:this,action:Ds_endOfStream(s),name:"endOfStream",doneFn:u})},f.removeAudio=function(s,u,m){void 0===m&&(m=ps),this.audioBuffered().length&&0!==this.audioBuffered().end(0)?Mo({type:"audio",sourceUpdater:this,action:Ds_remove(s,u),doneFn:m,name:"remove"}):m()},f.removeVideo=function(s,u,m){void 0===m&&(m=ps),this.videoBuffered().length&&0!==this.videoBuffered().end(0)?Mo({type:"video",sourceUpdater:this,action:Ds_remove(s,u),doneFn:m,name:"remove"}):m()},f.updating=function(){return!(!jc("audio",this)&&!jc("video",this))},f.audioTimestampOffset=function(s){return typeof s<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==s&&(Mo({type:"audio",sourceUpdater:this,action:Ds_timestampOffset(s),name:"timestampOffset"}),this.audioTimestampOffset_=s),this.audioTimestampOffset_},f.videoTimestampOffset=function(s){return typeof s<"u"&&this.videoBuffer&&this.videoTimestampOffset!==s&&(Mo({type:"video",sourceUpdater:this,action:Ds_timestampOffset(s),name:"timestampOffset"}),this.videoTimestampOffset_=s),this.videoTimestampOffset_},f.audioQueueCallback=function(s){!this.audioBuffer||Mo({type:"audio",sourceUpdater:this,action:Ds_callback(s),name:"callback"})},f.videoQueueCallback=function(s){!this.videoBuffer||Mo({type:"video",sourceUpdater:this,action:Ds_callback(s),name:"callback"})},f.dispose=function(){var s=this;this.trigger("dispose"),oc.forEach(function(u){s.abort(u),s.canRemoveSourceBuffer()?s.removeSourceBuffer(u):s[u+"QueueCallback"](function(){return Kv(u,s)})}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},d}(Be.EventTarget),ag=function(d){return decodeURIComponent(escape(String.fromCharCode.apply(null,d)))},Jv=new Uint8Array("\n\n".split("").map(function(b){return b.charCodeAt(0)})),Mr=function(b){function d(h,s){var u;return void 0===s&&(s={}),(u=b.call(this,h,s)||this).mediaSource_=null,u.subtitlesTrack_=null,u.loaderType_="subtitle",u.featuresNativeTextTracks_=h.featuresNativeTextTracks,u.shouldSaveSegmentTimingInfo_=!1,u}ze(d,b);var f=d.prototype;return f.createTransmuxer_=function(){return null},f.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Be.createTimeRanges();var s=this.subtitlesTrack_.cues;return Be.createTimeRanges([[s[0].startTime,s[s.length-1].startTime]])},f.initSegmentForMap=function(s,u){if(void 0===u&&(u=!1),!s)return null;var m=Hh(s),T=this.initSegments_[m];if(u&&!T&&s.bytes){var D=new Uint8Array(Jv.byteLength+s.bytes.byteLength);D.set(s.bytes),D.set(Jv,s.bytes.byteLength),this.initSegments_[m]=T={resolvedUri:s.resolvedUri,byterange:s.byterange,bytes:D}}return T||s},f.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},f.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},f.track=function(s){return typeof s>"u"||(this.subtitlesTrack_=s,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_},f.remove=function(s,u){gp(s,u,this.subtitlesTrack_)},f.fillBuffer_=function(){var s=this,u=this.chooseNextRequest_();if(u){if(null===this.syncController_.timestampOffsetForTimeline(u.timeline))return this.syncController_.one("timestampoffset",function(){s.state="READY",s.paused()||s.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(u)}},f.timestampOffsetForSegment_=function(){return null},f.chooseNextRequest_=function(){return this.skipEmptySegments_(b.prototype.chooseNextRequest_.call(this))},f.skipEmptySegments_=function(s){for(;s&&s.segment.empty;){if(s.mediaIndex+1>=s.playlist.segments.length){s=null;break}s=this.generateSegmentInfo_({playlist:s.playlist,mediaIndex:s.mediaIndex+1,startOfSegment:s.startOfSegment+s.duration,isSyncRequest:s.isSyncRequest})}return s},f.stopForError=function(s){this.error(s),this.state="READY",this.pause(),this.trigger("error")},f.segmentRequestFinished_=function(s,u,m){var T=this;if(this.subtitlesTrack_){if(this.saveTransferStats_(u.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(s)return-101===s.code&&this.handleTimeout_(),-102===s.code?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(s);var S=this.pendingSegment_;this.saveBandwidthRelatedStats_(S.duration,u.stats),u.key&&this.segmentKey(u.key,!0),this.state="APPENDING",this.trigger("appending");var D=S.segment;if(D.map&&(D.map.bytes=u.map.bytes),S.bytes=u.bytes,"function"!=typeof se().WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var P,W=function(){T.subtitlesTrack_.tech_.off("vttjsloaded",P),T.stopForError({message:"Error loading vtt.js"})};return P=function(){T.subtitlesTrack_.tech_.off("vttjserror",W),T.segmentRequestFinished_(s,u,m)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",P),void this.subtitlesTrack_.tech_.one("vttjserror",W)}D.requested=!0;try{this.parseVTTCues_(S)}catch(H){return void this.stopForError({message:H.message})}if(this.updateTimeMapping_(S,this.syncController_.timelines[S.timeline],this.playlist_),S.timingInfo=S.cues.length?{start:S.cues[0].startTime,end:S.cues[S.cues.length-1].endTime}:{start:S.startOfSegment,end:S.startOfSegment+S.duration},S.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");S.byteLength=S.bytes.byteLength,this.mediaSecondsLoaded+=D.duration,S.cues.forEach(function(H){T.subtitlesTrack_.addCue(T.featuresNativeTextTracks_?new(se().VTTCue)(H.startTime,H.endTime,H.text):H)}),function(d){var f=d.cues;if(f)for(var h=0;h<f.length;h++){for(var s=[],u=0,m=0;m<f.length;m++)f[h].startTime===f[m].startTime&&f[h].endTime===f[m].endTime&&f[h].text===f[m].text&&++u>1&&s.push(f[m]);s.length&&s.forEach(function(T){return d.removeCue(T)})}}(this.subtitlesTrack_),this.handleAppendsDone_()}else this.state="READY"},f.handleData_=function(){},f.updateTimingInfoEnd_=function(){},f.parseVTTCues_=function(s){var u,m=!1;"function"==typeof se().TextDecoder?u=new(se().TextDecoder)("utf8"):(u=se().WebVTT.StringDecoder(),m=!0);var T=new(se().WebVTT.Parser)(se(),se().vttjs,u);if(s.cues=[],s.timestampmap={MPEGTS:0,LOCAL:0},T.oncue=s.cues.push.bind(s.cues),T.ontimestampmap=function(P){s.timestampmap=P},T.onparsingerror=function(P){Be.log.warn("Error encountered when parsing cues: "+P.message)},s.segment.map){var S=s.segment.map.bytes;m&&(S=ag(S)),T.parse(S)}var D=s.bytes;m&&(D=ag(D)),T.parse(D),T.flush()},f.updateTimeMapping_=function(s,u,m){var T=s.segment;if(u){if(!s.cues.length)return void(T.empty=!0);var S=s.timestampmap,D=S.MPEGTS/sr.ONE_SECOND_IN_TS-S.LOCAL+u.mapping;s.cues.forEach(function(H){H.startTime+=D,H.endTime+=D}),m.syncInfo||(m.syncInfo={mediaSequence:m.mediaSequence+s.mediaIndex,time:Math.min(s.cues[0].startTime,s.cues[s.cues.length-1].startTime-T.duration)})}},d}(_p),Io=function(d,f){for(var h=d.cues,s=0;s<h.length;s++){var u=h[s];if(f>=u.adStartTime&&f<=u.adEndTime)return u}return null},lg=[{name:"VOD",run:function(d,f,h,s,u){return h!==1/0?{time:0,segmentIndex:0,partIndex:null}:null}},{name:"ProgramDateTime",run:function(d,f,h,s,u){if(!Object.keys(d.timelineToDatetimeMappings).length)return null;var m=null,T=null,S=Sv(f);u=u||0;for(var D=0;D<S.length;D++){var W=S[f.endList||0===u?D:S.length-(D+1)],H=W.segment,te=d.timelineToDatetimeMappings[H.timeline];if(te&&H.dateTimeObject){var ce=H.dateTimeObject.getTime()/1e3+te;if(H.parts&&"number"==typeof W.partIndex)for(var fe=0;fe<W.partIndex;fe++)ce+=H.parts[fe].duration;var ue=Math.abs(u-ce);if(null!==T&&(0===ue||T<ue))break;T=ue,m={time:ce,segmentIndex:W.segmentIndex,partIndex:W.partIndex}}}return m}},{name:"Segment",run:function(d,f,h,s,u){var m=null,T=null;u=u||0;for(var S=Sv(f),D=0;D<S.length;D++){var W=S[f.endList||0===u?D:S.length-(D+1)],H=W.segment,te=W.part&&W.part.start||H&&H.start;if(H.timeline===s&&typeof te<"u"){var le=Math.abs(u-te);if(null!==T&&T<le)break;(!m||null===T||T>=le)&&(T=le,m={time:te,segmentIndex:W.segmentIndex,partIndex:W.partIndex})}}return m}},{name:"Discontinuity",run:function(d,f,h,s,u){var m=null;if(u=u||0,f.discontinuityStarts&&f.discontinuityStarts.length)for(var T=null,S=0;S<f.discontinuityStarts.length;S++){var D=f.discontinuityStarts[S],W=d.discontinuities[f.discontinuitySequence+S+1];if(W){var H=Math.abs(u-W.time);if(null!==T&&T<H)break;(!m||null===T||T>=H)&&(T=H,m={time:W.time,segmentIndex:D,partIndex:null})}}return m}},{name:"Playlist",run:function(d,f,h,s,u){return f.syncInfo?{time:f.syncInfo.time,segmentIndex:f.syncInfo.mediaSequence-f.mediaSequence,partIndex:null}:null}}],ef=function(b){function d(h){var s;return(s=b.call(this)||this).timelines=[],s.discontinuities=[],s.timelineToDatetimeMappings={},s.logger_=ml("SyncController"),s}ze(d,b);var f=d.prototype;return f.getSyncPoint=function(s,u,m,T){var S=this.runStrategies_(s,u,m,T);return S.length?this.selectSyncPoint_(S,{key:"time",value:T}):null},f.getExpiredTime=function(s,u){if(!s||!s.segments)return null;var m=this.runStrategies_(s,u,s.discontinuitySequence,0);if(!m.length)return null;var T=this.selectSyncPoint_(m,{key:"segmentIndex",value:0});return T.segmentIndex>0&&(T.time*=-1),Math.abs(T.time+er({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:T.segmentIndex,endIndex:0}))},f.runStrategies_=function(s,u,m,T){for(var S=[],D=0;D<lg.length;D++){var P=lg[D],W=P.run(this,s,u,m,T);W&&(W.strategy=P.name,S.push({strategy:P.name,syncPoint:W}))}return S},f.selectSyncPoint_=function(s,u){for(var m=s[0].syncPoint,T=Math.abs(s[0].syncPoint[u.key]-u.value),S=s[0].strategy,D=1;D<s.length;D++){var P=Math.abs(s[D].syncPoint[u.key]-u.value);P<T&&(T=P,m=s[D].syncPoint,S=s[D].strategy)}return this.logger_("syncPoint for ["+u.key+": "+u.value+"] chosen with strategy ["+S+"]: [time:"+m.time+", segmentIndex:"+m.segmentIndex+("number"==typeof m.partIndex?",partIndex:"+m.partIndex:"")+"]"),m},f.saveExpiredSegmentInfo=function(s,u){var m=u.mediaSequence-s.mediaSequence;if(m>86400)Be.log.warn("Not saving expired segment info. Media sequence gap "+m+" is too large.");else for(var T=m-1;T>=0;T--){var S=s.segments[T];if(S&&typeof S.start<"u"){u.syncInfo={mediaSequence:s.mediaSequence+T,time:S.start},this.logger_("playlist refresh sync: [time:"+u.syncInfo.time+", mediaSequence: "+u.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}},f.setDateTimeMappingForStart=function(s){if(this.timelineToDatetimeMappings={},s.segments&&s.segments.length&&s.segments[0].dateTimeObject){var u=s.segments[0],m=u.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[u.timeline]=-m}},f.saveSegmentTimingInfo=function(s){var u=s.segmentInfo,m=s.shouldSaveTimelineMapping,T=this.calculateSegmentTimeMapping_(u,u.timingInfo,m),S=u.segment;T&&(this.saveDiscontinuitySyncInfo_(u),u.playlist.syncInfo||(u.playlist.syncInfo={mediaSequence:u.playlist.mediaSequence+u.mediaIndex,time:S.start}));var D=S.dateTimeObject;S.discontinuity&&m&&D&&(this.timelineToDatetimeMappings[S.timeline]=-D.getTime()/1e3)},f.timestampOffsetForTimeline=function(s){return typeof this.timelines[s]>"u"?null:this.timelines[s].time},f.mappingForTimeline=function(s){return typeof this.timelines[s]>"u"?null:this.timelines[s].mapping},f.calculateSegmentTimeMapping_=function(s,u,m){var P,W,T=s.segment,S=s.part,D=this.timelines[s.timeline];if("number"==typeof s.timestampOffset)D={time:s.startOfSegment,mapping:s.startOfSegment-u.start},m&&(this.timelines[s.timeline]=D,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+s.timeline+": [time: "+D.time+"] [mapping: "+D.mapping+"]")),P=s.startOfSegment,W=u.end+D.mapping;else{if(!D)return!1;P=u.start+D.mapping,W=u.end+D.mapping}return S&&(S.start=P,S.end=W),(!T.start||P<T.start)&&(T.start=P),T.end=W,!0},f.saveDiscontinuitySyncInfo_=function(s){var u=s.playlist,m=s.segment;if(m.discontinuity)this.discontinuities[m.timeline]={time:m.start,accuracy:0};else if(u.discontinuityStarts&&u.discontinuityStarts.length)for(var T=0;T<u.discontinuityStarts.length;T++){var S=u.discontinuityStarts[T],D=u.discontinuitySequence+T+1,P=S-s.mediaIndex,W=Math.abs(P);if(!this.discontinuities[D]||this.discontinuities[D].accuracy>W){var H;H=P<0?m.start-er({defaultDuration:u.targetDuration,durationList:u.segments,startIndex:s.mediaIndex,endIndex:S}):m.end+er({defaultDuration:u.targetDuration,durationList:u.segments,startIndex:s.mediaIndex+1,endIndex:S}),this.discontinuities[D]={time:H,accuracy:W}}}},f.dispose=function(){this.trigger("dispose"),this.off()},d}(Be.EventTarget),Bd=function(b){function d(){var h;return(h=b.call(this)||this).pendingTimelineChanges_={},h.lastTimelineChanges_={},h}ze(d,b);var f=d.prototype;return f.clearPendingTimelineChange=function(s){this.pendingTimelineChanges_[s]=null,this.trigger("pendingtimelinechange")},f.pendingTimelineChange=function(s){var u=s.type,m=s.from,T=s.to;return"number"==typeof m&&"number"==typeof T&&(this.pendingTimelineChanges_[u]={type:u,from:m,to:T},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[u]},f.lastTimelineChange=function(s){var u=s.type,m=s.from,T=s.to;return"number"==typeof m&&"number"==typeof T&&(this.lastTimelineChanges_[u]={type:u,from:m,to:T},delete this.pendingTimelineChanges_[u],this.trigger("timelinechange")),this.lastTimelineChanges_[u]},f.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},d}(Be.EventTarget),G0=jh(zh(function(){var b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function d(rt,et,Ft){return rt(Ft={path:et,exports:{},require:function(lt,St){return function f(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},Ft.exports),Ft.exports}var h=d(function(rt){function et(pt,lt){for(var St=0;St<lt.length;St++){var st=lt[St];st.enumerable=st.enumerable||!1,st.configurable=!0,"value"in st&&(st.writable=!0),Object.defineProperty(pt,st.key,st)}}rt.exports=function Ft(pt,lt,St){return lt&&et(pt.prototype,lt),St&&et(pt,St),pt},rt.exports.default=rt.exports,rt.exports.__esModule=!0}),s=d(function(rt){function et(Ft,pt){return rt.exports=et=Object.setPrototypeOf||function(St,st){return St.__proto__=st,St},rt.exports.default=rt.exports,rt.exports.__esModule=!0,et(Ft,pt)}rt.exports=et,rt.exports.default=rt.exports,rt.exports.__esModule=!0}),u=d(function(rt){rt.exports=function et(Ft,pt){Ft.prototype=Object.create(pt.prototype),Ft.prototype.constructor=Ft,s(Ft,pt)},rt.exports.default=rt.exports,rt.exports.__esModule=!0}),m=function(){function rt(){this.listeners={}}var et=rt.prototype;return et.on=function(pt,lt){this.listeners[pt]||(this.listeners[pt]=[]),this.listeners[pt].push(lt)},et.off=function(pt,lt){if(!this.listeners[pt])return!1;var St=this.listeners[pt].indexOf(lt);return this.listeners[pt]=this.listeners[pt].slice(0),this.listeners[pt].splice(St,1),St>-1},et.trigger=function(pt){var lt=this.listeners[pt];if(lt)if(2===arguments.length)for(var St=lt.length,st=0;st<St;++st)lt[st].call(this,arguments[1]);else for(var Wn=Array.prototype.slice.call(arguments,1),pn=lt.length,yi=0;yi<pn;++yi)lt[yi].apply(this,Wn)},et.dispose=function(){this.listeners={}},et.pipe=function(pt){this.on("data",function(lt){pt.push(lt)})},rt}(),D=null,P=function(){function rt(Ft){D||(D=function(){var st,Wn,pn,ms,gs,ns,na,fr,et=[[[],[],[],[],[]],[[],[],[],[],[]]],Ft=et[0],pt=et[1],lt=Ft[4],St=pt[4],yi=[],Or=[];for(st=0;st<256;st++)Or[(yi[st]=st<<1^283*(st>>7))^st]=st;for(Wn=pn=0;!lt[Wn];Wn^=ms||1,pn=Or[pn]||1)for(lt[Wn]=ns=(ns=pn^pn<<1^pn<<2^pn<<3^pn<<4)>>8^255&ns^99,St[ns]=Wn,fr=16843009*yi[gs=yi[ms=yi[Wn]]]^65537*gs^257*ms^16843008*Wn,na=257*yi[ns]^16843008*ns,st=0;st<4;st++)Ft[st][Wn]=na=na<<24^na>>>8,pt[st][ns]=fr=fr<<24^fr>>>8;for(st=0;st<5;st++)Ft[st]=Ft[st].slice(0),pt[st]=pt[st].slice(0);return et}()),this._tables=[[D[0][0].slice(),D[0][1].slice(),D[0][2].slice(),D[0][3].slice(),D[0][4].slice()],[D[1][0].slice(),D[1][1].slice(),D[1][2].slice(),D[1][3].slice(),D[1][4].slice()]];var pt,lt,St,st=this._tables[0][4],Wn=this._tables[1],pn=Ft.length,yi=1;if(4!==pn&&6!==pn&&8!==pn)throw new Error("Invalid aes key size");var Or=Ft.slice(0),ms=[];for(this._key=[Or,ms],pt=pn;pt<4*pn+28;pt++)St=Or[pt-1],(pt%pn==0||8===pn&&pt%pn==4)&&(St=st[St>>>24]<<24^st[St>>16&255]<<16^st[St>>8&255]<<8^st[255&St],pt%pn==0&&(St=St<<8^St>>>24^yi<<24,yi=yi<<1^283*(yi>>7))),Or[pt]=Or[pt-pn]^St;for(lt=0;pt;lt++,pt--)St=Or[3&lt?pt:pt-4],ms[lt]=pt<=4||lt<4?St:Wn[0][st[St>>>24]]^Wn[1][st[St>>16&255]]^Wn[2][st[St>>8&255]]^Wn[3][st[255&St]]}return rt.prototype.decrypt=function(pt,lt,St,st,Wn,pn){var ns,na,fr,bl,yi=this._key[1],Or=pt^yi[0],ms=st^yi[1],gs=St^yi[2],ys=lt^yi[3],hg=yi.length/4-2,Mu=4,Yl=this._tables[1],jd=Yl[0],Ro=Yl[1],Tl=Yl[2],hc=Yl[3],zd=Yl[4];for(bl=0;bl<hg;bl++)ns=jd[Or>>>24]^Ro[ms>>16&255]^Tl[gs>>8&255]^hc[255&ys]^yi[Mu],na=jd[ms>>>24]^Ro[gs>>16&255]^Tl[ys>>8&255]^hc[255&Or]^yi[Mu+1],fr=jd[gs>>>24]^Ro[ys>>16&255]^Tl[Or>>8&255]^hc[255&ms]^yi[Mu+2],ys=jd[ys>>>24]^Ro[Or>>16&255]^Tl[ms>>8&255]^hc[255&gs]^yi[Mu+3],Mu+=4,Or=ns,ms=na,gs=fr;for(bl=0;bl<4;bl++)Wn[(3&-bl)+pn]=zd[Or>>>24]<<24^zd[ms>>16&255]<<16^zd[gs>>8&255]<<8^zd[255&ys]^yi[Mu++],ns=Or,Or=ms,ms=gs,gs=ys,ys=ns},rt}(),W=function(rt){function et(){var pt;return(pt=rt.call(this,m)||this).jobs=[],pt.delay=1,pt.timeout_=null,pt}u(et,rt);var Ft=et.prototype;return Ft.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},Ft.push=function(lt){this.jobs.push(lt),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},et}(m),H=function(et){return et<<24|(65280&et)<<8|(16711680&et)>>8|et>>>24},le=function(){function rt(Ft,pt,lt,St){var st=rt.STEP,Wn=new Int32Array(Ft.buffer),pn=new Uint8Array(Ft.byteLength),yi=0;for(this.asyncStream_=new W,this.asyncStream_.push(this.decryptChunk_(Wn.subarray(yi,yi+st),pt,lt,pn)),yi=st;yi<Wn.length;yi+=st)lt=new Uint32Array([H(Wn[yi-4]),H(Wn[yi-3]),H(Wn[yi-2]),H(Wn[yi-1])]),this.asyncStream_.push(this.decryptChunk_(Wn.subarray(yi,yi+st),pt,lt,pn));this.asyncStream_.push(function(){St(null,function T(rt){return rt.subarray(0,rt.byteLength-rt[rt.byteLength-1])}(pn))})}return rt.prototype.decryptChunk_=function(pt,lt,St,st){return function(){var Wn=function(et,Ft,pt){var pn,yi,Or,ms,gs,ys,ns,na,fr,lt=new Int32Array(et.buffer,et.byteOffset,et.byteLength>>2),St=new P(Array.prototype.slice.call(Ft)),st=new Uint8Array(et.byteLength),Wn=new Int32Array(st.buffer);for(pn=pt[0],yi=pt[1],Or=pt[2],ms=pt[3],fr=0;fr<lt.length;fr+=4)gs=H(lt[fr]),ys=H(lt[fr+1]),ns=H(lt[fr+2]),na=H(lt[fr+3]),St.decrypt(gs,ys,ns,na,Wn,fr),Wn[fr]=H(Wn[fr]^pn),Wn[fr+1]=H(Wn[fr+1]^yi),Wn[fr+2]=H(Wn[fr+2]^Or),Wn[fr+3]=H(Wn[fr+3]^ms),pn=gs,yi=ys,Or=ns,ms=na;return st}(pt,lt,St);st.set(Wn,pt.byteOffset)}},h(rt,null,[{key:"STEP",get:function(){return 32e3}}]),rt}(),At=(typeof window<"u"?window:typeof b<"u"?b:typeof self<"u"?self:{}).BigInt||Number;At("0x1"),At("0x100"),At("0x10000"),At("0x1000000"),At("0x100000000"),At("0x10000000000"),At("0x1000000000000"),At("0x100000000000000"),At("0x10000000000000000");self.onmessage=function(rt){var et=rt.data,Ft=new Uint8Array(et.encrypted.bytes,et.encrypted.byteOffset,et.encrypted.byteLength),pt=new Uint32Array(et.key.bytes,et.key.byteOffset,et.key.byteLength/4),lt=new Uint32Array(et.iv.bytes,et.iv.byteOffset,et.iv.byteLength/4);new le(Ft,pt,lt,function(St,st){self.postMessage(function(et){var Ft={};return Object.keys(et).forEach(function(pt){var lt=et[pt];Ft[pt]=function(et){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(et):et&&et.buffer instanceof ArrayBuffer}(lt)?{bytes:lt.buffer,byteOffset:lt.byteOffset,byteLength:lt.byteLength}:lt}),Ft}({source:et.source,decrypted:st}),[st.buffer])})}})),ug=Zm(G0),ti=function(d){var f=d.default?"main":"alternative";return d.characteristics&&d.characteristics.indexOf("public.accessibility.describes-video")>=0&&(f="main-desc"),f},ho=function(d,f){d.abort(),d.pause(),f&&f.activePlaylistLoader&&(f.activePlaylistLoader.pause(),f.activePlaylistLoader=null)},Wc=function(d,f){f.activePlaylistLoader=d,d.load()},Ud={AUDIO:function(d,f){return function(){var s=f.mediaTypes[d],u=f.blacklistCurrentPlaylist;ho(f.segmentLoaders[d],s);var m=s.activeTrack(),T=s.activeGroup(),S=(T.filter(function(W){return W.default})[0]||T[0]).id,D=s.tracks[S];if(m!==D){for(var P in Be.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),s.tracks)s.tracks[P].enabled=s.tracks[P]===D;s.onTrackChanged()}else u({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(d,f){return function(){var h=f.segmentLoaders[d],s=f.mediaTypes[d];Be.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),ho(h,s);var u=s.activeTrack();u&&(u.mode="disabled"),s.onTrackChanged()}}},cg={AUDIO:function(d,f,h){if(f){var s=h.tech,u=h.requestOptions,m=h.segmentLoaders[d];f.on("loadedmetadata",function(){var T=f.media();m.playlist(T,u),(!s.paused()||T.endList&&"none"!==s.preload())&&m.load()}),f.on("loadedplaylist",function(){m.playlist(f.media(),u),s.paused()||m.load()}),f.on("error",Ud[d](d,h))}},SUBTITLES:function(d,f,h){var s=h.tech,u=h.requestOptions,m=h.segmentLoaders[d],T=h.mediaTypes[d];f.on("loadedmetadata",function(){var S=f.media();m.playlist(S,u),m.track(T.activeTrack()),(!s.paused()||S.endList&&"none"!==s.preload())&&m.load()}),f.on("loadedplaylist",function(){m.playlist(f.media(),u),s.paused()||m.load()}),f.on("error",Ud[d](d,h))}},yl={AUDIO:function(d,f){var h=f.vhs,s=f.sourceType,u=f.segmentLoaders[d],m=f.requestOptions,T=f.master.mediaGroups,S=f.mediaTypes[d],D=S.groups,P=S.tracks,W=S.logger_,H=f.masterPlaylistLoader,te=kh(H.master);for(var le in(!T[d]||0===Object.keys(T[d]).length)&&(T[d]={main:{default:{default:!0}}},te&&(T[d].main.default.playlists=H.master.playlists)),T[d])for(var ce in D[le]||(D[le]=[]),T[d][le]){var fe=T[d][le][ce],ue=void 0;if(te?(W("AUDIO group '"+le+"' label '"+ce+"' is a master playlist"),fe.isMasterPlaylist=!0,ue=null):ue="vhs-json"===s&&fe.playlists?new Zu(fe.playlists[0],h,m):fe.resolvedUri?new Zu(fe.resolvedUri,h,m):fe.playlists&&"dash"===s?new Gh(fe.playlists[0],h,m,H):null,fe=Be.mergeOptions({id:ce,playlistLoader:ue},fe),cg[d](d,fe.playlistLoader,f),D[le].push(fe),typeof P[ce]>"u"){var At=new Be.AudioTrack({id:ce,kind:ti(fe),enabled:!1,language:fe.language,default:fe.default,label:ce});P[ce]=At}}u.on("error",Ud[d](d,f))},SUBTITLES:function(d,f){var h=f.tech,s=f.vhs,u=f.sourceType,m=f.segmentLoaders[d],T=f.requestOptions,S=f.master.mediaGroups,D=f.mediaTypes[d],P=D.groups,W=D.tracks,H=f.masterPlaylistLoader;for(var te in S[d])for(var le in P[te]||(P[te]=[]),S[d][te])if(!S[d][te][le].forced){var ce=S[d][te][le],fe=void 0;if("hls"===u)fe=new Zu(ce.resolvedUri,s,T);else if("dash"===u){if(!ce.playlists.filter(function(sn){return sn.excludeUntil!==1/0}).length)return;fe=new Gh(ce.playlists[0],s,T,H)}else"vhs-json"===u&&(fe=new Zu(ce.playlists?ce.playlists[0]:ce.resolvedUri,s,T));if(ce=Be.mergeOptions({id:le,playlistLoader:fe},ce),cg[d](d,ce.playlistLoader,f),P[te].push(ce),typeof W[le]>"u"){var At=h.addRemoteTextTrack({id:le,kind:"subtitles",default:ce.default&&ce.autoselect,language:ce.language,label:le},!1).track;W[le]=At}}m.on("error",Ud[d](d,f))},"CLOSED-CAPTIONS":function(d,f){var h=f.tech,s=f.master.mediaGroups,u=f.mediaTypes[d],m=u.groups,T=u.tracks;for(var S in s[d])for(var D in m[S]||(m[S]=[]),s[d][S]){var P=s[d][S][D];if(/^(?:CC|SERVICE)/.test(P.instreamId)){var W=h.options_.vhs&&h.options_.vhs.captionServices||{},H={label:D,language:P.language,instreamId:P.instreamId,default:P.default&&P.autoselect};if(W[H.instreamId]&&(H=Be.mergeOptions(H,W[H.instreamId])),void 0===H.default&&delete H.default,m[S].push(Be.mergeOptions({id:D},P)),typeof T[D]>"u"){var te=h.addRemoteTextTrack({id:H.instreamId,kind:"captions",default:H.default,language:H.language,label:H.label},!1).track;T[D]=te}}}}},z0=function b(d,f){for(var h=0;h<d.length;h++)if(Cd(f,d[h])||d[h].playlists&&b(d[h].playlists,f))return!0;return!1},Wl={AUDIO:function(d,f){return function(){var h=f.mediaTypes[d].tracks;for(var s in h)if(h[s].enabled)return h[s];return null}},SUBTITLES:function(d,f){return function(){var h=f.mediaTypes[d].tracks;for(var s in h)if("showing"===h[s].mode||"hidden"===h[s].mode)return h[s];return null}}},Pb=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],nf=function(d){return this.audioSegmentLoader_[d]+this.mainSegmentLoader_[d]},uc=function(b){function d(h){var s;s=b.call(this)||this;var u=h.src,m=h.handleManifestRedirects,T=h.withCredentials,S=h.tech,D=h.bandwidth,P=h.externVhs,W=h.useCueTags,H=h.blacklistDuration,te=h.enableLowInitialPlaylist,le=h.sourceType,ce=h.cacheEncryptionKeys,fe=h.experimentalBufferBasedABR,ue=h.experimentalLeastPixelDiffSelector,At=h.captionServices;if(!u)throw new Error("A non-empty playlist URL or JSON manifest string is required");var sn=h.maxPlaylistRetries;(null===sn||typeof sn>"u")&&(sn=1/0),lc=P,s.experimentalBufferBasedABR=Boolean(fe),s.experimentalLeastPixelDiffSelector=Boolean(ue),s.withCredentials=T,s.tech_=S,s.vhs_=S.vhs,s.sourceType_=le,s.useCueTags_=W,s.blacklistDuration=H,s.maxPlaylistRetries=sn,s.enableLowInitialPlaylist=te,s.useCueTags_&&(s.cueTagsTrack_=s.tech_.addTextTrack("metadata","ad-cues"),s.cueTagsTrack_.inBandMetadataTrackDispatchType=""),s.requestOptions_={withCredentials:T,handleManifestRedirects:m,maxPlaylistRetries:sn,timeout:null},s.on("error",s.pauseLoading),s.mediaTypes_=function(){var d={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(f){d[f]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:ps,activeTrack:ps,getActiveGroup:ps,onGroupChanged:ps,onTrackChanged:ps,lastTrack_:null,logger_:ml("MediaGroups["+f+"]")}}),d}(),s.mediaSource=new(se().MediaSource),s.handleDurationChange_=s.handleDurationChange_.bind(gt(s)),s.handleSourceOpen_=s.handleSourceOpen_.bind(gt(s)),s.handleSourceEnded_=s.handleSourceEnded_.bind(gt(s)),s.mediaSource.addEventListener("durationchange",s.handleDurationChange_),s.mediaSource.addEventListener("sourceopen",s.handleSourceOpen_),s.mediaSource.addEventListener("sourceended",s.handleSourceEnded_),s.seekable_=Be.createTimeRanges(),s.hasPlayed_=!1,s.syncController_=new ef(h),s.segmentMetadataTrack_=S.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,s.decrypter_=new ug,s.sourceUpdater_=new zc(s.mediaSource),s.inbandTextTracks_={},s.timelineChangeController_=new Bd;var rt={vhs:s.vhs_,parse708captions:h.parse708captions,useDtsForTimestampOffset:h.useDtsForTimestampOffset,captionServices:At,mediaSource:s.mediaSource,currentTime:s.tech_.currentTime.bind(s.tech_),seekable:function(){return s.seekable()},seeking:function(){return s.tech_.seeking()},duration:function(){return s.duration()},hasPlayed:function(){return s.hasPlayed_},goalBufferLength:function(){return s.goalBufferLength()},bandwidth:D,syncController:s.syncController_,decrypter:s.decrypter_,sourceType:s.sourceType_,inbandTextTracks:s.inbandTextTracks_,cacheEncryptionKeys:ce,sourceUpdater:s.sourceUpdater_,timelineChangeController:s.timelineChangeController_,experimentalExactManifestTimings:h.experimentalExactManifestTimings};s.masterPlaylistLoader_="dash"===s.sourceType_?new Gh(u,s.vhs_,s.requestOptions_):new Zu(u,s.vhs_,s.requestOptions_),s.setupMasterPlaylistLoaderListeners_(),s.mainSegmentLoader_=new _p(Be.mergeOptions(rt,{segmentMetadataTrack:s.segmentMetadataTrack_,loaderType:"main"}),h),s.audioSegmentLoader_=new _p(Be.mergeOptions(rt,{loaderType:"audio"}),h),s.subtitleSegmentLoader_=new Mr(Be.mergeOptions(rt,{loaderType:"vtt",featuresNativeTextTracks:s.tech_.featuresNativeTextTracks}),h),s.setupSegmentLoaderListeners_(),s.experimentalBufferBasedABR&&(s.masterPlaylistLoader_.one("loadedplaylist",function(){return s.startABRTimer_()}),s.tech_.on("pause",function(){return s.stopABRTimer_()}),s.tech_.on("play",function(){return s.startABRTimer_()})),Pb.forEach(function(Ft){s[Ft+"_"]=nf.bind(gt(s),Ft)}),s.logger_=ml("MPC"),s.triggeredFmp4Usage=!1,"none"===s.tech_.preload()?(s.loadOnPlay_=function(){s.loadOnPlay_=null,s.masterPlaylistLoader_.load()},s.tech_.one("play",s.loadOnPlay_)):s.masterPlaylistLoader_.load(),s.timeToLoadedData__=-1,s.mainAppendsToLoadedData__=-1,s.audioAppendsToLoadedData__=-1;var et="none"===s.tech_.preload()?"play":"loadstart";return s.tech_.one(et,function(){var Ft=Date.now();s.tech_.one("loadeddata",function(){s.timeToLoadedData__=Date.now()-Ft,s.mainAppendsToLoadedData__=s.mainSegmentLoader_.mediaAppends,s.audioAppendsToLoadedData__=s.audioSegmentLoader_.mediaAppends})}),s}ze(d,b);var f=d.prototype;return f.mainAppendsToLoadedData_=function(){return this.mainAppendsToLoadedData__},f.audioAppendsToLoadedData_=function(){return this.audioAppendsToLoadedData__},f.appendsToLoadedData_=function(){var s=this.mainAppendsToLoadedData_(),u=this.audioAppendsToLoadedData_();return-1===s||-1===u?-1:s+u},f.timeToLoadedData_=function(){return this.timeToLoadedData__},f.checkABR_=function(){var s=this.selectPlaylist();s&&this.shouldSwitchToMedia_(s)&&this.switchMedia_(s,"abr")},f.switchMedia_=function(s,u,m){var T=this.media(),S=T&&(T.id||T.uri),D=s.id||s.uri;S&&S!==D&&(this.logger_("switch media "+S+" -> "+D+" from "+u),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+u})),this.masterPlaylistLoader_.media(s,m)},f.startABRTimer_=function(){var s=this;this.stopABRTimer_(),this.abrTimer_=se().setInterval(function(){return s.checkABR_()},250)},f.stopABRTimer_=function(){this.tech_.scrubbing&&this.tech_.scrubbing()||(se().clearInterval(this.abrTimer_),this.abrTimer_=null)},f.getAudioTrackPlaylists_=function(){var s=this.master(),u=s&&s.playlists||[];if(!s||!s.mediaGroups||!s.mediaGroups.AUDIO)return u;var S,m=s.mediaGroups.AUDIO,T=Object.keys(m);if(Object.keys(this.mediaTypes_.AUDIO.groups).length)S=this.mediaTypes_.AUDIO.activeTrack();else{var D=m.main||T.length&&m[T[0]];for(var P in D)if(D[P].default){S={label:P};break}}if(!S)return u;var W=[];for(var H in m)if(m[H][S.label]){var te=m[H][S.label];if(te.playlists&&te.playlists.length)W.push.apply(W,te.playlists);else if(te.uri)W.push(te);else if(s.playlists.length)for(var le=0;le<s.playlists.length;le++){var ce=s.playlists[le];ce.attributes&&ce.attributes.AUDIO&&ce.attributes.AUDIO===H&&W.push(ce)}}return W.length?W:u},f.setupMasterPlaylistLoaderListeners_=function(){var s=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var u=s.masterPlaylistLoader_.media(),m=1.5*u.targetDuration*1e3;s.requestOptions_.timeout=A0(s.masterPlaylistLoader_.master,s.masterPlaylistLoader_.media())?0:m,u.endList&&"none"!==s.tech_.preload()&&(s.mainSegmentLoader_.playlist(u,s.requestOptions_),s.mainSegmentLoader_.load()),function(d){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(le){yl[le](le,d)});var f=d.mediaTypes,h=d.masterPlaylistLoader,s=d.tech,u=d.vhs,m=d.segmentLoaders,T=m.AUDIO,S=m.main;["AUDIO","SUBTITLES"].forEach(function(le){f[le].activeGroup=function(d,f){return function(h){var u=f.mediaTypes[d].groups,m=f.masterPlaylistLoader.media();if(!m)return null;var T=null;m.attributes[d]&&(T=u[m.attributes[d]]);var S=Object.keys(u);if(!T)if("AUDIO"===d&&S.length>1&&kh(f.master))for(var D=0;D<S.length;D++){var P=u[S[D]];if(z0(P,m)){T=P;break}}else u.main?T=u.main:1===S.length&&(T=u[S[0]]);return typeof h>"u"?T:null!==h&&T&&T.filter(function(W){return W.id===h.id})[0]||null}}(le,d),f[le].activeTrack=Wl[le](le,d),f[le].onGroupChanged=function(d,f){return function(){var h=f.segmentLoaders,s=h[d],u=h.main,m=f.mediaTypes[d],T=m.activeTrack(),S=m.getActiveGroup(),D=m.activePlaylistLoader,P=m.lastGroup_;if((!S||!P||S.id!==P.id)&&(m.lastGroup_=S,m.lastTrack_=T,ho(s,m),S&&!S.isMasterPlaylist)){if(!S.playlistLoader)return void(D&&u.resetEverything());s.resyncLoader(),Wc(S.playlistLoader,m)}}}(le,d),f[le].onGroupChanging=function(d,f){return function(){var h=f.segmentLoaders[d];f.mediaTypes[d].lastGroup_=null,h.abort(),h.pause()}}(le,d),f[le].onTrackChanged=function(d,f){return function(){var h=f.masterPlaylistLoader,s=f.segmentLoaders,u=s[d],m=s.main,T=f.mediaTypes[d],S=T.activeTrack(),D=T.getActiveGroup(),P=T.activePlaylistLoader,W=T.lastTrack_;if((!W||!S||W.id!==S.id)&&(T.lastGroup_=D,T.lastTrack_=S,ho(u,T),D)){if(D.isMasterPlaylist){if(!S||!W||S.id===W.id)return;var H=f.vhs.masterPlaylistController_,te=H.selectPlaylist();if(H.media()===te)return;return T.logger_("track change. Switching master audio from "+W.id+" to "+S.id),h.pause(),m.resetEverything(),void H.fastQualityChange_(te)}if("AUDIO"===d){if(!D.playlistLoader)return m.setAudio(!0),void m.resetEverything();u.setAudio(!0),m.setAudio(!1)}if(P===D.playlistLoader)return void Wc(D.playlistLoader,T);u.track&&u.track(S),u.resetEverything(),Wc(D.playlistLoader,T)}}}(le,d),f[le].getActiveGroup=function(d,f){var h=f.mediaTypes;return function(){var s=h[d].activeTrack();return s?h[d].activeGroup(s):null}}(le,d)});var D=f.AUDIO.activeGroup();if(D){var P=(D.filter(function(le){return le.default})[0]||D[0]).id;f.AUDIO.tracks[P].enabled=!0,f.AUDIO.onGroupChanged(),f.AUDIO.onTrackChanged(),f.AUDIO.getActiveGroup().playlistLoader?(S.setAudio(!1),T.setAudio(!0)):S.setAudio(!0)}h.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(le){return f[le].onGroupChanged()})}),h.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(le){return f[le].onGroupChanging()})});var H=function(){f.AUDIO.onTrackChanged(),s.trigger({type:"usage",name:"vhs-audio-change"}),s.trigger({type:"usage",name:"hls-audio-change"})};for(var te in s.audioTracks().addEventListener("change",H),s.remoteTextTracks().addEventListener("change",f.SUBTITLES.onTrackChanged),u.on("dispose",function(){s.audioTracks().removeEventListener("change",H),s.remoteTextTracks().removeEventListener("change",f.SUBTITLES.onTrackChanged)}),s.clearTracks("audio"),f.AUDIO.tracks)s.audioTracks().addTrack(f.AUDIO.tracks[te])}({sourceType:s.sourceType_,segmentLoaders:{AUDIO:s.audioSegmentLoader_,SUBTITLES:s.subtitleSegmentLoader_,main:s.mainSegmentLoader_},tech:s.tech_,requestOptions:s.requestOptions_,masterPlaylistLoader:s.masterPlaylistLoader_,vhs:s.vhs_,master:s.master(),mediaTypes:s.mediaTypes_,blacklistCurrentPlaylist:s.blacklistCurrentPlaylist.bind(s)}),s.triggerPresenceUsage_(s.master(),u),s.setupFirstPlay(),!s.mediaTypes_.AUDIO.activePlaylistLoader||s.mediaTypes_.AUDIO.activePlaylistLoader.media()?s.trigger("selectedinitialmedia"):s.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){s.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){s.loadOnPlay_&&s.tech_.off("play",s.loadOnPlay_);var u=s.masterPlaylistLoader_.media();if(!u){var m;if(s.excludeUnsupportedVariants_(),s.enableLowInitialPlaylist&&(m=s.selectInitialPlaylist()),m||(m=s.selectPlaylist()),!m||!s.shouldSwitchToMedia_(m))return;if(s.initialMedia_=m,s.switchMedia_(s.initialMedia_,"initial"),"vhs-json"!==s.sourceType_||!s.initialMedia_.segments)return;u=s.initialMedia_}s.handleUpdatedMediaPlaylist(u)}),this.masterPlaylistLoader_.on("error",function(){s.blacklistCurrentPlaylist(s.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){s.mainSegmentLoader_.abort(),s.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var u=s.masterPlaylistLoader_.media(),m=1.5*u.targetDuration*1e3;s.requestOptions_.timeout=A0(s.masterPlaylistLoader_.master,s.masterPlaylistLoader_.media())?0:m,s.mainSegmentLoader_.playlist(u,s.requestOptions_),s.mainSegmentLoader_.load(),s.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var u=s.masterPlaylistLoader_.media();"playlist-unchanged"!==u.lastExcludeReason_&&s.stuckAtPlaylistEnd_(u)&&(s.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"}),s.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){s.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),s.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){s.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),s.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},f.handleUpdatedMediaPlaylist=function(s){this.useCueTags_&&this.updateAdCues_(s),this.mainSegmentLoader_.playlist(s,this.requestOptions_),this.updateDuration(!s.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},f.triggerPresenceUsage_=function(s,u){var m=s.mediaGroups||{},T=!0,S=Object.keys(m.AUDIO);for(var D in m.AUDIO)for(var P in m.AUDIO[D])m.AUDIO[D][P].uri||(T=!1);T&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(m.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),lc.Playlist.isAes(u)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),S.length&&Object.keys(m.AUDIO[S[0]]).length>1&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},f.shouldSwitchToMedia_=function(s){var u=this.masterPlaylistLoader_.media()||this.masterPlaylistLoader_.pendingMedia_,m=this.tech_.currentTime(),T=this.bufferLowWaterLine(),S=this.bufferHighWaterLine();return function(d){var f=d.currentPlaylist,h=d.buffered,s=d.currentTime,u=d.nextPlaylist,m=d.bufferLowWaterLine,T=d.bufferHighWaterLine,S=d.duration,D=d.experimentalBufferBasedABR,P=d.log;if(!u)return Be.log.warn("We received no playlist to switch to. Please check your stream."),!1;var W="allowing switch "+(f&&f.id||"null")+" -> "+u.id;if(!f)return P(W+" as current playlist is not set"),!0;if(u.id===f.id)return!1;var H=Boolean(Ed(h,s).length);if(!f.endList)return H||"number"!=typeof f.partTargetDuration?(P(W+" as current playlist is live"),!0):(P("not "+W+" as current playlist is live llhls, but currentTime isn't in buffered."),!1);var te=Lh(h,s),le=D?Sa.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Sa.MAX_BUFFER_LOW_WATER_LINE;if(S<le)return P(W+" as duration < max low water line ("+S+" < "+le+")"),!0;var ce=u.attributes.BANDWIDTH,fe=f.attributes.BANDWIDTH;if(ce<fe&&(!D||te<T)){var ue=W+" as next bandwidth < current bandwidth ("+ce+" < "+fe+")";return D&&(ue+=" and forwardBuffer < bufferHighWaterLine ("+te+" < "+T+")"),P(ue),!0}if((!D||ce>fe)&&te>=m){var At=W+" as forwardBuffer >= bufferLowWaterLine ("+te+" >= "+m+")";return D&&(At+=" and next bandwidth > current bandwidth ("+ce+" > "+fe+")"),P(At),!0}return P("not "+W+" as no switching criteria met"),!1}({buffered:this.tech_.buffered(),currentTime:m,currentPlaylist:u,nextPlaylist:s,bufferLowWaterLine:T,bufferHighWaterLine:S,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})},f.setupSegmentLoaderListeners_=function(){var s=this;this.experimentalBufferBasedABR||(this.mainSegmentLoader_.on("bandwidthupdate",function(){var m=s.selectPlaylist();s.shouldSwitchToMedia_(m)&&s.switchMedia_(m,"bandwidthupdate"),s.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){s.trigger("progress")})),this.mainSegmentLoader_.on("error",function(){s.blacklistCurrentPlaylist(s.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("appenderror",function(){s.error=s.mainSegmentLoader_.error_,s.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",function(){s.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){s.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),s.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){s.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",function(){s.error=s.audioSegmentLoader_.error_,s.trigger("error")}),this.mainSegmentLoader_.on("ended",function(){s.logger_("main segment loader ended"),s.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(m){s.experimentalBufferBasedABR||(s.delegateLoaders_("all",["abort"]),s.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120))});var u=function(){if(!s.sourceUpdater_.hasCreatedSourceBuffers())return s.tryToCreateSourceBuffers_();var T=s.getCodecsOrExclude_();!T||s.sourceUpdater_.addOrChangeSourceBuffers(T)};this.mainSegmentLoader_.on("trackinfo",u),this.audioSegmentLoader_.on("trackinfo",u),this.mainSegmentLoader_.on("fmp4",function(){s.triggeredFmp4Usage||(s.tech_.trigger({type:"usage",name:"vhs-fmp4"}),s.tech_.trigger({type:"usage",name:"hls-fmp4"}),s.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",function(){s.triggeredFmp4Usage||(s.tech_.trigger({type:"usage",name:"vhs-fmp4"}),s.tech_.trigger({type:"usage",name:"hls-fmp4"}),s.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",function(){s.logger_("audioSegmentLoader ended"),s.onEndOfStream()})},f.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},f.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},f.smoothQualityChange_=function(s){void 0===s&&(s=this.selectPlaylist()),this.fastQualityChange_(s)},f.fastQualityChange_=function(s){var u=this;void 0===s&&(s=this.selectPlaylist()),s!==this.masterPlaylistLoader_.media()?(this.switchMedia_(s,"fast-quality"),this.mainSegmentLoader_.resetEverything(function(){u.tech_.setCurrentTime(Be.browser.IE_VERSION||Be.browser.IS_EDGE?u.tech_.currentTime()+.04:u.tech_.currentTime())})):this.logger_("skipping fastQualityChange because new media is same as old")},f.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var s=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<s.start(0))return this.tech_.setCurrentTime(s.end(s.length-1))}},f.setupFirstPlay=function(){var s=this,u=this.masterPlaylistLoader_.media();if(!u||this.tech_.paused()||this.hasPlayed_)return!1;if(!u.endList){var m=this.seekable();if(!m.length)return!1;if(Be.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){s.trigger("firstplay"),s.tech_.setCurrentTime(m.end(0)),s.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(m.end(0))}return this.hasPlayed_=!0,this.load(),!0},f.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var s=this.tech_.play();typeof s<"u"&&"function"==typeof s.then&&s.then(null,function(u){})}this.trigger("sourceopen")},f.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var s=this.inbandTextTracks_.metadataTrack_.cues;if(s&&s.length){var u=this.duration();s[s.length-1].endTime=isNaN(u)||Math.abs(u)===1/0?Number.MAX_VALUE:u}}},f.handleDurationChange_=function(){this.tech_.trigger("durationchange")},f.onEndOfStream=function(){var s=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var u=this.mainSegmentLoader_.getCurrentMediaInfo_();s=!u||u.hasVideo?s&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_}!s||(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},f.stuckAtPlaylistEnd_=function(s){if(!this.seekable().length)return!1;var m=this.syncController_.getExpiredTime(s,this.duration());if(null===m)return!1;var T=lc.Playlist.playlistEnd(s,m),S=this.tech_.currentTime(),D=this.tech_.buffered();if(!D.length)return T-S<=oo;var P=D.end(D.length-1);return P-S<=oo&&T-P<=oo},f.blacklistCurrentPlaylist=function(s,u){void 0===s&&(s={});var m=s.playlist||this.masterPlaylistLoader_.media();if(u=u||s.blacklistDuration||this.blacklistDuration,!m)return this.error=s,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));m.playlistErrors_++;var W,T=this.masterPlaylistLoader_.master.playlists,S=T.filter(Wm),D=1===S.length&&S[0]===m;if(1===T.length&&u!==1/0)return Be.log.warn("Problem encountered with playlist "+m.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(D);if(D){var P=!1;T.forEach(function(ue){if(ue!==m){var At=ue.excludeUntil;typeof At<"u"&&At!==1/0&&(P=!0,delete ue.excludeUntil)}}),P&&(Be.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}W=m.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*u,m.excludeUntil=W,s.reason&&(m.lastExcludeReason_=s.reason),this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var H=this.selectPlaylist();if(!H)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");(s.internal?this.logger_:Be.log.warn)((s.internal?"Internal problem":"Problem")+" encountered with playlist "+m.id+"."+(s.message?" "+s.message:"")+" Switching to playlist "+H.id+"."),H.attributes.AUDIO!==m.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),H.attributes.SUBTITLES!==m.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var ce=H.targetDuration/2*1e3||5e3,fe="number"==typeof H.lastRequest&&Date.now()-H.lastRequest<=ce;return this.switchMedia_(H,"exclude",D||fe)},f.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()},f.delegateLoaders_=function(s,u){var m=this,T=[],S="all"===s;(S||"main"===s)&&T.push(this.masterPlaylistLoader_);var D=[];(S||"audio"===s)&&D.push("AUDIO"),(S||"subtitle"===s)&&(D.push("CLOSED-CAPTIONS"),D.push("SUBTITLES")),D.forEach(function(P){var W=m.mediaTypes_[P]&&m.mediaTypes_[P].activePlaylistLoader;W&&T.push(W)}),["main","audio","subtitle"].forEach(function(P){var W=m[P+"SegmentLoader_"];W&&(s===P||"all"===s)&&T.push(W)}),T.forEach(function(P){return u.forEach(function(W){"function"==typeof P[W]&&P[W]()})})},f.setCurrentTime=function(s){var u=Ed(this.tech_.buffered(),s);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?u&&u.length?s:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0},f.duration=function(){if(!this.masterPlaylistLoader_)return 0;var s=this.masterPlaylistLoader_.media();return s?s.endList?this.mediaSource?this.mediaSource.duration:lc.Playlist.duration(s):1/0:0},f.seekable=function(){return this.seekable_},f.onSyncInfoUpdate_=function(){var s;if(this.masterPlaylistLoader_){var u=this.masterPlaylistLoader_.media();if(u){var m=this.syncController_.getExpiredTime(u,this.duration());if(null!==m){var D,P,T=this.masterPlaylistLoader_.master,S=lc.Playlist.seekable(u,m,lc.Playlist.liveEdgeDelay(T,u));0===S.length||this.mediaTypes_.AUDIO.activePlaylistLoader&&(u=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(m=this.syncController_.getExpiredTime(u,this.duration()))||0===(s=lc.Playlist.seekable(u,m,lc.Playlist.liveEdgeDelay(T,u))).length)||(this.seekable_&&this.seekable_.length&&(D=this.seekable_.end(0),P=this.seekable_.start(0)),this.seekable_=s?s.start(0)>S.end(0)||S.start(0)>s.end(0)?S:Be.createTimeRanges([[s.start(0)>S.start(0)?s.start(0):S.start(0),s.end(0)<S.end(0)?s.end(0):S.end(0)]]):S,(!this.seekable_||!this.seekable_.length||this.seekable_.end(0)!==D||this.seekable_.start(0)!==P)&&(this.logger_("seekable updated ["+fb(this.seekable_)+"]"),this.tech_.trigger("seekablechanged")))}}}},f.updateDuration=function(s){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,s),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(s){var u=this.seekable();if(!u.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<u.end(u.length-1))&&this.sourceUpdater_.setDuration(u.end(u.length-1))}else{var m=this.tech_.buffered(),T=lc.Playlist.duration(this.masterPlaylistLoader_.media());m.length>0&&(T=Math.max(T,m.end(m.length-1))),this.mediaSource.duration!==T&&this.sourceUpdater_.setDuration(T)}},f.dispose=function(){var s=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(function(u){var m=s.mediaTypes_[u].groups;for(var T in m)m[T].forEach(function(S){S.playlistLoader&&S.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},f.master=function(){return this.masterPlaylistLoader_.master},f.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},f.areMediaTypesKnown_=function(){var s=!!this.mediaTypes_.AUDIO.activePlaylistLoader,u=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),m=!s||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return!(!u||!m)},f.getCodecsOrExclude_=function(){var s=this,u={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}};u.video=u.main;var m=fp(this.master(),this.media()),T={},S=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(u.main.hasVideo&&(T.video=m.video||u.main.videoCodec||"avc1.4d400d"),u.main.isMuxed&&(T.video+=","+(m.audio||u.main.audioCodec||ul)),(u.main.hasAudio&&!u.main.isMuxed||u.audio.hasAudio||S)&&(T.audio=m.audio||u.main.audioCodec||u.audio.audioCodec||ul,u.audio.isFmp4=u.main.hasAudio&&!u.main.isMuxed?u.main.isFmp4:u.audio.isFmp4),T.audio||T.video){var W,P={};if(["video","audio"].forEach(function(ce){if(T.hasOwnProperty(ce)&&!function(fe,ue){return fe?Tc(ue):Ns(ue)}(u[ce].isFmp4,T[ce])){var fe=u[ce].isFmp4?"browser":"muxer";P[fe]=P[fe]||[],P[fe].push(T[ce]),"audio"===ce&&(W=fe)}}),S&&W&&this.media().attributes.AUDIO){var H=this.media().attributes.AUDIO;this.master().playlists.forEach(function(ce){(ce.attributes&&ce.attributes.AUDIO)===H&&ce!==s.media()&&(ce.excludeUntil=1/0)}),this.logger_("excluding audio group "+H+" as "+W+' does not support codec(s): "'+T.audio+'"')}if(!Object.keys(P).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var le=[];if(["video","audio"].forEach(function(ce){var fe=(hn(s.sourceUpdater_.codecs[ce]||"")[0]||{}).type,ue=(hn(T[ce]||"")[0]||{}).type;fe&&ue&&fe.toLowerCase()!==ue.toLowerCase()&&le.push('"'+s.sourceUpdater_.codecs[ce]+'" -> "'+T[ce]+'"')}),le.length)return void this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+le.join(", ")+".",blacklistDuration:1/0,internal:!0})}return T}var te=Object.keys(P).reduce(function(ce,fe){return ce&&(ce+=", "),ce+(fe+' does not support codec(s): "')+P[fe].join(",")+'"'},"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:!0,message:te,blacklistDuration:1/0})}else this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:1/0})},f.tryToCreateSourceBuffers_=function(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.hasCreatedSourceBuffers()&&this.areMediaTypesKnown_()){var s=this.getCodecsOrExclude_();if(s){this.sourceUpdater_.createSourceBuffers(s);var u=[s.video,s.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(u)}}},f.excludeUnsupportedVariants_=function(){var s=this,u=this.master().playlists,m=[];Object.keys(u).forEach(function(T){var S=u[T];if(-1===m.indexOf(S.id)){m.push(S.id);var D=fp(s.master,S),P=[];D.audio&&!Ns(D.audio)&&!Tc(D.audio)&&P.push("audio codec "+D.audio),D.video&&!Ns(D.video)&&!Tc(D.video)&&P.push("video codec "+D.video),D.text&&"stpp.ttml.im1t"===D.text&&P.push("text codec "+D.text),P.length&&(S.excludeUntil=1/0,s.logger_("excluding "+S.id+" for unsupported: "+P.join(", ")))}})},f.excludeIncompatibleVariants_=function(s){var u=this,m=[],T=this.master().playlists,S=ig(hn(s)),D=tc(S),P=S.video&&hn(S.video)[0]||null,W=S.audio&&hn(S.audio)[0]||null;Object.keys(T).forEach(function(H){var te=T[H];if(-1===m.indexOf(te.id)&&te.excludeUntil!==1/0){m.push(te.id);var le=[],ce=fp(u.masterPlaylistLoader_.master,te),fe=tc(ce);if(ce.audio||ce.video){if(fe!==D&&le.push('codec count "'+fe+'" !== "'+D+'"'),!u.sourceUpdater_.canChangeType()){var ue=ce.video&&hn(ce.video)[0]||null,At=ce.audio&&hn(ce.audio)[0]||null;ue&&P&&ue.type.toLowerCase()!==P.type.toLowerCase()&&le.push('video codec "'+ue.type+'" !== "'+P.type+'"'),At&&W&&At.type.toLowerCase()!==W.type.toLowerCase()&&le.push('audio codec "'+At.type+'" !== "'+W.type+'"')}le.length&&(te.excludeUntil=1/0,u.logger_("blacklisting "+te.id+": "+le.join(" && ")))}}})},f.updateAdCues_=function(s){var u=0,m=this.seekable();m.length&&(u=m.start(0)),function(d,f,h){if(void 0===h&&(h=0),d.segments)for(var u,s=h,m=0;m<d.segments.length;m++){var T=d.segments[m];if(u||(u=Io(f,s+T.duration/2)),u){if("cueIn"in T){u.endTime=s,u.adEndTime=s,s+=T.duration,u=null;continue}if(s<u.endTime){s+=T.duration;continue}u.endTime+=T.duration}else if("cueOut"in T&&((u=new(se().VTTCue)(s,s+T.duration,T.cueOut)).adStartTime=s,u.adEndTime=s+parseFloat(T.cueOut),f.addCue(u)),"cueOutCont"in T){var S=T.cueOutCont.split("/").map(parseFloat),D=S[0],P=S[1];(u=new(se().VTTCue)(s,s+T.duration,"")).adStartTime=s-D,u.adEndTime=u.adStartTime+P,f.addCue(u)}s+=T.duration}}(s,this.cueTagsTrack_,u)},f.goalBufferLength=function(){var s=this.tech_.currentTime(),u=Sa.GOAL_BUFFER_LENGTH,m=Sa.GOAL_BUFFER_LENGTH_RATE,T=Math.max(u,Sa.MAX_GOAL_BUFFER_LENGTH);return Math.min(u+s*m,T)},f.bufferLowWaterLine=function(){var s=this.tech_.currentTime(),u=Sa.BUFFER_LOW_WATER_LINE,m=Sa.BUFFER_LOW_WATER_LINE_RATE,T=Math.max(u,Sa.MAX_BUFFER_LOW_WATER_LINE),S=Math.max(u,Sa.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(u+s*m,this.experimentalBufferBasedABR?S:T)},f.bufferHighWaterLine=function(){return Sa.BUFFER_HIGH_WATER_LINE},d}(Be.EventTarget),ii=function(d,f,h){var s=d.masterPlaylistController_,T=s[(d.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(s);if(f.attributes){var S=f.attributes.RESOLUTION;this.width=S&&S.width,this.height=S&&S.height,this.bandwidth=f.attributes.BANDWIDTH}this.codecs=fp(s.master(),f),this.playlist=f,this.id=h,this.enabled=function(d,f,h){return function(s){var u=d.master.playlists[f],m=Rv(u),T=Wm(u);return typeof s>"u"?T:(s?delete u.disabled:u.disabled=!0,s!==T&&!m&&(h(),d.trigger(s?"renditionenabled":"renditiondisabled")),s)}}(d.playlists,f.id,T)},$l=["seeking","seeked","pause","playing","error"],ql=function(){function b(f){var h=this;this.masterPlaylistController_=f.masterPlaylistController,this.tech_=f.tech,this.seekable=f.seekable,this.allowSeeksWithinUnsafeLiveWindow=f.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=f.liveRangeSafeTimeDelta,this.media=f.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=ml("PlaybackWatcher"),this.logger_("initialize");var s=function(){return h.monitorCurrentTime_()},u=function(){return h.monitorCurrentTime_()},m=function(){return h.techWaiting_()},T=function(){return h.cancelTimer_()},S=this.masterPlaylistController_,D=["main","subtitle","audio"],P={};D.forEach(function(H){P[H]={reset:function(){return h.resetSegmentDownloads_(H)},updateend:function(){return h.checkSegmentDownloads_(H)}},S[H+"SegmentLoader_"].on("appendsdone",P[H].updateend),S[H+"SegmentLoader_"].on("playlistupdate",P[H].reset),h.tech_.on(["seeked","seeking"],P[H].reset)});var W=function(te){["main","audio"].forEach(function(le){S[le+"SegmentLoader_"][te]("appended",h.seekingAppendCheck_)})};this.seekingAppendCheck_=function(){h.fixesBadSeeks_()&&(h.consecutiveUpdates=0,h.lastRecordedTime=h.tech_.currentTime(),W("off"))},this.clearSeekingAppendCheck_=function(){return W("off")},this.watchForBadSeeking_=function(){h.clearSeekingAppendCheck_(),W("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",m),this.tech_.on($l,T),this.tech_.on("canplay",u),this.tech_.one("play",s),this.dispose=function(){h.clearSeekingAppendCheck_(),h.logger_("dispose"),h.tech_.off("waiting",m),h.tech_.off($l,T),h.tech_.off("canplay",u),h.tech_.off("play",s),h.tech_.off("seeking",h.watchForBadSeeking_),h.tech_.off("seeked",h.clearSeekingAppendCheck_),D.forEach(function(H){S[H+"SegmentLoader_"].off("appendsdone",P[H].updateend),S[H+"SegmentLoader_"].off("playlistupdate",P[H].reset),h.tech_.off(["seeked","seeking"],P[H].reset)}),h.checkCurrentTimeTimeout_&&se().clearTimeout(h.checkCurrentTimeTimeout_),h.cancelTimer_()}}var d=b.prototype;return d.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&se().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=se().setTimeout(this.monitorCurrentTime_.bind(this),250)},d.resetSegmentDownloads_=function(h){var s=this.masterPlaylistController_[h+"SegmentLoader_"];this[h+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+h+" loader"),this[h+"StalledDownloads_"]=0,this[h+"Buffered_"]=s.buffered_()},d.checkSegmentDownloads_=function(h){var s=this.masterPlaylistController_,u=s[h+"SegmentLoader_"],m=u.buffered_(),T=function(d,f){if(d===f)return!1;if(!d&&f||!f&&d||d.length!==f.length)return!0;for(var h=0;h<d.length;h++)if(d.start(h)!==f.start(h)||d.end(h)!==f.end(h))return!0;return!1}(this[h+"Buffered_"],m);this[h+"Buffered_"]=m,T?this.resetSegmentDownloads_(h):(this[h+"StalledDownloads_"]++,this.logger_("found #"+this[h+"StalledDownloads_"]+" "+h+" appends that did not increase buffer (possible stalled download)",{playlistId:u.playlist_&&u.playlist_.id,buffered:Ku(m)}),!(this[h+"StalledDownloads_"]<10)&&(this.logger_(h+" loader stalled download exclusion"),this.resetSegmentDownloads_(h),this.tech_.trigger({type:"usage",name:"vhs-"+h+"-download-exclusion"}),"subtitle"!==h&&s.blacklistCurrentPlaylist({message:"Excessive "+h+" segment downloading detected."},1/0)))},d.checkCurrentTime_=function(){if(!this.tech_.paused()&&!this.tech_.seeking()){var h=this.tech_.currentTime(),s=this.tech_.buffered();if(this.lastRecordedTime===h&&(!s.length||h+oo>=s.end(s.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&h===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):h===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=h)}},d.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},d.fixesBadSeeks_=function(){if(!this.tech_.seeking())return!1;var T,s=this.seekable(),u=this.tech_.currentTime();if(this.afterSeekableWindow_(s,u,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(T=s.end(s.length-1)),this.beforeSeekableWindow_(s,u)){var D=s.start(0);T=D+(D===s.end(0)?0:oo)}if(typeof T<"u")return this.logger_("Trying to seek outside of seekable at time "+u+" with seekable range "+fb(s)+". Seeking to "+T+"."),this.tech_.setCurrentTime(T),!0;for(var P=this.masterPlaylistController_.sourceUpdater_,W=this.tech_.buffered(),H=P.audioBuffer?P.audioBuffered():null,te=P.videoBuffer?P.videoBuffered():null,le=this.media(),ce=le.partTargetDuration?le.partTargetDuration:2*(le.targetDuration-_s),fe=[H,te],ue=0;ue<fe.length;ue++)if(fe[ue]&&Lh(fe[ue],u)<ce)return!1;var sn=Oh(W,u);return 0!==sn.length&&(T=sn.start(0)+oo,this.logger_("Buffered region starts ("+sn.start(0)+")  just beyond seek point ("+u+"). Seeking to "+T+"."),this.tech_.setCurrentTime(T),!0)},d.waiting_=function(){if(!this.techWaiting_()){var h=this.tech_.currentTime(),s=this.tech_.buffered(),u=Ed(s,h);if(u.length&&h+3<=u.end(0))return this.cancelTimer_(),this.tech_.setCurrentTime(h),this.logger_("Stopped at "+h+" while inside a buffered region ["+u.start(0)+" -> "+u.end(0)+"]. Attempting to resume playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})}},d.techWaiting_=function(){var h=this.seekable(),s=this.tech_.currentTime();if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(h,s)){var u=h.end(h.length-1);return this.logger_("Fell out of live window at time "+s+". Seeking to live point (seekable end) "+u),this.cancelTimer_(),this.tech_.setCurrentTime(u),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var m=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,T=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:m.audioBuffered(),videoBuffered:m.videoBuffered(),currentTime:s}))return this.cancelTimer_(),this.tech_.setCurrentTime(s),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var D=Oh(T,s);if(D.length>0){var P=D.start(0)-s;return this.logger_("Stopped at "+s+", setting timer for "+P+", seeking to "+D.start(0)),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*P,s),!0}return!1},d.afterSeekableWindow_=function(h,s,u,m){if(void 0===m&&(m=!1),!h.length)return!1;var T=h.end(h.length-1)+oo;return!u.endList&&m&&(T=h.end(h.length-1)+3*u.targetDuration),s>T},d.beforeSeekableWindow_=function(h,s){return!!(h.length&&h.start(0)>0&&s<h.start(0)-this.liveRangeSafeTimeDelta)},d.videoUnderflow_=function(h){var s=h.videoBuffered,u=h.audioBuffered,m=h.currentTime;if(s){var T;if(s.length&&u.length){var S=Ed(s,m-3),D=Ed(s,m),P=Ed(u,m);P.length&&!D.length&&S.length&&(T={start:S.end(0),end:P.end(0)})}else Oh(s,m).length||(T=this.gapFromVideoUnderflow_(s,m));return!!T&&(this.logger_("Encountered a gap in video from "+T.start+" to "+T.end+". Seeking to current time "+m),!0)}},d.skipTheGap_=function(h){var s=this.tech_.buffered(),u=this.tech_.currentTime(),m=Oh(s,u);this.cancelTimer_(),0!==m.length&&u===h&&(this.logger_("skipTheGap_:","currentTime:",u,"scheduled currentTime:",h,"nextRange start:",m.start(0)),this.tech_.setCurrentTime(m.start(0)+_s),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},d.gapFromVideoUnderflow_=function(h,s){for(var u=function(d){if(d.length<2)return Be.createTimeRanges();for(var f=[],h=1;h<d.length;h++){var s=d.end(h-1),u=d.start(h);f.push([s,u])}return Be.createTimeRanges(f)}(h),m=0;m<u.length;m++){var T=u.start(m),S=u.end(m);if(s-T<4&&s-T>2)return{start:T,end:S}}return null},b}(),Ob={errorInterval:30,getSource:function(d){return d(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},Vd=function b(d,f){var h=0,s=0,u=Be.mergeOptions(Ob,f);d.ready(function(){d.trigger({type:"usage",name:"vhs-error-reload-initialized"}),d.trigger({type:"usage",name:"hls-error-reload-initialized"})});var m=function(){s&&d.currentTime(s)},T=function(H){null!=H&&(s=d.duration()!==1/0&&d.currentTime()||0,d.one("loadedmetadata",m),d.src(H),d.trigger({type:"usage",name:"vhs-error-reload"}),d.trigger({type:"usage",name:"hls-error-reload"}),d.play())},S=function(){return Date.now()-h<1e3*u.errorInterval?(d.trigger({type:"usage",name:"vhs-error-reload-canceled"}),void d.trigger({type:"usage",name:"hls-error-reload-canceled"})):u.getSource&&"function"==typeof u.getSource?(h=Date.now(),u.getSource.call(d,T)):void Be.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")},D=function W(){d.off("loadedmetadata",m),d.off("error",S),d.off("dispose",W)};d.on("error",S),d.on("dispose",D),d.reloadSourceOnError=function(H){D(),b(d,H)}},pa={PlaylistLoader:Zu,Playlist:lo,utils:Nd,STANDARD_PLAYLIST_SELECTOR:Yv,INITIAL_PLAYLIST_SELECTOR:function(){var d=this,f=this.playlists.master.playlists.filter(lo.isEnabled);return nc(f,function(s,u){return qh(s,u)}),f.filter(function(s){return!!fp(d.playlists.master,s).video})[0]||null},lastBandwidthSelector:Yv,movingAverageBandwidthSelector:function(d){var f=-1,h=-1;if(d<0||d>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var s=this.useDevicePixelRatio&&se().devicePixelRatio||1;return f<0&&(f=this.systemBandwidth,h=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==h&&(f=d*this.systemBandwidth+(1-d)*f,h=this.systemBandwidth),pp(this.playlists.master,f,parseInt(Zo(this.tech_.el(),"width"),10)*s,parseInt(Zo(this.tech_.el(),"height"),10)*s,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}},comparePlaylistBandwidth:qh,comparePlaylistResolution:function(d,f){var h,s;return d.attributes.RESOLUTION&&d.attributes.RESOLUTION.width&&(h=d.attributes.RESOLUTION.width),h=h||se().Number.MAX_VALUE,f.attributes.RESOLUTION&&f.attributes.RESOLUTION.width&&(s=f.attributes.RESOLUTION.width),h===(s=s||se().Number.MAX_VALUE)&&d.attributes.BANDWIDTH&&f.attributes.BANDWIDTH?d.attributes.BANDWIDTH-f.attributes.BANDWIDTH:h-s},xhr:Qo()};Object.keys(Sa).forEach(function(b){Object.defineProperty(pa,b,{get:function(){return Be.log.warn("using Vhs."+b+" is UNSAFE be sure you know what you are doing"),Sa[b]},set:function(f){Be.log.warn("using Vhs."+b+" is UNSAFE be sure you know what you are doing"),"number"!=typeof f||f<0?Be.log.warn("value of Vhs."+b+" must be greater than or equal to 0"):Sa[b]=f}})});var wp="videojs-vhs",Ea=function(d,f){for(var h=f.media(),s=-1,u=0;u<d.length;u++)if(d[u].id===h.id){s=u;break}d.selectedIndex_=s,d.trigger({selectedIndex:s,type:"change"})};pa.canPlaySource=function(){return Be.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var kb=function(){if(!se().localStorage)return null;var d=se().localStorage.getItem(wp);if(!d)return null;try{return JSON.parse(d)}catch{return null}};pa.supportsNativeHls=function(){if(!Oe()||!Oe().createElement)return!1;var b=Oe().createElement("video");return!!Be.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(f){return/maybe|probably/i.test(b.canPlayType(f))})}(),pa.supportsNativeDash=!!(Oe()&&Oe().createElement&&Be.getTech("Html5").isSupported())&&/maybe|probably/i.test(Oe().createElement("video").canPlayType("application/dash+xml")),pa.supportsTypeNatively=function(b){return"hls"===b?pa.supportsNativeHls:"dash"===b&&pa.supportsNativeDash},pa.isSupported=function(){return Be.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var xp=function(b){function d(h,s,u){var m;if(m=b.call(this,s,Be.mergeOptions(u.hls,u.vhs))||this,u.hls&&Object.keys(u.hls).length&&Be.log.warn("Using hls options is deprecated. Please rename `hls` to `vhs` in your options object."),"number"==typeof u.initialBandwidth&&(m.options_.bandwidth=u.initialBandwidth),m.logger_=ml("VhsHandler"),s.options_&&s.options_.playerId){var T=Be(s.options_.playerId);T.hasOwnProperty("hls")||Object.defineProperty(T,"hls",{get:function(){return Be.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),s.trigger({type:"usage",name:"hls-player-access"}),gt(m)},configurable:!0}),T.hasOwnProperty("vhs")||Object.defineProperty(T,"vhs",{get:function(){return Be.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),s.trigger({type:"usage",name:"vhs-player-access"}),gt(m)},configurable:!0}),T.hasOwnProperty("dash")||Object.defineProperty(T,"dash",{get:function(){return Be.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),gt(m)},configurable:!0}),m.player_=T}if(m.tech_=s,m.source_=h,m.stats={},m.ignoreNextSeekingEvent_=!1,m.setOptions_(),m.options_.overrideNative&&s.overrideNativeAudioTracks&&s.overrideNativeVideoTracks)s.overrideNativeAudioTracks(!0),s.overrideNativeVideoTracks(!0);else if(m.options_.overrideNative&&(s.featuresNativeVideoTracks||s.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return m.on(Oe(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(S){var D=Oe().fullscreenElement||Oe().webkitFullscreenElement||Oe().mozFullScreenElement||Oe().msFullscreenElement;D&&D.contains(m.tech_.el())?m.masterPlaylistController_.fastQualityChange_():m.masterPlaylistController_.checkABR_()}),m.on(m.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),m.on(m.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),m.on(m.tech_,"play",m.play),m}ze(d,b);var f=d.prototype;return f.setOptions_=function(){var s=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=!1!==this.options_.handleManifestRedirects,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var u=kb();u&&u.bandwidth&&(this.options_.bandwidth=u.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),u&&u.throughput&&(this.options_.throughput=u.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Sa.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Sa.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS","useNetworkInformationApi","useDtsForTimestampOffset","experimentalExactManifestTimings","experimentalLeastPixelDiffSelector"].forEach(function(m){typeof s.source_[m]<"u"&&(s.options_[m]=s.source_[m])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},f.src=function(s,u){var m=this;if(s){this.setOptions_(),this.options_.src=function(d){return 0===d.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(d.substring(d.indexOf(",")+1)):d}(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=pa,this.options_.sourceType=au(u),this.options_.seekTo=function(D){m.tech_.setCurrentTime(D)},this.options_.smoothQualityChange&&Be.log.warn("smoothQualityChange is deprecated and will be removed in the next major version"),this.masterPlaylistController_=new uc(this.options_);var T=Be.mergeOptions({liveRangeSafeTimeDelta:oo},this.options_,{seekable:function(){return m.seekable()},media:function(){return m.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new ql(T),this.masterPlaylistController_.on("error",function(){var D=Be.players[m.tech_.options_.playerId],P=m.masterPlaylistController_.error;"object"!=typeof P||P.code?"string"==typeof P&&(P={message:P,code:3}):P.code=3,D.error(P)});var S=this.options_.experimentalBufferBasedABR?pa.movingAverageBandwidthSelector(.55):pa.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):S.bind(this),this.masterPlaylistController_.selectInitialPlaylist=pa.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(P){this.masterPlaylistController_.selectPlaylist=P.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(P){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=P,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){var P=this.masterPlaylistController_.mainSegmentLoader_.bandwidth,W=se().navigator.connection||se().navigator.mozConnection||se().navigator.webkitConnection,H=1e7;if(this.options_.useNetworkInformationApi&&W){var te=1e3*W.downlink*1e3;P=te>=H&&P>=H?Math.max(P,te):te}return P},set:function(P){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=P,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){return Math.floor(1/(1/(this.bandwidth||1)+(this.throughput>0?1/this.throughput:0)))},set:function(){Be.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return m.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return m.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return m.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return m.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return m.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return m.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return m.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return m.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},mediaAppends:{get:function(){return m.masterPlaylistController_.mediaAppends_()||0},enumerable:!0},mainAppendsToLoadedData:{get:function(){return m.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:!0},audioAppendsToLoadedData:{get:function(){return m.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:!0},appendsToLoadedData:{get:function(){return m.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:!0},timeToLoadedData:{get:function(){return m.masterPlaylistController_.timeToLoadedData_()||0},enumerable:!0},buffered:{get:function(){return Ku(m.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return m.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return m.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return m.tech_.name_},enumerable:!0},duration:{get:function(){return m.tech_.duration()},enumerable:!0},master:{get:function(){return m.playlists.master},enumerable:!0},playerDimensions:{get:function(){return m.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Ku(m.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return m.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){m.options_.useBandwidthFromLocalStorage&&function(d){if(!se().localStorage)return!1;var f=kb();f=f?Be.mergeOptions(f,d):d;try{se().localStorage.setItem(wp,JSON.stringify(f))}catch{return!1}}({bandwidth:m.bandwidth,throughput:Math.round(m.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(d){d.representations=function(){var f=d.masterPlaylistController_.master(),h=kh(f)?d.masterPlaylistController_.getAudioTrackPlaylists_():f.playlists;return h?h.filter(function(s){return!Rv(s)}).map(function(s,u){return new ii(d,s,s.id)}):[]}}(m)}),this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",function(){m.setupEme_()}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=se().URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},f.createKeySessions_=function(){var s=this,u=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),function(d){var f=d.player,h=d.sourceKeySystems,s=d.audioMedia,u=d.mainPlaylists;if(!f.eme.initializeMediaKeys)return Promise.resolve();var T=function(d,f){return d.reduce(function(h,s){if(!s.contentProtection)return h;var u=f.reduce(function(m,T){var S=s.contentProtection[T];return S&&S.pssh&&(m[T]={pssh:S.pssh}),m},{});return Object.keys(u).length&&h.push(u),h},[])}(s?u.concat([s]):u,Object.keys(h)),S=[],D=[];return T.forEach(function(P){D.push(new Promise(function(W,H){f.tech_.one("keysessioncreated",W)})),S.push(new Promise(function(W,H){f.eme.initializeMediaKeys({keySystems:P},function(te){te?H(te):W()})}))}),Promise.race([Promise.all(S),Promise.race(D)])}({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:u&&u.media(),mainPlaylists:this.playlists.master.playlists}).then(function(){s.logger_("created EME key session"),s.masterPlaylistController_.sourceUpdater_.initializedEme()}).catch(function(m){s.logger_("error while creating EME key session",m),s.player_.error({message:"Failed to initialize media keys for EME",code:3})})},f.handleWaitingForKey_=function(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()},f.setupEme_=function(){var s=this,u=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,m=function(d){var f=d.player,m=function(d,f,h){if(!d)return d;var s={};f&&f.attributes&&f.attributes.CODECS&&(s=ig(hn(f.attributes.CODECS))),h&&h.attributes&&h.attributes.CODECS&&(s.audio=h.attributes.CODECS);var u=As(s.video),m=As(s.audio),T={};for(var S in d)T[S]={},m&&(T[S].audioContentType=m),u&&(T[S].videoContentType=u),f.contentProtection&&f.contentProtection[S]&&f.contentProtection[S].pssh&&(T[S].pssh=f.contentProtection[S].pssh),"string"==typeof d[S]&&(T[S].url=d[S]);return Be.mergeOptions(d,T)}(d.sourceKeySystems,d.media,d.audioMedia);return!(!m||(f.currentSource().keySystems=m,m&&!f.eme&&(Be.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),1)))}({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:u&&u.media()});this.player_.tech_.on("keystatuschange",function(T){if("output-restricted"===T.status){var S=s.masterPlaylistController_.master();if(S&&S.playlists){var P,D=[];S.playlists.forEach(function(W){W&&W.attributes&&W.attributes.RESOLUTION&&W.attributes.RESOLUTION.height>=720&&(!W.excludeUntil||W.excludeUntil<1/0)&&(W.excludeUntil=1/0,D.push(W))}),D.length&&((P=Be.log).warn.apply(P,['DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.'].concat(D)),s.masterPlaylistController_.fastQualityChange_())}}}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),11!==Be.browser.IE_VERSION&&m?this.createKeySessions_():this.masterPlaylistController_.sourceUpdater_.initializedEme()},f.setupQualityLevels_=function(){var s=this,u=Be.players[this.tech_.options_.playerId];!u||!u.qualityLevels||this.qualityLevels_||(this.qualityLevels_=u.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(d,f){f.representations().forEach(function(h){d.addQualityLevel(h)}),Ea(d,f.playlists)}(s.qualityLevels_,s)}),this.playlists.on("mediachange",function(){Ea(s.qualityLevels_,s.playlists)}))},d.version=function(){return{"@videojs/http-streaming":"2.14.3","mux.js":"6.0.1","mpd-parser":"0.21.1","m3u8-parser":"4.7.1","aes-decrypter":"3.1.3"}},f.version=function(){return this.constructor.version()},f.canChangeType=function(){return zc.canChangeType()},f.play=function(){this.masterPlaylistController_.play()},f.setCurrentTime=function(s){this.masterPlaylistController_.setCurrentTime(s)},f.duration=function(){return this.masterPlaylistController_.duration()},f.seekable=function(){return this.masterPlaylistController_.seekable()},f.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&se().URL.revokeObjectURL&&(se().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),b.prototype.dispose.call(this)},f.convertToProgramTime=function(s,u){return function(d){var f=d.playlist,h=d.time,s=void 0===h?void 0:h,u=d.callback;if(!u)throw new Error("getProgramTime: callback must be provided");if(!f||void 0===s)return u({message:"getProgramTime: playlist and time must be provided"});var m=function(d,f){if(!f||!f.segments||0===f.segments.length)return null;for(var s,h=0,u=0;u<f.segments.length&&!(d<=(h=(s=f.segments[u]).videoTimingInfo?s.videoTimingInfo.transmuxedPresentationEnd:h+s.duration));u++);var m=f.segments[f.segments.length-1];if(m.videoTimingInfo&&m.videoTimingInfo.transmuxedPresentationEnd<d)return null;if(d>h){if(d>h+.25*m.duration)return null;s=m}return{segment:s,estimatedStart:s.videoTimingInfo?s.videoTimingInfo.transmuxedPresentationStart:h-s.duration,type:s.videoTimingInfo?"accurate":"estimate"}}(s,f);if(!m)return u({message:"valid programTime was not found"});if("estimate"===m.type)return u({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:m.estimatedStart});var T={mediaSeconds:s},S=function(d,f){if(!f.dateTimeObject)return null;var m=d-(f.videoTimingInfo.transmuxedPresentationStart+f.videoTimingInfo.transmuxerPrependedSeconds);return new Date(f.dateTimeObject.getTime()+1e3*m)}(s,m.segment);return S&&(T.programDateTime=S.toISOString()),u(null,T)}({playlist:this.masterPlaylistController_.media(),time:s,callback:u})},f.seekToProgramTime=function(s,u,m,T){return void 0===m&&(m=!0),void 0===T&&(T=2),C0({programTime:s,playlist:this.masterPlaylistController_.media(),retryCount:T,pauseAfterSeek:m,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:u})},d}(Be.getComponent("Component")),rf={name:"videojs-http-streaming",VERSION:"2.14.3",canHandleSource:function(d,f){void 0===f&&(f={});var h=Be.mergeOptions(Be.options,f);return rf.canPlayType(d.type,h)},handleSource:function(d,f,h){void 0===h&&(h={});var s=Be.mergeOptions(Be.options,h);return f.vhs=new xp(d,f,s),Be.hasOwnProperty("hls")||Object.defineProperty(f,"hls",{get:function(){return Be.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),f.vhs},configurable:!0}),f.vhs.xhr=Qo(),f.vhs.src(d.src,d.type),f.vhs},canPlayType:function(d,f){void 0===f&&(f={});var h=Be.mergeOptions(Be.options,f),s=h.vhs,u=(s=void 0===s?{}:s).overrideNative,m=void 0===u?!Be.browser.IS_ANY_SAFARI:u,T=h.hls,S=(T=void 0===T?{}:T).overrideNative,D=void 0!==S&&S,P=au(d);return P&&(!pa.supportsTypeNatively(P)||D||m)?"maybe":""}};Tc("avc1.4d400d,mp4a.40.2")&&Be.getTech("Html5").registerSourceHandler(rf,0),Be.VhsHandler=xp,Object.defineProperty(Be,"HlsHandler",{get:function(){return Be.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),xp},configurable:!0}),Be.VhsSourceHandler=rf,Object.defineProperty(Be,"HlsSourceHandler",{get:function(){return Be.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),rf},configurable:!0}),Be.Vhs=pa,Object.defineProperty(Be,"Hls",{get:function(){return Be.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),pa},configurable:!0}),Be.use||(Be.registerComponent("Hls",pa),Be.registerComponent("Vhs",pa)),Be.options.vhs=Be.options.vhs||{},Be.options.hls=Be.options.hls||{},Be.getPlugin&&Be.getPlugin("reloadSourceOnError")||(Be.registerPlugin||Be.plugin)("reloadSourceOnError",function(d){Vd(this,d)});const t_=Be},557:function(ni,In,on){var ht=on(156).default;ni.exports=function(se,dt,Oe){"use strict";se=se&&se.hasOwnProperty("default")?se.default:se,dt=dt&&dt.hasOwnProperty("default")?dt.default:dt,Oe=Oe&&Oe.hasOwnProperty("default")?Oe.default:Oe;var Mt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function yt(a,o){return a(o={exports:{}},o.exports),o.exports}var Nt=Wt(yt(function(a){a.exports=function o(l){if(void 0===l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l},a.exports.default=a.exports,a.exports.__esModule=!0})),ze=yt(function(a){function o(l,p){return a.exports=o=Object.setPrototypeOf||function(y,x){return y.__proto__=x,y},a.exports.default=a.exports,a.exports.__esModule=!0,o(l,p)}a.exports=o,a.exports.default=a.exports,a.exports.__esModule=!0});Wt(ze);var Bt=Wt(yt(function(a){a.exports=function o(l,p){l.prototype=Object.create(p.prototype),l.prototype.constructor=l,ze(l,p)},a.exports.default=a.exports,a.exports.__esModule=!0})),Ir=Wt(yt(function(a,o){a.exports=function(){var l=typeof window<"u"?window:typeof Mt<"u"?Mt:typeof self<"u"?self:{};var y=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},x=function($,q){for(var Ae=0,Ie=$.length;Ae<Ie;Ae++)q[Ae]=$[Ae]},E=function($,q){for(var Ae in q)q.hasOwnProperty(Ae)&&($[Ae]=q[Ae]);return $},R=function p(ie){return ie&&ie.__esModule&&Object.prototype.hasOwnProperty.call(ie,"default")?ie.default:ie}(function v(ie,$){return ie($={exports:{}},$.exports),$.exports}(function(ie,$){ie.exports=function(){var V,Ae=function(){function V(j,K){for(var ne=0;ne<K.length;ne++){var ve=K[ne];ve.enumerable=ve.enumerable||!1,ve.configurable=!0,"value"in ve&&(ve.writable=!0),Object.defineProperty(j,ve.key,ve)}}return function(j,K,ne){return K&&V(j.prototype,K),ne&&V(j,ne),j}}(),Ie=function(j,K){if(Array.isArray(j))return j;if(Symbol.iterator in Object(j))return function V(j,K){var ne=[],ve=!0,Pe=!1,Ge=void 0;try{for(var Dt,It=j[Symbol.iterator]();!(ve=(Dt=It.next()).done)&&(ne.push(Dt.value),!K||ne.length!==K);ve=!0);}catch($e){Pe=!0,Ge=$e}finally{try{!ve&&It.return&&It.return()}finally{if(Pe)throw Ge}}return ne}(j,K);throw new TypeError("Invalid attempt to destructure non-iterable instance")},vt=function(j,K,ne){return j+(K-j)*ne},ke=(V=/iPad|iPhone|iPod/.test(navigator.platform),function(){return V}),Qe=function(){var V=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return V}}(),tt=function(){var V=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return V}}(),ut=function(){var V=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return V}}(),Ze=function(){var V=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),j=V?parseInt(V[1],10):null;return function(){return j}}(),Ce=function(){var V;return V=ke()&&tt()&&-1!==navigator.userAgent.indexOf("13_4"),function(){return V}}(),Fe=function(){var V=!1;if(65===Ze()){var j=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(j){var K=j[1].split("."),ne=Ie(K,4),It=ne[3];V=3325===parseInt(ne[2],10)&&parseInt(It,10)<148}}return function(){return V}}(),je=function(){var V=-1!==navigator.userAgent.indexOf("R7 Build");return function(){return V}}(),at=function(){var j=90==window.orientation||-90==window.orientation;return je()?!j:j},xt=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Ut=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Qn=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},ki=function(j,K,ne,ve){var Pe=j.createShader(j.VERTEX_SHADER);j.shaderSource(Pe,K),j.compileShader(Pe);var Ge=j.createShader(j.FRAGMENT_SHADER);j.shaderSource(Ge,ne),j.compileShader(Ge);var It=j.createProgram();for(var Dt in j.attachShader(It,Pe),j.attachShader(It,Ge),ve)j.bindAttribLocation(It,ve[Dt],Dt);return j.linkProgram(It),j.deleteShader(Pe),j.deleteShader(Ge),It},mt=function(j,K){for(var ne={},ve=j.getProgramParameter(K,j.ACTIVE_UNIFORMS),Pe="",Ge=0;Ge<ve;Ge++)ne[Pe=j.getActiveUniform(K,Ge).name.replace("[0]","")]=j.getUniformLocation(K,Pe);return ne},Kn=function(){var K,j=!1;return K=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(K)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(K.substr(0,4)))&&(j=!0),j},Ni=function(j,K){for(var ne in K)K.hasOwnProperty(ne)&&(j[ne]=K[ne]);return j},ri=function(j){if(ke()){var K=j.style.width,ne=j.style.height;j.style.width=parseInt(K)+1+"px",j.style.height=parseInt(ne)+"px",setTimeout(function(){j.style.width=K,j.style.height=ne},100)}window.canvas=j},Hi=function(){var V=Math.PI/180,j=.25*Math.PI;var Ge=new Float32Array([0,0,0,1]),It=new Float32Array([0,0,0]);function Dt($e,We,Xt,Sn,ln,bi){(function K($e,We,Xt,Sn){var ln=Math.tan(We?We.upDegrees*V:j),bi=Math.tan(We?We.downDegrees*V:j),ir=Math.tan(We?We.leftDegrees*V:j),nn=Math.tan(We?We.rightDegrees*V:j),rn=2/(ir+nn),qi=2/(ln+bi);return $e[0]=rn,$e[1]=0,$e[2]=0,$e[3]=0,$e[4]=0,$e[5]=qi,$e[6]=0,$e[7]=0,$e[8]=-(ir-nn)*rn*.5,$e[9]=(ln-bi)*qi*.5,$e[10]=Sn/(Xt-Sn),$e[11]=-1,$e[12]=0,$e[13]=0,$e[14]=Sn*Xt/(Xt-Sn),$e[15]=0,$e})($e,Sn||null,bi.depthNear,bi.depthFar),function ne($e,We,Xt){var Sn=We[0],ln=We[1],bi=We[2],ir=We[3],nn=Sn+Sn,rn=ln+ln,qi=bi+bi,ra=Sn*nn,sa=Sn*rn,kr=Sn*qi,Ci=ln*rn,Xr=ln*qi,xr=bi*qi,Ms=ir*nn,po=ir*rn,ji=ir*qi;return $e[0]=1-(Ci+xr),$e[1]=sa+ji,$e[2]=kr-po,$e[3]=0,$e[4]=sa-ji,$e[5]=1-(ra+xr),$e[6]=Xr+Ms,$e[7]=0,$e[8]=kr+po,$e[9]=Xr-Ms,$e[10]=1-(ra+Ci),$e[11]=0,$e[12]=Xt[0],$e[13]=Xt[1],$e[14]=Xt[2],$e[15]=1,$e}(We,Xt.orientation||Ge,Xt.position||It),ln&&function ve($e,We,Xt){var ir,nn,rn,qi,ra,sa,kr,Ci,Xr,xr,Ms,po,Sn=Xt[0],ln=Xt[1],bi=Xt[2];return We===$e?($e[12]=We[0]*Sn+We[4]*ln+We[8]*bi+We[12],$e[13]=We[1]*Sn+We[5]*ln+We[9]*bi+We[13],$e[14]=We[2]*Sn+We[6]*ln+We[10]*bi+We[14],$e[15]=We[3]*Sn+We[7]*ln+We[11]*bi+We[15]):(nn=We[1],rn=We[2],qi=We[3],ra=We[4],sa=We[5],kr=We[6],Ci=We[7],Xr=We[8],xr=We[9],Ms=We[10],po=We[11],$e[0]=ir=We[0],$e[1]=nn,$e[2]=rn,$e[3]=qi,$e[4]=ra,$e[5]=sa,$e[6]=kr,$e[7]=Ci,$e[8]=Xr,$e[9]=xr,$e[10]=Ms,$e[11]=po,$e[12]=ir*Sn+ra*ln+Xr*bi+We[12],$e[13]=nn*Sn+sa*ln+xr*bi+We[13],$e[14]=rn*Sn+kr*ln+Ms*bi+We[14],$e[15]=qi*Sn+Ci*ln+po*bi+We[15]),$e}(We,We,ln),function Pe($e,We){var Xt=We[0],Sn=We[1],ln=We[2],bi=We[3],ir=We[4],nn=We[5],rn=We[6],qi=We[7],ra=We[8],sa=We[9],kr=We[10],Ci=We[11],Xr=We[12],xr=We[13],Ms=We[14],po=We[15],ji=Xt*nn-Sn*ir,ff=Xt*rn-ln*ir,Np=Xt*qi-bi*ir,pf=Sn*rn-ln*nn,mf=Sn*qi-bi*nn,gf=ln*qi-bi*rn,gr=ra*xr-sa*Xr,Pp=ra*Ms-kr*Xr,qc=ra*po-Ci*Xr,ee=sa*Ms-kr*xr,M=sa*po-Ci*xr,O=kr*po-Ci*Ms,N=ji*O-ff*M+Np*ee+pf*qc-mf*Pp+gf*gr;return N?($e[0]=(nn*O-rn*M+qi*ee)*(N=1/N),$e[1]=(ln*M-Sn*O-bi*ee)*N,$e[2]=(xr*gf-Ms*mf+po*pf)*N,$e[3]=(kr*mf-sa*gf-Ci*pf)*N,$e[4]=(rn*qc-ir*O-qi*Pp)*N,$e[5]=(Xt*O-ln*qc+bi*Pp)*N,$e[6]=(Ms*Np-Xr*gf-po*ff)*N,$e[7]=(ra*gf-kr*Np+Ci*ff)*N,$e[8]=(ir*M-nn*qc+qi*gr)*N,$e[9]=(Sn*qc-Xt*M-bi*gr)*N,$e[10]=(Xr*mf-xr*Np+po*ji)*N,$e[11]=(sa*Np-ra*mf-Ci*ji)*N,$e[12]=(nn*Pp-ir*ee-rn*gr)*N,$e[13]=(Xt*ee-Sn*Pp+ln*gr)*N,$e[14]=(xr*ff-Xr*pf-Ms*ji)*N,$e[15]=(ra*pf-sa*ff+kr*ji)*N,$e):null}(We,We)}return function($e,We,Xt){return!(!$e||!We||($e.pose=We,$e.timestamp=We.timestamp,Dt($e.leftProjectionMatrix,$e.leftViewMatrix,We,Xt._getFieldOfView("left"),Xt._getEyeOffset("left"),Xt),Dt($e.rightProjectionMatrix,$e.rightViewMatrix,We,Xt._getFieldOfView("right"),Xt._getEyeOffset("right"),Xt),0))}}(),Vt=function(j){var ne=j.indexOf("://"),ve=j.indexOf("/",-1!==ne?ne+3:0);return-1===ve&&(ve=j.length),j.substring(0,ve)},un=function(){var V={};return function(j,K){void 0===V[j]&&(console.warn("webvr-polyfill: "+K),V[j]=!0)}}(),On=function(j,K){un(j,j+" has been deprecated. This may not work on native WebVR displays. "+(K?"Please use "+K+" instead.":""))};var _e=function Ve(V,j,K){if(j){for(var ne=[],ve=null,Pe=0;Pe<j.length;++Pe)switch(Ge=j[Pe]){case V.TEXTURE_BINDING_2D:case V.TEXTURE_BINDING_CUBE_MAP:if((It=j[++Pe])<V.TEXTURE0||It>V.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),ne.push(null,null);break}ve||(ve=V.getParameter(V.ACTIVE_TEXTURE)),V.activeTexture(It),ne.push(V.getParameter(Ge),null);break;case V.ACTIVE_TEXTURE:ve=V.getParameter(V.ACTIVE_TEXTURE),ne.push(null);break;default:ne.push(V.getParameter(Ge))}for(K(V),Pe=0;Pe<j.length;++Pe){var Ge,Dt=ne[Pe];switch(Ge=j[Pe]){case V.ACTIVE_TEXTURE:break;case V.ARRAY_BUFFER_BINDING:V.bindBuffer(V.ARRAY_BUFFER,Dt);break;case V.COLOR_CLEAR_VALUE:V.clearColor(Dt[0],Dt[1],Dt[2],Dt[3]);break;case V.COLOR_WRITEMASK:V.colorMask(Dt[0],Dt[1],Dt[2],Dt[3]);break;case V.CURRENT_PROGRAM:V.useProgram(Dt);break;case V.ELEMENT_ARRAY_BUFFER_BINDING:V.bindBuffer(V.ELEMENT_ARRAY_BUFFER,Dt);break;case V.FRAMEBUFFER_BINDING:V.bindFramebuffer(V.FRAMEBUFFER,Dt);break;case V.RENDERBUFFER_BINDING:V.bindRenderbuffer(V.RENDERBUFFER,Dt);break;case V.TEXTURE_BINDING_2D:if((It=j[++Pe])<V.TEXTURE0||It>V.TEXTURE31)break;V.activeTexture(It),V.bindTexture(V.TEXTURE_2D,Dt);break;case V.TEXTURE_BINDING_CUBE_MAP:var It;if((It=j[++Pe])<V.TEXTURE0||It>V.TEXTURE31)break;V.activeTexture(It),V.bindTexture(V.TEXTURE_CUBE_MAP,Dt);break;case V.VIEWPORT:V.viewport(Dt[0],Dt[1],Dt[2],Dt[3]);break;case V.BLEND:case V.CULL_FACE:case V.DEPTH_TEST:case V.SCISSOR_TEST:case V.STENCIL_TEST:Dt?V.enable(Ge):V.disable(Ge);break;default:console.log("No GL restore behavior for 0x"+Ge.toString(16))}ve&&V.activeTexture(ve)}}else K(V)},me=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),Et=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function _t(V,j,K,ne){this.gl=V,this.cardboardUI=j,this.bufferScale=K,this.dirtySubmitFrameBindings=ne,this.ctxAttribs=V.getContextAttributes(),this.instanceExt=V.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=V.drawingBufferWidth,this.bufferHeight=V.drawingBufferHeight,this.realBindFramebuffer=V.bindFramebuffer,this.realEnable=V.enable,this.realDisable=V.disable,this.realColorMask=V.colorMask,this.realClearColor=V.clearColor,this.realViewport=V.viewport,ke()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(V.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(V.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=ki(V,me,Et,this.attribs),this.uniforms=mt(V,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=V.createBuffer(),this.indexBuffer=V.createBuffer(),this.indexCount=0,this.renderTarget=V.createTexture(),this.framebuffer=V.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=V.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=V.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=V.createRenderbuffer()),this.patch(),this.onResize()}_t.prototype.destroy=function(){var V=this.gl;this.unpatch(),V.deleteProgram(this.program),V.deleteBuffer(this.vertexBuffer),V.deleteBuffer(this.indexBuffer),V.deleteTexture(this.renderTarget),V.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&V.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&V.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&V.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},_t.prototype.onResize=function(){var V=this.gl,j=this;_e(V,[V.RENDERBUFFER_BINDING,V.TEXTURE_BINDING_2D,V.TEXTURE0],function(ne){j.realBindFramebuffer.call(ne,ne.FRAMEBUFFER,null),j.scissorTest&&j.realDisable.call(ne,ne.SCISSOR_TEST),j.realColorMask.call(ne,!0,!0,!0,!0),j.realViewport.call(ne,0,0,ne.drawingBufferWidth,ne.drawingBufferHeight),j.realClearColor.call(ne,0,0,0,1),ne.clear(ne.COLOR_BUFFER_BIT),j.realBindFramebuffer.call(ne,ne.FRAMEBUFFER,j.framebuffer),ne.bindTexture(ne.TEXTURE_2D,j.renderTarget),ne.texImage2D(ne.TEXTURE_2D,0,j.ctxAttribs.alpha?ne.RGBA:ne.RGB,j.bufferWidth,j.bufferHeight,0,j.ctxAttribs.alpha?ne.RGBA:ne.RGB,ne.UNSIGNED_BYTE,null),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.framebufferTexture2D(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_2D,j.renderTarget,0),j.ctxAttribs.depth&&j.ctxAttribs.stencil?(ne.bindRenderbuffer(ne.RENDERBUFFER,j.depthStencilBuffer),ne.renderbufferStorage(ne.RENDERBUFFER,ne.DEPTH_STENCIL,j.bufferWidth,j.bufferHeight),ne.framebufferRenderbuffer(ne.FRAMEBUFFER,ne.DEPTH_STENCIL_ATTACHMENT,ne.RENDERBUFFER,j.depthStencilBuffer)):j.ctxAttribs.depth?(ne.bindRenderbuffer(ne.RENDERBUFFER,j.depthBuffer),ne.renderbufferStorage(ne.RENDERBUFFER,ne.DEPTH_COMPONENT16,j.bufferWidth,j.bufferHeight),ne.framebufferRenderbuffer(ne.FRAMEBUFFER,ne.DEPTH_ATTACHMENT,ne.RENDERBUFFER,j.depthBuffer)):j.ctxAttribs.stencil&&(ne.bindRenderbuffer(ne.RENDERBUFFER,j.stencilBuffer),ne.renderbufferStorage(ne.RENDERBUFFER,ne.STENCIL_INDEX8,j.bufferWidth,j.bufferHeight),ne.framebufferRenderbuffer(ne.FRAMEBUFFER,ne.STENCIL_ATTACHMENT,ne.RENDERBUFFER,j.stencilBuffer)),!ne.checkFramebufferStatus(ne.FRAMEBUFFER)===ne.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),j.realBindFramebuffer.call(ne,ne.FRAMEBUFFER,j.lastBoundFramebuffer),j.scissorTest&&j.realEnable.call(ne,ne.SCISSOR_TEST),j.realColorMask.apply(ne,j.colorMask),j.realViewport.apply(ne,j.viewport),j.realClearColor.apply(ne,j.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},_t.prototype.patch=function(){if(!this.isPatched){var V=this,j=this.gl.canvas,K=this.gl;ke()||(j.width=xt()*this.bufferScale,j.height=Ut()*this.bufferScale,Object.defineProperty(j,"width",{configurable:!0,enumerable:!0,get:function(){return V.bufferWidth},set:function(ve){V.bufferWidth=ve,V.realCanvasWidth.set.call(j,ve),V.onResize()}}),Object.defineProperty(j,"height",{configurable:!0,enumerable:!0,get:function(){return V.bufferHeight},set:function(ve){V.bufferHeight=ve,V.realCanvasHeight.set.call(j,ve),V.onResize()}})),this.lastBoundFramebuffer=K.getParameter(K.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(K.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(ne,ve){V.lastBoundFramebuffer=ve||V.framebuffer,V.realBindFramebuffer.call(K,ne,V.lastBoundFramebuffer)},this.cullFace=K.getParameter(K.CULL_FACE),this.depthTest=K.getParameter(K.DEPTH_TEST),this.blend=K.getParameter(K.BLEND),this.scissorTest=K.getParameter(K.SCISSOR_TEST),this.stencilTest=K.getParameter(K.STENCIL_TEST),K.enable=function(ne){switch(ne){case K.CULL_FACE:V.cullFace=!0;break;case K.DEPTH_TEST:V.depthTest=!0;break;case K.BLEND:V.blend=!0;break;case K.SCISSOR_TEST:V.scissorTest=!0;break;case K.STENCIL_TEST:V.stencilTest=!0}V.realEnable.call(K,ne)},K.disable=function(ne){switch(ne){case K.CULL_FACE:V.cullFace=!1;break;case K.DEPTH_TEST:V.depthTest=!1;break;case K.BLEND:V.blend=!1;break;case K.SCISSOR_TEST:V.scissorTest=!1;break;case K.STENCIL_TEST:V.stencilTest=!1}V.realDisable.call(K,ne)},this.colorMask=K.getParameter(K.COLOR_WRITEMASK),K.colorMask=function(ne,ve,Pe,Ge){V.colorMask[0]=ne,V.colorMask[1]=ve,V.colorMask[2]=Pe,V.colorMask[3]=Ge,V.realColorMask.call(K,ne,ve,Pe,Ge)},this.clearColor=K.getParameter(K.COLOR_CLEAR_VALUE),K.clearColor=function(ne,ve,Pe,Ge){V.clearColor[0]=ne,V.clearColor[1]=ve,V.clearColor[2]=Pe,V.clearColor[3]=Ge,V.realClearColor.call(K,ne,ve,Pe,Ge)},this.viewport=K.getParameter(K.VIEWPORT),K.viewport=function(ne,ve,Pe,Ge){V.viewport[0]=ne,V.viewport[1]=ve,V.viewport[2]=Pe,V.viewport[3]=Ge,V.realViewport.call(K,ne,ve,Pe,Ge)},this.isPatched=!0,ri(j)}},_t.prototype.unpatch=function(){if(this.isPatched){var V=this.gl,j=this.gl.canvas;ke()||(Object.defineProperty(j,"width",this.realCanvasWidth),Object.defineProperty(j,"height",this.realCanvasHeight)),j.width=this.bufferWidth,j.height=this.bufferHeight,V.bindFramebuffer=this.realBindFramebuffer,V.enable=this.realEnable,V.disable=this.realDisable,V.colorMask=this.realColorMask,V.clearColor=this.realClearColor,V.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&V.bindFramebuffer(V.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){ri(j)},1)}},_t.prototype.setTextureBounds=function(V,j){V||(V=[0,0,.5,1]),j||(j=[.5,0,.5,1]),this.viewportOffsetScale[0]=V[0],this.viewportOffsetScale[1]=V[1],this.viewportOffsetScale[2]=V[2],this.viewportOffsetScale[3]=V[3],this.viewportOffsetScale[4]=j[0],this.viewportOffsetScale[5]=j[1],this.viewportOffsetScale[6]=j[2],this.viewportOffsetScale[7]=j[3]},_t.prototype.submitFrame=function(){var V=this.gl,j=this,K=[];if(this.dirtySubmitFrameBindings||K.push(V.CURRENT_PROGRAM,V.ARRAY_BUFFER_BINDING,V.ELEMENT_ARRAY_BUFFER_BINDING,V.TEXTURE_BINDING_2D,V.TEXTURE0),_e(V,K,function(ve){j.realBindFramebuffer.call(ve,ve.FRAMEBUFFER,null);var Pe=0,Ge=0;j.instanceExt&&(Pe=ve.getVertexAttrib(j.attribs.position,j.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),Ge=ve.getVertexAttrib(j.attribs.texCoord,j.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),j.cullFace&&j.realDisable.call(ve,ve.CULL_FACE),j.depthTest&&j.realDisable.call(ve,ve.DEPTH_TEST),j.blend&&j.realDisable.call(ve,ve.BLEND),j.scissorTest&&j.realDisable.call(ve,ve.SCISSOR_TEST),j.stencilTest&&j.realDisable.call(ve,ve.STENCIL_TEST),j.realColorMask.call(ve,!0,!0,!0,!0),j.realViewport.call(ve,0,0,ve.drawingBufferWidth,ve.drawingBufferHeight),(j.ctxAttribs.alpha||ke())&&(j.realClearColor.call(ve,0,0,0,1),ve.clear(ve.COLOR_BUFFER_BIT)),ve.useProgram(j.program),ve.bindBuffer(ve.ELEMENT_ARRAY_BUFFER,j.indexBuffer),ve.bindBuffer(ve.ARRAY_BUFFER,j.vertexBuffer),ve.enableVertexAttribArray(j.attribs.position),ve.enableVertexAttribArray(j.attribs.texCoord),ve.vertexAttribPointer(j.attribs.position,2,ve.FLOAT,!1,20,0),ve.vertexAttribPointer(j.attribs.texCoord,3,ve.FLOAT,!1,20,8),j.instanceExt&&(0!=Pe&&j.instanceExt.vertexAttribDivisorANGLE(j.attribs.position,0),0!=Ge&&j.instanceExt.vertexAttribDivisorANGLE(j.attribs.texCoord,0)),ve.activeTexture(ve.TEXTURE0),ve.uniform1i(j.uniforms.diffuse,0),ve.bindTexture(ve.TEXTURE_2D,j.renderTarget),ve.uniform4fv(j.uniforms.viewportOffsetScale,j.viewportOffsetScale),ve.drawElements(ve.TRIANGLES,j.indexCount,ve.UNSIGNED_SHORT,0),j.cardboardUI&&j.cardboardUI.renderNoState(),j.realBindFramebuffer.call(j.gl,ve.FRAMEBUFFER,j.framebuffer),j.ctxAttribs.preserveDrawingBuffer||(j.realClearColor.call(ve,0,0,0,0),ve.clear(ve.COLOR_BUFFER_BIT)),j.dirtySubmitFrameBindings||j.realBindFramebuffer.call(ve,ve.FRAMEBUFFER,j.lastBoundFramebuffer),j.cullFace&&j.realEnable.call(ve,ve.CULL_FACE),j.depthTest&&j.realEnable.call(ve,ve.DEPTH_TEST),j.blend&&j.realEnable.call(ve,ve.BLEND),j.scissorTest&&j.realEnable.call(ve,ve.SCISSOR_TEST),j.stencilTest&&j.realEnable.call(ve,ve.STENCIL_TEST),j.realColorMask.apply(ve,j.colorMask),j.realViewport.apply(ve,j.viewport),(j.ctxAttribs.alpha||!j.ctxAttribs.preserveDrawingBuffer)&&j.realClearColor.apply(ve,j.clearColor),j.instanceExt&&(0!=Pe&&j.instanceExt.vertexAttribDivisorANGLE(j.attribs.position,Pe),0!=Ge&&j.instanceExt.vertexAttribDivisorANGLE(j.attribs.texCoord,Ge))}),ke()){var ne=V.canvas;(ne.width!=j.bufferWidth||ne.height!=j.bufferHeight)&&(j.bufferWidth=ne.width,j.bufferHeight=ne.height,j.onResize())}},_t.prototype.updateDeviceInfo=function(V){var j=this.gl,K=this;_e(j,[j.ARRAY_BUFFER_BINDING,j.ELEMENT_ARRAY_BUFFER_BINDING],function(ve){var Pe=K.computeMeshVertices_(K.meshWidth,K.meshHeight,V);if(ve.bindBuffer(ve.ARRAY_BUFFER,K.vertexBuffer),ve.bufferData(ve.ARRAY_BUFFER,Pe,ve.STATIC_DRAW),!K.indexCount){var Ge=K.computeMeshIndices_(K.meshWidth,K.meshHeight);ve.bindBuffer(ve.ELEMENT_ARRAY_BUFFER,K.indexBuffer),ve.bufferData(ve.ELEMENT_ARRAY_BUFFER,Ge,ve.STATIC_DRAW),K.indexCount=Ge.length}})},_t.prototype.computeMeshVertices_=function(V,j,K){for(var ne=new Float32Array(2*V*j*5),ve=K.getLeftEyeVisibleTanAngles(),Pe=K.getLeftEyeNoLensTanAngles(),Ge=K.getLeftEyeVisibleScreenRect(Pe),It=0,Dt=0;Dt<2;Dt++){for(var $e=0;$e<j;$e++)for(var We=0;We<V;We++,It++){var Xt=We/(V-1),Sn=$e/(j-1),ln=Xt,bi=Sn,ir=vt(ve[0],ve[2],Xt),nn=vt(ve[3],ve[1],Sn),rn=Math.sqrt(ir*ir+nn*nn),qi=K.distortion.distortInverse(rn);Sn=2*(Ge.y+(Sn=(nn*qi/rn-Pe[3])/(Pe[1]-Pe[3]))*Ge.height-.5),ne[5*It+0]=Xt=2*(Ge.x+(Xt=(ir*qi/rn-Pe[0])/(Pe[2]-Pe[0]))*Ge.width-.5),ne[5*It+1]=Sn,ne[5*It+2]=ln,ne[5*It+3]=bi,ne[5*It+4]=Dt}var kr=ve[2]-ve[0];ve[0]=-(kr+ve[0]),ve[2]=kr-ve[2],Pe[0]=-((kr=Pe[2]-Pe[0])+Pe[0]),Pe[2]=kr-Pe[2],Ge.x=1-(Ge.x+Ge.width)}return ne},_t.prototype.computeMeshIndices_=function(V,j){for(var K=new Uint16Array(2*(V-1)*(j-1)*6),ne=V/2,ve=j/2,Pe=0,Ge=0,It=0;It<2;It++)for(var Dt=0;Dt<j;Dt++)for(var $e=0;$e<V;$e++,Pe++)0==$e||0==Dt||($e<=ne==Dt<=ve?(K[Ge++]=Pe,K[Ge++]=Pe-V-1,K[Ge++]=Pe-V,K[Ge++]=Pe-V-1,K[Ge++]=Pe,K[Ge++]=Pe-1):(K[Ge++]=Pe-1,K[Ge++]=Pe-V,K[Ge++]=Pe,K[Ge++]=Pe-V,K[Ge++]=Pe-1,K[Ge++]=Pe-V-1));return K},_t.prototype.getOwnPropertyDescriptor_=function(V,j){var K=Object.getOwnPropertyDescriptor(V,j);return(void 0===K.get||void 0===K.set)&&(K.configurable=!0,K.enumerable=!0,K.get=function(){return this.getAttribute(j)},K.set=function(ne){this.setAttribute(j,ne)}),K};var Le=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),Gt=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),An=Math.PI/180;function nl(V){this.gl=V,this.attribs={position:0},this.program=ki(V,Le,Gt,this.attribs),this.uniforms=mt(V,this.program),this.vertexBuffer=V.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}function Ql(V){this.coefficients=V}nl.prototype.destroy=function(){var V=this.gl;this.listener&&V.canvas.removeEventListener("click",this.listener,!1),V.deleteProgram(this.program),V.deleteBuffer(this.vertexBuffer)},nl.prototype.listen=function(V,j){var K=this.gl.canvas;this.listener=function(ne){var ve=K.clientWidth/2;ne.clientX>ve-42&&ne.clientX<ve+42&&ne.clientY>K.clientHeight-42?V(ne):ne.clientX<42&&ne.clientY<42&&j(ne)},K.addEventListener("click",this.listener,!1)},nl.prototype.onResize=function(){var V=this.gl,j=this;_e(V,[V.ARRAY_BUFFER_BINDING],function(ne){var ve=[],Pe=ne.drawingBufferWidth/2,Ge=Math.max(screen.width,screen.height)*window.devicePixelRatio,Dt=ne.drawingBufferWidth/Ge*window.devicePixelRatio,$e=4*Dt/2,We=42*Dt,Xt=28*Dt/2,Sn=14*Dt;function ln(qi,ra){var sa=(90-qi)*An,kr=Math.cos(sa),Ci=Math.sin(sa);ve.push(.3125*kr*Xt+Pe,.3125*Ci*Xt+Xt),ve.push(ra*kr*Xt+Pe,ra*Ci*Xt+Xt)}ve.push(Pe-$e,We),ve.push(Pe-$e,ne.drawingBufferHeight),ve.push(Pe+$e,We),ve.push(Pe+$e,ne.drawingBufferHeight),j.gearOffset=ve.length/2;for(var bi=0;bi<=6;bi++){var ir=60*bi;ln(ir,1),ln(ir+12,1),ln(ir+20,.75),ln(ir+40,.75),ln(ir+48,1)}function nn(qi,ra){ve.push(Sn+qi,ne.drawingBufferHeight-Sn-ra)}j.gearVertexCount=ve.length/2-j.gearOffset,j.arrowOffset=ve.length/2;var rn=$e/Math.sin(45*An);nn(0,Xt),nn(Xt,0),nn(Xt+rn,rn),nn(rn,Xt+rn),nn(rn,Xt-rn),nn(0,Xt),nn(Xt,2*Xt),nn(Xt+rn,2*Xt-rn),nn(rn,Xt-rn),nn(0,Xt),nn(rn,Xt-$e),nn(28*Dt,Xt-$e),nn(rn,Xt+$e),nn(28*Dt,Xt+$e),j.arrowVertexCount=ve.length/2-j.arrowOffset,ne.bindBuffer(ne.ARRAY_BUFFER,j.vertexBuffer),ne.bufferData(ne.ARRAY_BUFFER,new Float32Array(ve),ne.STATIC_DRAW)})},nl.prototype.render=function(){var V=this.gl,j=this;_e(V,[V.CULL_FACE,V.DEPTH_TEST,V.BLEND,V.SCISSOR_TEST,V.STENCIL_TEST,V.COLOR_WRITEMASK,V.VIEWPORT,V.CURRENT_PROGRAM,V.ARRAY_BUFFER_BINDING],function(ne){ne.disable(ne.CULL_FACE),ne.disable(ne.DEPTH_TEST),ne.disable(ne.BLEND),ne.disable(ne.SCISSOR_TEST),ne.disable(ne.STENCIL_TEST),ne.colorMask(!0,!0,!0,!0),ne.viewport(0,0,ne.drawingBufferWidth,ne.drawingBufferHeight),j.renderNoState()})},nl.prototype.renderNoState=function(){var j,K,ne,ve,Pe,Ge,It,Dt,$e,We,V=this.gl;V.useProgram(this.program),V.bindBuffer(V.ARRAY_BUFFER,this.vertexBuffer),V.enableVertexAttribArray(this.attribs.position),V.vertexAttribPointer(this.attribs.position,2,V.FLOAT,!1,8,0),V.uniform4f(this.uniforms.color,1,1,1,1),$e=1/((ve=0)-(Pe=V.drawingBufferHeight)),We=1/((Ge=.1)-(It=1024)),(j=this.projMat)[0]=-2*(Dt=1/((K=0)-(ne=V.drawingBufferWidth))),j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=-2*$e,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=2*We,j[11]=0,j[12]=(K+ne)*Dt,j[13]=(Pe+ve)*$e,j[14]=(It+Ge)*We,j[15]=1,V.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),V.drawArrays(V.TRIANGLE_STRIP,0,4),V.drawArrays(V.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),V.drawArrays(V.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},Ql.prototype.distortInverse=function(V){for(var j=0,K=1,ne=V-this.distort(j);Math.abs(K-j)>1e-4;){var ve=V-this.distort(K),Pe=K-ve*((K-j)/(ve-ne));j=K,K=Pe,ne=ve}return K},Ql.prototype.distort=function(V){for(var j=V*V,K=0,ne=0;ne<this.coefficients.length;ne++)K=j*(K+this.coefficients[ne]);return(K+1)*V};var No=Math.PI/180,Al=180/Math.PI,$r=function(j,K,ne){this.x=j||0,this.y=K||0,this.z=ne||0};$r.prototype={constructor:$r,set:function(j,K,ne){return this.x=j,this.y=K,this.z=ne,this},copy:function(j){return this.x=j.x,this.y=j.y,this.z=j.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var j=this.length();return 0!==j?this.multiplyScalar(1/j):(this.x=0,this.y=0,this.z=0),this},multiplyScalar:function(j){this.x*=j,this.y*=j,this.z*=j},applyQuaternion:function(j){var K=this.x,ne=this.y,ve=this.z,Pe=j.x,Ge=j.y,It=j.z,Dt=j.w,$e=Dt*K+Ge*ve-It*ne,We=Dt*ne+It*K-Pe*ve,Xt=Dt*ve+Pe*ne-Ge*K,Sn=-Pe*K-Ge*ne-It*ve;return this.x=$e*Dt+Sn*-Pe+We*-It-Xt*-Ge,this.y=We*Dt+Sn*-Ge+Xt*-Pe-$e*-It,this.z=Xt*Dt+Sn*-It+$e*-Ge-We*-Pe,this},dot:function(j){return this.x*j.x+this.y*j.y+this.z*j.z},crossVectors:function(j,K){var ne=j.x,ve=j.y,Pe=j.z,Ge=K.x,It=K.y,Dt=K.z;return this.x=ve*Dt-Pe*It,this.y=Pe*Ge-ne*Dt,this.z=ne*It-ve*Ge,this}};var tr=function(j,K,ne,ve){this.x=j||0,this.y=K||0,this.z=ne||0,this.w=void 0!==ve?ve:1};function Kl(V){this.width=V.width||xt(),this.height=V.height||Ut(),this.widthMeters=V.widthMeters,this.heightMeters=V.heightMeters,this.bevelMeters=V.bevelMeters}tr.prototype={constructor:tr,set:function(j,K,ne,ve){return this.x=j,this.y=K,this.z=ne,this.w=ve,this},copy:function(j){return this.x=j.x,this.y=j.y,this.z=j.z,this.w=j.w,this},setFromEulerXYZ:function(j,K,ne){var ve=Math.cos(j/2),Pe=Math.cos(K/2),Ge=Math.cos(ne/2),It=Math.sin(j/2),Dt=Math.sin(K/2),$e=Math.sin(ne/2);return this.x=It*Pe*Ge+ve*Dt*$e,this.y=ve*Dt*Ge-It*Pe*$e,this.z=ve*Pe*$e+It*Dt*Ge,this.w=ve*Pe*Ge-It*Dt*$e,this},setFromEulerYXZ:function(j,K,ne){var ve=Math.cos(j/2),Pe=Math.cos(K/2),Ge=Math.cos(ne/2),It=Math.sin(j/2),Dt=Math.sin(K/2),$e=Math.sin(ne/2);return this.x=It*Pe*Ge+ve*Dt*$e,this.y=ve*Dt*Ge-It*Pe*$e,this.z=ve*Pe*$e-It*Dt*Ge,this.w=ve*Pe*Ge+It*Dt*$e,this},setFromAxisAngle:function(j,K){var ne=K/2,ve=Math.sin(ne);return this.x=j.x*ve,this.y=j.y*ve,this.z=j.z*ve,this.w=Math.cos(ne),this},multiply:function(j){return this.multiplyQuaternions(this,j)},multiplyQuaternions:function(j,K){var ne=j.x,ve=j.y,Pe=j.z,Ge=j.w,It=K.x,Dt=K.y,$e=K.z,We=K.w;return this.x=ne*We+Ge*It+ve*$e-Pe*Dt,this.y=ve*We+Ge*Dt+Pe*It-ne*$e,this.z=Pe*We+Ge*$e+ne*Dt-ve*It,this.w=Ge*We-ne*It-ve*Dt-Pe*$e,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var j=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===j?(this.x=0,this.y=0,this.z=0,this.w=1):(this.x=this.x*(j=1/j),this.y=this.y*j,this.z=this.z*j,this.w=this.w*j),this},slerp:function(j,K){if(0===K)return this;if(1===K)return this.copy(j);var ne=this.x,ve=this.y,Pe=this.z,Ge=this.w,It=Ge*j.w+ne*j.x+ve*j.y+Pe*j.z;if(It<0?(this.w=-j.w,this.x=-j.x,this.y=-j.y,this.z=-j.z,It=-It):this.copy(j),It>=1)return this.w=Ge,this.x=ne,this.y=ve,this.z=Pe,this;var Dt=Math.acos(It),$e=Math.sqrt(1-It*It);if(Math.abs($e)<.001)return this.w=.5*(Ge+this.w),this.x=.5*(ne+this.x),this.y=.5*(ve+this.y),this.z=.5*(Pe+this.z),this;var We=Math.sin((1-K)*Dt)/$e,Xt=Math.sin(K*Dt)/$e;return this.w=Ge*We+this.w*Xt,this.x=ne*We+this.x*Xt,this.y=ve*We+this.y*Xt,this.z=Pe*We+this.z*Xt,this},setFromUnitVectors:function(){var V,j;return function(ne,ve){return void 0===V&&(V=new $r),(j=ne.dot(ve)+1)<1e-6?(j=0,Math.abs(ne.x)>Math.abs(ne.z)?V.set(-ne.y,ne.x,0):V.set(0,-ne.z,ne.y)):V.crossVectors(ne,ve),this.x=V.x,this.y=V.y,this.z=V.z,this.w=j,this.normalize(),this}}()};var s_=new Kl({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),yg=new Kl({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Mp={CardboardV1:new Zl({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Zl({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function ur(V,j){this.viewer=Mp.CardboardV2,this.updateDeviceParams(V),this.distortion=new Ql(this.viewer.distortionCoefficients);for(var K=0;K<j.length;K++){var ne=j[K];Mp[ne.id]=new Zl(ne)}}function Zl(V){this.id=V.id,this.label=V.label,this.fov=V.fov,this.interLensDistance=V.interLensDistance,this.baselineLensDistance=V.baselineLensDistance,this.screenLensDistance=V.screenLensDistance,this.distortionCoefficients=V.distortionCoefficients,this.inverseCoefficients=V.inverseCoefficients}ur.prototype.updateDeviceParams=function(V){this.device=this.determineDevice_(V)||this.device},ur.prototype.getDevice=function(){return this.device},ur.prototype.setViewer=function(V){this.viewer=V,this.distortion=new Ql(this.viewer.distortionCoefficients)},ur.prototype.determineDevice_=function(V){if(!V)return ke()?(console.warn("Using fallback iOS device measurements."),yg):(console.warn("Using fallback Android device measurements."),s_);var j=.0254,ne=j/V.ydpi;return new Kl({widthMeters:j/V.xdpi*xt(),heightMeters:ne*Ut(),bevelMeters:.001*V.bevelMm})},ur.prototype.getDistortedFieldOfViewLeftEye=function(){var V=this.viewer,j=this.device,K=this.distortion,ne=V.screenLensDistance,Pe=V.interLensDistance/2,Ge=V.baselineLensDistance-j.bevelMeters,It=j.heightMeters-Ge,Dt=Al*Math.atan(K.distort((j.widthMeters-V.interLensDistance)/2/ne)),$e=Al*Math.atan(K.distort(Pe/ne)),We=Al*Math.atan(K.distort(Ge/ne)),Xt=Al*Math.atan(K.distort(It/ne));return{leftDegrees:Math.min(Dt,V.fov),rightDegrees:Math.min($e,V.fov),downDegrees:Math.min(We,V.fov),upDegrees:Math.min(Xt,V.fov)}},ur.prototype.getLeftEyeVisibleTanAngles=function(){var V=this.viewer,j=this.device,K=this.distortion,ne=Math.tan(-No*V.fov),ve=Math.tan(No*V.fov),Pe=Math.tan(No*V.fov),Ge=Math.tan(-No*V.fov),It=j.widthMeters/4,Dt=j.heightMeters/2,We=V.interLensDistance/2-It,Xt=-(V.baselineLensDistance-j.bevelMeters-Dt),Sn=V.screenLensDistance,ln=K.distort((We-It)/Sn),bi=K.distort((Xt+Dt)/Sn),ir=K.distort((We+It)/Sn),nn=K.distort((Xt-Dt)/Sn),rn=new Float32Array(4);return rn[0]=Math.max(ne,ln),rn[1]=Math.min(ve,bi),rn[2]=Math.min(Pe,ir),rn[3]=Math.max(Ge,nn),rn},ur.prototype.getLeftEyeNoLensTanAngles=function(){var V=this.viewer,j=this.device,K=this.distortion,ne=new Float32Array(4),ve=K.distortInverse(Math.tan(-No*V.fov)),Pe=K.distortInverse(Math.tan(No*V.fov)),Ge=K.distortInverse(Math.tan(No*V.fov)),It=K.distortInverse(Math.tan(-No*V.fov)),Dt=j.widthMeters/4,$e=j.heightMeters/2,Xt=V.interLensDistance/2-Dt,Sn=-(V.baselineLensDistance-j.bevelMeters-$e),ln=V.screenLensDistance,ir=(Sn+$e)/ln,nn=(Xt+Dt)/ln,rn=(Sn-$e)/ln;return ne[0]=Math.max(ve,(Xt-Dt)/ln),ne[1]=Math.min(Pe,ir),ne[2]=Math.min(Ge,nn),ne[3]=Math.max(It,rn),ne},ur.prototype.getLeftEyeVisibleScreenRect=function(V){var j=this.viewer,K=this.device,ne=j.screenLensDistance,ve=(K.widthMeters-j.interLensDistance)/2,Pe=j.baselineLensDistance-K.bevelMeters,Ge=(V[0]*ne+ve)/K.widthMeters,$e=(V[3]*ne+Pe)/K.heightMeters;return{x:Ge,y:$e,width:(V[2]*ne+ve)/K.widthMeters-Ge,height:(V[1]*ne+Pe)/K.heightMeters-$e}},ur.prototype.getFieldOfViewLeftEye=function(V){return V?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},ur.prototype.getFieldOfViewRightEye=function(V){var j=this.getFieldOfViewLeftEye(V);return{leftDegrees:j.rightDegrees,rightDegrees:j.leftDegrees,upDegrees:j.upDegrees,downDegrees:j.downDegrees}},ur.prototype.getUndistortedFieldOfViewLeftEye=function(){var V=this.getUndistortedParams_();return{leftDegrees:Al*Math.atan(V.outerDist),rightDegrees:Al*Math.atan(V.innerDist),downDegrees:Al*Math.atan(V.bottomDist),upDegrees:Al*Math.atan(V.topDist)}},ur.prototype.getUndistortedViewportLeftEye=function(){var V=this.getUndistortedParams_(),K=this.device,ne=this.viewer.screenLensDistance,Ge=K.width/(K.widthMeters/ne),It=K.height/(K.heightMeters/ne),Dt=Math.round((V.eyePosX-V.outerDist)*Ge),$e=Math.round((V.eyePosY-V.bottomDist)*It);return{x:Dt,y:$e,width:Math.round((V.eyePosX+V.innerDist)*Ge)-Dt,height:Math.round((V.eyePosY+V.topDist)*It)-$e}},ur.prototype.getUndistortedParams_=function(){var V=this.viewer,j=this.device,ne=V.screenLensDistance,ve=V.interLensDistance/2/ne,Ge=j.heightMeters/ne,It=j.widthMeters/ne/2-ve,Dt=(V.baselineLensDistance-j.bevelMeters)/ne,We=this.distortion.distortInverse(Math.tan(No*V.fov)),Xt=Math.min(It,We),Sn=Math.min(ve,We),ln=Math.min(Dt,We);return{outerDist:Xt,innerDist:Sn,topDist:Math.min(Ge-Dt,We),bottomDist:ln,eyePosX:It,eyePosY:Dt}},ur.Viewers=Mp;var Xe={format:1,last_updated:"2019-11-09T17:36:14Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}]};function nt(V,j){if(this.dpdb=Xe,this.recalculateDeviceParams_(),V){this.onDeviceParamsUpdated=j;var K=new XMLHttpRequest,ne=this;K.open("GET",V,!0),K.addEventListener("load",function(){ne.loading=!1,K.status>=200&&K.status<=299?(ne.dpdb=JSON.parse(K.response),ne.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),K.send()}}function bt(V){this.xdpi=V.xdpi,this.ydpi=V.ydpi,this.bevelMm=V.bevelMm}function vn(V,j){this.set(V,j)}function Pi(V,j){this.kFilter=V,this.isDebug=j,this.currentAccelMeasurement=new vn,this.currentGyroMeasurement=new vn,this.previousGyroMeasurement=new vn,this.filterQ=ke()?new tr(-1,0,0,1):new tr(1,0,0,1),this.previousFilterQ=new tr,this.previousFilterQ.copy(this.filterQ),this.accelQ=new tr,this.isOrientationInitialized=!1,this.estimatedGravity=new $r,this.measuredGravity=new $r,this.gyroIntegralQ=new tr}function Fi(V,j){this.predictionTimeS=V,this.isDebug=j,this.previousQ=new tr,this.previousTimestampS=null,this.deltaQ=new tr,this.outQ=new tr}function hi(V,j,K,ne){this.yawOnly=K,this.accelerometer=new $r,this.gyroscope=new $r,this.filter=new Pi(V,ne),this.posePredictor=new Fi(j,ne),this.isFirefoxAndroid=ut(),this.isIOS=ke();var ve=Ze();this.isDeviceMotionInRadians=!this.isIOS&&ve&&ve<66,this.isWithoutDeviceMotion=Fe()||Ce(),this.filterToWorldQ=new tr,ke()?this.filterToWorldQ.setFromAxisAngle(new $r(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new $r(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new tr,this.worldToScreenQ=new tr,this.originalPoseAdjustQ=new tr,this.originalPoseAdjustQ.setFromAxisAngle(new $r(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),at()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new tr,this.orientationOut_=new Float32Array(4),this.start()}nt.prototype.getDeviceParams=function(){return this.deviceParams},nt.prototype.recalculateDeviceParams_=function(){var V=this.calcDeviceParams_();V?(this.deviceParams=V,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},nt.prototype.calcDeviceParams_=function(){var V=this.dpdb;if(!V)return console.error("DPDB not available."),null;if(1!=V.format)return console.error("DPDB has unexpected format version."),null;if(!V.devices||!V.devices.length)return console.error("DPDB does not have a devices section."),null;var j=navigator.userAgent||navigator.vendor||window.opera,K=xt(),ne=Ut();if(!V.devices)return console.error("DPDB has no devices section."),null;for(var ve=0;ve<V.devices.length;ve++){var Pe=V.devices[ve];if(Pe.rules)if("ios"==Pe.type||"android"==Pe.type){if(ke()==("ios"==Pe.type)){for(var Ge=!1,It=0;It<Pe.rules.length;It++)if(this.ruleMatches_(Pe.rules[It],j,K,ne)){Ge=!0;break}if(Ge)return new bt({xdpi:Pe.dpi[0]||Pe.dpi,ydpi:Pe.dpi[1]||Pe.dpi,bevelMm:Pe.bw})}}else console.warn("Device["+ve+"] has invalid type.");else console.warn("Device["+ve+"] has no rules section.")}return console.warn("No DPDB device match."),null},nt.prototype.ruleMatches_=function(V,j,K,ne){if(!V.ua&&!V.res||(V.ua&&"SM"===V.ua.substring(0,2)&&(V.ua=V.ua.substring(0,7)),V.ua&&j.indexOf(V.ua)<0))return!1;if(V.res){if(!V.res[0]||!V.res[1])return!1;var ve=V.res[0],Pe=V.res[1];if(Math.min(K,ne)!=Math.min(ve,Pe)||Math.max(K,ne)!=Math.max(ve,Pe))return!1}return!0},vn.prototype.set=function(V,j){this.sample=V,this.timestampS=j},vn.prototype.copy=function(V){this.set(V.sample,V.timestampS)},Pi.prototype.addAccelMeasurement=function(V,j){this.currentAccelMeasurement.set(V,j)},Pi.prototype.addGyroMeasurement=function(V,j){this.currentGyroMeasurement.set(V,j),function(j){return!(isNaN(j)||j<=.001||j>1)}(j-this.previousGyroMeasurement.timestampS)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},Pi.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var j=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS);this.gyroIntegralQ.multiply(j),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(j);var K=new tr;K.copy(this.filterQ),K.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(K),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var ne=new tr;ne.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),ne.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",Al*function(j){return j.w>1?(console.warn("getQuaternionAngle: w > 1"),0):2*Math.acos(j.w)}(ne),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var ve=new tr;ve.copy(this.filterQ),ve.multiply(ne),this.filterQ.slerp(ve,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},Pi.prototype.getOrientation=function(){return this.filterQ},Pi.prototype.accelToQuaternion_=function(V){var j=new $r;j.copy(V),j.normalize();var K=new tr;return K.setFromUnitVectors(new $r(0,0,-1),j),K.inverse(),K},Pi.prototype.gyroToQuaternionDelta_=function(V,j){var K=new tr,ne=new $r;return ne.copy(V),ne.normalize(),K.setFromAxisAngle(ne,V.length()*j),K},Fi.prototype.getPrediction=function(V,j,K){if(!this.previousTimestampS)return this.previousQ.copy(V),this.previousTimestampS=K,V;var ne=new $r;ne.copy(j),ne.normalize();var ve=j.length();return ve<20*No?(this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(Al*ve).toFixed(1)),this.outQ.copy(V),this.previousQ.copy(V),this.outQ):(this.deltaQ.setFromAxisAngle(ne,ve*this.predictionTimeS),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(V),this.previousTimestampS=K,this.outQ)},hi.prototype.getPosition=function(){return null},hi.prototype.getOrientation=function(){var V=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ)return this.deviceOrientationFixQ=this.deviceOrientationFixQ||(ve=(new tr).setFromAxisAngle(new $r(0,0,-1),0),Pe=new tr,-90===window.orientation?Pe.setFromAxisAngle(new $r(0,1,0),Math.PI/-2):Pe.setFromAxisAngle(new $r(0,1,0),Math.PI/2),ve.multiply(Pe)),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var ve=new tr;return ve.setFromAxisAngle(new $r(1,0,0),-Math.PI/2),ve}(),V=this._deviceOrientationQ,(K=new tr).copy(V),K.multiply(this.deviceOrientationFilterToWorldQ),K.multiply(this.resetQ),K.multiply(this.worldToScreenQ),K.multiplyQuaternions(this.deviceOrientationFixQ,K),this.yawOnly&&(K.x=0,K.z=0,K.normalize()),this.orientationOut_[0]=K.x,this.orientationOut_[1]=K.y,this.orientationOut_[2]=K.z,this.orientationOut_[3]=K.w,this.orientationOut_;var ve,Pe,K,j=this.filter.getOrientation();return V=this.posePredictor.getPrediction(j,this.gyroscope,this.previousTimestampS),(K=new tr).copy(this.filterToWorldQ),K.multiply(this.resetQ),K.multiply(V),K.multiply(this.worldToScreenQ),this.yawOnly&&(K.x=0,K.z=0,K.normalize()),this.orientationOut_[0]=K.x,this.orientationOut_[1]=K.y,this.orientationOut_[2]=K.z,this.orientationOut_[3]=K.w,this.orientationOut_},hi.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),at()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},hi.prototype.onDeviceOrientation_=function(V){this._deviceOrientationQ=this._deviceOrientationQ||new tr;var j=V.alpha,K=V.beta,ne=V.gamma;j=(j||0)*Math.PI/180,K=(K||0)*Math.PI/180,ne=(ne||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(K,j,-ne)},hi.prototype.onDeviceMotion_=function(V){this.updateDeviceMotion_(V)},hi.prototype.updateDeviceMotion_=function(V){var j=V.accelerationIncludingGravity,K=V.rotationRate,ne=V.timeStamp/1e3,ve=ne-this.previousTimestampS;return ve<0?(un("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),void(this.previousTimestampS=ne)):ve<=.001||ve>1?(un("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),void(this.previousTimestampS=ne)):(this.accelerometer.set(-j.x,-j.y,-j.z),K&&(je()?this.gyroscope.set(-K.beta,K.alpha,K.gamma):this.gyroscope.set(K.alpha,K.beta,K.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,ne)),this.filter.addAccelMeasurement(this.accelerometer,ne),void(this.previousTimestampS=ne))},hi.prototype.onOrientationChange_=function(V){this.setScreenTransform_()},hi.prototype.onMessage_=function(V){var j=V.data;j&&j.type&&"devicemotion"===j.type.toLowerCase()&&this.updateDeviceMotion_(j.deviceMotionEvent)},hi.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new $r(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new $r(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},hi.prototype.start=function(){var j,K,ne;this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),ke()&&(j=window.self!==window.top,K=Vt(document.referrer),ne=Vt(window.location.href),j&&K!==ne)&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},hi.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var qr=new $r(1,0,0),os=new $r(0,0,1),fi=new tr;fi.setFromAxisAngle(qr,-Math.PI/2),fi.multiply((new tr).setFromAxisAngle(os,Math.PI/2));var ai=function(){function V(j){(function(V,j){if(!(V instanceof j))throw new TypeError("Cannot call a class as a function")})(this,V),this.config=j,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new tr,this._outQ=new tr,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return Ae(V,[{key:"init",value:function(){var K=null;try{(K=new RelativeOrientationSensor({frequency:60,referenceFrame:"screen"})).addEventListener("error",this._onSensorError)}catch(ne){this.errors.push(ne),"SecurityError"===ne.name?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):"ReferenceError"===ne.name?this.useDeviceMotion():console.error(ne)}K&&(this.api="sensor",this.sensor=K,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new hi(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var K=this.sensor.quaternion;this._sensorQ.set(K[0],K[1],K[2],K[3]);var ne=this._outQ;return ne.copy(fi),ne.multiply(this._sensorQ),this.config.YAW_ONLY&&(ne.x=ne.z=0,ne.normalize()),this._out[0]=ne.x,this._out[1]=ne.y,this._out[2]=ne.z,this._out[3]=ne.w,this._out}},{key:"_onSensorError",value:function(K){this.errors.push(K.error),"NotAllowedError"===K.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===K.error.name?console.error("Sensor could not be read"):console.error(K.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),V}();function mr(){this.loadIcon_();var V=document.createElement("div");(Ge=V.style).position="fixed",Ge.top=0,Ge.right=0,Ge.bottom=0,Ge.left=0,Ge.backgroundColor="gray",Ge.fontFamily="sans-serif",Ge.zIndex=1e6;var j=document.createElement("img");j.src=this.icon,(Ge=j.style).marginLeft="25%",Ge.marginTop="25%",Ge.width="50%",V.appendChild(j);var K=document.createElement("div");(Ge=K.style).textAlign="center",Ge.fontSize="16px",Ge.lineHeight="24px",Ge.margin="24px 25%",Ge.width="50%",K.innerHTML="Place your phone into your Cardboard viewer.",V.appendChild(K);var ne=document.createElement("div");(Ge=ne.style).backgroundColor="#CFD8DC",Ge.position="fixed",Ge.bottom=0,Ge.width="100%",Ge.height="48px",Ge.padding="14px 24px",Ge.boxSizing="border-box",Ge.color="#656A6B",V.appendChild(ne);var ve=document.createElement("div");ve.style.float="left",ve.innerHTML="No Cardboard viewer?";var Ge,Pe=document.createElement("a");Pe.href="https://www.google.com/get/cardboard/get-cardboard/",Pe.innerHTML="get one",Pe.target="_blank",(Ge=Pe.style).float="right",Ge.fontWeight=600,Ge.textTransform="uppercase",Ge.borderLeft="1px solid gray",Ge.paddingLeft="24px",Ge.textDecoration="none",Ge.color="#656A6B",ne.appendChild(ve),ne.appendChild(Pe),this.overlay=V,this.text=K,this.hide()}mr.prototype.show=function(V){V||this.overlay.parentElement?V&&(this.overlay.parentElement&&this.overlay.parentElement!=V&&this.overlay.parentElement.removeChild(this.overlay),V.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var K=this.overlay.querySelector("img").style;at()?(K.width="20%",K.marginLeft="40%",K.marginTop="3%"):(K.width="50%",K.marginLeft="25%",K.marginTop="25%")},mr.prototype.hide=function(){this.overlay.style.display="none"},mr.prototype.showTemporarily=function(V,j){this.show(j),this.timer=setTimeout(this.hide.bind(this),V)},mr.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},mr.prototype.update=function(){this.disableShowTemporarily(),!at()&&Kn()?this.show():this.hide()},mr.prototype.loadIcon_=function(){this.icon="data:"+"image/svg+xml"+","+encodeURIComponent("<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>")};var bs="WEBVR_CARDBOARD_VIEWER";function Qi(V){try{this.selectedKey=localStorage.getItem(bs)}catch(j){console.error("Failed to load viewer profile: %s",j)}this.selectedKey||(this.selectedKey=V||"CardboardV1"),this.dialog=this.createDialog_(ur.Viewers),this.root=null,this.onChangeCallbacks_=[]}Qi.prototype.show=function(V){this.root=V,V.appendChild(this.dialog),this.dialog.querySelector("#"+this.selectedKey).checked=!0,this.dialog.style.display="block"},Qi.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Qi.prototype.getCurrentViewer=function(){return ur.Viewers[this.selectedKey]},Qi.prototype.getSelectedKey_=function(){var V=this.dialog.querySelector("input[name=field]:checked");return V?V.id:null},Qi.prototype.onChange=function(V){this.onChangeCallbacks_.push(V)},Qi.prototype.fireOnChange_=function(V){for(var j=0;j<this.onChangeCallbacks_.length;j++)this.onChangeCallbacks_[j](V)},Qi.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),this.selectedKey&&ur.Viewers[this.selectedKey]){this.fireOnChange_(ur.Viewers[this.selectedKey]);try{localStorage.setItem(bs,this.selectedKey)}catch(V){console.error("Failed to save viewer profile: %s",V)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")},Qi.prototype.createDialog_=function(V){var j=document.createElement("div");j.classList.add("webvr-polyfill-viewer-selector"),j.style.display="none";var K=document.createElement("div");(Pe=K.style).position="fixed",Pe.left=0,Pe.top=0,Pe.width="100%",Pe.height="100%",Pe.background="rgba(0, 0, 0, 0.3)",K.addEventListener("click",this.hide.bind(this));var ve=document.createElement("div"),Pe=ve.style;for(var Ge in Pe.boxSizing="border-box",Pe.position="fixed",Pe.top="24px",Pe.left="50%",Pe.marginLeft="-140px",Pe.width="280px",Pe.padding="24px",Pe.overflow="hidden",Pe.background="#fafafa",Pe.fontFamily="'Roboto', sans-serif",Pe.boxShadow="0px 5px 20px #666",ve.appendChild(this.createH1_("Select your viewer")),V)ve.appendChild(this.createChoice_(Ge,V[Ge].label));return ve.appendChild(this.createButton_("Save",this.onSave_.bind(this))),j.appendChild(K),j.appendChild(ve),j},Qi.prototype.createH1_=function(V){var j=document.createElement("h1"),K=j.style;return K.color="black",K.fontSize="20px",K.fontWeight="bold",K.marginTop=0,K.marginBottom="24px",j.innerHTML=V,j},Qi.prototype.createChoice_=function(V,j){var K=document.createElement("div");K.style.marginTop="8px",K.style.color="black";var ne=document.createElement("input");ne.style.fontSize="30px",ne.setAttribute("id",V),ne.setAttribute("type","radio"),ne.setAttribute("value",V),ne.setAttribute("name","field");var ve=document.createElement("label");return ve.style.marginLeft="4px",ve.setAttribute("for",V),ve.innerHTML=j,K.appendChild(ne),K.appendChild(ve),K},Qi.prototype.createButton_=function(V,j){var K=document.createElement("button");K.innerHTML=V;var ne=K.style;return ne.float="right",ne.textTransform="uppercase",ne.color="#1094f7",ne.fontSize="14px",ne.letterSpacing=0,ne.border=0,ne.background="none",ne.marginTop="16px",K.addEventListener("click",j),K},typeof window<"u"?window:typeof l<"u"||typeof self<"u"&&self;var Rp=function il(V,j){return V(j={exports:{}},j.exports),j.exports}(function(V,j){V.exports=function(){return function(K){var ne={};function ve(Pe){if(ne[Pe])return ne[Pe].exports;var Ge=ne[Pe]={i:Pe,l:!1,exports:{}};return K[Pe].call(Ge.exports,Ge,Ge.exports,ve),Ge.l=!0,Ge.exports}return ve.m=K,ve.c=ne,ve.d=function(Pe,Ge,It){ve.o(Pe,Ge)||Object.defineProperty(Pe,Ge,{configurable:!1,enumerable:!0,get:It})},ve.n=function(Pe){var Ge=Pe&&Pe.__esModule?function(){return Pe.default}:function(){return Pe};return ve.d(Ge,"a",Ge),Ge},ve.o=function(Pe,Ge){return Object.prototype.hasOwnProperty.call(Pe,Ge)},ve.p="",ve(ve.s=0)}([function(K,ne,ve){var Pe=function(){function We(Xt,Sn){for(var ln=0;ln<Sn.length;ln++){var bi=Sn[ln];bi.enumerable=bi.enumerable||!1,bi.configurable=!0,"value"in bi&&(bi.writable=!0),Object.defineProperty(Xt,bi.key,bi)}}return function(Xt,Sn,ln){return Sn&&We(Xt.prototype,Sn),ln&&We(Xt,ln),Xt}}();var It=ve(1),Dt=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,$e=function(){function We(){(function Ge(We,Xt){if(!(We instanceof Xt))throw new TypeError("Cannot call a class as a function")})(this,We),Dt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",It),this.noSleepVideo.addEventListener("timeupdate",function(Xt){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return Pe(We,[{key:"enable",value:function(){Dt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){Dt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),We}();K.exports=$e},function(K,ne,ve){K.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])}()}),rl=function Ts(V){return V&&V.__esModule&&Object.prototype.hasOwnProperty.call(V,"default")?V.default:V}(Rp),Ar=1e3,Iu=[0,0,.5,1],lf=[.5,0,.5,1],uf=window.requestAnimationFrame,cf=window.cancelAnimationFrame;function $d(V){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:V.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:V.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:V.canPresent},maxLayers:{writable:!1,enumerable:!0,value:V.maxLayers},hasOrientation:{enumerable:!0,get:function(){return On("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),V.hasOrientation}}})}function Lr(V){var j=!("wakelock"in(V=V||{}))||V.wakelock;this.isPolyfilled=!0,this.displayId=Ar++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return On("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new $d({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,j&&Kn()&&(this.wakelock_=new rl)}Lr.prototype.getFrameData=function(V){return Hi(V,this._getPose(),this)},Lr.prototype.getPose=function(){return On("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Lr.prototype.resetPose=function(){return On("VRDisplay.prototype.resetPose"),this._resetPose()},Lr.prototype.getImmediatePose=function(){return On("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Lr.prototype.requestAnimationFrame=function(V){return uf(V)},Lr.prototype.cancelAnimationFrame=function(V){return cf(V)},Lr.prototype.wrapForFullscreen=function(V){if(ke())return V;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var j=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",j.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==V)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=V,this.originalParent_=V.parentElement,this.originalParent_||document.body.appendChild(V),!this.fullscreenWrapper_.parentElement){var K=this.fullscreenElement_.parentElement;K.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),K.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var ne=this;return function ve(){if(ne.fullscreenElement_){var Pe=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];ne.fullscreenElement_.setAttribute("style",Pe.join("; ")+";")}}(),this.fullscreenWrapper_},Lr.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var V=this.fullscreenElement_;this.fullscreenElementCachedStyle_?V.setAttribute("style",this.fullscreenElementCachedStyle_):V.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var j=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(V),this.originalParent_===j?j.insertBefore(V,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(V),j.removeChild(this.fullscreenWrapper_),V}},Lr.prototype.requestPresent=function(V){var j=this.isPresenting,K=this;return V instanceof Array||(On("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),V=[V]),new Promise(function(ne,ve){if(K.capabilities.canPresent)if(0==V.length||V.length>K.capabilities.maxLayers)ve(new Error("Invalid number of layers."));else{var Pe=V[0];if(Pe.source){var Ge=Pe.leftBounds||Iu,It=Pe.rightBounds||lf;if(j){var Dt=K.layer_;Dt.source!==Pe.source&&(Dt.source=Pe.source);for(var $e=0;$e<4;$e++)Dt.leftBounds[$e]=Ge[$e],Dt.rightBounds[$e]=It[$e];return K.wrapForFullscreen(K.layer_.source),K.updatePresent_(),void ne()}if(K.layer_={predistorted:Pe.predistorted,source:Pe.source,leftBounds:Ge.slice(0),rightBounds:It.slice(0)},K.waitingForPresent_=!1,K.layer_&&K.layer_.source){var We=K.wrapForFullscreen(K.layer_.source);K.addFullscreenListeners_(We,function(){var bi=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;K.isPresenting=We===bi,K.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(ir){console.error("screen.orientation.lock() failed due to",ir.message)}),K.waitingForPresent_=!1,K.beginPresent_(),ne()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),K.removeFullscreenWrapper(),K.disableWakeLock(),K.endPresent_(),K.removeFullscreenListeners_()),K.fireVRDisplayPresentChange_()},function(){!K.waitingForPresent_||(K.removeFullscreenWrapper(),K.removeFullscreenListeners_(),K.disableWakeLock(),K.waitingForPresent_=!1,K.isPresenting=!1,ve(new Error("Unable to present.")))}),function(j){if(Qe())return!1;if(j.requestFullscreen)j.requestFullscreen();else if(j.webkitRequestFullscreen)j.webkitRequestFullscreen();else if(j.mozRequestFullScreen)j.mozRequestFullScreen();else{if(!j.msRequestFullscreen)return!1;j.msRequestFullscreen()}return!0}(We)?(K.enableWakeLock(),K.waitingForPresent_=!0):(ke()||Qe())&&(K.enableWakeLock(),K.isPresenting=!0,K.beginPresent_(),K.fireVRDisplayPresentChange_(),ne())}!K.waitingForPresent_&&!ke()&&(Qn(),ve(new Error("Unable to present.")))}else ne()}else ve(new Error("VRDisplay is not capable of presenting."))})},Lr.prototype.exitPresent=function(){var V=this.isPresenting,j=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(K,ne){V?(!Qn()&&ke()&&(j.endPresent_(),j.fireVRDisplayPresentChange_()),Qe()&&(j.removeFullscreenWrapper(),j.removeFullscreenListeners_(),j.endPresent_(),j.fireVRDisplayPresentChange_()),K()):ne(new Error("Was not presenting to VRDisplay."))})},Lr.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Lr.prototype.fireVRDisplayPresentChange_=function(){var V=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(V)},Lr.prototype.fireVRDisplayConnect_=function(){var V=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(V)},Lr.prototype.addFullscreenListeners_=function(V,j,K){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=V,this.fullscreenChangeHandler_=j,this.fullscreenErrorHandler_=K,j&&(document.fullscreenEnabled?V.addEventListener("fullscreenchange",j,!1):document.webkitFullscreenEnabled?V.addEventListener("webkitfullscreenchange",j,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",j,!1):document.msFullscreenEnabled&&V.addEventListener("msfullscreenchange",j,!1)),K&&(document.fullscreenEnabled?V.addEventListener("fullscreenerror",K,!1):document.webkitFullscreenEnabled?V.addEventListener("webkitfullscreenerror",K,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",K,!1):document.msFullscreenEnabled&&V.addEventListener("msfullscreenerror",K,!1))},Lr.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var V=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var j=this.fullscreenChangeHandler_;V.removeEventListener("fullscreenchange",j,!1),V.removeEventListener("webkitfullscreenchange",j,!1),document.removeEventListener("mozfullscreenchange",j,!1),V.removeEventListener("msfullscreenchange",j,!1)}if(this.fullscreenErrorHandler_){var K=this.fullscreenErrorHandler_;V.removeEventListener("fullscreenerror",K,!1),V.removeEventListener("webkitfullscreenerror",K,!1),document.removeEventListener("mozfullscreenerror",K,!1),V.removeEventListener("msfullscreenerror",K,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Lr.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Lr.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Lr.prototype.beginPresent_=function(){},Lr.prototype.endPresent_=function(){},Lr.prototype.submitFrame=function(V){},Lr.prototype.getEyeParameters=function(V){return null};var hf={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},mc_LEFT="left",mc_RIGHT="right";function ia(V){var j=Ni({},hf);V=Ni(j,V||{}),Lr.call(this,{wakelock:V.MOBILE_WAKE_LOCK}),this.config=V,this.displayName="Cardboard VRDisplay",this.capabilities=new $d({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new ai(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new nt(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new ur(this.dpdb_.getDeviceParams(),V.ADDITIONAL_VIEWERS),this.viewerSelector_=new Qi(V.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new mr),ke()&&window.addEventListener("resize",this.onResize_.bind(this))}return(ia.prototype=Object.create(Lr.prototype))._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},ia.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},ia.prototype._getFieldOfView=function(V){var j;if(V==mc_LEFT)j=this.deviceInfo_.getFieldOfViewLeftEye();else{if(V!=mc_RIGHT)return console.error("Invalid eye provided: %s",V),null;j=this.deviceInfo_.getFieldOfViewRightEye()}return j},ia.prototype._getEyeOffset=function(V){var j;if(V==mc_LEFT)j=[.5*-this.deviceInfo_.viewer.interLensDistance,0,0];else{if(V!=mc_RIGHT)return console.error("Invalid eye provided: %s",V),null;j=[.5*this.deviceInfo_.viewer.interLensDistance,0,0]}return j},ia.prototype.getEyeParameters=function(V){var j=this._getEyeOffset(V),K=this._getFieldOfView(V),ne={offset:j,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(ne,"fieldOfView",{enumerable:!0,get:function(){return On("VRFieldOfView","VRFrameData's projection matrices"),K}}),ne},ia.prototype.onDeviceParamsUpdated_=function(V){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(V),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},ia.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},ia.prototype.beginPresent_=function(){var V=this.layer_.source.getContext("webgl");V||(V=this.layer_.source.getContext("experimental-webgl")),V||(V=this.layer_.source.getContext("webgl2")),V&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(V.canvas.width=xt()*this.bufferScale_,V.canvas.height=Ut()*this.bufferScale_,this.cardboardUI_=new nl(V)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new nl(V)),this.distorter_=new _t(V,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(j){this.viewerSelector_.show(this.layer_.source.parentElement),j.stopPropagation(),j.preventDefault()}.bind(this),function(j){this.exitPresent(),j.stopPropagation(),j.preventDefault()}.bind(this)),this.rotateInstructions_&&(at()&&Kn()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},ia.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},ia.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},ia.prototype.submitFrame=function(V){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var j=this.layer_.source.getContext("webgl");j||(j=this.layer_.source.getContext("experimental-webgl")),j||(j=this.layer_.source.getContext("webgl2"));var K=j.canvas;(K.width!=this.lastWidth||K.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=K.width,this.lastHeight=K.height,this.cardboardUI_.render()}},ia.prototype.onOrientationChange_=function(V){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},ia.prototype.onResize_=function(V){if(this.layer_){var j=this.layer_.source.getContext("webgl");j||(j=this.layer_.source.getContext("experimental-webgl")),j||(j=this.layer_.source.getContext("webgl2")),j.canvas.setAttribute("style",["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"].join("; ")+";"),ri(j.canvas)}},ia.prototype.onViewerChanged_=function(V){this.deviceInfo_.setViewer(V),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},ia.prototype.fireVRDisplayDeviceParamsChange_=function(){var V=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(V)},ia.VRFrameData=function df(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null},ia.VRDisplay=Lr,ia}()})),k={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function U(ie){this.config=E(E({},k),ie),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&y())&&(this.enable(),this.getVRDisplays().then(function($){$&&$[0]&&$[0].fireVRDisplayConnect_&&$[0].fireVRDisplayConnect_()}))}U.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(y()){var ie=new R({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(ie)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},U.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var ie=this.native.VRFrameData,$=new this.native.VRFrameData,q=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(Ae){Ae instanceof ie?q.call(this,Ae):(q.call(this,$),Ae.pose=$.pose,x($.leftProjectionMatrix,Ae.leftProjectionMatrix),x($.rightProjectionMatrix,Ae.rightProjectionMatrix),x($.leftViewMatrix,Ae.leftViewMatrix),x($.rightViewMatrix,Ae.rightViewMatrix))}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=R.VRDisplay,window.VRFrameData=R.VRFrameData},U.prototype.getVRDisplays=function(){var ie=this;return this.hasNative?this.native.getVRDisplays.call(navigator).then(function(q){return q.length>0?q:ie.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},U.version="0.10.12",U.VRFrameData=R.VRFrameData,U.VRDisplay=R.VRDisplay;var G=Object.freeze({default:U}),Y=G&&U||G;return typeof l<"u"&&l.window&&(l.document||(l.document=l.window.document),l.navigator||(l.navigator=l.window.navigator)),Y}()}));const zt_LEFT=0,zt_MIDDLE=1,zt_RIGHT=2,Hs=1001,ba=1003,oe=1006,oa=1015,Qr=1020,To=1022,_r=1023,Bo=1026,If=1027,oh=2400,ad=2401,Il=3e3,Cr=35044,lm=35048;function Go(){}Object.assign(Go.prototype,{addEventListener:function(a,o){void 0===this._listeners&&(this._listeners={});const l=this._listeners;void 0===l[a]&&(l[a]=[]),-1===l[a].indexOf(o)&&l[a].push(o)},hasEventListener:function(a,o){if(void 0===this._listeners)return!1;const l=this._listeners;return void 0!==l[a]&&-1!==l[a].indexOf(o)},removeEventListener:function(a,o){if(void 0===this._listeners)return;const p=this._listeners[a];if(void 0!==p){const v=p.indexOf(o);-1!==v&&p.splice(v,1)}},dispatchEvent:function(a){if(void 0===this._listeners)return;const l=this._listeners[a.type];if(void 0!==l){a.target=this;const p=l.slice(0);for(let v=0,y=p.length;v<y;v++)p[v].call(this,a)}}});const xn=[];for(let a=0;a<256;a++)xn[a]=(a<16?"0":"")+a.toString(16);let Bu=1234567;const pi={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const a=4294967295*Math.random()|0,o=4294967295*Math.random()|0,l=4294967295*Math.random()|0,p=4294967295*Math.random()|0;return(xn[255&a]+xn[a>>8&255]+xn[a>>16&255]+xn[a>>24&255]+"-"+xn[255&o]+xn[o>>8&255]+"-"+xn[o>>16&15|64]+xn[o>>24&255]+"-"+xn[63&l|128]+xn[l>>8&255]+"-"+xn[l>>16&255]+xn[l>>24&255]+xn[255&p]+xn[p>>8&255]+xn[p>>16&255]+xn[p>>24&255]).toUpperCase()},clamp:function(a,o,l){return Math.max(o,Math.min(l,a))},euclideanModulo:function(a,o){return(a%o+o)%o},mapLinear:function(a,o,l,p,v){return p+(a-o)*(v-p)/(l-o)},lerp:function(a,o,l){return(1-l)*a+l*o},damp:function(a,o,l,p){return pi.lerp(a,o,1-Math.exp(-l*p))},pingpong:function(a,o=1){return o-Math.abs(pi.euclideanModulo(a,2*o)-o)},smoothstep:function(a,o,l){return a<=o?0:a>=l?1:(a=(a-o)/(l-o))*a*(3-2*a)},smootherstep:function(a,o,l){return a<=o?0:a>=l?1:(a=(a-o)/(l-o))*a*a*(a*(6*a-15)+10)},randInt:function(a,o){return a+Math.floor(Math.random()*(o-a+1))},randFloat:function(a,o){return a+Math.random()*(o-a)},randFloatSpread:function(a){return a*(.5-Math.random())},seededRandom:function(a){return void 0!==a&&(Bu=a%2147483647),Bu=16807*Bu%2147483647,(Bu-1)/2147483646},degToRad:function(a){return a*pi.DEG2RAD},radToDeg:function(a){return a*pi.RAD2DEG},isPowerOfTwo:function(a){return 0==(a&a-1)&&0!==a},ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},setQuaternionFromProperEuler:function(a,o,l,p,v){const y=Math.cos,x=Math.sin,E=y(l/2),I=x(l/2),R=y((o+p)/2),F=x((o+p)/2),k=y((o-p)/2),U=x((o-p)/2),G=y((p-o)/2),Y=x((p-o)/2);switch(v){case"XYX":a.set(E*F,I*k,I*U,E*R);break;case"YZY":a.set(I*U,E*F,I*k,E*R);break;case"ZXZ":a.set(I*k,I*U,E*F,E*R);break;case"XZX":a.set(E*F,I*Y,I*G,E*R);break;case"YXY":a.set(I*G,E*F,I*Y,E*R);break;case"ZYZ":a.set(I*Y,I*G,E*F,E*R);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+v)}}};class qe{constructor(o=0,l=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=o,this.y=l}get width(){return this.x}set width(o){this.x=o}get height(){return this.y}set height(o){this.y=o}set(o,l){return this.x=o,this.y=l,this}setScalar(o){return this.x=o,this.y=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setComponent(o,l){switch(o){case 0:this.x=l;break;case 1:this.y=l;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y)}copy(o){return this.x=o.x,this.y=o.y,this}add(o,l){return void 0!==l?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,l)):(this.x+=o.x,this.y+=o.y,this)}addScalar(o){return this.x+=o,this.y+=o,this}addVectors(o,l){return this.x=o.x+l.x,this.y=o.y+l.y,this}addScaledVector(o,l){return this.x+=o.x*l,this.y+=o.y*l,this}sub(o,l){return void 0!==l?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,l)):(this.x-=o.x,this.y-=o.y,this)}subScalar(o){return this.x-=o,this.y-=o,this}subVectors(o,l){return this.x=o.x-l.x,this.y=o.y-l.y,this}multiply(o){return this.x*=o.x,this.y*=o.y,this}multiplyScalar(o){return this.x*=o,this.y*=o,this}divide(o){return this.x/=o.x,this.y/=o.y,this}divideScalar(o){return this.multiplyScalar(1/o)}applyMatrix3(o){const l=this.x,p=this.y,v=o.elements;return this.x=v[0]*l+v[3]*p+v[6],this.y=v[1]*l+v[4]*p+v[7],this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this}clamp(o,l){return this.x=Math.max(o.x,Math.min(l.x,this.x)),this.y=Math.max(o.y,Math.min(l.y,this.y)),this}clampScalar(o,l){return this.x=Math.max(o,Math.min(l,this.x)),this.y=Math.max(o,Math.min(l,this.y)),this}clampLength(o,l){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(o,Math.min(l,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(o){return this.x*o.x+this.y*o.y}cross(o){return this.x*o.y-this.y*o.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const l=this.x-o.x,p=this.y-o.y;return l*l+p*p}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,l){return this.x+=(o.x-this.x)*l,this.y+=(o.y-this.y)*l,this}lerpVectors(o,l,p){return this.x=o.x+(l.x-o.x)*p,this.y=o.y+(l.y-o.y)*p,this}equals(o){return o.x===this.x&&o.y===this.y}fromArray(o,l=0){return this.x=o[l],this.y=o[l+1],this}toArray(o=[],l=0){return o[l]=this.x,o[l+1]=this.y,o}fromBufferAttribute(o,l,p){return void 0!==p&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(l),this.y=o.getY(l),this}rotateAround(o,l){const p=Math.cos(l),v=Math.sin(l),y=this.x-o.x,x=this.y-o.y;return this.x=y*p-x*v+o.x,this.y=y*v+x*p+o.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class la{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(o,l,p,v,y,x,E,I,R){const F=this.elements;return F[0]=o,F[1]=v,F[2]=E,F[3]=l,F[4]=y,F[5]=I,F[6]=p,F[7]=x,F[8]=R,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return(new this.constructor).fromArray(this.elements)}copy(o){const l=this.elements,p=o.elements;return l[0]=p[0],l[1]=p[1],l[2]=p[2],l[3]=p[3],l[4]=p[4],l[5]=p[5],l[6]=p[6],l[7]=p[7],l[8]=p[8],this}extractBasis(o,l,p){return o.setFromMatrix3Column(this,0),l.setFromMatrix3Column(this,1),p.setFromMatrix3Column(this,2),this}setFromMatrix4(o){const l=o.elements;return this.set(l[0],l[4],l[8],l[1],l[5],l[9],l[2],l[6],l[10]),this}multiply(o){return this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,l){const p=o.elements,v=l.elements,y=this.elements,x=p[0],E=p[3],I=p[6],R=p[1],F=p[4],k=p[7],U=p[2],G=p[5],Y=p[8],re=v[0],ie=v[3],$=v[6],q=v[1],Ae=v[4],Ie=v[7],Se=v[2],he=v[5],De=v[8];return y[0]=x*re+E*q+I*Se,y[3]=x*ie+E*Ae+I*he,y[6]=x*$+E*Ie+I*De,y[1]=R*re+F*q+k*Se,y[4]=R*ie+F*Ae+k*he,y[7]=R*$+F*Ie+k*De,y[2]=U*re+G*q+Y*Se,y[5]=U*ie+G*Ae+Y*he,y[8]=U*$+G*Ie+Y*De,this}multiplyScalar(o){const l=this.elements;return l[0]*=o,l[3]*=o,l[6]*=o,l[1]*=o,l[4]*=o,l[7]*=o,l[2]*=o,l[5]*=o,l[8]*=o,this}determinant(){const o=this.elements,l=o[0],p=o[1],v=o[2],y=o[3],x=o[4],E=o[5],I=o[6],R=o[7],F=o[8];return l*x*F-l*E*R-p*y*F+p*E*I+v*y*R-v*x*I}invert(){const o=this.elements,l=o[0],p=o[1],v=o[2],y=o[3],x=o[4],E=o[5],I=o[6],R=o[7],F=o[8],k=F*x-E*R,U=E*I-F*y,G=R*y-x*I,Y=l*k+p*U+v*G;if(0===Y)return this.set(0,0,0,0,0,0,0,0,0);const re=1/Y;return o[0]=k*re,o[1]=(v*R-F*p)*re,o[2]=(E*p-v*x)*re,o[3]=U*re,o[4]=(F*l-v*I)*re,o[5]=(v*y-E*l)*re,o[6]=G*re,o[7]=(p*I-R*l)*re,o[8]=(x*l-p*y)*re,this}transpose(){let o;const l=this.elements;return o=l[1],l[1]=l[3],l[3]=o,o=l[2],l[2]=l[6],l[6]=o,o=l[5],l[5]=l[7],l[7]=o,this}getNormalMatrix(o){return this.setFromMatrix4(o).copy(this).invert().transpose()}transposeIntoArray(o){const l=this.elements;return o[0]=l[0],o[1]=l[3],o[2]=l[6],o[3]=l[1],o[4]=l[4],o[5]=l[7],o[6]=l[2],o[7]=l[5],o[8]=l[8],this}setUvTransform(o,l,p,v,y,x,E){const I=Math.cos(y),R=Math.sin(y);return this.set(p*I,p*R,-p*(I*x+R*E)+x+o,-v*R,v*I,-v*(-R*x+I*E)+E+l,0,0,1),this}scale(o,l){const p=this.elements;return p[0]*=o,p[3]*=o,p[6]*=o,p[1]*=l,p[4]*=l,p[7]*=l,this}rotate(o){const l=Math.cos(o),p=Math.sin(o),v=this.elements,y=v[0],x=v[3],E=v[6],I=v[1],R=v[4],F=v[7];return v[0]=l*y+p*I,v[3]=l*x+p*R,v[6]=l*E+p*F,v[1]=-p*y+l*I,v[4]=-p*x+l*R,v[7]=-p*E+l*F,this}translate(o,l){const p=this.elements;return p[0]+=o*p[2],p[3]+=o*p[5],p[6]+=o*p[8],p[1]+=l*p[2],p[4]+=l*p[5],p[7]+=l*p[8],this}equals(o){const l=this.elements,p=o.elements;for(let v=0;v<9;v++)if(l[v]!==p[v])return!1;return!0}fromArray(o,l=0){for(let p=0;p<9;p++)this.elements[p]=o[p+l];return this}toArray(o=[],l=0){const p=this.elements;return o[l]=p[0],o[l+1]=p[1],o[l+2]=p[2],o[l+3]=p[3],o[l+4]=p[4],o[l+5]=p[5],o[l+6]=p[6],o[l+7]=p[7],o[l+8]=p[8],o}}let wo;const lu={getDataURL:function(a){if(/^data:/i.test(a.src)||typeof HTMLCanvasElement>"u")return a.src;let o;if(a instanceof HTMLCanvasElement)o=a;else{void 0===wo&&(wo=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),wo.width=a.width,wo.height=a.height;const l=wo.getContext("2d");a instanceof ImageData?l.putImageData(a,0,0):l.drawImage(a,0,0,a.width,a.height),o=wo}return o.width>2048||o.height>2048?o.toDataURL("image/jpeg",.6):o.toDataURL("image/png")}};let xs=0;function Li(a=Li.DEFAULT_IMAGE,o=Li.DEFAULT_MAPPING,l=Hs,p=Hs,v=oe,y=1008,x=_r,E=1009,I=1,R=Il){Object.defineProperty(this,"id",{value:xs++}),this.uuid=pi.generateUUID(),this.name="",this.image=a,this.mipmaps=[],this.mapping=o,this.wrapS=l,this.wrapT=p,this.magFilter=v,this.minFilter=y,this.anisotropy=I,this.format=x,this.internalFormat=null,this.type=E,this.offset=new qe(0,0),this.repeat=new qe(1,1),this.center=new qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new la,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=R,this.version=0,this.onUpdate=null}function zg(a){return typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&a instanceof ImageBitmap?lu.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Li.DEFAULT_IMAGE=void 0,Li.DEFAULT_MAPPING=300,Li.prototype=Object.assign(Object.create(Go.prototype),{constructor:Li,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.name=a.name,this.image=a.image,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.internalFormat=a.internalFormat,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.encoding=a.encoding,this},toJSON:function(a){const o=void 0===a||"string"==typeof a;if(!o&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];const l={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const p=this.image;if(void 0===p.uuid&&(p.uuid=pi.generateUUID()),!o&&void 0===a.images[p.uuid]){let v;if(Array.isArray(p)){v=[];for(let y=0,x=p.length;y<x;y++)v.push(zg(p[y].isDataTexture?p[y].image:p[y]))}else v=zg(p);a.images[p.uuid]={uuid:p.uuid,url:v}}l.image=p.uuid}return o||(a.textures[this.uuid]=l),l},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(300!==this.mapping)return a;if(a.applyMatrix3(this.matrix),a.x<0||a.x>1)switch(this.wrapS){case 1e3:a.x=a.x-Math.floor(a.x);break;case Hs:a.x=a.x<0?0:1;break;case 1002:a.x=1===Math.abs(Math.floor(a.x)%2)?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(a.y<0||a.y>1)switch(this.wrapT){case 1e3:a.y=a.y-Math.floor(a.y);break;case Hs:a.y=a.y<0?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}return this.flipY&&(a.y=1-a.y),a}}),Object.defineProperty(Li.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});class Hr{constructor(o=0,l=0,p=0,v=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=o,this.y=l,this.z=p,this.w=v}get width(){return this.z}set width(o){this.z=o}get height(){return this.w}set height(o){this.w=o}set(o,l,p,v){return this.x=o,this.y=l,this.z=p,this.w=v,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this.w=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setW(o){return this.w=o,this}setComponent(o,l){switch(o){case 0:this.x=l;break;case 1:this.y=l;break;case 2:this.z=l;break;case 3:this.w=l;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this.w=void 0!==o.w?o.w:1,this}add(o,l){return void 0!==l?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,l)):(this.x+=o.x,this.y+=o.y,this.z+=o.z,this.w+=o.w,this)}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this.w+=o,this}addVectors(o,l){return this.x=o.x+l.x,this.y=o.y+l.y,this.z=o.z+l.z,this.w=o.w+l.w,this}addScaledVector(o,l){return this.x+=o.x*l,this.y+=o.y*l,this.z+=o.z*l,this.w+=o.w*l,this}sub(o,l){return void 0!==l?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,l)):(this.x-=o.x,this.y-=o.y,this.z-=o.z,this.w-=o.w,this)}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this.w-=o,this}subVectors(o,l){return this.x=o.x-l.x,this.y=o.y-l.y,this.z=o.z-l.z,this.w=o.w-l.w,this}multiply(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this.w*=o.w,this}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this.w*=o,this}applyMatrix4(o){const l=this.x,p=this.y,v=this.z,y=this.w,x=o.elements;return this.x=x[0]*l+x[4]*p+x[8]*v+x[12]*y,this.y=x[1]*l+x[5]*p+x[9]*v+x[13]*y,this.z=x[2]*l+x[6]*p+x[10]*v+x[14]*y,this.w=x[3]*l+x[7]*p+x[11]*v+x[15]*y,this}divideScalar(o){return this.multiplyScalar(1/o)}setAxisAngleFromQuaternion(o){this.w=2*Math.acos(o.w);const l=Math.sqrt(1-o.w*o.w);return l<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=o.x/l,this.y=o.y/l,this.z=o.z/l),this}setAxisAngleFromRotationMatrix(o){let l,p,v,y;const I=o.elements,R=I[0],F=I[4],k=I[8],U=I[1],G=I[5],Y=I[9],re=I[2],ie=I[6],$=I[10];if(Math.abs(F-U)<.01&&Math.abs(k-re)<.01&&Math.abs(Y-ie)<.01){if(Math.abs(F+U)<.1&&Math.abs(k+re)<.1&&Math.abs(Y+ie)<.1&&Math.abs(R+G+$-3)<.1)return this.set(1,0,0,0),this;l=Math.PI;const Ae=(R+1)/2,Ie=(G+1)/2,Se=($+1)/2,he=(F+U)/4,De=(k+re)/4,vt=(Y+ie)/4;return Ae>Ie&&Ae>Se?Ae<.01?(p=0,v=.707106781,y=.707106781):(p=Math.sqrt(Ae),v=he/p,y=De/p):Ie>Se?Ie<.01?(p=.707106781,v=0,y=.707106781):(v=Math.sqrt(Ie),p=he/v,y=vt/v):Se<.01?(p=.707106781,v=.707106781,y=0):(y=Math.sqrt(Se),p=De/y,v=vt/y),this.set(p,v,y,l),this}let q=Math.sqrt((ie-Y)*(ie-Y)+(k-re)*(k-re)+(U-F)*(U-F));return Math.abs(q)<.001&&(q=1),this.x=(ie-Y)/q,this.y=(k-re)/q,this.z=(U-F)/q,this.w=Math.acos((R+G+$-1)/2),this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this.w=Math.min(this.w,o.w),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this.w=Math.max(this.w,o.w),this}clamp(o,l){return this.x=Math.max(o.x,Math.min(l.x,this.x)),this.y=Math.max(o.y,Math.min(l.y,this.y)),this.z=Math.max(o.z,Math.min(l.z,this.z)),this.w=Math.max(o.w,Math.min(l.w,this.w)),this}clampScalar(o,l){return this.x=Math.max(o,Math.min(l,this.x)),this.y=Math.max(o,Math.min(l,this.y)),this.z=Math.max(o,Math.min(l,this.z)),this.w=Math.max(o,Math.min(l,this.w)),this}clampLength(o,l){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(o,Math.min(l,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z+this.w*o.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,l){return this.x+=(o.x-this.x)*l,this.y+=(o.y-this.y)*l,this.z+=(o.z-this.z)*l,this.w+=(o.w-this.w)*l,this}lerpVectors(o,l,p){return this.x=o.x+(l.x-o.x)*p,this.y=o.y+(l.y-o.y)*p,this.z=o.z+(l.z-o.z)*p,this.w=o.w+(l.w-o.w)*p,this}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z&&o.w===this.w}fromArray(o,l=0){return this.x=o[l],this.y=o[l+1],this.z=o[l+2],this.w=o[l+3],this}toArray(o=[],l=0){return o[l]=this.x,o[l+1]=this.y,o[l+2]=this.z,o[l+3]=this.w,o}fromBufferAttribute(o,l,p){return void 0!==p&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(l),this.y=o.getY(l),this.z=o.getZ(l),this.w=o.getW(l),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}class Of extends Go{constructor(o,l,p){super(),Object.defineProperty(this,"isWebGLRenderTarget",{value:!0}),this.width=o,this.height=l,this.scissor=new Hr(0,0,o,l),this.scissorTest=!1,this.viewport=new Hr(0,0,o,l),this.texture=new Li(void 0,(p=p||{}).mapping,p.wrapS,p.wrapT,p.magFilter,p.minFilter,p.format,p.type,p.anisotropy,p.encoding),this.texture.image={},this.texture.image.width=o,this.texture.image.height=l,this.texture.generateMipmaps=void 0!==p.generateMipmaps&&p.generateMipmaps,this.texture.minFilter=void 0!==p.minFilter?p.minFilter:oe,this.depthBuffer=void 0===p.depthBuffer||p.depthBuffer,this.stencilBuffer=void 0!==p.stencilBuffer&&p.stencilBuffer,this.depthTexture=void 0!==p.depthTexture?p.depthTexture:null}setSize(o,l){(this.width!==o||this.height!==l)&&(this.width=o,this.height=l,this.texture.image.width=o,this.texture.image.height=l,this.dispose()),this.viewport.set(0,0,o,l),this.scissor.set(0,0,o,l)}clone(){return(new this.constructor).copy(this)}copy(o){return this.width=o.width,this.height=o.height,this.viewport.copy(o.viewport),this.texture=o.texture.clone(),this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ci{constructor(o=0,l=0,p=0,v=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=o,this._y=l,this._z=p,this._w=v}static slerp(o,l,p,v){return p.copy(o).slerp(l,v)}static slerpFlat(o,l,p,v,y,x,E){let I=p[v+0],R=p[v+1],F=p[v+2],k=p[v+3];const U=y[x+0],G=y[x+1],Y=y[x+2],re=y[x+3];if(k!==re||I!==U||R!==G||F!==Y){let ie=1-E;const $=I*U+R*G+F*Y+k*re,q=$>=0?1:-1,Ae=1-$*$;if(Ae>Number.EPSILON){const Se=Math.sqrt(Ae),he=Math.atan2(Se,$*q);ie=Math.sin(ie*he)/Se,E=Math.sin(E*he)/Se}const Ie=E*q;if(I=I*ie+U*Ie,R=R*ie+G*Ie,F=F*ie+Y*Ie,k=k*ie+re*Ie,ie===1-E){const Se=1/Math.sqrt(I*I+R*R+F*F+k*k);I*=Se,R*=Se,F*=Se,k*=Se}}o[l]=I,o[l+1]=R,o[l+2]=F,o[l+3]=k}static multiplyQuaternionsFlat(o,l,p,v,y,x){const E=p[v],I=p[v+1],R=p[v+2],F=p[v+3],k=y[x],U=y[x+1],G=y[x+2],Y=y[x+3];return o[l]=E*Y+F*k+I*G-R*U,o[l+1]=I*Y+F*U+R*k-E*G,o[l+2]=R*Y+F*G+E*U-I*k,o[l+3]=F*Y-E*k-I*U-R*G,o}get x(){return this._x}set x(o){this._x=o,this._onChangeCallback()}get y(){return this._y}set y(o){this._y=o,this._onChangeCallback()}get z(){return this._z}set z(o){this._z=o,this._onChangeCallback()}get w(){return this._w}set w(o){this._w=o,this._onChangeCallback()}set(o,l,p,v){return this._x=o,this._y=l,this._z=p,this._w=v,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(o){return this._x=o.x,this._y=o.y,this._z=o.z,this._w=o.w,this._onChangeCallback(),this}setFromEuler(o,l){if(!o||!o.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const p=o._x,v=o._y,y=o._z,x=o._order,E=Math.cos,I=Math.sin,R=E(p/2),F=E(v/2),k=E(y/2),U=I(p/2),G=I(v/2),Y=I(y/2);switch(x){case"XYZ":this._x=U*F*k+R*G*Y,this._y=R*G*k-U*F*Y,this._z=R*F*Y+U*G*k,this._w=R*F*k-U*G*Y;break;case"YXZ":this._x=U*F*k+R*G*Y,this._y=R*G*k-U*F*Y,this._z=R*F*Y-U*G*k,this._w=R*F*k+U*G*Y;break;case"ZXY":this._x=U*F*k-R*G*Y,this._y=R*G*k+U*F*Y,this._z=R*F*Y+U*G*k,this._w=R*F*k-U*G*Y;break;case"ZYX":this._x=U*F*k-R*G*Y,this._y=R*G*k+U*F*Y,this._z=R*F*Y-U*G*k,this._w=R*F*k+U*G*Y;break;case"YZX":this._x=U*F*k+R*G*Y,this._y=R*G*k+U*F*Y,this._z=R*F*Y-U*G*k,this._w=R*F*k-U*G*Y;break;case"XZY":this._x=U*F*k-R*G*Y,this._y=R*G*k-U*F*Y,this._z=R*F*Y+U*G*k,this._w=R*F*k+U*G*Y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+x)}return!1!==l&&this._onChangeCallback(),this}setFromAxisAngle(o,l){const p=l/2,v=Math.sin(p);return this._x=o.x*v,this._y=o.y*v,this._z=o.z*v,this._w=Math.cos(p),this._onChangeCallback(),this}setFromRotationMatrix(o){const l=o.elements,p=l[0],v=l[4],y=l[8],x=l[1],E=l[5],I=l[9],R=l[2],F=l[6],k=l[10],U=p+E+k;if(U>0){const G=.5/Math.sqrt(U+1);this._w=.25/G,this._x=(F-I)*G,this._y=(y-R)*G,this._z=(x-v)*G}else if(p>E&&p>k){const G=2*Math.sqrt(1+p-E-k);this._w=(F-I)/G,this._x=.25*G,this._y=(v+x)/G,this._z=(y+R)/G}else if(E>k){const G=2*Math.sqrt(1+E-p-k);this._w=(y-R)/G,this._x=(v+x)/G,this._y=.25*G,this._z=(I+F)/G}else{const G=2*Math.sqrt(1+k-p-E);this._w=(x-v)/G,this._x=(y+R)/G,this._y=(I+F)/G,this._z=.25*G}return this._onChangeCallback(),this}setFromUnitVectors(o,l){let v=o.dot(l)+1;return v<1e-6?(v=0,Math.abs(o.x)>Math.abs(o.z)?(this._x=-o.y,this._y=o.x,this._z=0,this._w=v):(this._x=0,this._y=-o.z,this._z=o.y,this._w=v)):(this._x=o.y*l.z-o.z*l.y,this._y=o.z*l.x-o.x*l.z,this._z=o.x*l.y-o.y*l.x,this._w=v),this.normalize()}angleTo(o){return 2*Math.acos(Math.abs(pi.clamp(this.dot(o),-1,1)))}rotateTowards(o,l){const p=this.angleTo(o);if(0===p)return this;const v=Math.min(1,l/p);return this.slerp(o,v),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(o){return this._x*o._x+this._y*o._y+this._z*o._z+this._w*o._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let o=this.length();return 0===o?(this._x=0,this._y=0,this._z=0,this._w=1):(o=1/o,this._x=this._x*o,this._y=this._y*o,this._z=this._z*o,this._w=this._w*o),this._onChangeCallback(),this}multiply(o,l){return void 0!==l?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(o,l)):this.multiplyQuaternions(this,o)}premultiply(o){return this.multiplyQuaternions(o,this)}multiplyQuaternions(o,l){const p=o._x,v=o._y,y=o._z,x=o._w,E=l._x,I=l._y,R=l._z,F=l._w;return this._x=p*F+x*E+v*R-y*I,this._y=v*F+x*I+y*E-p*R,this._z=y*F+x*R+p*I-v*E,this._w=x*F-p*E-v*I-y*R,this._onChangeCallback(),this}slerp(o,l){if(0===l)return this;if(1===l)return this.copy(o);const p=this._x,v=this._y,y=this._z,x=this._w;let E=x*o._w+p*o._x+v*o._y+y*o._z;if(E<0?(this._w=-o._w,this._x=-o._x,this._y=-o._y,this._z=-o._z,E=-E):this.copy(o),E>=1)return this._w=x,this._x=p,this._y=v,this._z=y,this;const I=1-E*E;if(I<=Number.EPSILON){const G=1-l;return this._w=G*x+l*this._w,this._x=G*p+l*this._x,this._y=G*v+l*this._y,this._z=G*y+l*this._z,this.normalize(),this._onChangeCallback(),this}const R=Math.sqrt(I),F=Math.atan2(R,E),k=Math.sin((1-l)*F)/R,U=Math.sin(l*F)/R;return this._w=x*k+this._w*U,this._x=p*k+this._x*U,this._y=v*k+this._y*U,this._z=y*k+this._z*U,this._onChangeCallback(),this}equals(o){return o._x===this._x&&o._y===this._y&&o._z===this._z&&o._w===this._w}fromArray(o,l=0){return this._x=o[l],this._y=o[l+1],this._z=o[l+2],this._w=o[l+3],this._onChangeCallback(),this}toArray(o=[],l=0){return o[l]=this._x,o[l+1]=this._y,o[l+2]=this._z,o[l+3]=this._w,o}fromBufferAttribute(o,l){return this._x=o.getX(l),this._y=o.getY(l),this._z=o.getZ(l),this._w=o.getW(l),this}_onChange(o){return this._onChangeCallback=o,this}_onChangeCallback(){}}class xe{constructor(o=0,l=0,p=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=o,this.y=l,this.z=p}set(o,l,p){return void 0===p&&(p=this.z),this.x=o,this.y=l,this.z=p,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setComponent(o,l){switch(o){case 0:this.x=l;break;case 1:this.y=l;break;case 2:this.z=l;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this}add(o,l){return void 0!==l?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,l)):(this.x+=o.x,this.y+=o.y,this.z+=o.z,this)}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this}addVectors(o,l){return this.x=o.x+l.x,this.y=o.y+l.y,this.z=o.z+l.z,this}addScaledVector(o,l){return this.x+=o.x*l,this.y+=o.y*l,this.z+=o.z*l,this}sub(o,l){return void 0!==l?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,l)):(this.x-=o.x,this.y-=o.y,this.z-=o.z,this)}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this}subVectors(o,l){return this.x=o.x-l.x,this.y=o.y-l.y,this.z=o.z-l.z,this}multiply(o,l){return void 0!==l?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(o,l)):(this.x*=o.x,this.y*=o.y,this.z*=o.z,this)}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this}multiplyVectors(o,l){return this.x=o.x*l.x,this.y=o.y*l.y,this.z=o.z*l.z,this}applyEuler(o){return o&&o.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Tn.setFromEuler(o))}applyAxisAngle(o,l){return this.applyQuaternion(Tn.setFromAxisAngle(o,l))}applyMatrix3(o){const l=this.x,p=this.y,v=this.z,y=o.elements;return this.x=y[0]*l+y[3]*p+y[6]*v,this.y=y[1]*l+y[4]*p+y[7]*v,this.z=y[2]*l+y[5]*p+y[8]*v,this}applyNormalMatrix(o){return this.applyMatrix3(o).normalize()}applyMatrix4(o){const l=this.x,p=this.y,v=this.z,y=o.elements,x=1/(y[3]*l+y[7]*p+y[11]*v+y[15]);return this.x=(y[0]*l+y[4]*p+y[8]*v+y[12])*x,this.y=(y[1]*l+y[5]*p+y[9]*v+y[13])*x,this.z=(y[2]*l+y[6]*p+y[10]*v+y[14])*x,this}applyQuaternion(o){const l=this.x,p=this.y,v=this.z,y=o.x,x=o.y,E=o.z,I=o.w,R=I*l+x*v-E*p,F=I*p+E*l-y*v,k=I*v+y*p-x*l,U=-y*l-x*p-E*v;return this.x=R*I+U*-y+F*-E-k*-x,this.y=F*I+U*-x+k*-y-R*-E,this.z=k*I+U*-E+R*-x-F*-y,this}project(o){return this.applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix)}unproject(o){return this.applyMatrix4(o.projectionMatrixInverse).applyMatrix4(o.matrixWorld)}transformDirection(o){const l=this.x,p=this.y,v=this.z,y=o.elements;return this.x=y[0]*l+y[4]*p+y[8]*v,this.y=y[1]*l+y[5]*p+y[9]*v,this.z=y[2]*l+y[6]*p+y[10]*v,this.normalize()}divide(o){return this.x/=o.x,this.y/=o.y,this.z/=o.z,this}divideScalar(o){return this.multiplyScalar(1/o)}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this}clamp(o,l){return this.x=Math.max(o.x,Math.min(l.x,this.x)),this.y=Math.max(o.y,Math.min(l.y,this.y)),this.z=Math.max(o.z,Math.min(l.z,this.z)),this}clampScalar(o,l){return this.x=Math.max(o,Math.min(l,this.x)),this.y=Math.max(o,Math.min(l,this.y)),this.z=Math.max(o,Math.min(l,this.z)),this}clampLength(o,l){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(o,Math.min(l,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,l){return this.x+=(o.x-this.x)*l,this.y+=(o.y-this.y)*l,this.z+=(o.z-this.z)*l,this}lerpVectors(o,l,p){return this.x=o.x+(l.x-o.x)*p,this.y=o.y+(l.y-o.y)*p,this.z=o.z+(l.z-o.z)*p,this}cross(o,l){return void 0!==l?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(o,l)):this.crossVectors(this,o)}crossVectors(o,l){const p=o.x,v=o.y,y=o.z,x=l.x,E=l.y,I=l.z;return this.x=v*I-y*E,this.y=y*x-p*I,this.z=p*E-v*x,this}projectOnVector(o){const l=o.lengthSq();if(0===l)return this.set(0,0,0);const p=o.dot(this)/l;return this.copy(o).multiplyScalar(p)}projectOnPlane(o){return um.copy(this).projectOnVector(o),this.sub(um)}reflect(o){return this.sub(um.copy(o).multiplyScalar(2*this.dot(o)))}angleTo(o){const l=Math.sqrt(this.lengthSq()*o.lengthSq());if(0===l)return Math.PI/2;const p=this.dot(o)/l;return Math.acos(pi.clamp(p,-1,1))}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const l=this.x-o.x,p=this.y-o.y,v=this.z-o.z;return l*l+p*p+v*v}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)+Math.abs(this.z-o.z)}setFromSpherical(o){return this.setFromSphericalCoords(o.radius,o.phi,o.theta)}setFromSphericalCoords(o,l,p){const v=Math.sin(l)*o;return this.x=v*Math.sin(p),this.y=Math.cos(l)*o,this.z=v*Math.cos(p),this}setFromCylindrical(o){return this.setFromCylindricalCoords(o.radius,o.theta,o.y)}setFromCylindricalCoords(o,l,p){return this.x=o*Math.sin(l),this.y=p,this.z=o*Math.cos(l),this}setFromMatrixPosition(o){const l=o.elements;return this.x=l[12],this.y=l[13],this.z=l[14],this}setFromMatrixScale(o){const l=this.setFromMatrixColumn(o,0).length(),p=this.setFromMatrixColumn(o,1).length(),v=this.setFromMatrixColumn(o,2).length();return this.x=l,this.y=p,this.z=v,this}setFromMatrixColumn(o,l){return this.fromArray(o.elements,4*l)}setFromMatrix3Column(o,l){return this.fromArray(o.elements,3*l)}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z}fromArray(o,l=0){return this.x=o[l],this.y=o[l+1],this.z=o[l+2],this}toArray(o=[],l=0){return o[l]=this.x,o[l+1]=this.y,o[l+2]=this.z,o}fromBufferAttribute(o,l,p){return void 0!==p&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(l),this.y=o.getY(l),this.z=o.getZ(l),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const um=new xe,Tn=new ci;class js{constructor(o,l){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==o?o:new xe(1/0,1/0,1/0),this.max=void 0!==l?l:new xe(-1/0,-1/0,-1/0)}set(o,l){return this.min.copy(o),this.max.copy(l),this}setFromArray(o){let l=1/0,p=1/0,v=1/0,y=-1/0,x=-1/0,E=-1/0;for(let I=0,R=o.length;I<R;I+=3){const F=o[I],k=o[I+1],U=o[I+2];F<l&&(l=F),k<p&&(p=k),U<v&&(v=U),F>y&&(y=F),k>x&&(x=k),U>E&&(E=U)}return this.min.set(l,p,v),this.max.set(y,x,E),this}setFromBufferAttribute(o){let l=1/0,p=1/0,v=1/0,y=-1/0,x=-1/0,E=-1/0;for(let I=0,R=o.count;I<R;I++){const F=o.getX(I),k=o.getY(I),U=o.getZ(I);F<l&&(l=F),k<p&&(p=k),U<v&&(v=U),F>y&&(y=F),k>x&&(x=k),U>E&&(E=U)}return this.min.set(l,p,v),this.max.set(y,x,E),this}setFromPoints(o){this.makeEmpty();for(let l=0,p=o.length;l<p;l++)this.expandByPoint(o[l]);return this}setFromCenterAndSize(o,l){const p=lr.copy(l).multiplyScalar(.5);return this.min.copy(o).sub(p),this.max.copy(o).add(p),this}setFromObject(o){return this.makeEmpty(),this.expandByObject(o)}clone(){return(new this.constructor).copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(o){return void 0===o&&(console.warn("THREE.Box3: .getCenter() target is now required"),o=new xe),this.isEmpty()?o.set(0,0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return void 0===o&&(console.warn("THREE.Box3: .getSize() target is now required"),o=new xe),this.isEmpty()?o.set(0,0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}expandByObject(o){o.updateWorldMatrix(!1,!1);const l=o.geometry;void 0!==l&&(null===l.boundingBox&&l.computeBoundingBox(),jo.copy(l.boundingBox),jo.applyMatrix4(o.matrixWorld),this.union(jo));const p=o.children;for(let v=0,y=p.length;v<y;v++)this.expandByObject(p[v]);return this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y||o.z<this.min.z||o.z>this.max.z)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y&&this.min.z<=o.min.z&&o.max.z<=this.max.z}getParameter(o,l){return void 0===l&&(console.warn("THREE.Box3: .getParameter() target is now required"),l=new xe),l.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y),(o.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y||o.max.z<this.min.z||o.min.z>this.max.z)}intersectsSphere(o){return this.clampPoint(o.center,lr),lr.distanceToSquared(o.center)<=o.radius*o.radius}intersectsPlane(o){let l,p;return o.normal.x>0?(l=o.normal.x*this.min.x,p=o.normal.x*this.max.x):(l=o.normal.x*this.max.x,p=o.normal.x*this.min.x),o.normal.y>0?(l+=o.normal.y*this.min.y,p+=o.normal.y*this.max.y):(l+=o.normal.y*this.max.y,p+=o.normal.y*this.min.y),o.normal.z>0?(l+=o.normal.z*this.min.z,p+=o.normal.z*this.max.z):(l+=o.normal.z*this.max.z,p+=o.normal.z*this.min.z),l<=-o.constant&&p>=-o.constant}intersectsTriangle(o){if(this.isEmpty())return!1;this.getCenter(ua),Gr.subVectors(this.max,ua),Js.subVectors(o.a,ua),Na.subVectors(o.b,ua),dn.subVectors(o.c,ua),vi.subVectors(Na,Js),sr.subVectors(dn,Na),ea.subVectors(Js,dn);let l=[0,-vi.z,vi.y,0,-sr.z,sr.y,0,-ea.z,ea.y,vi.z,0,-vi.x,sr.z,0,-sr.x,ea.z,0,-ea.x,-vi.y,vi.x,0,-sr.y,sr.x,0,-ea.y,ea.x,0];return!(!Tr(l,Js,Na,dn,Gr)||(l=[1,0,0,0,1,0,0,0,1],!Tr(l,Js,Na,dn,Gr)))&&(uu.crossVectors(vi,sr),l=[uu.x,uu.y,uu.z],Tr(l,Js,Na,dn,Gr))}clampPoint(o,l){return void 0===l&&(console.warn("THREE.Box3: .clampPoint() target is now required"),l=new xe),l.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return lr.copy(o).clamp(this.min,this.max).sub(o).length()}getBoundingSphere(o){return void 0===o&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(o.center),o.radius=.5*this.getSize(lr).length(),o}intersect(o){return this.min.max(o.min),this.max.min(o.max),this.isEmpty()&&this.makeEmpty(),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}applyMatrix4(o){return this.isEmpty()||(Ss[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(o),Ss[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(o),Ss[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(o),Ss[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(o),Ss[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(o),Ss[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(o),Ss[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(o),Ss[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(o),this.setFromPoints(Ss)),this}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}function Tr(a,o,l,p,v){for(let y=0,x=a.length-3;y<=x;y+=3){jr.fromArray(a,y);const E=v.x*Math.abs(jr.x)+v.y*Math.abs(jr.y)+v.z*Math.abs(jr.z),I=o.dot(jr),R=l.dot(jr),F=p.dot(jr);if(Math.max(-Math.max(I,R,F),Math.min(I,R,F))>E)return!1}return!0}const Ss=[new xe,new xe,new xe,new xe,new xe,new xe,new xe,new xe],lr=new xe,jo=new js,Js=new xe,Na=new xe,dn=new xe,vi=new xe,sr=new xe,ea=new xe,ua=new xe,Gr=new xe,uu=new xe,jr=new xe,Lf=new js;class io{constructor(o,l){this.center=void 0!==o?o:new xe,this.radius=void 0!==l?l:-1}set(o,l){return this.center.copy(o),this.radius=l,this}setFromPoints(o,l){const p=this.center;void 0!==l?p.copy(l):Lf.setFromPoints(o).getCenter(p);let v=0;for(let y=0,x=o.length;y<x;y++)v=Math.max(v,p.distanceToSquared(o[y]));return this.radius=Math.sqrt(v),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.center.copy(o.center),this.radius=o.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(o){return o.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(o){return o.distanceTo(this.center)-this.radius}intersectsSphere(o){const l=this.radius+o.radius;return o.center.distanceToSquared(this.center)<=l*l}intersectsBox(o){return o.intersectsSphere(this)}intersectsPlane(o){return Math.abs(o.distanceToPoint(this.center))<=this.radius}clampPoint(o,l){const p=this.center.distanceToSquared(o);return void 0===l&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),l=new xe),l.copy(o),p>this.radius*this.radius&&(l.sub(this.center).normalize(),l.multiplyScalar(this.radius).add(this.center)),l}getBoundingBox(o){return void 0===o&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),o=new js),this.isEmpty()?(o.makeEmpty(),o):(o.set(this.center,this.center),o.expandByScalar(this.radius),o)}applyMatrix4(o){return this.center.applyMatrix4(o),this.radius=this.radius*o.getMaxScaleOnAxis(),this}translate(o){return this.center.add(o),this}equals(o){return o.center.equals(this.center)&&o.radius===this.radius}}const di=new xe,ld=new xe,zo=new xe,Wo=new xe,cl=new xe,dr=new xe,ud=new xe;class Nl{constructor(o,l){this.origin=void 0!==o?o:new xe,this.direction=void 0!==l?l:new xe(0,0,-1)}set(o,l){return this.origin.copy(o),this.direction.copy(l),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.origin.copy(o.origin),this.direction.copy(o.direction),this}at(o,l){return void 0===l&&(console.warn("THREE.Ray: .at() target is now required"),l=new xe),l.copy(this.direction).multiplyScalar(o).add(this.origin)}lookAt(o){return this.direction.copy(o).sub(this.origin).normalize(),this}recast(o){return this.origin.copy(this.at(o,di)),this}closestPointToPoint(o,l){void 0===l&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),l=new xe),l.subVectors(o,this.origin);const p=l.dot(this.direction);return p<0?l.copy(this.origin):l.copy(this.direction).multiplyScalar(p).add(this.origin)}distanceToPoint(o){return Math.sqrt(this.distanceSqToPoint(o))}distanceSqToPoint(o){const l=di.subVectors(o,this.origin).dot(this.direction);return l<0?this.origin.distanceToSquared(o):(di.copy(this.direction).multiplyScalar(l).add(this.origin),di.distanceToSquared(o))}distanceSqToSegment(o,l,p,v){ld.copy(o).add(l).multiplyScalar(.5),zo.copy(l).sub(o).normalize(),Wo.copy(this.origin).sub(ld);const y=.5*o.distanceTo(l),x=-this.direction.dot(zo),E=Wo.dot(this.direction),I=-Wo.dot(zo),R=Wo.lengthSq(),F=Math.abs(1-x*x);let k,U,G,Y;if(F>0)if(k=x*I-E,U=x*E-I,Y=y*F,k>=0)if(U>=-Y)if(U<=Y){const re=1/F;k*=re,U*=re,G=k*(k+x*U+2*E)+U*(x*k+U+2*I)+R}else U=y,k=Math.max(0,-(x*U+E)),G=-k*k+U*(U+2*I)+R;else U=-y,k=Math.max(0,-(x*U+E)),G=-k*k+U*(U+2*I)+R;else U<=-Y?(k=Math.max(0,-(-x*y+E)),U=k>0?-y:Math.min(Math.max(-y,-I),y),G=-k*k+U*(U+2*I)+R):U<=Y?(k=0,U=Math.min(Math.max(-y,-I),y),G=U*(U+2*I)+R):(k=Math.max(0,-(x*y+E)),U=k>0?y:Math.min(Math.max(-y,-I),y),G=-k*k+U*(U+2*I)+R);else U=x>0?-y:y,k=Math.max(0,-(x*U+E)),G=-k*k+U*(U+2*I)+R;return p&&p.copy(this.direction).multiplyScalar(k).add(this.origin),v&&v.copy(zo).multiplyScalar(U).add(ld),G}intersectSphere(o,l){di.subVectors(o.center,this.origin);const p=di.dot(this.direction),v=di.dot(di)-p*p,y=o.radius*o.radius;if(v>y)return null;const x=Math.sqrt(y-v),E=p-x,I=p+x;return E<0&&I<0?null:this.at(E<0?I:E,l)}intersectsSphere(o){return this.distanceSqToPoint(o.center)<=o.radius*o.radius}distanceToPlane(o){const l=o.normal.dot(this.direction);if(0===l)return 0===o.distanceToPoint(this.origin)?0:null;const p=-(this.origin.dot(o.normal)+o.constant)/l;return p>=0?p:null}intersectPlane(o,l){const p=this.distanceToPlane(o);return null===p?null:this.at(p,l)}intersectsPlane(o){const l=o.distanceToPoint(this.origin);return 0===l||o.normal.dot(this.direction)*l<0}intersectBox(o,l){let p,v,y,x,E,I;const R=1/this.direction.x,F=1/this.direction.y,k=1/this.direction.z,U=this.origin;return R>=0?(p=(o.min.x-U.x)*R,v=(o.max.x-U.x)*R):(p=(o.max.x-U.x)*R,v=(o.min.x-U.x)*R),F>=0?(y=(o.min.y-U.y)*F,x=(o.max.y-U.y)*F):(y=(o.max.y-U.y)*F,x=(o.min.y-U.y)*F),p>x||y>v||((y>p||p!=p)&&(p=y),(x<v||v!=v)&&(v=x),k>=0?(E=(o.min.z-U.z)*k,I=(o.max.z-U.z)*k):(E=(o.max.z-U.z)*k,I=(o.min.z-U.z)*k),p>I||E>v)||((E>p||p!=p)&&(p=E),(I<v||v!=v)&&(v=I),v<0)?null:this.at(p>=0?p:v,l)}intersectsBox(o){return null!==this.intersectBox(o,di)}intersectTriangle(o,l,p,v,y){cl.subVectors(l,o),dr.subVectors(p,o),ud.crossVectors(cl,dr);let E,x=this.direction.dot(ud);if(x>0){if(v)return null;E=1}else{if(!(x<0))return null;E=-1,x=-x}Wo.subVectors(this.origin,o);const I=E*this.direction.dot(dr.crossVectors(Wo,dr));if(I<0)return null;const R=E*this.direction.dot(cl.cross(Wo));if(R<0||I+R>x)return null;const F=-E*Wo.dot(ud);return F<0?null:this.at(F/x,y)}applyMatrix4(o){return this.origin.applyMatrix4(o),this.direction.transformDirection(o),this}equals(o){return o.origin.equals(this.origin)&&o.direction.equals(this.direction)}}class Kt{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(o,l,p,v,y,x,E,I,R,F,k,U,G,Y,re,ie){const $=this.elements;return $[0]=o,$[4]=l,$[8]=p,$[12]=v,$[1]=y,$[5]=x,$[9]=E,$[13]=I,$[2]=R,$[6]=F,$[10]=k,$[14]=U,$[3]=G,$[7]=Y,$[11]=re,$[15]=ie,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Kt).fromArray(this.elements)}copy(o){const l=this.elements,p=o.elements;return l[0]=p[0],l[1]=p[1],l[2]=p[2],l[3]=p[3],l[4]=p[4],l[5]=p[5],l[6]=p[6],l[7]=p[7],l[8]=p[8],l[9]=p[9],l[10]=p[10],l[11]=p[11],l[12]=p[12],l[13]=p[13],l[14]=p[14],l[15]=p[15],this}copyPosition(o){const l=this.elements,p=o.elements;return l[12]=p[12],l[13]=p[13],l[14]=p[14],this}setFromMatrix3(o){const l=o.elements;return this.set(l[0],l[3],l[6],0,l[1],l[4],l[7],0,l[2],l[5],l[8],0,0,0,0,1),this}extractBasis(o,l,p){return o.setFromMatrixColumn(this,0),l.setFromMatrixColumn(this,1),p.setFromMatrixColumn(this,2),this}makeBasis(o,l,p){return this.set(o.x,l.x,p.x,0,o.y,l.y,p.y,0,o.z,l.z,p.z,0,0,0,0,1),this}extractRotation(o){const l=this.elements,p=o.elements,v=1/dl.setFromMatrixColumn(o,0).length(),y=1/dl.setFromMatrixColumn(o,1).length(),x=1/dl.setFromMatrixColumn(o,2).length();return l[0]=p[0]*v,l[1]=p[1]*v,l[2]=p[2]*v,l[3]=0,l[4]=p[4]*y,l[5]=p[5]*y,l[6]=p[6]*y,l[7]=0,l[8]=p[8]*x,l[9]=p[9]*x,l[10]=p[10]*x,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this}makeRotationFromEuler(o){o&&o.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const l=this.elements,p=o.x,v=o.y,y=o.z,x=Math.cos(p),E=Math.sin(p),I=Math.cos(v),R=Math.sin(v),F=Math.cos(y),k=Math.sin(y);if("XYZ"===o.order){const U=x*F,G=x*k,Y=E*F,re=E*k;l[0]=I*F,l[4]=-I*k,l[8]=R,l[1]=G+Y*R,l[5]=U-re*R,l[9]=-E*I,l[2]=re-U*R,l[6]=Y+G*R,l[10]=x*I}else if("YXZ"===o.order){const U=I*F,G=I*k,Y=R*F,re=R*k;l[0]=U+re*E,l[4]=Y*E-G,l[8]=x*R,l[1]=x*k,l[5]=x*F,l[9]=-E,l[2]=G*E-Y,l[6]=re+U*E,l[10]=x*I}else if("ZXY"===o.order){const U=I*F,G=I*k,Y=R*F,re=R*k;l[0]=U-re*E,l[4]=-x*k,l[8]=Y+G*E,l[1]=G+Y*E,l[5]=x*F,l[9]=re-U*E,l[2]=-x*R,l[6]=E,l[10]=x*I}else if("ZYX"===o.order){const U=x*F,G=x*k,Y=E*F,re=E*k;l[0]=I*F,l[4]=Y*R-G,l[8]=U*R+re,l[1]=I*k,l[5]=re*R+U,l[9]=G*R-Y,l[2]=-R,l[6]=E*I,l[10]=x*I}else if("YZX"===o.order){const U=x*I,G=x*R,Y=E*I,re=E*R;l[0]=I*F,l[4]=re-U*k,l[8]=Y*k+G,l[1]=k,l[5]=x*F,l[9]=-E*F,l[2]=-R*F,l[6]=G*k+Y,l[10]=U-re*k}else if("XZY"===o.order){const U=x*I,G=x*R,Y=E*I,re=E*R;l[0]=I*F,l[4]=-k,l[8]=R*F,l[1]=U*k+re,l[5]=x*F,l[9]=G*k-Y,l[2]=Y*k-G,l[6]=E*F,l[10]=re*k+U}return l[3]=0,l[7]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this}makeRotationFromQuaternion(o){return this.compose(Kr,o,lh)}lookAt(o,l,p){const v=this.elements;return Es.subVectors(o,l),0===Es.lengthSq()&&(Es.z=1),Es.normalize(),Ec.crossVectors(p,Es),0===Ec.lengthSq()&&(1===Math.abs(p.z)?Es.x+=1e-4:Es.z+=1e-4,Es.normalize(),Ec.crossVectors(p,Es)),Ec.normalize(),zr.crossVectors(Es,Ec),v[0]=Ec.x,v[4]=zr.x,v[8]=Es.x,v[1]=Ec.y,v[5]=zr.y,v[9]=Es.y,v[2]=Ec.z,v[6]=zr.z,v[10]=Es.z,this}multiply(o,l){return void 0!==l?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(o,l)):this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,l){const p=o.elements,v=l.elements,y=this.elements,x=p[0],E=p[4],I=p[8],R=p[12],F=p[1],k=p[5],U=p[9],G=p[13],Y=p[2],re=p[6],ie=p[10],$=p[14],q=p[3],Ae=p[7],Ie=p[11],Se=p[15],he=v[0],De=v[4],vt=v[8],ke=v[12],Qe=v[1],tt=v[5],ut=v[9],Ze=v[13],Ce=v[2],Fe=v[6],je=v[10],at=v[14],Pt=v[3],xt=v[7],Ut=v[11],qt=v[15];return y[0]=x*he+E*Qe+I*Ce+R*Pt,y[4]=x*De+E*tt+I*Fe+R*xt,y[8]=x*vt+E*ut+I*je+R*Ut,y[12]=x*ke+E*Ze+I*at+R*qt,y[1]=F*he+k*Qe+U*Ce+G*Pt,y[5]=F*De+k*tt+U*Fe+G*xt,y[9]=F*vt+k*ut+U*je+G*Ut,y[13]=F*ke+k*Ze+U*at+G*qt,y[2]=Y*he+re*Qe+ie*Ce+$*Pt,y[6]=Y*De+re*tt+ie*Fe+$*xt,y[10]=Y*vt+re*ut+ie*je+$*Ut,y[14]=Y*ke+re*Ze+ie*at+$*qt,y[3]=q*he+Ae*Qe+Ie*Ce+Se*Pt,y[7]=q*De+Ae*tt+Ie*Fe+Se*xt,y[11]=q*vt+Ae*ut+Ie*je+Se*Ut,y[15]=q*ke+Ae*Ze+Ie*at+Se*qt,this}multiplyScalar(o){const l=this.elements;return l[0]*=o,l[4]*=o,l[8]*=o,l[12]*=o,l[1]*=o,l[5]*=o,l[9]*=o,l[13]*=o,l[2]*=o,l[6]*=o,l[10]*=o,l[14]*=o,l[3]*=o,l[7]*=o,l[11]*=o,l[15]*=o,this}determinant(){const o=this.elements,l=o[0],p=o[4],v=o[8],y=o[12],x=o[1],E=o[5],I=o[9],R=o[13],F=o[2],k=o[6],U=o[10],G=o[14];return o[3]*(+y*I*k-v*R*k-y*E*U+p*R*U+v*E*G-p*I*G)+o[7]*(+l*I*G-l*R*U+y*x*U-v*x*G+v*R*F-y*I*F)+o[11]*(+l*R*k-l*E*G-y*x*k+p*x*G+y*E*F-p*R*F)+o[15]*(-v*E*F-l*I*k+l*E*U+v*x*k-p*x*U+p*I*F)}transpose(){const o=this.elements;let l;return l=o[1],o[1]=o[4],o[4]=l,l=o[2],o[2]=o[8],o[8]=l,l=o[6],o[6]=o[9],o[9]=l,l=o[3],o[3]=o[12],o[12]=l,l=o[7],o[7]=o[13],o[13]=l,l=o[11],o[11]=o[14],o[14]=l,this}setPosition(o,l,p){const v=this.elements;return o.isVector3?(v[12]=o.x,v[13]=o.y,v[14]=o.z):(v[12]=o,v[13]=l,v[14]=p),this}invert(){const o=this.elements,l=o[0],p=o[1],v=o[2],y=o[3],x=o[4],E=o[5],I=o[6],R=o[7],F=o[8],k=o[9],U=o[10],G=o[11],Y=o[12],re=o[13],ie=o[14],$=o[15],q=k*ie*R-re*U*R+re*I*G-E*ie*G-k*I*$+E*U*$,Ae=Y*U*R-F*ie*R-Y*I*G+x*ie*G+F*I*$-x*U*$,Ie=F*re*R-Y*k*R+Y*E*G-x*re*G-F*E*$+x*k*$,Se=Y*k*I-F*re*I-Y*E*U+x*re*U+F*E*ie-x*k*ie,he=l*q+p*Ae+v*Ie+y*Se;if(0===he)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const De=1/he;return o[0]=q*De,o[1]=(re*U*y-k*ie*y-re*v*G+p*ie*G+k*v*$-p*U*$)*De,o[2]=(E*ie*y-re*I*y+re*v*R-p*ie*R-E*v*$+p*I*$)*De,o[3]=(k*I*y-E*U*y-k*v*R+p*U*R+E*v*G-p*I*G)*De,o[4]=Ae*De,o[5]=(F*ie*y-Y*U*y+Y*v*G-l*ie*G-F*v*$+l*U*$)*De,o[6]=(Y*I*y-x*ie*y-Y*v*R+l*ie*R+x*v*$-l*I*$)*De,o[7]=(x*U*y-F*I*y+F*v*R-l*U*R-x*v*G+l*I*G)*De,o[8]=Ie*De,o[9]=(Y*k*y-F*re*y-Y*p*G+l*re*G+F*p*$-l*k*$)*De,o[10]=(x*re*y-Y*E*y+Y*p*R-l*re*R-x*p*$+l*E*$)*De,o[11]=(F*E*y-x*k*y-F*p*R+l*k*R+x*p*G-l*E*G)*De,o[12]=Se*De,o[13]=(F*re*v-Y*k*v+Y*p*U-l*re*U-F*p*ie+l*k*ie)*De,o[14]=(Y*E*v-x*re*v-Y*p*I+l*re*I+x*p*ie-l*E*ie)*De,o[15]=(x*k*v-F*E*v+F*p*I-l*k*I-x*p*U+l*E*U)*De,this}scale(o){const l=this.elements,p=o.x,v=o.y,y=o.z;return l[0]*=p,l[4]*=v,l[8]*=y,l[1]*=p,l[5]*=v,l[9]*=y,l[2]*=p,l[6]*=v,l[10]*=y,l[3]*=p,l[7]*=v,l[11]*=y,this}getMaxScaleOnAxis(){const o=this.elements;return Math.sqrt(Math.max(o[0]*o[0]+o[1]*o[1]+o[2]*o[2],o[4]*o[4]+o[5]*o[5]+o[6]*o[6],o[8]*o[8]+o[9]*o[9]+o[10]*o[10]))}makeTranslation(o,l,p){return this.set(1,0,0,o,0,1,0,l,0,0,1,p,0,0,0,1),this}makeRotationX(o){const l=Math.cos(o),p=Math.sin(o);return this.set(1,0,0,0,0,l,-p,0,0,p,l,0,0,0,0,1),this}makeRotationY(o){const l=Math.cos(o),p=Math.sin(o);return this.set(l,0,p,0,0,1,0,0,-p,0,l,0,0,0,0,1),this}makeRotationZ(o){const l=Math.cos(o),p=Math.sin(o);return this.set(l,-p,0,0,p,l,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(o,l){const p=Math.cos(l),v=Math.sin(l),y=1-p,x=o.x,E=o.y,I=o.z,R=y*x,F=y*E;return this.set(R*x+p,R*E-v*I,R*I+v*E,0,R*E+v*I,F*E+p,F*I-v*x,0,R*I-v*E,F*I+v*x,y*I*I+p,0,0,0,0,1),this}makeScale(o,l,p){return this.set(o,0,0,0,0,l,0,0,0,0,p,0,0,0,0,1),this}makeShear(o,l,p){return this.set(1,l,p,0,o,1,p,0,o,l,1,0,0,0,0,1),this}compose(o,l,p){const v=this.elements,y=l._x,x=l._y,E=l._z,I=l._w,R=y+y,F=x+x,k=E+E,U=y*R,G=y*F,Y=y*k,re=x*F,ie=x*k,$=E*k,q=I*R,Ae=I*F,Ie=I*k,Se=p.x,he=p.y,De=p.z;return v[0]=(1-(re+$))*Se,v[1]=(G+Ie)*Se,v[2]=(Y-Ae)*Se,v[3]=0,v[4]=(G-Ie)*he,v[5]=(1-(U+$))*he,v[6]=(ie+q)*he,v[7]=0,v[8]=(Y+Ae)*De,v[9]=(ie-q)*De,v[10]=(1-(U+re))*De,v[11]=0,v[12]=o.x,v[13]=o.y,v[14]=o.z,v[15]=1,this}decompose(o,l,p){const v=this.elements;let y=dl.set(v[0],v[1],v[2]).length();const x=dl.set(v[4],v[5],v[6]).length(),E=dl.set(v[8],v[9],v[10]).length();this.determinant()<0&&(y=-y),o.x=v[12],o.y=v[13],o.z=v[14],hl.copy(this);const R=1/y,F=1/x,k=1/E;return hl.elements[0]*=R,hl.elements[1]*=R,hl.elements[2]*=R,hl.elements[4]*=F,hl.elements[5]*=F,hl.elements[6]*=F,hl.elements[8]*=k,hl.elements[9]*=k,hl.elements[10]*=k,l.setFromRotationMatrix(hl),p.x=y,p.y=x,p.z=E,this}makePerspective(o,l,p,v,y,x){void 0===x&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const E=this.elements,R=2*y/(p-v),F=(l+o)/(l-o),k=(p+v)/(p-v),U=-(x+y)/(x-y),G=-2*x*y/(x-y);return E[0]=2*y/(l-o),E[4]=0,E[8]=F,E[12]=0,E[1]=0,E[5]=R,E[9]=k,E[13]=0,E[2]=0,E[6]=0,E[10]=U,E[14]=G,E[3]=0,E[7]=0,E[11]=-1,E[15]=0,this}makeOrthographic(o,l,p,v,y,x){const E=this.elements,I=1/(l-o),R=1/(p-v),F=1/(x-y),k=(l+o)*I,U=(p+v)*R,G=(x+y)*F;return E[0]=2*I,E[4]=0,E[8]=0,E[12]=-k,E[1]=0,E[5]=2*R,E[9]=0,E[13]=-U,E[2]=0,E[6]=0,E[10]=-2*F,E[14]=-G,E[3]=0,E[7]=0,E[11]=0,E[15]=1,this}equals(o){const l=this.elements,p=o.elements;for(let v=0;v<16;v++)if(l[v]!==p[v])return!1;return!0}fromArray(o,l=0){for(let p=0;p<16;p++)this.elements[p]=o[p+l];return this}toArray(o=[],l=0){const p=this.elements;return o[l]=p[0],o[l+1]=p[1],o[l+2]=p[2],o[l+3]=p[3],o[l+4]=p[4],o[l+5]=p[5],o[l+6]=p[6],o[l+7]=p[7],o[l+8]=p[8],o[l+9]=p[9],o[l+10]=p[10],o[l+11]=p[11],o[l+12]=p[12],o[l+13]=p[13],o[l+14]=p[14],o[l+15]=p[15],o}}const dl=new xe,hl=new Kt,Kr=new xe(0,0,0),lh=new xe(1,1,1),Ec=new xe,zr=new xe,Es=new xe;let cu=(()=>{class a{constructor(l=0,p=0,v=0,y=a.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=l,this._y=p,this._z=v,this._order=y}get x(){return this._x}set x(l){this._x=l,this._onChangeCallback()}get y(){return this._y}set y(l){this._y=l,this._onChangeCallback()}get z(){return this._z}set z(l){this._z=l,this._onChangeCallback()}get order(){return this._order}set order(l){this._order=l,this._onChangeCallback()}set(l,p,v,y){return this._x=l,this._y=p,this._z=v,this._order=y||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(l){return this._x=l._x,this._y=l._y,this._z=l._z,this._order=l._order,this._onChangeCallback(),this}setFromRotationMatrix(l,p,v){const y=pi.clamp,x=l.elements,E=x[0],I=x[4],R=x[8],F=x[1],k=x[5],U=x[9],G=x[2],Y=x[6],re=x[10];switch(p=p||this._order){case"XYZ":this._y=Math.asin(y(R,-1,1)),Math.abs(R)<.9999999?(this._x=Math.atan2(-U,re),this._z=Math.atan2(-I,E)):(this._x=Math.atan2(Y,k),this._z=0);break;case"YXZ":this._x=Math.asin(-y(U,-1,1)),Math.abs(U)<.9999999?(this._y=Math.atan2(R,re),this._z=Math.atan2(F,k)):(this._y=Math.atan2(-G,E),this._z=0);break;case"ZXY":this._x=Math.asin(y(Y,-1,1)),Math.abs(Y)<.9999999?(this._y=Math.atan2(-G,re),this._z=Math.atan2(-I,k)):(this._y=0,this._z=Math.atan2(F,E));break;case"ZYX":this._y=Math.asin(-y(G,-1,1)),Math.abs(G)<.9999999?(this._x=Math.atan2(Y,re),this._z=Math.atan2(F,E)):(this._x=0,this._z=Math.atan2(-I,k));break;case"YZX":this._z=Math.asin(y(F,-1,1)),Math.abs(F)<.9999999?(this._x=Math.atan2(-U,k),this._y=Math.atan2(-G,E)):(this._x=0,this._y=Math.atan2(R,re));break;case"XZY":this._z=Math.asin(-y(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(Y,k),this._y=Math.atan2(R,E)):(this._x=Math.atan2(-U,re),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+p)}return this._order=p,!1!==v&&this._onChangeCallback(),this}setFromQuaternion(l,p,v){return Uu.makeRotationFromQuaternion(l),this.setFromRotationMatrix(Uu,p,v)}setFromVector3(l,p){return this.set(l.x,l.y,l.z,p||this._order)}reorder(l){return ds.setFromEuler(this),this.setFromQuaternion(ds,l)}equals(l){return l._x===this._x&&l._y===this._y&&l._z===this._z&&l._order===this._order}fromArray(l){return this._x=l[0],this._y=l[1],this._z=l[2],void 0!==l[3]&&(this._order=l[3]),this._onChangeCallback(),this}toArray(l=[],p=0){return l[p]=this._x,l[p+1]=this._y,l[p+2]=this._z,l[p+3]=this._order,l}toVector3(l){return l?l.set(this._x,this._y,this._z):new xe(this._x,this._y,this._z)}_onChange(l){return this._onChangeCallback=l,this}_onChangeCallback(){}}return a.DefaultOrder="XYZ",a.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],a})();const Uu=new Kt,ds=new ci;class wa{constructor(){this.mask=1}set(o){this.mask=1<<o|0}enable(o){this.mask|=1<<o|0}enableAll(){this.mask=-1}toggle(o){this.mask^=1<<o|0}disable(o){this.mask&=~(1<<o|0)}disableAll(){this.mask=0}test(o){return 0!=(this.mask&o.mask)}}let Fy=0;const Ga=new xe,ja=new ci,ca=new Kt,Vu=new xe,Hu=new xe,fl=new xe,kf=new ci,Gu=new xe(1,0,0),Wg=new xe(0,1,0),uh=new xe(0,0,1),V_={type:"added"},H_={type:"removed"};function Jn(){Object.defineProperty(this,"id",{value:Fy++}),this.uuid=pi.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Jn.DefaultUp.clone();const a=new xe,o=new cu,l=new ci,p=new xe(1,1,1);o._onChange(function v(){l.setFromEuler(o,!1)}),l._onChange(function y(){o.setFromQuaternion(l,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:o},quaternion:{configurable:!0,enumerable:!0,value:l},scale:{configurable:!0,enumerable:!0,value:p},modelViewMatrix:{value:new Kt},normalMatrix:{value:new la}}),this.matrix=new Kt,this.matrixWorld=new Kt,this.matrixAutoUpdate=Jn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new wa,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Jn.DefaultUp=new xe(0,1,0),Jn.DefaultMatrixAutoUpdate=!0,Jn.prototype=Object.assign(Object.create(Go.prototype),{constructor:Jn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(a){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(a),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){return this.quaternion.premultiply(a),this},setRotationFromAxisAngle:function(a,o){this.quaternion.setFromAxisAngle(a,o)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(a,o){return ja.setFromAxisAngle(a,o),this.quaternion.multiply(ja),this},rotateOnWorldAxis:function(a,o){return ja.setFromAxisAngle(a,o),this.quaternion.premultiply(ja),this},rotateX:function(a){return this.rotateOnAxis(Gu,a)},rotateY:function(a){return this.rotateOnAxis(Wg,a)},rotateZ:function(a){return this.rotateOnAxis(uh,a)},translateOnAxis:function(a,o){return Ga.copy(a).applyQuaternion(this.quaternion),this.position.add(Ga.multiplyScalar(o)),this},translateX:function(a){return this.translateOnAxis(Gu,a)},translateY:function(a){return this.translateOnAxis(Wg,a)},translateZ:function(a){return this.translateOnAxis(uh,a)},localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(a){return a.applyMatrix4(ca.copy(this.matrixWorld).invert())},lookAt:function(a,o,l){a.isVector3?Vu.copy(a):Vu.set(a,o,l);const p=this.parent;this.updateWorldMatrix(!0,!1),Hu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ca.lookAt(Hu,Vu,this.up):ca.lookAt(Vu,Hu,this.up),this.quaternion.setFromRotationMatrix(ca),p&&(ca.extractRotation(p.matrixWorld),ja.setFromRotationMatrix(ca),this.quaternion.premultiply(ja.invert()))},add:function(a){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}return a===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this):(a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,this.children.push(a),a.dispatchEvent(V_)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this)},remove:function(a){if(arguments.length>1){for(let l=0;l<arguments.length;l++)this.remove(arguments[l]);return this}const o=this.children.indexOf(a);return-1!==o&&(a.parent=null,this.children.splice(o,1),a.dispatchEvent(H_)),this},clear:function(){for(let a=0;a<this.children.length;a++){const o=this.children[a];o.parent=null,o.dispatchEvent(H_)}return this.children.length=0,this},attach:function(a){return this.updateWorldMatrix(!0,!1),ca.copy(this.matrixWorld).invert(),null!==a.parent&&(a.parent.updateWorldMatrix(!0,!1),ca.multiply(a.parent.matrixWorld)),a.applyMatrix4(ca),a.updateWorldMatrix(!1,!1),this.add(a),this},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,o){if(this[a]===o)return this;for(let l=0,p=this.children.length;l<p;l++){const y=this.children[l].getObjectByProperty(a,o);if(void 0!==y)return y}},getWorldPosition:function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),a=new xe),this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),a=new ci),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Hu,a,fl),a},getWorldScale:function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),a=new xe),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Hu,kf,a),a},getWorldDirection:function(a){void 0===a&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),a=new xe),this.updateWorldMatrix(!0,!1);const o=this.matrixWorld.elements;return a.set(o[8],o[9],o[10]).normalize()},raycast:function(){},traverse:function(a){a(this);const o=this.children;for(let l=0,p=o.length;l<p;l++)o[l].traverse(a)},traverseVisible:function(a){if(!1===this.visible)return;a(this);const o=this.children;for(let l=0,p=o.length;l<p;l++)o[l].traverseVisible(a)},traverseAncestors:function(a){const o=this.parent;null!==o&&(a(o),o.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);const o=this.children;for(let l=0,p=o.length;l<p;l++)o[l].updateMatrixWorld(a)},updateWorldMatrix:function(a,o){const l=this.parent;if(!0===a&&null!==l&&l.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===o){const p=this.children;for(let v=0,y=p.length;v<y;v++)p[v].updateWorldMatrix(!1,!0)}},toJSON:function(a){const o=void 0===a||"string"==typeof a,l={};o&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},l.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const p={};function v(x,E){return void 0===x[E.uuid]&&(x[E.uuid]=E.toJSON(a)),E.uuid}if(p.uuid=this.uuid,p.type=this.type,""!==this.name&&(p.name=this.name),!0===this.castShadow&&(p.castShadow=!0),!0===this.receiveShadow&&(p.receiveShadow=!0),!1===this.visible&&(p.visible=!1),!1===this.frustumCulled&&(p.frustumCulled=!1),0!==this.renderOrder&&(p.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(p.userData=this.userData),p.layers=this.layers.mask,p.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(p.matrixAutoUpdate=!1),this.isInstancedMesh&&(p.type="InstancedMesh",p.count=this.count,p.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){p.geometry=v(a.geometries,this.geometry);const x=this.geometry.parameters;if(void 0!==x&&void 0!==x.shapes){const E=x.shapes;if(Array.isArray(E))for(let I=0,R=E.length;I<R;I++)v(a.shapes,E[I]);else v(a.shapes,E)}}if(this.isSkinnedMesh&&(p.bindMode=this.bindMode,p.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(v(a.skeletons,this.skeleton),p.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const x=[];for(let E=0,I=this.material.length;E<I;E++)x.push(v(a.materials,this.material[E]));p.material=x}else p.material=v(a.materials,this.material);if(this.children.length>0){p.children=[];for(let x=0;x<this.children.length;x++)p.children.push(this.children[x].toJSON(a).object)}if(this.animations.length>0){p.animations=[];for(let x=0;x<this.animations.length;x++)p.animations.push(v(a.animations,this.animations[x]))}if(o){const x=y(a.geometries),E=y(a.materials),I=y(a.textures),R=y(a.images),F=y(a.shapes),k=y(a.skeletons),U=y(a.animations);x.length>0&&(l.geometries=x),E.length>0&&(l.materials=E),I.length>0&&(l.textures=I),R.length>0&&(l.images=R),F.length>0&&(l.shapes=F),k.length>0&&(l.skeletons=k),U.length>0&&(l.animations=U)}return l.object=p,l;function y(x){const E=[];for(const I in x){const R=x[I];delete R.metadata,E.push(R)}return E}},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,o=!0){if(this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.userData=JSON.parse(JSON.stringify(a.userData)),!0===o)for(let l=0;l<a.children.length;l++)this.add(a.children[l].clone());return this}});const cm=new xe,G_=new xe,Ao=new la;class Pl{constructor(o,l){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==o?o:new xe(1,0,0),this.constant=void 0!==l?l:0}set(o,l){return this.normal.copy(o),this.constant=l,this}setComponents(o,l,p,v){return this.normal.set(o,l,p),this.constant=v,this}setFromNormalAndCoplanarPoint(o,l){return this.normal.copy(o),this.constant=-l.dot(this.normal),this}setFromCoplanarPoints(o,l,p){const v=cm.subVectors(p,l).cross(G_.subVectors(o,l)).normalize();return this.setFromNormalAndCoplanarPoint(v,o),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.normal.copy(o.normal),this.constant=o.constant,this}normalize(){const o=1/this.normal.length();return this.normal.multiplyScalar(o),this.constant*=o,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(o){return this.normal.dot(o)+this.constant}distanceToSphere(o){return this.distanceToPoint(o.center)-o.radius}projectPoint(o,l){return void 0===l&&(console.warn("THREE.Plane: .projectPoint() target is now required"),l=new xe),l.copy(this.normal).multiplyScalar(-this.distanceToPoint(o)).add(o)}intersectLine(o,l){void 0===l&&(console.warn("THREE.Plane: .intersectLine() target is now required"),l=new xe);const p=o.delta(cm),v=this.normal.dot(p);if(0===v)return 0===this.distanceToPoint(o.start)?l.copy(o.start):void 0;const y=-(o.start.dot(this.normal)+this.constant)/v;return y<0||y>1?void 0:l.copy(p).multiplyScalar(y).add(o.start)}intersectsLine(o){const l=this.distanceToPoint(o.start),p=this.distanceToPoint(o.end);return l<0&&p>0||p<0&&l>0}intersectsBox(o){return o.intersectsPlane(this)}intersectsSphere(o){return o.intersectsPlane(this)}coplanarPoint(o){return void 0===o&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),o=new xe),o.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(o,l){const p=l||Ao.getNormalMatrix(o),v=this.coplanarPoint(cm).applyMatrix4(o),y=this.normal.applyMatrix3(p).normalize();return this.constant=-v.dot(y),this}translate(o){return this.constant-=o.dot(this.normal),this}equals(o){return o.normal.equals(this.normal)&&o.constant===this.constant}}const du=new xe,ju=new xe,$g=new xe,Cc=new xe,hu=new xe,fu=new xe,j_=new xe,Ff=new xe,$i=new xe,Dc=new xe;class za{constructor(o,l,p){this.a=void 0!==o?o:new xe,this.b=void 0!==l?l:new xe,this.c=void 0!==p?p:new xe}static getNormal(o,l,p,v){void 0===v&&(console.warn("THREE.Triangle: .getNormal() target is now required"),v=new xe),v.subVectors(p,l),du.subVectors(o,l),v.cross(du);const y=v.lengthSq();return y>0?v.multiplyScalar(1/Math.sqrt(y)):v.set(0,0,0)}static getBarycoord(o,l,p,v,y){du.subVectors(v,l),ju.subVectors(p,l),$g.subVectors(o,l);const x=du.dot(du),E=du.dot(ju),I=du.dot($g),R=ju.dot(ju),F=ju.dot($g),k=x*R-E*E;if(void 0===y&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),y=new xe),0===k)return y.set(-2,-1,-1);const U=1/k,G=(R*I-E*F)*U,Y=(x*F-E*I)*U;return y.set(1-G-Y,Y,G)}static containsPoint(o,l,p,v){return this.getBarycoord(o,l,p,v,Cc),Cc.x>=0&&Cc.y>=0&&Cc.x+Cc.y<=1}static getUV(o,l,p,v,y,x,E,I){return this.getBarycoord(o,l,p,v,Cc),I.set(0,0),I.addScaledVector(y,Cc.x),I.addScaledVector(x,Cc.y),I.addScaledVector(E,Cc.z),I}static isFrontFacing(o,l,p,v){return du.subVectors(p,l),ju.subVectors(o,l),du.cross(ju).dot(v)<0}set(o,l,p){return this.a.copy(o),this.b.copy(l),this.c.copy(p),this}setFromPointsAndIndices(o,l,p,v){return this.a.copy(o[l]),this.b.copy(o[p]),this.c.copy(o[v]),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.a.copy(o.a),this.b.copy(o.b),this.c.copy(o.c),this}getArea(){return du.subVectors(this.c,this.b),ju.subVectors(this.a,this.b),.5*du.cross(ju).length()}getMidpoint(o){return void 0===o&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),o=new xe),o.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(o){return za.getNormal(this.a,this.b,this.c,o)}getPlane(o){return void 0===o&&(console.warn("THREE.Triangle: .getPlane() target is now required"),o=new Pl),o.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(o,l){return za.getBarycoord(o,this.a,this.b,this.c,l)}getUV(o,l,p,v,y){return za.getUV(o,this.a,this.b,this.c,l,p,v,y)}containsPoint(o){return za.containsPoint(o,this.a,this.b,this.c)}isFrontFacing(o){return za.isFrontFacing(this.a,this.b,this.c,o)}intersectsBox(o){return o.intersectsTriangle(this)}closestPointToPoint(o,l){void 0===l&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),l=new xe);const p=this.a,v=this.b,y=this.c;let x,E;hu.subVectors(v,p),fu.subVectors(y,p),Ff.subVectors(o,p);const I=hu.dot(Ff),R=fu.dot(Ff);if(I<=0&&R<=0)return l.copy(p);$i.subVectors(o,v);const F=hu.dot($i),k=fu.dot($i);if(F>=0&&k<=F)return l.copy(v);const U=I*k-F*R;if(U<=0&&I>=0&&F<=0)return x=I/(I-F),l.copy(p).addScaledVector(hu,x);Dc.subVectors(o,y);const G=hu.dot(Dc),Y=fu.dot(Dc);if(Y>=0&&G<=Y)return l.copy(y);const re=G*R-I*Y;if(re<=0&&R>=0&&Y<=0)return E=R/(R-Y),l.copy(p).addScaledVector(fu,E);const ie=F*Y-G*k;if(ie<=0&&k-F>=0&&G-Y>=0)return j_.subVectors(y,v),E=(k-F)/(k-F+(G-Y)),l.copy(v).addScaledVector(j_,E);const $=1/(ie+re+U);return x=re*$,E=U*$,l.copy(p).addScaledVector(hu,x).addScaledVector(fu,E)}equals(o){return o.a.equals(this.a)&&o.b.equals(this.b)&&o.c.equals(this.c)}}const cd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hs={h:0,s:0,l:0},Mc={h:0,s:0,l:0};function Aa(a,o,l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?a+6*(o-a)*l:l<.5?o:l<2/3?a+6*(o-a)*(2/3-l):a}function Bf(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function Ol(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}let ei=(()=>{class a{constructor(l,p,v){return Object.defineProperty(this,"isColor",{value:!0}),void 0===p&&void 0===v?this.set(l):this.setRGB(l,p,v)}set(l){return l&&l.isColor?this.copy(l):"number"==typeof l?this.setHex(l):"string"==typeof l&&this.setStyle(l),this}setScalar(l){return this.r=l,this.g=l,this.b=l,this}setHex(l){return l=Math.floor(l),this.r=(l>>16&255)/255,this.g=(l>>8&255)/255,this.b=(255&l)/255,this}setRGB(l,p,v){return this.r=l,this.g=p,this.b=v,this}setHSL(l,p,v){if(l=pi.euclideanModulo(l,1),p=pi.clamp(p,0,1),v=pi.clamp(v,0,1),0===p)this.r=this.g=this.b=v;else{const y=v<=.5?v*(1+p):v+p-v*p,x=2*v-y;this.r=Aa(x,y,l+1/3),this.g=Aa(x,y,l),this.b=Aa(x,y,l-1/3)}return this}setStyle(l){function p(y){void 0!==y&&parseFloat(y)<1&&console.warn("THREE.Color: Alpha component of "+l+" will be ignored.")}let v;if(v=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(l)){let y;const E=v[2];switch(v[1]){case"rgb":case"rgba":if(y=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(E))return this.r=Math.min(255,parseInt(y[1],10))/255,this.g=Math.min(255,parseInt(y[2],10))/255,this.b=Math.min(255,parseInt(y[3],10))/255,p(y[4]),this;if(y=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(E))return this.r=Math.min(100,parseInt(y[1],10))/100,this.g=Math.min(100,parseInt(y[2],10))/100,this.b=Math.min(100,parseInt(y[3],10))/100,p(y[4]),this;break;case"hsl":case"hsla":if(y=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(E)){const I=parseFloat(y[1])/360,R=parseInt(y[2],10)/100,F=parseInt(y[3],10)/100;return p(y[4]),this.setHSL(I,R,F)}}}else if(v=/^\#([A-Fa-f\d]+)$/.exec(l)){const y=v[1],x=y.length;if(3===x)return this.r=parseInt(y.charAt(0)+y.charAt(0),16)/255,this.g=parseInt(y.charAt(1)+y.charAt(1),16)/255,this.b=parseInt(y.charAt(2)+y.charAt(2),16)/255,this;if(6===x)return this.r=parseInt(y.charAt(0)+y.charAt(1),16)/255,this.g=parseInt(y.charAt(2)+y.charAt(3),16)/255,this.b=parseInt(y.charAt(4)+y.charAt(5),16)/255,this}return l&&l.length>0?this.setColorName(l):this}setColorName(l){const p=cd[l];return void 0!==p?this.setHex(p):console.warn("THREE.Color: Unknown color "+l),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(l){return this.r=l.r,this.g=l.g,this.b=l.b,this}copyGammaToLinear(l,p=2){return this.r=Math.pow(l.r,p),this.g=Math.pow(l.g,p),this.b=Math.pow(l.b,p),this}copyLinearToGamma(l,p=2){const v=p>0?1/p:1;return this.r=Math.pow(l.r,v),this.g=Math.pow(l.g,v),this.b=Math.pow(l.b,v),this}convertGammaToLinear(l){return this.copyGammaToLinear(this,l),this}convertLinearToGamma(l){return this.copyLinearToGamma(this,l),this}copySRGBToLinear(l){return this.r=Bf(l.r),this.g=Bf(l.g),this.b=Bf(l.b),this}copyLinearToSRGB(l){return this.r=Ol(l.r),this.g=Ol(l.g),this.b=Ol(l.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(l){void 0===l&&(console.warn("THREE.Color: .getHSL() target is now required"),l={h:0,s:0,l:0});const p=this.r,v=this.g,y=this.b,x=Math.max(p,v,y),E=Math.min(p,v,y);let I,R;const F=(E+x)/2;if(E===x)I=0,R=0;else{const k=x-E;switch(R=F<=.5?k/(x+E):k/(2-x-E),x){case p:I=(v-y)/k+(v<y?6:0);break;case v:I=(y-p)/k+2;break;case y:I=(p-v)/k+4}I/=6}return l.h=I,l.s=R,l.l=F,l}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(l,p,v){return this.getHSL(hs),hs.h+=l,hs.s+=p,hs.l+=v,this.setHSL(hs.h,hs.s,hs.l),this}add(l){return this.r+=l.r,this.g+=l.g,this.b+=l.b,this}addColors(l,p){return this.r=l.r+p.r,this.g=l.g+p.g,this.b=l.b+p.b,this}addScalar(l){return this.r+=l,this.g+=l,this.b+=l,this}sub(l){return this.r=Math.max(0,this.r-l.r),this.g=Math.max(0,this.g-l.g),this.b=Math.max(0,this.b-l.b),this}multiply(l){return this.r*=l.r,this.g*=l.g,this.b*=l.b,this}multiplyScalar(l){return this.r*=l,this.g*=l,this.b*=l,this}lerp(l,p){return this.r+=(l.r-this.r)*p,this.g+=(l.g-this.g)*p,this.b+=(l.b-this.b)*p,this}lerpColors(l,p,v){return this.r=l.r+(p.r-l.r)*v,this.g=l.g+(p.g-l.g)*v,this.b=l.b+(p.b-l.b)*v,this}lerpHSL(l,p){this.getHSL(hs),l.getHSL(Mc);const v=pi.lerp(hs.h,Mc.h,p),y=pi.lerp(hs.s,Mc.s,p),x=pi.lerp(hs.l,Mc.l,p);return this.setHSL(v,y,x),this}equals(l){return l.r===this.r&&l.g===this.g&&l.b===this.b}fromArray(l,p=0){return this.r=l[p],this.g=l[p+1],this.b=l[p+2],this}toArray(l=[],p=0){return l[p]=this.r,l[p+1]=this.g,l[p+2]=this.b,l}fromBufferAttribute(l,p){return this.r=l.getX(p),this.g=l.getY(p),this.b=l.getZ(p),!0===l.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return a.NAMES=cd,a})();ei.prototype.r=1,ei.prototype.g=1,ei.prototype.b=1;class dd{constructor(o,l,p,v,y,x=0){this.a=o,this.b=l,this.c=p,this.normal=v&&v.isVector3?v:new xe,this.vertexNormals=Array.isArray(v)?v:[],this.color=y&&y.isColor?y:new ei,this.vertexColors=Array.isArray(y)?y:[],this.materialIndex=x}clone(){return(new this.constructor).copy(this)}copy(o){this.a=o.a,this.b=o.b,this.c=o.c,this.normal.copy(o.normal),this.color.copy(o.color),this.materialIndex=o.materialIndex;for(let l=0,p=o.vertexNormals.length;l<p;l++)this.vertexNormals[l]=o.vertexNormals[l].clone();for(let l=0,p=o.vertexColors.length;l<p;l++)this.vertexColors[l]=o.vertexColors[l].clone();return this}}let Uf=0;function _i(){Object.defineProperty(this,"id",{value:Uf++}),this.uuid=pi.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Pa(a){_i.call(this),this.type="MeshBasicMaterial",this.color=new ei(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(a)}_i.prototype=Object.assign(Object.create(Go.prototype),{constructor:_i,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(a){if(void 0!==a)for(const o in a){const l=a[o];if(void 0===l){console.warn("THREE.Material: '"+o+"' parameter is undefined.");continue}if("shading"===o){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===l;continue}const p=this[o];void 0!==p?p&&p.isColor?p.set(l):p&&p.isVector3&&l&&l.isVector3?p.copy(l):this[o]=l:console.warn("THREE."+this.type+": '"+o+"' is not a property of this material.")}},toJSON:function(a){const o=void 0===a||"string"==typeof a;o&&(a={textures:{},images:{}});const l={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function p(v){const y=[];for(const x in v){const E=v[x];delete E.metadata,y.push(E)}return y}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),this.color&&this.color.isColor&&(l.color=this.color.getHex()),void 0!==this.roughness&&(l.roughness=this.roughness),void 0!==this.metalness&&(l.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(l.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(l.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(l.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(l.specular=this.specular.getHex()),void 0!==this.shininess&&(l.shininess=this.shininess),void 0!==this.clearcoat&&(l.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(l.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(l.clearcoatMap=this.clearcoatMap.toJSON(a).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(l.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(l.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,l.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(l.map=this.map.toJSON(a).uuid),this.matcap&&this.matcap.isTexture&&(l.matcap=this.matcap.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(l.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(l.lightMap=this.lightMap.toJSON(a).uuid),this.aoMap&&this.aoMap.isTexture&&(l.aoMap=this.aoMap.toJSON(a).uuid,l.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(l.bumpMap=this.bumpMap.toJSON(a).uuid,l.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(l.normalMap=this.normalMap.toJSON(a).uuid,l.normalMapType=this.normalMapType,l.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(l.displacementMap=this.displacementMap.toJSON(a).uuid,l.displacementScale=this.displacementScale,l.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(l.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(l.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(l.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(l.specularMap=this.specularMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(l.envMap=this.envMap.toJSON(a).uuid,l.reflectivity=this.reflectivity,l.refractionRatio=this.refractionRatio,void 0!==this.combine&&(l.combine=this.combine),void 0!==this.envMapIntensity&&(l.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(l.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.size&&(l.size=this.size),void 0!==this.sizeAttenuation&&(l.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(l.blending=this.blending),!0===this.flatShading&&(l.flatShading=this.flatShading),0!==this.side&&(l.side=this.side),this.vertexColors&&(l.vertexColors=!0),this.opacity<1&&(l.opacity=this.opacity),!0===this.transparent&&(l.transparent=this.transparent),l.depthFunc=this.depthFunc,l.depthTest=this.depthTest,l.depthWrite=this.depthWrite,l.stencilWrite=this.stencilWrite,l.stencilWriteMask=this.stencilWriteMask,l.stencilFunc=this.stencilFunc,l.stencilRef=this.stencilRef,l.stencilFuncMask=this.stencilFuncMask,l.stencilFail=this.stencilFail,l.stencilZFail=this.stencilZFail,l.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(l.rotation=this.rotation),!0===this.polygonOffset&&(l.polygonOffset=!0),0!==this.polygonOffsetFactor&&(l.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(l.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(l.linewidth=this.linewidth),void 0!==this.dashSize&&(l.dashSize=this.dashSize),void 0!==this.gapSize&&(l.gapSize=this.gapSize),void 0!==this.scale&&(l.scale=this.scale),!0===this.dithering&&(l.dithering=!0),this.alphaTest>0&&(l.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(l.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(l.wireframe=this.wireframe),this.wireframeLinewidth>1&&(l.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(l.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(l.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(l.morphTargets=!0),!0===this.morphNormals&&(l.morphNormals=!0),!0===this.skinning&&(l.skinning=!0),!1===this.visible&&(l.visible=!1),!1===this.toneMapped&&(l.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(l.userData=this.userData),o){const v=p(a.textures),y=p(a.images);v.length>0&&(l.textures=v),y.length>0&&(l.images=y)}return l},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name,this.fog=a.fog,this.blending=a.blending,this.side=a.side,this.flatShading=a.flatShading,this.vertexColors=a.vertexColors,this.opacity=a.opacity,this.transparent=a.transparent,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.stencilWriteMask=a.stencilWriteMask,this.stencilFunc=a.stencilFunc,this.stencilRef=a.stencilRef,this.stencilFuncMask=a.stencilFuncMask,this.stencilFail=a.stencilFail,this.stencilZFail=a.stencilZFail,this.stencilZPass=a.stencilZPass,this.stencilWrite=a.stencilWrite;const o=a.clippingPlanes;let l=null;if(null!==o){const p=o.length;l=new Array(p);for(let v=0;v!==p;++v)l[v]=o[v].clone()}return this.clippingPlanes=l,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.premultipliedAlpha=a.premultipliedAlpha,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(_i.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),(Pa.prototype=Object.create(_i.prototype)).constructor=Pa,Pa.prototype.isMeshBasicMaterial=!0,Pa.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this};const wr=new xe,da=new qe;function Ii(a,o,l){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=a,this.itemSize=o,this.count=void 0!==a?a.length/o:0,this.normalized=!0===l,this.usage=Cr,this.updateRange={offset:0,count:-1},this.version=0}function dm(a,o,l){Ii.call(this,new Int8Array(a),o,l)}function hd(a,o,l){Ii.call(this,new Uint8Array(a),o,l)}function hm(a,o,l){Ii.call(this,new Uint8ClampedArray(a),o,l)}function fm(a,o,l){Ii.call(this,new Int16Array(a),o,l)}function fs(a,o,l){Ii.call(this,new Uint16Array(a),o,l)}function fd(a,o,l){Ii.call(this,new Int32Array(a),o,l)}function Ll(a,o,l){Ii.call(this,new Uint32Array(a),o,l)}function Ic(a,o,l){Ii.call(this,new Uint16Array(a),o,l)}function zi(a,o,l){Ii.call(this,new Float32Array(a),o,l)}function pm(a,o,l){Ii.call(this,new Float64Array(a),o,l)}function ch(a){if(0===a.length)return-1/0;let o=a[0];for(let l=1,p=a.length;l<p;++l)a[l]>o&&(o=a[l]);return o}Object.defineProperty(Ii.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),Object.assign(Ii.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(a){return this.usage=a,this},copy:function(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this},copyAt:function(a,o,l){a*=this.itemSize,l*=o.itemSize;for(let p=0,v=this.itemSize;p<v;p++)this.array[a+p]=o.array[l+p];return this},copyArray:function(a){return this.array.set(a),this},copyColorsArray:function(a){const o=this.array;let l=0;for(let p=0,v=a.length;p<v;p++){let y=a[p];void 0===y&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",p),y=new ei),o[l++]=y.r,o[l++]=y.g,o[l++]=y.b}return this},copyVector2sArray:function(a){const o=this.array;let l=0;for(let p=0,v=a.length;p<v;p++){let y=a[p];void 0===y&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",p),y=new qe),o[l++]=y.x,o[l++]=y.y}return this},copyVector3sArray:function(a){const o=this.array;let l=0;for(let p=0,v=a.length;p<v;p++){let y=a[p];void 0===y&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",p),y=new xe),o[l++]=y.x,o[l++]=y.y,o[l++]=y.z}return this},copyVector4sArray:function(a){const o=this.array;let l=0;for(let p=0,v=a.length;p<v;p++){let y=a[p];void 0===y&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",p),y=new Hr),o[l++]=y.x,o[l++]=y.y,o[l++]=y.z,o[l++]=y.w}return this},applyMatrix3:function(a){if(2===this.itemSize)for(let o=0,l=this.count;o<l;o++)da.fromBufferAttribute(this,o),da.applyMatrix3(a),this.setXY(o,da.x,da.y);else if(3===this.itemSize)for(let o=0,l=this.count;o<l;o++)wr.fromBufferAttribute(this,o),wr.applyMatrix3(a),this.setXYZ(o,wr.x,wr.y,wr.z);return this},applyMatrix4:function(a){for(let o=0,l=this.count;o<l;o++)wr.x=this.getX(o),wr.y=this.getY(o),wr.z=this.getZ(o),wr.applyMatrix4(a),this.setXYZ(o,wr.x,wr.y,wr.z);return this},applyNormalMatrix:function(a){for(let o=0,l=this.count;o<l;o++)wr.x=this.getX(o),wr.y=this.getY(o),wr.z=this.getZ(o),wr.applyNormalMatrix(a),this.setXYZ(o,wr.x,wr.y,wr.z);return this},transformDirection:function(a){for(let o=0,l=this.count;o<l;o++)wr.x=this.getX(o),wr.y=this.getY(o),wr.z=this.getZ(o),wr.transformDirection(a),this.setXYZ(o,wr.x,wr.y,wr.z);return this},set:function(a,o=0){return this.array.set(a,o),this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,o){return this.array[a*this.itemSize]=o,this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,o){return this.array[a*this.itemSize+1]=o,this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,o){return this.array[a*this.itemSize+2]=o,this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,o){return this.array[a*this.itemSize+3]=o,this},setXY:function(a,o,l){return this.array[0+(a*=this.itemSize)]=o,this.array[a+1]=l,this},setXYZ:function(a,o,l,p){return this.array[0+(a*=this.itemSize)]=o,this.array[a+1]=l,this.array[a+2]=p,this},setXYZW:function(a,o,l,p,v){return this.array[0+(a*=this.itemSize)]=o,this.array[a+1]=l,this.array[a+2]=p,this.array[a+3]=v,this},onUpload:function(a){return this.onUploadCallback=a,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(dm.prototype=Object.create(Ii.prototype)).constructor=dm,(hd.prototype=Object.create(Ii.prototype)).constructor=hd,(hm.prototype=Object.create(Ii.prototype)).constructor=hm,(fm.prototype=Object.create(Ii.prototype)).constructor=fm,(fs.prototype=Object.create(Ii.prototype)).constructor=fs,(fd.prototype=Object.create(Ii.prototype)).constructor=fd,(Ll.prototype=Object.create(Ii.prototype)).constructor=Ll,(Ic.prototype=Object.create(Ii.prototype)).constructor=Ic,Ic.prototype.isFloat16BufferAttribute=!0,(zi.prototype=Object.create(Ii.prototype)).constructor=zi,(pm.prototype=Object.create(Ii.prototype)).constructor=pm;const dh={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function xa(a,o){return new dh[a](o)}let mm=0;const xo=new Kt,gm=new Jn,$o=new xe,So=new js,ro=new js,Fn=new xe;function xi(){Object.defineProperty(this,"id",{value:mm++}),this.uuid=pi.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}xi.prototype=Object.assign(Object.create(Go.prototype),{constructor:xi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(a){return this.index=Array.isArray(a)?new(ch(a)>65535?Ll:fs)(a,1):a,this},getAttribute:function(a){return this.attributes[a]},setAttribute:function(a,o){return this.attributes[a]=o,this},deleteAttribute:function(a){return delete this.attributes[a],this},hasAttribute:function(a){return void 0!==this.attributes[a]},addGroup:function(a,o,l=0){this.groups.push({start:a,count:o,materialIndex:l})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,o){this.drawRange.start=a,this.drawRange.count=o},applyMatrix4:function(a){const o=this.attributes.position;void 0!==o&&(o.applyMatrix4(a),o.needsUpdate=!0);const l=this.attributes.normal;if(void 0!==l){const v=(new la).getNormalMatrix(a);l.applyNormalMatrix(v),l.needsUpdate=!0}const p=this.attributes.tangent;return void 0!==p&&(p.transformDirection(a),p.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(a){return xo.makeRotationX(a),this.applyMatrix4(xo),this},rotateY:function(a){return xo.makeRotationY(a),this.applyMatrix4(xo),this},rotateZ:function(a){return xo.makeRotationZ(a),this.applyMatrix4(xo),this},translate:function(a,o,l){return xo.makeTranslation(a,o,l),this.applyMatrix4(xo),this},scale:function(a,o,l){return xo.makeScale(a,o,l),this.applyMatrix4(xo),this},lookAt:function(a){return gm.lookAt(a),gm.updateMatrix(),this.applyMatrix4(gm.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter($o).negate(),this.translate($o.x,$o.y,$o.z),this},setFromPoints:function(a){const o=[];for(let l=0,p=a.length;l<p;l++){const v=a[l];o.push(v.x,v.y,v.z||0)}return this.setAttribute("position",new zi(o,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new js);const a=this.attributes.position,o=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new xe(-1/0,-1/0,-1/0),new xe(1/0,1/0,1/0));if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),o)for(let l=0,p=o.length;l<p;l++)So.setFromBufferAttribute(o[l]),this.morphTargetsRelative?(Fn.addVectors(this.boundingBox.min,So.min),this.boundingBox.expandByPoint(Fn),Fn.addVectors(this.boundingBox.max,So.max),this.boundingBox.expandByPoint(Fn)):(this.boundingBox.expandByPoint(So.min),this.boundingBox.expandByPoint(So.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new io);const a=this.attributes.position,o=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new xe,1/0);if(a){const l=this.boundingSphere.center;if(So.setFromBufferAttribute(a),o)for(let v=0,y=o.length;v<y;v++)ro.setFromBufferAttribute(o[v]),this.morphTargetsRelative?(Fn.addVectors(So.min,ro.min),So.expandByPoint(Fn),Fn.addVectors(So.max,ro.max),So.expandByPoint(Fn)):(So.expandByPoint(ro.min),So.expandByPoint(ro.max));So.getCenter(l);let p=0;for(let v=0,y=a.count;v<y;v++)Fn.fromBufferAttribute(a,v),p=Math.max(p,l.distanceToSquared(Fn));if(o)for(let v=0,y=o.length;v<y;v++){const x=o[v],E=this.morphTargetsRelative;for(let I=0,R=x.count;I<R;I++)Fn.fromBufferAttribute(x,I),E&&($o.fromBufferAttribute(a,I),Fn.add($o)),p=Math.max(p,l.distanceToSquared(Fn))}this.boundingSphere.radius=Math.sqrt(p),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){const a=this.index,o=this.attributes;if(null===a||void 0===o.position||void 0===o.normal||void 0===o.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const l=a.array,p=o.position.array,v=o.normal.array,y=o.uv.array,x=p.length/3;void 0===o.tangent&&this.setAttribute("tangent",new Ii(new Float32Array(4*x),4));const E=o.tangent.array,I=[],R=[];for(let ke=0;ke<x;ke++)I[ke]=new xe,R[ke]=new xe;const F=new xe,k=new xe,U=new xe,G=new qe,Y=new qe,re=new qe,ie=new xe,$=new xe;function q(ke,Qe,tt){F.fromArray(p,3*ke),k.fromArray(p,3*Qe),U.fromArray(p,3*tt),G.fromArray(y,2*ke),Y.fromArray(y,2*Qe),re.fromArray(y,2*tt),k.sub(F),U.sub(F),Y.sub(G),re.sub(G);const ut=1/(Y.x*re.y-re.x*Y.y);!isFinite(ut)||(ie.copy(k).multiplyScalar(re.y).addScaledVector(U,-Y.y).multiplyScalar(ut),$.copy(U).multiplyScalar(Y.x).addScaledVector(k,-re.x).multiplyScalar(ut),I[ke].add(ie),I[Qe].add(ie),I[tt].add(ie),R[ke].add($),R[Qe].add($),R[tt].add($))}let Ae=this.groups;0===Ae.length&&(Ae=[{start:0,count:l.length}]);for(let ke=0,Qe=Ae.length;ke<Qe;++ke){const tt=Ae[ke],ut=tt.start;for(let Ce=ut,Fe=ut+tt.count;Ce<Fe;Ce+=3)q(l[Ce+0],l[Ce+1],l[Ce+2])}const Ie=new xe,Se=new xe,he=new xe,De=new xe;function vt(ke){he.fromArray(v,3*ke),De.copy(he);const Qe=I[ke];Ie.copy(Qe),Ie.sub(he.multiplyScalar(he.dot(Qe))).normalize(),Se.crossVectors(De,Qe);const ut=Se.dot(R[ke])<0?-1:1;E[4*ke]=Ie.x,E[4*ke+1]=Ie.y,E[4*ke+2]=Ie.z,E[4*ke+3]=ut}for(let ke=0,Qe=Ae.length;ke<Qe;++ke){const tt=Ae[ke],ut=tt.start;for(let Ce=ut,Fe=ut+tt.count;Ce<Fe;Ce+=3)vt(l[Ce+0]),vt(l[Ce+1]),vt(l[Ce+2])}},computeVertexNormals:function(){const a=this.index,o=this.getAttribute("position");if(void 0!==o){let l=this.getAttribute("normal");if(void 0===l)l=new Ii(new Float32Array(3*o.count),3),this.setAttribute("normal",l);else for(let k=0,U=l.count;k<U;k++)l.setXYZ(k,0,0,0);const p=new xe,v=new xe,y=new xe,x=new xe,E=new xe,I=new xe,R=new xe,F=new xe;if(a)for(let k=0,U=a.count;k<U;k+=3){const G=a.getX(k+0),Y=a.getX(k+1),re=a.getX(k+2);p.fromBufferAttribute(o,G),v.fromBufferAttribute(o,Y),y.fromBufferAttribute(o,re),R.subVectors(y,v),F.subVectors(p,v),R.cross(F),x.fromBufferAttribute(l,G),E.fromBufferAttribute(l,Y),I.fromBufferAttribute(l,re),x.add(R),E.add(R),I.add(R),l.setXYZ(G,x.x,x.y,x.z),l.setXYZ(Y,E.x,E.y,E.z),l.setXYZ(re,I.x,I.y,I.z)}else for(let k=0,U=o.count;k<U;k+=3)p.fromBufferAttribute(o,k+0),v.fromBufferAttribute(o,k+1),y.fromBufferAttribute(o,k+2),R.subVectors(y,v),F.subVectors(p,v),R.cross(F),l.setXYZ(k+0,R.x,R.y,R.z),l.setXYZ(k+1,R.x,R.y,R.z),l.setXYZ(k+2,R.x,R.y,R.z);this.normalizeNormals(),l.needsUpdate=!0}},merge:function(a,o){if(!a||!a.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a);void 0===o&&(o=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const l=this.attributes;for(const p in l){if(void 0===a.attributes[p])continue;const y=l[p].array,x=a.attributes[p],E=x.array,I=x.itemSize*o,R=Math.min(E.length,y.length-I);for(let F=0,k=I;F<R;F++,k++)y[k]=E[F]}return this},normalizeNormals:function(){const a=this.attributes.normal;for(let o=0,l=a.count;o<l;o++)Fn.fromBufferAttribute(a,o),Fn.normalize(),a.setXYZ(o,Fn.x,Fn.y,Fn.z)},toNonIndexed:function(){function a(x,E){const I=x.array,R=x.itemSize,F=x.normalized,k=new I.constructor(E.length*R);let U=0,G=0;for(let Y=0,re=E.length;Y<re;Y++){U=E[Y]*R;for(let ie=0;ie<R;ie++)k[G++]=I[U++]}return new Ii(k,R,F)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const o=new xi,l=this.index.array,p=this.attributes;for(const x in p){const I=a(p[x],l);o.setAttribute(x,I)}const v=this.morphAttributes;for(const x in v){const E=[],I=v[x];for(let R=0,F=I.length;R<F;R++){const U=a(I[R],l);E.push(U)}o.morphAttributes[x]=E}o.morphTargetsRelative=this.morphTargetsRelative;const y=this.groups;for(let x=0,E=y.length;x<E;x++){const I=y[x];o.addGroup(I.start,I.count,I.materialIndex)}return o},toJSON:function(){const a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),void 0!==this.parameters){const E=this.parameters;for(const I in E)void 0!==E[I]&&(a[I]=E[I]);return a}a.data={attributes:{}};const o=this.index;null!==o&&(a.data.index={type:o.array.constructor.name,array:Array.prototype.slice.call(o.array)});const l=this.attributes;for(const E in l){const I=l[E],R=I.toJSON(a.data);""!==I.name&&(R.name=I.name),a.data.attributes[E]=R}const p={};let v=!1;for(const E in this.morphAttributes){const I=this.morphAttributes[E],R=[];for(let F=0,k=I.length;F<k;F++){const U=I[F],G=U.toJSON(a.data);""!==U.name&&(G.name=U.name),R.push(G)}R.length>0&&(p[E]=R,v=!0)}v&&(a.data.morphAttributes=p,a.data.morphTargetsRelative=this.morphTargetsRelative);const y=this.groups;y.length>0&&(a.data.groups=JSON.parse(JSON.stringify(y)));const x=this.boundingSphere;return null!==x&&(a.data.boundingSphere={center:x.center.toArray(),radius:x.radius}),a},clone:function(){return(new xi).copy(this)},copy:function(a){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const o={};this.name=a.name;const l=a.index;null!==l&&this.setIndex(l.clone(o));const p=a.attributes;for(const I in p)this.setAttribute(I,p[I].clone(o));const v=a.morphAttributes;for(const I in v){const R=[],F=v[I];for(let k=0,U=F.length;k<U;k++)R.push(F[k].clone(o));this.morphAttributes[I]=R}this.morphTargetsRelative=a.morphTargetsRelative;const y=a.groups;for(let I=0,R=y.length;I<R;I++){const F=y[I];this.addGroup(F.start,F.count,F.materialIndex)}const x=a.boundingBox;null!==x&&(this.boundingBox=x.clone());const E=a.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const z_=new Kt,Rc=new Nl,hh=new io,kl=new xe,zu=new xe,Nc=new xe,so=new xe,ft=new xe,Vi=new xe,Wa=new xe,Eo=new xe,Os=new xe,ao=new qe,hr=new qe,zs=new qe,Vf=new xe,Cs=new xe;function Zr(a=new xi,o=new Pa){Jn.call(this),this.type="Mesh",this.geometry=a,this.material=o,this.updateMorphTargets()}function Fl(a,o,l,p,v,y,x,E,I,R,F,k){kl.fromBufferAttribute(v,R),zu.fromBufferAttribute(v,F),Nc.fromBufferAttribute(v,k);const U=a.morphTargetInfluences;if(o.morphTargets&&y&&U){Wa.set(0,0,0),Eo.set(0,0,0),Os.set(0,0,0);for(let Y=0,re=y.length;Y<re;Y++){const ie=U[Y],$=y[Y];0!==ie&&(so.fromBufferAttribute($,R),ft.fromBufferAttribute($,F),Vi.fromBufferAttribute($,k),x?(Wa.addScaledVector(so,ie),Eo.addScaledVector(ft,ie),Os.addScaledVector(Vi,ie)):(Wa.addScaledVector(so.sub(kl),ie),Eo.addScaledVector(ft.sub(zu),ie),Os.addScaledVector(Vi.sub(Nc),ie)))}kl.add(Wa),zu.add(Eo),Nc.add(Os)}a.isSkinnedMesh&&(a.boneTransform(R,kl),a.boneTransform(F,zu),a.boneTransform(k,Nc));const G=function vm(a,o,l,p,v,y,x,E){let I;if(I=1===o.side?p.intersectTriangle(x,y,v,!0,E):p.intersectTriangle(v,y,x,2!==o.side,E),null===I)return null;Cs.copy(E),Cs.applyMatrix4(a.matrixWorld);const R=l.ray.origin.distanceTo(Cs);return R<l.near||R>l.far?null:{distance:R,point:Cs.clone(),object:a}}(a,o,l,p,kl,zu,Nc,Vf);if(G){E&&(ao.fromBufferAttribute(E,R),hr.fromBufferAttribute(E,F),zs.fromBufferAttribute(E,k),G.uv=za.getUV(Vf,kl,zu,Nc,ao,hr,zs,new qe)),I&&(ao.fromBufferAttribute(I,R),hr.fromBufferAttribute(I,F),zs.fromBufferAttribute(I,k),G.uv2=za.getUV(Vf,kl,zu,Nc,ao,hr,zs,new qe));const Y=new dd(R,F,k);za.getNormal(kl,zu,Nc,Y.normal),G.face=Y}return G}Zr.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Zr,isMesh:!0,copy:function(a){return Jn.prototype.copy.call(this,a),void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=a.material,this.geometry=a.geometry,this},updateMorphTargets:function(){const a=this.geometry;if(a.isBufferGeometry){const o=a.morphAttributes,l=Object.keys(o);if(l.length>0){const p=o[l[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let v=0,y=p.length;v<y;v++){const x=p[v].name||String(v);this.morphTargetInfluences.push(0),this.morphTargetDictionary[x]=v}}}}else{const o=a.morphTargets;void 0!==o&&o.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(a,o){const l=this.geometry,p=this.material,v=this.matrixWorld;if(void 0===p||(null===l.boundingSphere&&l.computeBoundingSphere(),hh.copy(l.boundingSphere),hh.applyMatrix4(v),!1===a.ray.intersectsSphere(hh))||(z_.copy(v).invert(),Rc.copy(a.ray).applyMatrix4(z_),null!==l.boundingBox&&!1===Rc.intersectsBox(l.boundingBox)))return;let y;if(l.isBufferGeometry){const x=l.index,E=l.attributes.position,I=l.morphAttributes.position,R=l.morphTargetsRelative,F=l.attributes.uv,k=l.attributes.uv2,U=l.groups,G=l.drawRange;if(null!==x)if(Array.isArray(p))for(let Y=0,re=U.length;Y<re;Y++){const ie=U[Y],$=p[ie.materialIndex];for(let Ie=Math.max(ie.start,G.start),Se=Math.min(ie.start+ie.count,G.start+G.count);Ie<Se;Ie+=3){const he=x.getX(Ie),De=x.getX(Ie+1),vt=x.getX(Ie+2);y=Fl(this,$,a,Rc,E,I,R,F,k,he,De,vt),y&&(y.faceIndex=Math.floor(Ie/3),y.face.materialIndex=ie.materialIndex,o.push(y))}}else for(let ie=Math.max(0,G.start),$=Math.min(x.count,G.start+G.count);ie<$;ie+=3){const q=x.getX(ie),Ae=x.getX(ie+1),Ie=x.getX(ie+2);y=Fl(this,p,a,Rc,E,I,R,F,k,q,Ae,Ie),y&&(y.faceIndex=Math.floor(ie/3),o.push(y))}else if(void 0!==E)if(Array.isArray(p))for(let Y=0,re=U.length;Y<re;Y++){const ie=U[Y],$=p[ie.materialIndex];for(let Ie=Math.max(ie.start,G.start),Se=Math.min(ie.start+ie.count,G.start+G.count);Ie<Se;Ie+=3)y=Fl(this,$,a,Rc,E,I,R,F,k,Ie,Ie+1,Ie+2),y&&(y.faceIndex=Math.floor(Ie/3),y.face.materialIndex=ie.materialIndex,o.push(y))}else for(let ie=Math.max(0,G.start),$=Math.min(E.count,G.start+G.count);ie<$;ie+=3)y=Fl(this,p,a,Rc,E,I,R,F,k,ie,ie+1,ie+2),y&&(y.faceIndex=Math.floor(ie/3),o.push(y))}else l.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});class Pc extends xi{constructor(o=1,l=1,p=1,v=1,y=1,x=1){super(),this.type="BoxGeometry",this.parameters={width:o,height:l,depth:p,widthSegments:v,heightSegments:y,depthSegments:x};const E=this;v=Math.floor(v),y=Math.floor(y),x=Math.floor(x);const I=[],R=[],F=[],k=[];let U=0,G=0;function Y(re,ie,$,q,Ae,Ie,Se,he,De,vt,ke){const Qe=Ie/De,tt=Se/vt,ut=Ie/2,Ze=Se/2,Ce=he/2,Fe=De+1,je=vt+1;let at=0,Pt=0;const xt=new xe;for(let Ut=0;Ut<je;Ut++){const qt=Ut*tt-Ze;for(let Qn=0;Qn<Fe;Qn++)xt[re]=(Qn*Qe-ut)*q,xt[ie]=qt*Ae,xt[$]=Ce,R.push(xt.x,xt.y,xt.z),xt[re]=0,xt[ie]=0,xt[$]=he>0?1:-1,F.push(xt.x,xt.y,xt.z),k.push(Qn/De),k.push(1-Ut/vt),at+=1}for(let Ut=0;Ut<vt;Ut++)for(let qt=0;qt<De;qt++){const Un=U+qt+Fe*(Ut+1),ki=U+(qt+1)+Fe*(Ut+1),mt=U+(qt+1)+Fe*Ut;I.push(U+qt+Fe*Ut,Un,mt),I.push(Un,ki,mt),Pt+=6}E.addGroup(G,Pt,ke),G+=Pt,U+=at}Y("z","y","x",-1,-1,p,l,o,x,y,0),Y("z","y","x",1,-1,p,l,-o,x,y,1),Y("x","z","y",1,1,o,p,l,v,x,2),Y("x","z","y",1,-1,o,p,-l,v,x,3),Y("x","y","z",1,-1,o,l,p,v,y,4),Y("x","y","z",-1,-1,o,l,-p,v,y,5),this.setIndex(I),this.setAttribute("position",new zi(R,3)),this.setAttribute("normal",new zi(F,3)),this.setAttribute("uv",new zi(k,2))}}function Ls(a){const o={};for(const l in a){o[l]={};for(const p in a[l]){const v=a[l][p];o[l][p]=v&&(v.isColor||v.isMatrix3||v.isMatrix4||v.isVector2||v.isVector3||v.isVector4||v.isTexture)?v.clone():Array.isArray(v)?v.slice():v}}return o}function Jr(a){const o={};for(let l=0;l<a.length;l++){const p=Ls(a[l]);for(const v in p)o[v]=p[v]}return o}const qg={clone:Ls,merge:Jr};function Ws(a){_i.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))}function Wu(){Jn.call(this),this.type="Camera",this.matrixWorldInverse=new Kt,this.projectionMatrix=new Kt,this.projectionMatrixInverse=new Kt}function ks(a=50,o=1,l=.1,p=2e3){Wu.call(this),this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=l,this.far=p,this.focus=10,this.aspect=o,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}(Ws.prototype=Object.create(_i.prototype)).constructor=Ws,Ws.prototype.isShaderMaterial=!0,Ws.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=Ls(a.uniforms),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.lights=a.lights,this.clipping=a.clipping,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this},Ws.prototype.toJSON=function(a){const o=_i.prototype.toJSON.call(this,a);o.glslVersion=this.glslVersion,o.uniforms={};for(const p in this.uniforms){const y=this.uniforms[p].value;o.uniforms[p]=y&&y.isTexture?{type:"t",value:y.toJSON(a).uuid}:y&&y.isColor?{type:"c",value:y.getHex()}:y&&y.isVector2?{type:"v2",value:y.toArray()}:y&&y.isVector3?{type:"v3",value:y.toArray()}:y&&y.isVector4?{type:"v4",value:y.toArray()}:y&&y.isMatrix3?{type:"m3",value:y.toArray()}:y&&y.isMatrix4?{type:"m4",value:y.toArray()}:{value:y}}Object.keys(this.defines).length>0&&(o.defines=this.defines),o.vertexShader=this.vertexShader,o.fragmentShader=this.fragmentShader;const l={};for(const p in this.extensions)!0===this.extensions[p]&&(l[p]=!0);return Object.keys(l).length>0&&(o.extensions=l),o},Wu.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Wu,isCamera:!0,copy:function(a,o){return Jn.prototype.copy.call(this,a,o),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this},getWorldDirection:function(a){void 0===a&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),a=new xe),this.updateWorldMatrix(!0,!1);const o=this.matrixWorld.elements;return a.set(-o[8],-o[9],-o[10]).normalize()},updateMatrixWorld:function(a){Jn.prototype.updateMatrixWorld.call(this,a),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(a,o){Jn.prototype.updateWorldMatrix.call(this,a,o),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),ks.prototype=Object.assign(Object.create(Wu.prototype),{constructor:ks,isPerspectiveCamera:!0,copy:function(a,o){return Wu.prototype.copy.call(this,a,o),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this},setFocalLength:function(a){const o=.5*this.getFilmHeight()/a;this.fov=2*pi.RAD2DEG*Math.atan(o),this.updateProjectionMatrix()},getFocalLength:function(){const a=Math.tan(.5*pi.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*pi.RAD2DEG*Math.atan(Math.tan(.5*pi.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,o,l,p,v,y){this.aspect=a/o,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=o,this.view.offsetX=l,this.view.offsetY=p,this.view.width=v,this.view.height=y,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const a=this.near;let o=a*Math.tan(.5*pi.DEG2RAD*this.fov)/this.zoom,l=2*o,p=this.aspect*l,v=-.5*p;const y=this.view;if(null!==this.view&&this.view.enabled){const E=y.fullWidth,I=y.fullHeight;v+=y.offsetX*p/E,o-=y.offsetY*l/I,p*=y.width/E,l*=y.height/I}const x=this.filmOffset;0!==x&&(v+=a*x/this.getFilmWidth()),this.projectionMatrix.makePerspective(v,v+p,o,o-l,a,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(a){const o=Jn.prototype.toJSON.call(this,a);return o.object.fov=this.fov,o.object.zoom=this.zoom,o.object.near=this.near,o.object.far=this.far,o.object.focus=this.focus,o.object.aspect=this.aspect,null!==this.view&&(o.object.view=Object.assign({},this.view)),o.object.filmGauge=this.filmGauge,o.object.filmOffset=this.filmOffset,o}});function Ul(a,o,l){if(Jn.call(this),this.type="CubeCamera",!0!==l.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=l;const p=new ks(90,1,a,o);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new xe(1,0,0)),this.add(p);const v=new ks(90,1,a,o);v.layers=this.layers,v.up.set(0,-1,0),v.lookAt(new xe(-1,0,0)),this.add(v);const y=new ks(90,1,a,o);y.layers=this.layers,y.up.set(0,0,1),y.lookAt(new xe(0,1,0)),this.add(y);const x=new ks(90,1,a,o);x.layers=this.layers,x.up.set(0,0,-1),x.lookAt(new xe(0,-1,0)),this.add(x);const E=new ks(90,1,a,o);E.layers=this.layers,E.up.set(0,-1,0),E.lookAt(new xe(0,0,1)),this.add(E);const I=new ks(90,1,a,o);I.layers=this.layers,I.up.set(0,-1,0),I.lookAt(new xe(0,0,-1)),this.add(I),this.update=function(R,F){null===this.parent&&this.updateMatrixWorld();const k=R.xr.enabled,U=R.getRenderTarget();R.xr.enabled=!1;const G=l.texture.generateMipmaps;l.texture.generateMipmaps=!1,R.setRenderTarget(l,0),R.render(F,p),R.setRenderTarget(l,1),R.render(F,v),R.setRenderTarget(l,2),R.render(F,y),R.setRenderTarget(l,3),R.render(F,x),R.setRenderTarget(l,4),R.render(F,E),l.texture.generateMipmaps=G,R.setRenderTarget(l,5),R.render(F,I),R.setRenderTarget(U),R.xr.enabled=k}}function Rr(a,o,l,p,v,y,x,E,I,R){Li.call(this,a=void 0!==a?a:[],o=void 0!==o?o:301,l,p,v,y,x=void 0!==x?x:To,E,I,R),this.flipY=!1,this._needsFlipEnvMap=!0}(Ul.prototype=Object.create(Jn.prototype)).constructor=Ul,(Rr.prototype=Object.create(Li.prototype)).constructor=Rr,Rr.prototype.isCubeTexture=!0,Object.defineProperty(Rr.prototype,"images",{get:function(){return this.image},set:function(a){this.image=a}});class Xg extends Of{constructor(o,l,p){Number.isInteger(l)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),l=p),super(o,o,l),Object.defineProperty(this,"isWebGLCubeRenderTarget",{value:!0}),this.texture=new Rr(void 0,(l=l||{}).mapping,l.wrapS,l.wrapT,l.magFilter,l.minFilter,l.format,l.type,l.anisotropy,l.encoding),this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(o,l){this.texture.type=l.type,this.texture.format=_r,this.texture.encoding=l.encoding,this.texture.generateMipmaps=l.generateMipmaps,this.texture.minFilter=l.minFilter,this.texture.magFilter=l.magFilter;const p_uniforms={tEquirect:{value:null}},p_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",p_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",v=new Pc(5,5,5),y=new Ws({name:"CubemapFromEquirect",uniforms:Ls(p_uniforms),vertexShader:p_vertexShader,fragmentShader:p_fragmentShader,side:1,blending:0});y.uniforms.tEquirect.value=l;const x=new Zr(v,y),E=l.minFilter;return 1008===l.minFilter&&(l.minFilter=oe),new Ul(1,10,this).update(o,x),l.minFilter=E,x.geometry.dispose(),x.material.dispose(),this}clear(o,l,p,v){const y=o.getRenderTarget();for(let x=0;x<6;x++)o.setRenderTarget(this,x),o.clear(l,p,v);o.setRenderTarget(y)}}function Dr(a,o,l,p,v,y,x,E,I,R,F,k){Li.call(this,null,y,x,E,I,R,p,v,F,k),this.image={data:a||null,width:o||1,height:l||1},this.magFilter=void 0!==I?I:ba,this.minFilter=void 0!==R?R:ba,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}(Dr.prototype=Object.create(Li.prototype)).constructor=Dr,Dr.prototype.isDataTexture=!0;const md=new io,ph=new xe;class Hf{constructor(o,l,p,v,y,x){this.planes=[void 0!==o?o:new Pl,void 0!==l?l:new Pl,void 0!==p?p:new Pl,void 0!==v?v:new Pl,void 0!==y?y:new Pl,void 0!==x?x:new Pl]}set(o,l,p,v,y,x){const E=this.planes;return E[0].copy(o),E[1].copy(l),E[2].copy(p),E[3].copy(v),E[4].copy(y),E[5].copy(x),this}clone(){return(new this.constructor).copy(this)}copy(o){const l=this.planes;for(let p=0;p<6;p++)l[p].copy(o.planes[p]);return this}setFromProjectionMatrix(o){const l=this.planes,p=o.elements,v=p[0],y=p[1],x=p[2],E=p[3],I=p[4],R=p[5],F=p[6],k=p[7],U=p[8],G=p[9],Y=p[10],re=p[11],ie=p[12],$=p[13],q=p[14],Ae=p[15];return l[0].setComponents(E-v,k-I,re-U,Ae-ie).normalize(),l[1].setComponents(E+v,k+I,re+U,Ae+ie).normalize(),l[2].setComponents(E+y,k+R,re+G,Ae+$).normalize(),l[3].setComponents(E-y,k-R,re-G,Ae-$).normalize(),l[4].setComponents(E-x,k-F,re-Y,Ae-q).normalize(),l[5].setComponents(E+x,k+F,re+Y,Ae+q).normalize(),this}intersectsObject(o){const l=o.geometry;return null===l.boundingSphere&&l.computeBoundingSphere(),md.copy(l.boundingSphere).applyMatrix4(o.matrixWorld),this.intersectsSphere(md)}intersectsSprite(o){return md.center.set(0,0,0),md.radius=.7071067811865476,md.applyMatrix4(o.matrixWorld),this.intersectsSphere(md)}intersectsSphere(o){const l=this.planes,p=o.center,v=-o.radius;for(let y=0;y<6;y++)if(l[y].distanceToPoint(p)<v)return!1;return!0}intersectsBox(o){const l=this.planes;for(let p=0;p<6;p++){const v=l[p];if(ph.x=v.normal.x>0?o.max.x:o.min.x,ph.y=v.normal.y>0?o.max.y:o.min.y,ph.z=v.normal.z>0?o.max.z:o.min.z,v.distanceToPoint(ph)<0)return!1}return!0}containsPoint(o){const l=this.planes;for(let p=0;p<6;p++)if(l[p].distanceToPoint(o)<0)return!1;return!0}}function Gf(){let a=null,o=!1,l=null,p=null;function v(y,x){l(y,x),p=a.requestAnimationFrame(v)}return{start:function(){!0!==o&&null!==l&&(p=a.requestAnimationFrame(v),o=!0)},stop:function(){a.cancelAnimationFrame(p),o=!1},setAnimationLoop:function(y){l=y},setContext:function(y){a=y}}}function Rt(a,o){const l=o.isWebGL2,p=new WeakMap;return{get:function x(R){return R.isInterleavedBufferAttribute&&(R=R.data),p.get(R)},remove:function E(R){R.isInterleavedBufferAttribute&&(R=R.data);const F=p.get(R);F&&(a.deleteBuffer(F.buffer),p.delete(R))},update:function I(R,F){if(R.isGLBufferAttribute){const U=p.get(R);return void((!U||U.version<R.version)&&p.set(R,{buffer:R.buffer,type:R.type,bytesPerElement:R.elementSize,version:R.version}))}R.isInterleavedBufferAttribute&&(R=R.data);const k=p.get(R);void 0===k?p.set(R,function v(R,F){const k=R.array,U=R.usage,G=a.createBuffer();a.bindBuffer(F,G),a.bufferData(F,k,U),R.onUploadCallback();let Y=5126;return k instanceof Float32Array?Y=5126:k instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):k instanceof Uint16Array?R.isFloat16BufferAttribute?l?Y=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):Y=5123:k instanceof Int16Array?Y=5122:k instanceof Uint32Array?Y=5125:k instanceof Int32Array?Y=5124:k instanceof Int8Array?Y=5120:k instanceof Uint8Array&&(Y=5121),{buffer:G,type:Y,bytesPerElement:k.BYTES_PER_ELEMENT,version:R.version}}(R,F)):k.version<R.version&&(function y(R,F,k){const U=F.array,G=F.updateRange;a.bindBuffer(k,R),-1===G.count?a.bufferSubData(k,0,U):(l?a.bufferSubData(k,G.offset*U.BYTES_PER_ELEMENT,U,G.offset,G.count):a.bufferSubData(k,G.offset*U.BYTES_PER_ELEMENT,U.subarray(G.offset,G.offset+G.count)),G.count=-1)}(k.buffer,R,F),k.version=R.version)}}}class W_ extends xi{constructor(o=1,l=1,p=1,v=1){super(),this.type="PlaneGeometry",this.parameters={width:o,height:l,widthSegments:p,heightSegments:v};const y=o/2,x=l/2,E=Math.floor(p),I=Math.floor(v),R=E+1,F=I+1,k=o/E,U=l/I,G=[],Y=[],re=[],ie=[];for(let $=0;$<F;$++){const q=$*U-x;for(let Ae=0;Ae<R;Ae++)Y.push(Ae*k-y,-q,0),re.push(0,0,1),ie.push(Ae/E),ie.push(1-$/I)}for(let $=0;$<I;$++)for(let q=0;q<E;q++){const Ie=q+R*($+1),Se=q+1+R*($+1),he=q+1+R*$;G.push(q+R*$,Ie,he),G.push(Ie,Se,he)}this.setIndex(G),this.setAttribute("position",new zi(Y,3)),this.setAttribute("normal",new zi(re,3)),this.setAttribute("uv",new zi(ie,2))}}const Bn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},fn={common:{diffuse:{value:new ei(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new la},uv2Transform:{value:new la},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ei(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ei(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new la}},sprite:{diffuse:{value:new ei(15658734)},opacity:{value:1},center:{value:new qe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new la}}},Ya={basic:{uniforms:Jr([fn.common,fn.specularmap,fn.envmap,fn.aomap,fn.lightmap,fn.fog]),vertexShader:Bn.meshbasic_vert,fragmentShader:Bn.meshbasic_frag},lambert:{uniforms:Jr([fn.common,fn.specularmap,fn.envmap,fn.aomap,fn.lightmap,fn.emissivemap,fn.fog,fn.lights,{emissive:{value:new ei(0)}}]),vertexShader:Bn.meshlambert_vert,fragmentShader:Bn.meshlambert_frag},phong:{uniforms:Jr([fn.common,fn.specularmap,fn.envmap,fn.aomap,fn.lightmap,fn.emissivemap,fn.bumpmap,fn.normalmap,fn.displacementmap,fn.fog,fn.lights,{emissive:{value:new ei(0)},specular:{value:new ei(1118481)},shininess:{value:30}}]),vertexShader:Bn.meshphong_vert,fragmentShader:Bn.meshphong_frag},standard:{uniforms:Jr([fn.common,fn.envmap,fn.aomap,fn.lightmap,fn.emissivemap,fn.bumpmap,fn.normalmap,fn.displacementmap,fn.roughnessmap,fn.metalnessmap,fn.fog,fn.lights,{emissive:{value:new ei(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Bn.meshphysical_vert,fragmentShader:Bn.meshphysical_frag},toon:{uniforms:Jr([fn.common,fn.aomap,fn.lightmap,fn.emissivemap,fn.bumpmap,fn.normalmap,fn.displacementmap,fn.gradientmap,fn.fog,fn.lights,{emissive:{value:new ei(0)}}]),vertexShader:Bn.meshtoon_vert,fragmentShader:Bn.meshtoon_frag},matcap:{uniforms:Jr([fn.common,fn.bumpmap,fn.normalmap,fn.displacementmap,fn.fog,{matcap:{value:null}}]),vertexShader:Bn.meshmatcap_vert,fragmentShader:Bn.meshmatcap_frag},points:{uniforms:Jr([fn.points,fn.fog]),vertexShader:Bn.points_vert,fragmentShader:Bn.points_frag},dashed:{uniforms:Jr([fn.common,fn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bn.linedashed_vert,fragmentShader:Bn.linedashed_frag},depth:{uniforms:Jr([fn.common,fn.displacementmap]),vertexShader:Bn.depth_vert,fragmentShader:Bn.depth_frag},normal:{uniforms:Jr([fn.common,fn.bumpmap,fn.normalmap,fn.displacementmap,{opacity:{value:1}}]),vertexShader:Bn.normal_vert,fragmentShader:Bn.normal_frag},sprite:{uniforms:Jr([fn.sprite,fn.fog]),vertexShader:Bn.sprite_vert,fragmentShader:Bn.sprite_frag},background:{uniforms:{uvTransform:{value:new la},t2D:{value:null}},vertexShader:Bn.background_vert,fragmentShader:Bn.background_frag},cube:{uniforms:Jr([fn.envmap,{opacity:{value:1}}]),vertexShader:Bn.cube_vert,fragmentShader:Bn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bn.equirect_vert,fragmentShader:Bn.equirect_frag},distanceRGBA:{uniforms:Jr([fn.common,fn.displacementmap,{referencePosition:{value:new xe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bn.distanceRGBA_vert,fragmentShader:Bn.distanceRGBA_frag},shadow:{uniforms:Jr([fn.lights,fn.fog,{color:{value:new ei(0)},opacity:{value:1}}]),vertexShader:Bn.shadow_vert,fragmentShader:Bn.shadow_frag}};function c0(a,o,l,p,v){const y=new ei(0);let E,I,x=0,R=null,F=0,k=null;function G(Y,re){l.buffers.color.setClear(Y.r,Y.g,Y.b,re,v)}return{getClearColor:function(){return y},setClearColor:function(Y,re=1){y.set(Y),x=re,G(y,x)},getClearAlpha:function(){return x},setClearAlpha:function(Y){x=Y,G(y,x)},render:function U(Y,re,ie,$){let q=!0===re.isScene?re.background:null;q&&q.isTexture&&(q=o.get(q));const Ae=a.xr,Ie=Ae.getSession&&Ae.getSession();Ie&&"additive"===Ie.environmentBlendMode&&(q=null),null===q?G(y,x):q&&q.isColor&&(G(q,1),$=!0),(a.autoClear||$)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),q&&(q.isCubeTexture||q.isWebGLCubeRenderTarget||306===q.mapping)?(void 0===I&&(I=new Zr(new Pc(1,1,1),new Ws({name:"BackgroundCubeMaterial",uniforms:Ls(Ya.cube.uniforms),vertexShader:Ya.cube.vertexShader,fragmentShader:Ya.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),I.geometry.deleteAttribute("normal"),I.geometry.deleteAttribute("uv"),I.onBeforeRender=function(Se,he,De){this.matrixWorld.copyPosition(De.matrixWorld)},Object.defineProperty(I.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),p.update(I)),q.isWebGLCubeRenderTarget&&(q=q.texture),I.material.uniforms.envMap.value=q,I.material.uniforms.flipEnvMap.value=q.isCubeTexture&&q._needsFlipEnvMap?-1:1,(R!==q||F!==q.version||k!==a.toneMapping)&&(I.material.needsUpdate=!0,R=q,F=q.version,k=a.toneMapping),Y.unshift(I,I.geometry,I.material,0,0,null)):q&&q.isTexture&&(void 0===E&&(E=new Zr(new W_(2,2),new Ws({name:"BackgroundMaterial",uniforms:Ls(Ya.background.uniforms),vertexShader:Ya.background.vertexShader,fragmentShader:Ya.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),E.geometry.deleteAttribute("normal"),Object.defineProperty(E.material,"map",{get:function(){return this.uniforms.t2D.value}}),p.update(E)),E.material.uniforms.t2D.value=q,!0===q.matrixAutoUpdate&&q.updateMatrix(),E.material.uniforms.uvTransform.value.copy(q.matrix),(R!==q||F!==q.version||k!==a.toneMapping)&&(E.material.needsUpdate=!0,R=q,F=q.version,k=a.toneMapping),Y.unshift(E,E.geometry,E.material,0,0,null))}}}function cv(a,o,l,p){const v=a.getParameter(34921),y=p.isWebGL2?null:o.get("OES_vertex_array_object"),x=p.isWebGL2||null!==y,E={},I=re(null);let R=I;function U(Ze){return p.isWebGL2?a.bindVertexArray(Ze):y.bindVertexArrayOES(Ze)}function G(Ze){return p.isWebGL2?a.deleteVertexArray(Ze):y.deleteVertexArrayOES(Ze)}function re(Ze){const Ce=[],Fe=[],je=[];for(let at=0;at<v;at++)Ce[at]=0,Fe[at]=0,je[at]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ce,enabledAttributes:Fe,attributeDivisors:je,object:Ze,attributes:{},index:null}}function q(){const Ze=R.newAttributes;for(let Ce=0,Fe=Ze.length;Ce<Fe;Ce++)Ze[Ce]=0}function Ae(Ze){Ie(Ze,0)}function Ie(Ze,Ce){const je=R.enabledAttributes,at=R.attributeDivisors;R.newAttributes[Ze]=1,0===je[Ze]&&(a.enableVertexAttribArray(Ze),je[Ze]=1),at[Ze]!==Ce&&((p.isWebGL2?a:o.get("ANGLE_instanced_arrays"))[p.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ze,Ce),at[Ze]=Ce)}function Se(){const Ze=R.newAttributes,Ce=R.enabledAttributes;for(let Fe=0,je=Ce.length;Fe<je;Fe++)Ce[Fe]!==Ze[Fe]&&(a.disableVertexAttribArray(Fe),Ce[Fe]=0)}function he(Ze,Ce,Fe,je,at,Pt){!0!==p.isWebGL2||5124!==Fe&&5125!==Fe?a.vertexAttribPointer(Ze,Ce,Fe,je,at,Pt):a.vertexAttribIPointer(Ze,Ce,Fe,at,Pt)}function tt(){ut(),R!==I&&(R=I,U(R.object))}function ut(){I.geometry=null,I.program=null,I.wireframe=!1}return{setup:function F(Ze,Ce,Fe,je,at){let Pt=!1;if(x){const xt=function Y(Ze,Ce,Fe){const je=!0===Fe.wireframe;let at=E[Ze.id];void 0===at&&(at={},E[Ze.id]=at);let Pt=at[Ce.id];void 0===Pt&&(Pt={},at[Ce.id]=Pt);let xt=Pt[je];return void 0===xt&&(xt=re(function k(){return p.isWebGL2?a.createVertexArray():y.createVertexArrayOES()}()),Pt[je]=xt),xt}(je,Fe,Ce);R!==xt&&(R=xt,U(R.object)),Pt=function ie(Ze,Ce){const Fe=R.attributes,je=Ze.attributes;let at=0;for(const Pt in je){const xt=Fe[Pt],Ut=je[Pt];if(void 0===xt||xt.attribute!==Ut||xt.data!==Ut.data)return!0;at++}return R.attributesNum!==at||R.index!==Ce}(je,at),Pt&&function $(Ze,Ce){const Fe={},je=Ze.attributes;let at=0;for(const Pt in je){const xt=je[Pt],Ut={};Ut.attribute=xt,xt.data&&(Ut.data=xt.data),Fe[Pt]=Ut,at++}R.attributes=Fe,R.attributesNum=at,R.index=Ce}(je,at)}else{const xt=!0===Ce.wireframe;(R.geometry!==je.id||R.program!==Fe.id||R.wireframe!==xt)&&(R.geometry=je.id,R.program=Fe.id,R.wireframe=xt,Pt=!0)}!0===Ze.isInstancedMesh&&(Pt=!0),null!==at&&l.update(at,34963),Pt&&(function De(Ze,Ce,Fe,je){if(!1===p.isWebGL2&&(Ze.isInstancedMesh||je.isInstancedBufferGeometry)&&null===o.get("ANGLE_instanced_arrays"))return;q();const at=je.attributes,Pt=Fe.getAttributes(),xt=Ce.defaultAttributeValues;for(const Ut in Pt){const qt=Pt[Ut];if(qt>=0){const Qn=at[Ut];if(void 0!==Qn){const Un=Qn.normalized,ki=Qn.itemSize,mt=l.get(Qn);if(void 0===mt)continue;const is=mt.buffer,Kn=mt.type,Ni=mt.bytesPerElement;if(Qn.isInterleavedBufferAttribute){const ri=Qn.data,Hi=ri.stride,si=Qn.offset;ri&&ri.isInstancedInterleavedBuffer?(Ie(qt,ri.meshPerAttribute),void 0===je._maxInstanceCount&&(je._maxInstanceCount=ri.meshPerAttribute*ri.count)):Ae(qt),a.bindBuffer(34962,is),he(qt,ki,Kn,Un,Hi*Ni,si*Ni)}else Qn.isInstancedBufferAttribute?(Ie(qt,Qn.meshPerAttribute),void 0===je._maxInstanceCount&&(je._maxInstanceCount=Qn.meshPerAttribute*Qn.count)):Ae(qt),a.bindBuffer(34962,is),he(qt,ki,Kn,Un,0,0)}else if("instanceMatrix"===Ut){const Un=l.get(Ze.instanceMatrix);if(void 0===Un)continue;const ki=Un.buffer,mt=Un.type;Ie(qt+0,1),Ie(qt+1,1),Ie(qt+2,1),Ie(qt+3,1),a.bindBuffer(34962,ki),a.vertexAttribPointer(qt+0,4,mt,!1,64,0),a.vertexAttribPointer(qt+1,4,mt,!1,64,16),a.vertexAttribPointer(qt+2,4,mt,!1,64,32),a.vertexAttribPointer(qt+3,4,mt,!1,64,48)}else if("instanceColor"===Ut){const Un=l.get(Ze.instanceColor);if(void 0===Un)continue;const ki=Un.buffer,mt=Un.type;Ie(qt,1),a.bindBuffer(34962,ki),a.vertexAttribPointer(qt,3,mt,!1,12,0)}else if(void 0!==xt){const Un=xt[Ut];if(void 0!==Un)switch(Un.length){case 2:a.vertexAttrib2fv(qt,Un);break;case 3:a.vertexAttrib3fv(qt,Un);break;case 4:a.vertexAttrib4fv(qt,Un);break;default:a.vertexAttrib1fv(qt,Un)}}}}Se()}(Ze,Ce,Fe,je),null!==at&&a.bindBuffer(34963,l.get(at).buffer))},reset:tt,resetDefaultState:ut,dispose:function vt(){tt();for(const Ze in E){const Ce=E[Ze];for(const Fe in Ce){const je=Ce[Fe];for(const at in je)G(je[at].object),delete je[at];delete Ce[Fe]}delete E[Ze]}},releaseStatesOfGeometry:function ke(Ze){if(void 0===E[Ze.id])return;const Ce=E[Ze.id];for(const Fe in Ce){const je=Ce[Fe];for(const at in je)G(je[at].object),delete je[at];delete Ce[Fe]}delete E[Ze.id]},releaseStatesOfProgram:function Qe(Ze){for(const Ce in E){const Fe=E[Ce];if(void 0===Fe[Ze.id])continue;const je=Fe[Ze.id];for(const at in je)G(je[at].object),delete je[at];delete Fe[Ze.id]}},initAttributes:q,enableAttribute:Ae,disableUnusedAttributes:Se}}function d0(a,o,l,p){const v=p.isWebGL2;let y;this.setMode=function x(R){y=R},this.render=function E(R,F){a.drawArrays(y,R,F),l.update(F,y,1)},this.renderInstances=function I(R,F,k){if(0===k)return;let U,G;if(v)U=a,G="drawArraysInstanced";else if(U=o.get("ANGLE_instanced_arrays"),G="drawArraysInstancedANGLE",null===U)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");U[G](y,R,F,k),l.update(F,y,k)}}function Rm(a,o,l){let p;function y(he){if("highp"===he){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";he="mediump"}return"mediump"===he&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const x=typeof WebGL2RenderingContext<"u"&&a instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&a instanceof WebGL2ComputeRenderingContext;let E=void 0!==l.precision?l.precision:"highp";const I=y(E);I!==E&&(console.warn("THREE.WebGLRenderer:",E,"not supported, using",I,"instead."),E=I);const R=!0===l.logarithmicDepthBuffer,F=a.getParameter(34930),k=a.getParameter(35660),U=a.getParameter(3379),G=a.getParameter(34076),Y=a.getParameter(34921),re=a.getParameter(36347),ie=a.getParameter(36348),$=a.getParameter(36349),q=k>0,Ae=x||!!o.get("OES_texture_float");return{isWebGL2:x,getMaxAnisotropy:function v(){if(void 0!==p)return p;const he=o.get("EXT_texture_filter_anisotropic");return p=null!==he?a.getParameter(he.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,p},getMaxPrecision:y,precision:E,logarithmicDepthBuffer:R,maxTextures:F,maxVertexTextures:k,maxTextureSize:U,maxCubemapSize:G,maxAttributes:Y,maxVertexUniforms:re,maxVaryings:ie,maxFragmentUniforms:$,vertexTextures:q,floatFragmentTextures:Ae,floatVertexTextures:q&&Ae,maxSamples:x?a.getParameter(36183):0}}function yu(a){const o=this;let l=null,p=0,v=!1,y=!1;const x=new Pl,E=new la,I={value:null,needsUpdate:!1};function R(){I.value!==l&&(I.value=l,I.needsUpdate=p>0),o.numPlanes=p,o.numIntersection=0}function F(k,U,G,Y){const re=null!==k?k.length:0;let ie=null;if(0!==re){if(ie=I.value,!0!==Y||null===ie){const $=G+4*re,q=U.matrixWorldInverse;E.getNormalMatrix(q),(null===ie||ie.length<$)&&(ie=new Float32Array($));for(let Ae=0,Ie=G;Ae!==re;++Ae,Ie+=4)x.copy(k[Ae]).applyMatrix4(q,E),x.normal.toArray(ie,Ie),ie[Ie+3]=x.constant}I.value=ie,I.needsUpdate=!0}return o.numPlanes=re,o.numIntersection=0,ie}this.uniform=I,this.numPlanes=0,this.numIntersection=0,this.init=function(k,U,G){const Y=0!==k.length||U||0!==p||v;return v=U,l=F(k,G,0),p=k.length,Y},this.beginShadows=function(){y=!0,F(null)},this.endShadows=function(){y=!1,R()},this.setState=function(k,U,G){const Y=k.clippingPlanes,re=k.clipIntersection,ie=k.clipShadows,$=a.get(k);if(!v||null===Y||0===Y.length||y&&!ie)y?F(null):R();else{const q=y?0:p,Ae=4*q;let Ie=$.clippingState||null;I.value=Ie,Ie=F(Y,U,Ae,G);for(let Se=0;Se!==Ae;++Se)Ie[Se]=l[Se];$.clippingState=Ie,this.numIntersection=re?this.numPlanes:0,this.numPlanes+=q}}}function dv(a){let o=new WeakMap;function l(x,E){return 303===E?x.mapping=301:304===E&&(x.mapping=302),x}function v(x){const E=x.target;E.removeEventListener("dispose",v);const I=o.get(E);void 0!==I&&(o.delete(E),I.dispose())}return{get:function p(x){if(x&&x.isTexture){const E=x.mapping;if(303===E||304===E){if(o.has(x))return l(o.get(x).texture,x.mapping);{const I=x.image;if(I&&I.height>0){const R=a.getRenderList(),F=a.getRenderTarget(),k=new Xg(I.height/2);return k.fromEquirectangularTexture(a,x),o.set(x,k),a.setRenderTarget(F),a.setRenderList(R),x.addEventListener("dispose",v),l(k.texture,x.mapping)}return null}}}return x},dispose:function y(){o=new WeakMap}}}function wd(a){const o={};function l(p){if(void 0!==o[p])return o[p];let v;switch(p){case"WEBGL_depth_texture":v=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":v=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":v=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":v=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:v=a.getExtension(p)}return o[p]=v,v}return{has:function(p){return null!==l(p)},init:function(p){p.isWebGL2?l("EXT_color_buffer_float"):(l("WEBGL_depth_texture"),l("OES_texture_float"),l("OES_texture_half_float"),l("OES_texture_half_float_linear"),l("OES_standard_derivatives"),l("OES_element_index_uint"),l("OES_vertex_array_object"),l("ANGLE_instanced_arrays")),l("OES_texture_float_linear"),l("EXT_color_buffer_half_float")},get:function(p){const v=l(p);return null===v&&console.warn("THREE.WebGLRenderer: "+p+" extension not supported."),v}}}function ab(a,o,l,p){const v={},y=new WeakMap;function x(k){const U=k.target;null!==U.index&&o.remove(U.index);for(const Y in U.attributes)o.remove(U.attributes[Y]);U.removeEventListener("dispose",x),delete v[U.id];const G=y.get(U);G&&(o.remove(G),y.delete(U)),p.releaseStatesOfGeometry(U),!0===U.isInstancedBufferGeometry&&delete U._maxInstanceCount,l.memory.geometries--}function R(k){const U=[],G=k.index,Y=k.attributes.position;let re=0;if(null!==G){const q=G.array;re=G.version;for(let Ae=0,Ie=q.length;Ae<Ie;Ae+=3){const Se=q[Ae+0],he=q[Ae+1],De=q[Ae+2];U.push(Se,he,he,De,De,Se)}}else{re=Y.version;for(let Ae=0,Ie=Y.array.length/3-1;Ae<Ie;Ae+=3){const Se=Ae+0,he=Ae+1,De=Ae+2;U.push(Se,he,he,De,De,Se)}}const ie=new(ch(U)>65535?Ll:fs)(U,1);ie.version=re;const $=y.get(k);$&&o.remove($),y.set(k,ie)}return{get:function E(k,U){return!0===v[U.id]||(U.addEventListener("dispose",x),v[U.id]=!0,l.memory.geometries++),U},update:function I(k){const U=k.attributes;for(const Y in U)o.update(U[Y],34962);const G=k.morphAttributes;for(const Y in G){const re=G[Y];for(let ie=0,$=re.length;ie<$;ie++)o.update(re[ie],34962)}},getWireframeAttribute:function F(k){const U=y.get(k);if(U){const G=k.index;null!==G&&U.version<G.version&&R(k)}else R(k);return y.get(k)}}}function Jf(a,o,l,p){const v=p.isWebGL2;let y,E,I;this.setMode=function x(U){y=U},this.setIndex=function R(U){E=U.type,I=U.bytesPerElement},this.render=function F(U,G){a.drawElements(y,G,E,U*I),l.update(G,y,1)},this.renderInstances=function k(U,G,Y){if(0===Y)return;let re,ie;if(v)re=a,ie="drawElementsInstanced";else if(re=o.get("ANGLE_instanced_arrays"),ie="drawElementsInstancedANGLE",null===re)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");re[ie](y,G,E,U*I,Y),l.update(G,y,Y)}}function Mh(a){const l={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:l,programs:null,autoReset:!0,reset:function v(){l.frame++,l.calls=0,l.triangles=0,l.points=0,l.lines=0},update:function p(y,x,E){switch(l.calls++,x){case 4:l.triangles+=E*(y/3);break;case 1:l.lines+=E*(y/2);break;case 3:l.lines+=E*(y-1);break;case 2:l.lines+=E*y;break;case 0:l.points+=E*y;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",x)}}}}function Ih(a,o){return a[0]-o[0]}function hv(a,o){return Math.abs(o[1])-Math.abs(a[1])}function h0(a){const o={},l=new Float32Array(8),p=[];for(let y=0;y<8;y++)p[y]=[y,0];return{update:function v(y,x,E,I){const R=y.morphTargetInfluences,F=void 0===R?0:R.length;let k=o[x.id];if(void 0===k){k=[];for(let ie=0;ie<F;ie++)k[ie]=[ie,0];o[x.id]=k}for(let ie=0;ie<F;ie++){const $=k[ie];$[0]=ie,$[1]=R[ie]}k.sort(hv);for(let ie=0;ie<8;ie++)ie<F&&k[ie][1]?(p[ie][0]=k[ie][0],p[ie][1]=k[ie][1]):(p[ie][0]=Number.MAX_SAFE_INTEGER,p[ie][1]=0);p.sort(Ih);const U=E.morphTargets&&x.morphAttributes.position,G=E.morphNormals&&x.morphAttributes.normal;let Y=0;for(let ie=0;ie<8;ie++){const $=p[ie],q=$[0],Ae=$[1];q!==Number.MAX_SAFE_INTEGER&&Ae?(U&&x.getAttribute("morphTarget"+ie)!==U[q]&&x.setAttribute("morphTarget"+ie,U[q]),G&&x.getAttribute("morphNormal"+ie)!==G[q]&&x.setAttribute("morphNormal"+ie,G[q]),l[ie]=Ae,Y+=Ae):(U&&!0===x.hasAttribute("morphTarget"+ie)&&x.deleteAttribute("morphTarget"+ie),G&&!0===x.hasAttribute("morphNormal"+ie)&&x.deleteAttribute("morphNormal"+ie),l[ie]=0)}const re=x.morphTargetsRelative?1:1-Y;I.getUniforms().setValue(a,"morphTargetBaseInfluence",re),I.getUniforms().setValue(a,"morphTargetInfluences",l)}}}function f0(a,o,l,p){let v=new WeakMap;function E(I){const R=I.target;R.removeEventListener("dispose",E),l.remove(R.instanceMatrix),null!==R.instanceColor&&l.remove(R.instanceColor)}return{update:function y(I){const R=p.render.frame,k=o.get(I,I.geometry);return v.get(k)!==R&&(o.update(k),v.set(k,R)),I.isInstancedMesh&&(!1===I.hasEventListener("dispose",E)&&I.addEventListener("dispose",E),l.update(I.instanceMatrix,34962),null!==I.instanceColor&&l.update(I.instanceColor,34962)),k},dispose:function x(){v=new WeakMap}}}function Gl(a=null,o=1,l=1,p=1){Li.call(this,null),this.image={data:a,width:o,height:l,depth:p},this.magFilter=ba,this.minFilter=ba,this.wrapR=Hs,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function bu(a=null,o=1,l=1,p=1){Li.call(this,null),this.image={data:a,width:o,height:l,depth:p},this.magFilter=ba,this.minFilter=ba,this.wrapR=Hs,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ya.physical={uniforms:Jr([Ya.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new qe(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ei(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Bn.meshphysical_vert,fragmentShader:Bn.meshphysical_frag},(Gl.prototype=Object.create(Li.prototype)).constructor=Gl,Gl.prototype.isDataTexture2DArray=!0,(bu.prototype=Object.create(Li.prototype)).constructor=bu,bu.prototype.isDataTexture3D=!0;const fv=new Li,ob=new Gl,pv=new bu,Nm=new Rr,mv=[],gv=[],Fc=new Float32Array(16),vv=new Float32Array(9),ep=new Float32Array(4);function Ad(a,o,l){const p=a[0];if(p<=0||p>0)return a;const v=o*l;let y=mv[v];if(void 0===y&&(y=new Float32Array(v),mv[v]=y),0!==o){p.toArray(y,0);for(let x=1,E=0;x!==o;++x)E+=l,a[x].toArray(y,E)}return y}function pl(a,o){if(a.length!==o.length)return!1;for(let l=0,p=a.length;l<p;l++)if(a[l]!==o[l])return!1;return!0}function Co(a,o){for(let l=0,p=o.length;l<p;l++)a[l]=o[l]}function lb(a,o){let l=gv[o];void 0===l&&(l=new Int32Array(o),gv[o]=l);for(let p=0;p!==o;++p)l[p]=a.allocateTextureUnit();return l}function p0(a,o){const l=this.cache;l[0]!==o&&(a.uniform1f(this.addr,o),l[0]=o)}function m0(a,o){const l=this.cache;if(void 0!==o.x)(l[0]!==o.x||l[1]!==o.y)&&(a.uniform2f(this.addr,o.x,o.y),l[0]=o.x,l[1]=o.y);else{if(pl(l,o))return;a.uniform2fv(this.addr,o),Co(l,o)}}function _v(a,o){const l=this.cache;if(void 0!==o.x)(l[0]!==o.x||l[1]!==o.y||l[2]!==o.z)&&(a.uniform3f(this.addr,o.x,o.y,o.z),l[0]=o.x,l[1]=o.y,l[2]=o.z);else if(void 0!==o.r)(l[0]!==o.r||l[1]!==o.g||l[2]!==o.b)&&(a.uniform3f(this.addr,o.r,o.g,o.b),l[0]=o.r,l[1]=o.g,l[2]=o.b);else{if(pl(l,o))return;a.uniform3fv(this.addr,o),Co(l,o)}}function g0(a,o){const l=this.cache;if(void 0!==o.x)(l[0]!==o.x||l[1]!==o.y||l[2]!==o.z||l[3]!==o.w)&&(a.uniform4f(this.addr,o.x,o.y,o.z,o.w),l[0]=o.x,l[1]=o.y,l[2]=o.z,l[3]=o.w);else{if(pl(l,o))return;a.uniform4fv(this.addr,o),Co(l,o)}}function v0(a,o){const l=this.cache,p=o.elements;if(void 0===p){if(pl(l,o))return;a.uniformMatrix2fv(this.addr,!1,o),Co(l,o)}else{if(pl(l,p))return;ep.set(p),a.uniformMatrix2fv(this.addr,!1,ep),Co(l,p)}}function tp(a,o){const l=this.cache,p=o.elements;if(void 0===p){if(pl(l,o))return;a.uniformMatrix3fv(this.addr,!1,o),Co(l,o)}else{if(pl(l,p))return;vv.set(p),a.uniformMatrix3fv(this.addr,!1,vv),Co(l,p)}}function yv(a,o){const l=this.cache,p=o.elements;if(void 0===p){if(pl(l,o))return;a.uniformMatrix4fv(this.addr,!1,o),Co(l,o)}else{if(pl(l,p))return;Fc.set(p),a.uniformMatrix4fv(this.addr,!1,Fc),Co(l,p)}}function Rh(a,o,l){const p=this.cache,v=l.allocateTextureUnit();p[0]!==v&&(a.uniform1i(this.addr,v),p[0]=v),l.safeSetTexture2D(o||fv,v)}function ub(a,o,l){const p=this.cache,v=l.allocateTextureUnit();p[0]!==v&&(a.uniform1i(this.addr,v),p[0]=v),l.setTexture2DArray(o||ob,v)}function bv(a,o,l){const p=this.cache,v=l.allocateTextureUnit();p[0]!==v&&(a.uniform1i(this.addr,v),p[0]=v),l.setTexture3D(o||pv,v)}function wn(a,o,l){const p=this.cache,v=l.allocateTextureUnit();p[0]!==v&&(a.uniform1i(this.addr,v),p[0]=v),l.safeSetTextureCube(o||Nm,v)}function xd(a,o){const l=this.cache;l[0]!==o&&(a.uniform1i(this.addr,o),l[0]=o)}function Pm(a,o){const l=this.cache;pl(l,o)||(a.uniform2iv(this.addr,o),Co(l,o))}function Om(a,o){const l=this.cache;pl(l,o)||(a.uniform3iv(this.addr,o),Co(l,o))}function Lm(a,o){const l=this.cache;pl(l,o)||(a.uniform4iv(this.addr,o),Co(l,o))}function np(a,o){const l=this.cache;l[0]!==o&&(a.uniform1ui(this.addr,o),l[0]=o)}function ta(a,o){a.uniform1fv(this.addr,o)}function ip(a,o){a.uniform1iv(this.addr,o)}function km(a,o){a.uniform2iv(this.addr,o)}function Nh(a,o){a.uniform3iv(this.addr,o)}function Ph(a,o){a.uniform4iv(this.addr,o)}function Qa(a,o){const l=Ad(o,this.size,2);a.uniform2fv(this.addr,l)}function Xo(a,o){const l=Ad(o,this.size,3);a.uniform3fv(this.addr,l)}function _0(a,o){const l=Ad(o,this.size,4);a.uniform4fv(this.addr,l)}function Fm(a,o){const l=Ad(o,this.size,4);a.uniformMatrix2fv(this.addr,!1,l)}function cb(a,o){const l=Ad(o,this.size,9);a.uniformMatrix3fv(this.addr,!1,l)}function y0(a,o){const l=Ad(o,this.size,16);a.uniformMatrix4fv(this.addr,!1,l)}function Tu(a,o,l){const p=o.length,v=lb(l,p);a.uniform1iv(this.addr,v);for(let y=0;y!==p;++y)l.safeSetTexture2D(o[y]||fv,v[y])}function db(a,o,l){const p=o.length,v=lb(l,p);a.uniform1iv(this.addr,v);for(let y=0;y!==p;++y)l.safeSetTextureCube(o[y]||Nm,v[y])}function Be(a,o,l){this.id=a,this.addr=l,this.cache=[],this.setValue=function Sd(a){switch(a){case 5126:return p0;case 35664:return m0;case 35665:return _v;case 35666:return g0;case 35674:return v0;case 35675:return tp;case 35676:return yv;case 5124:case 35670:return xd;case 35667:case 35671:return Pm;case 35668:case 35672:return Om;case 35669:case 35673:return Lm;case 5125:return np;case 35678:case 36198:case 36298:case 36306:case 35682:return Rh;case 35679:case 36299:case 36307:return bv;case 35680:case 36300:case 36308:case 36293:return wn;case 36289:case 36303:case 36311:case 36292:return ub}}(o.type)}function rp(a,o,l){this.id=a,this.addr=l,this.cache=[],this.size=o.size,this.setValue=function Tv(a){switch(a){case 5126:return ta;case 35664:return Qa;case 35665:return Xo;case 35666:return _0;case 35674:return Fm;case 35675:return cb;case 35676:return y0;case 5124:case 35670:return ip;case 35667:case 35671:return km;case 35668:case 35672:return Nh;case 35669:case 35673:return Ph;case 35678:case 36198:case 36298:case 36306:case 35682:return Tu;case 35680:case 36300:case 36308:case 36293:return db}}(o.type)}function Bm(a){this.id=a,this.seq=[],this.map={}}rp.prototype.updateCache=function(a){const o=this.cache;a instanceof Float32Array&&o.length!==a.length&&(this.cache=new Float32Array(a.length)),Co(o,a)},Bm.prototype.setValue=function(a,o,l){const p=this.seq;for(let v=0,y=p.length;v!==y;++v){const x=p[v];x.setValue(a,o[x.id],l)}};const Yo=/(\w+)(\])?(\[|\.)?/g;function Qu(a,o){a.seq.push(o),a.map[o.id]=o}function ml(a,o,l){const p=a.name,v=p.length;for(Yo.lastIndex=0;;){const y=Yo.exec(p),x=Yo.lastIndex;let E=y[1];const R=y[3];if("]"===y[2]&&(E|=0),void 0===R||"["===R&&x+2===v){Qu(l,void 0===R?new Be(E,a,o):new rp(E,a,o));break}{let k=l.map[E];void 0===k&&(k=new Bm(E),Qu(l,k)),l=k}}}function _s(a,o){this.seq=[],this.map={};const l=a.getProgramParameter(o,35718);for(let p=0;p<l;++p){const v=a.getActiveUniform(o,p);ml(v,a.getUniformLocation(o,v.name),this)}}function oo(a,o,l){const p=a.createShader(o);return a.shaderSource(p,l),a.compileShader(p),p}_s.prototype.setValue=function(a,o,l,p){const v=this.map[o];void 0!==v&&v.setValue(a,l,p)},_s.prototype.setOptional=function(a,o,l){const p=o[l];void 0!==p&&this.setValue(a,l,p)},_s.upload=function(a,o,l,p){for(let v=0,y=o.length;v!==y;++v){const x=o[v],E=l[x.id];!1!==E.needsUpdate&&x.setValue(a,E.value,p)}},_s.seqWithValue=function(a,o){const l=[];for(let p=0,v=a.length;p!==v;++p){const y=a[p];y.id in o&&l.push(y)}return l};let wv=0;function Oh(a){switch(a){case Il:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}function hb(a,o,l){const p=a.getShaderParameter(o,35713),v=a.getShaderInfoLog(o).trim();return p&&""===v?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+l+"\n"+v+function Ed(a){const o=a.split("\n");for(let l=0;l<o.length;l++)o[l]=l+1+": "+o[l];return o.join("\n")}(a.getShaderSource(o))}function Um(a,o){const l=Oh(o);return"vec4 "+a+"( vec4 value ) { return "+l[0]+"ToLinear"+l[1]+"; }"}function fb(a,o){const l=Oh(o);return"vec4 "+a+"( vec4 value ) { return LinearTo"+l[0]+l[1]+"; }"}function Av(a,o){let l;switch(o){case 1:l="Linear";break;case 2:l="Reinhard";break;case 3:l="OptimizedCineon";break;case 4:l="ACESFilmic";break;case 5:l="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",o),l="Linear"}return"vec3 "+a+"( vec3 color ) { return "+l+"ToneMapping( color ); }"}function Lh(a){return""!==a}function Vm(a,o){return a.replace(/NUM_DIR_LIGHTS/g,o.numDirLights).replace(/NUM_SPOT_LIGHTS/g,o.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,o.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,o.numPointLights).replace(/NUM_HEMI_LIGHTS/g,o.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,o.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,o.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,o.numPointLightShadows)}function Hm(a,o){return a.replace(/NUM_CLIPPING_PLANES/g,o.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,o.numClippingPlanes-o.numClipIntersection)}const Sv=/^[ \t]*#include +<([\w\d./]+)>/gm;function Gm(a){return a.replace(Sv,b0)}function b0(a,o){const l=Bn[o];if(void 0===l)throw new Error("Can not resolve #include <"+o+">");return Gm(l)}const Ev=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,jm=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Cv(a){return a.replace(jm,Dv).replace(Ev,zm)}function zm(a,o,l,p){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Dv(0,o,l,p)}function Dv(a,o,l,p){let v="";for(let y=parseInt(o);y<parseInt(l);y++)v+=p.replace(/\[\s*i\s*\]/g,"[ "+y+" ]").replace(/UNROLLED_LOOP_INDEX/g,y);return v}function er(a){let o="precision "+a.precision+" float;\nprecision "+a.precision+" int;";return"highp"===a.precision?o+="\n#define HIGH_PRECISION":"mediump"===a.precision?o+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(o+="\n#define LOW_PRECISION"),o}function Rv(a,o,l,p){const v=a.getContext(),y=l.defines;let x=l.vertexShader,E=l.fragmentShader;const I=function T0(a){let o="SHADOWMAP_TYPE_BASIC";return 1===a.shadowMapType?o="SHADOWMAP_TYPE_PCF":2===a.shadowMapType?o="SHADOWMAP_TYPE_PCF_SOFT":3===a.shadowMapType&&(o="SHADOWMAP_TYPE_VSM"),o}(l),R=function mb(a){let o="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:o="ENVMAP_TYPE_CUBE";break;case 306:case 307:o="ENVMAP_TYPE_CUBE_UV"}return o}(l),F=function Mv(a){let o="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case 302:case 307:o="ENVMAP_MODE_REFRACTION"}return o}(l),k=function Iv(a){let o="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:o="ENVMAP_BLENDING_MULTIPLY";break;case 1:o="ENVMAP_BLENDING_MIX";break;case 2:o="ENVMAP_BLENDING_ADD"}return o}(l),U=a.gammaFactor>0?a.gammaFactor:1,G=l.isWebGL2?"":function Ku(a){return[a.extensionDerivatives||a.envMapCubeUV||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||"physical"===a.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Lh).join("\n")}(l),Y=function xv(a){const o=[];for(const l in a){const p=a[l];!1!==p&&o.push("#define "+l+" "+p)}return o.join("\n")}(y),re=v.createProgram();let ie,$,q=l.glslVersion?"#version "+l.glslVersion+"\n":"";l.isRawShaderMaterial?(ie=[Y].filter(Lh).join("\n"),ie.length>0&&(ie+="\n"),$=[G,Y].filter(Lh).join("\n"),$.length>0&&($+="\n")):(ie=[er(l),"#define SHADER_NAME "+l.shaderName,Y,l.instancing?"#define USE_INSTANCING":"",l.instancingColor?"#define USE_INSTANCING_COLOR":"",l.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+U,"#define MAX_BONES "+l.maxBones,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp2?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+F:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.normalMap&&l.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",l.normalMap&&l.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",l.clearcoatMap?"#define USE_CLEARCOATMAP":"",l.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",l.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",l.displacementMap&&l.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.transmissionMap?"#define USE_TRANSMISSIONMAP":"",l.vertexTangents?"#define USE_TANGENT":"",l.vertexColors?"#define USE_COLOR":"",l.vertexUvs?"#define USE_UV":"",l.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",l.flatShading?"#define FLAT_SHADED":"",l.skinning?"#define USE_SKINNING":"",l.useVertexTexture?"#define BONE_TEXTURE":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals&&!1===l.flatShading?"#define USE_MORPHNORMALS":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+I:"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&l.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Lh).join("\n"),$=[G,er(l),"#define SHADER_NAME "+l.shaderName,Y,l.alphaTest?"#define ALPHATEST "+l.alphaTest+(l.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+U,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp2?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.matcap?"#define USE_MATCAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+R:"",l.envMap?"#define "+F:"",l.envMap?"#define "+k:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.normalMap&&l.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",l.normalMap&&l.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",l.clearcoatMap?"#define USE_CLEARCOATMAP":"",l.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",l.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.sheen?"#define USE_SHEEN":"",l.transmissionMap?"#define USE_TRANSMISSIONMAP":"",l.vertexTangents?"#define USE_TANGENT":"",l.vertexColors||l.instancingColor?"#define USE_COLOR":"",l.vertexUvs?"#define USE_UV":"",l.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",l.gradientMap?"#define USE_GRADIENTMAP":"",l.flatShading?"#define FLAT_SHADED":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+I:"",l.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",l.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&l.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(l.extensionShaderTextureLOD||l.envMap)&&l.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==l.toneMapping?"#define TONE_MAPPING":"",0!==l.toneMapping?Bn.tonemapping_pars_fragment:"",0!==l.toneMapping?Av("toneMapping",l.toneMapping):"",l.dithering?"#define DITHERING":"",Bn.encodings_pars_fragment,l.map?Um("mapTexelToLinear",l.mapEncoding):"",l.matcap?Um("matcapTexelToLinear",l.matcapEncoding):"",l.envMap?Um("envMapTexelToLinear",l.envMapEncoding):"",l.emissiveMap?Um("emissiveMapTexelToLinear",l.emissiveMapEncoding):"",l.lightMap?Um("lightMapTexelToLinear",l.lightMapEncoding):"",fb("linearToOutputTexel",l.outputEncoding),l.depthPacking?"#define DEPTH_PACKING "+l.depthPacking:"","\n"].filter(Lh).join("\n")),x=Gm(x),x=Vm(x,l),x=Hm(x,l),E=Gm(E),E=Vm(E,l),E=Hm(E,l),x=Cv(x),E=Cv(E),l.isWebGL2&&!0!==l.isRawShaderMaterial&&(q="#version 300 es\n",ie=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+ie,$=["#define varying in","300 es"===l.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===l.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+$);const Ie=q+$+E,Se=oo(v,35633,q+ie+x),he=oo(v,35632,Ie);if(v.attachShader(re,Se),v.attachShader(re,he),void 0!==l.index0AttributeName?v.bindAttribLocation(re,0,l.index0AttributeName):!0===l.morphTargets&&v.bindAttribLocation(re,0,"position"),v.linkProgram(re),a.debug.checkShaderErrors){const ke=v.getProgramInfoLog(re).trim(),Qe=v.getShaderInfoLog(Se).trim(),tt=v.getShaderInfoLog(he).trim();let ut=!0,Ze=!0;if(!1===v.getProgramParameter(re,35714)){ut=!1;const Ce=hb(v,Se,"vertex"),Fe=hb(v,he,"fragment");console.error("THREE.WebGLProgram: shader error: ",v.getError(),"35715",v.getProgramParameter(re,35715),"gl.getProgramInfoLog",ke,Ce,Fe)}else""!==ke?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",ke):(""===Qe||""===tt)&&(Ze=!1);Ze&&(this.diagnostics={runnable:ut,programLog:ke,vertexShader:{log:Qe,prefix:ie},fragmentShader:{log:tt,prefix:$}})}let De,vt;return v.deleteShader(Se),v.deleteShader(he),this.getUniforms=function(){return void 0===De&&(De=new _s(v,re)),De},this.getAttributes=function(){return void 0===vt&&(vt=function pb(a,o){const l={},p=a.getProgramParameter(o,35721);for(let v=0;v<p;v++){const x=a.getActiveAttrib(o,v).name;l[x]=a.getAttribLocation(o,x)}return l}(v,re)),vt},this.destroy=function(){p.releaseStatesOfProgram(this),v.deleteProgram(re),this.program=void 0},this.name=l.shaderName,this.id=wv++,this.cacheKey=o,this.usedTimes=1,this.program=re,this.vertexShader=Se,this.fragmentShader=he,this}function Wm(a,o,l,p,v,y){const x=[],E=p.isWebGL2,I=p.logarithmicDepthBuffer,R=p.floatVertexTextures,F=p.maxVertexUniforms,k=p.vertexTextures;let U=p.precision;const G={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Y=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function ie(he){let De;return he&&he.isTexture?De=he.encoding:he&&he.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),De=he.texture.encoding):De=Il,De}return{getParameters:function $(he,De,vt,ke,Qe){const tt=ke.fog,Ze=o.get(he.envMap||(he.isMeshStandardMaterial?ke.environment:null)),Ce=G[he.type],Fe=Qe.isSkinnedMesh?function re(he){const vt=he.skeleton.bones;if(R)return 1024;{const Qe=Math.floor((F-20)/4),tt=Math.min(Qe,vt.length);return tt<vt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+vt.length+" bones. This GPU supports "+tt+"."),0):tt}}(Qe):0;let je,at;if(null!==he.precision&&(U=p.getMaxPrecision(he.precision),U!==he.precision&&console.warn("THREE.WebGLProgram.getParameters:",he.precision,"not supported, using",U,"instead.")),Ce){const Ut=Ya[Ce];je=Ut.vertexShader,at=Ut.fragmentShader}else je=he.vertexShader,at=he.fragmentShader;const Pt=a.getRenderTarget();return{isWebGL2:E,shaderID:Ce,shaderName:he.type,vertexShader:je,fragmentShader:at,defines:he.defines,isRawShaderMaterial:!0===he.isRawShaderMaterial,glslVersion:he.glslVersion,precision:U,instancing:!0===Qe.isInstancedMesh,instancingColor:!0===Qe.isInstancedMesh&&null!==Qe.instanceColor,supportsVertexTextures:k,outputEncoding:null!==Pt?ie(Pt.texture):a.outputEncoding,map:!!he.map,mapEncoding:ie(he.map),matcap:!!he.matcap,matcapEncoding:ie(he.matcap),envMap:!!Ze,envMapMode:Ze&&Ze.mapping,envMapEncoding:ie(Ze),envMapCubeUV:!!Ze&&(306===Ze.mapping||307===Ze.mapping),lightMap:!!he.lightMap,lightMapEncoding:ie(he.lightMap),aoMap:!!he.aoMap,emissiveMap:!!he.emissiveMap,emissiveMapEncoding:ie(he.emissiveMap),bumpMap:!!he.bumpMap,normalMap:!!he.normalMap,objectSpaceNormalMap:1===he.normalMapType,tangentSpaceNormalMap:0===he.normalMapType,clearcoatMap:!!he.clearcoatMap,clearcoatRoughnessMap:!!he.clearcoatRoughnessMap,clearcoatNormalMap:!!he.clearcoatNormalMap,displacementMap:!!he.displacementMap,roughnessMap:!!he.roughnessMap,metalnessMap:!!he.metalnessMap,specularMap:!!he.specularMap,alphaMap:!!he.alphaMap,gradientMap:!!he.gradientMap,sheen:!!he.sheen,transmissionMap:!!he.transmissionMap,combine:he.combine,vertexTangents:he.normalMap&&he.vertexTangents,vertexColors:he.vertexColors,vertexUvs:!!(he.map||he.bumpMap||he.normalMap||he.specularMap||he.alphaMap||he.emissiveMap||he.roughnessMap||he.metalnessMap||he.clearcoatMap||he.clearcoatRoughnessMap||he.clearcoatNormalMap||he.displacementMap||he.transmissionMap),uvsVertexOnly:!(he.map||he.bumpMap||he.normalMap||he.specularMap||he.alphaMap||he.emissiveMap||he.roughnessMap||he.metalnessMap||he.clearcoatNormalMap||he.transmissionMap||!he.displacementMap),fog:!!tt,useFog:he.fog,fogExp2:tt&&tt.isFogExp2,flatShading:he.flatShading,sizeAttenuation:he.sizeAttenuation,logarithmicDepthBuffer:I,skinning:he.skinning&&Fe>0,maxBones:Fe,useVertexTexture:R,morphTargets:he.morphTargets,morphNormals:he.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:De.directional.length,numPointLights:De.point.length,numSpotLights:De.spot.length,numRectAreaLights:De.rectArea.length,numHemiLights:De.hemi.length,numDirLightShadows:De.directionalShadowMap.length,numPointLightShadows:De.pointShadowMap.length,numSpotLightShadows:De.spotShadowMap.length,numClippingPlanes:y.numPlanes,numClipIntersection:y.numIntersection,dithering:he.dithering,shadowMapEnabled:a.shadowMap.enabled&&vt.length>0,shadowMapType:a.shadowMap.type,toneMapping:he.toneMapped?a.toneMapping:0,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:he.premultipliedAlpha,alphaTest:he.alphaTest,doubleSided:2===he.side,flipSided:1===he.side,depthPacking:void 0!==he.depthPacking&&he.depthPacking,index0AttributeName:he.index0AttributeName,extensionDerivatives:he.extensions&&he.extensions.derivatives,extensionFragDepth:he.extensions&&he.extensions.fragDepth,extensionDrawBuffers:he.extensions&&he.extensions.drawBuffers,extensionShaderTextureLOD:he.extensions&&he.extensions.shaderTextureLOD,rendererExtensionFragDepth:E||l.has("EXT_frag_depth"),rendererExtensionDrawBuffers:E||l.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:E||l.has("EXT_shader_texture_lod"),customProgramCacheKey:he.customProgramCacheKey()}},getProgramCacheKey:function q(he){const De=[];if(he.shaderID?De.push(he.shaderID):(De.push(he.fragmentShader),De.push(he.vertexShader)),void 0!==he.defines)for(const vt in he.defines)De.push(vt),De.push(he.defines[vt]);if(!1===he.isRawShaderMaterial){for(let vt=0;vt<Y.length;vt++)De.push(he[Y[vt]]);De.push(a.outputEncoding),De.push(a.gammaFactor)}return De.push(he.customProgramCacheKey),De.join()},getUniforms:function Ae(he){const De=G[he.type];let vt;return vt=De?qg.clone(Ya[De].uniforms):he.uniforms,vt},acquireProgram:function Ie(he,De){let vt;for(let ke=0,Qe=x.length;ke<Qe;ke++){const tt=x[ke];if(tt.cacheKey===De){vt=tt,++vt.usedTimes;break}}return void 0===vt&&(vt=new Rv(a,De,he,v),x.push(vt)),vt},releaseProgram:function Se(he){if(0==--he.usedTimes){const De=x.indexOf(he);x[De]=x[x.length-1],x.pop(),he.destroy()}},programs:x}}function gb(){let a=new WeakMap;return{get:function o(y){let x=a.get(y);return void 0===x&&(x={},a.set(y,x)),x},remove:function l(y){a.delete(y)},update:function p(y,x,E){a.get(y)[x]=E},dispose:function v(){a=new WeakMap}}}function vb(a,o){return a.groupOrder!==o.groupOrder?a.groupOrder-o.groupOrder:a.renderOrder!==o.renderOrder?a.renderOrder-o.renderOrder:a.program!==o.program?a.program.id-o.program.id:a.material.id!==o.material.id?a.material.id-o.material.id:a.z!==o.z?a.z-o.z:a.id-o.id}function w0(a,o){return a.groupOrder!==o.groupOrder?a.groupOrder-o.groupOrder:a.renderOrder!==o.renderOrder?a.renderOrder-o.renderOrder:a.z!==o.z?o.z-a.z:a.id-o.id}function _b(a){const o=[];let l=0;const p=[],v=[],y={id:-1};function E(U,G,Y,re,ie,$){let q=o[l];const Ae=a.get(Y);return void 0===q?(q={id:U.id,object:U,geometry:G,material:Y,program:Ae.program||y,groupOrder:re,renderOrder:U.renderOrder,z:ie,group:$},o[l]=q):(q.id=U.id,q.object=U,q.geometry=G,q.material=Y,q.program=Ae.program||y,q.groupOrder=re,q.renderOrder=U.renderOrder,q.z=ie,q.group=$),l++,q}return{opaque:p,transparent:v,init:function x(){l=0,p.length=0,v.length=0},push:function I(U,G,Y,re,ie,$){const q=E(U,G,Y,re,ie,$);(!0===Y.transparent?v:p).push(q)},unshift:function R(U,G,Y,re,ie,$){const q=E(U,G,Y,re,ie,$);(!0===Y.transparent?v:p).unshift(q)},finish:function k(){for(let U=l,G=o.length;U<G;U++){const Y=o[U];if(null===Y.id)break;Y.id=null,Y.object=null,Y.geometry=null,Y.material=null,Y.program=null,Y.group=null}},sort:function F(U,G){p.length>1&&p.sort(U||vb),v.length>1&&v.sort(G||w0)}}}function A0(a){let o=new WeakMap;return{get:function l(v,y){const x=o.get(v);let E;return void 0===x?(E=new _b(a),o.set(v,new WeakMap),o.get(v).set(y,E)):(E=x.get(y),void 0===E&&(E=new _b(a),x.set(y,E))),E},dispose:function p(){o=new WeakMap}}}function Cd(){const a={};return{get:function(o){if(void 0!==a[o.id])return a[o.id];let l;switch(o.type){case"DirectionalLight":l={direction:new xe,color:new ei};break;case"SpotLight":l={position:new xe,direction:new xe,color:new ei,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":l={position:new xe,color:new ei,distance:0,decay:0};break;case"HemisphereLight":l={direction:new xe,skyColor:new ei,groundColor:new ei};break;case"RectAreaLight":l={color:new ei,position:new xe,halfWidth:new xe,halfHeight:new xe}}return a[o.id]=l,l}}}let kh=0;function lo(a,o){return(o.castShadow?1:0)-(a.castShadow?1:0)}function Nv(a,o){const l=new Cd,p=function $m(){const a={};return{get:function(o){if(void 0!==a[o.id])return a[o.id];let l;switch(o.type){case"DirectionalLight":case"SpotLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe};break;case"PointLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe,shadowCameraNear:1,shadowCameraFar:1e3}}return a[o.id]=l,l}}}(),v={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let F=0;F<9;F++)v.probe.push(new xe);const y=new xe,x=new Kt,E=new Kt;return{setup:function I(F){let k=0,U=0,G=0;for(let De=0;De<9;De++)v.probe[De].set(0,0,0);let Y=0,re=0,ie=0,$=0,q=0,Ae=0,Ie=0,Se=0;F.sort(lo);for(let De=0,vt=F.length;De<vt;De++){const ke=F[De],Qe=ke.color,tt=ke.intensity,ut=ke.distance,Ze=ke.shadow&&ke.shadow.map?ke.shadow.map.texture:null;if(ke.isAmbientLight)k+=Qe.r*tt,U+=Qe.g*tt,G+=Qe.b*tt;else if(ke.isLightProbe)for(let Ce=0;Ce<9;Ce++)v.probe[Ce].addScaledVector(ke.sh.coefficients[Ce],tt);else if(ke.isDirectionalLight){const Ce=l.get(ke);if(Ce.color.copy(ke.color).multiplyScalar(ke.intensity),ke.castShadow){const Fe=ke.shadow,je=p.get(ke);je.shadowBias=Fe.bias,je.shadowNormalBias=Fe.normalBias,je.shadowRadius=Fe.radius,je.shadowMapSize=Fe.mapSize,v.directionalShadow[Y]=je,v.directionalShadowMap[Y]=Ze,v.directionalShadowMatrix[Y]=ke.shadow.matrix,Ae++}v.directional[Y]=Ce,Y++}else if(ke.isSpotLight){const Ce=l.get(ke);if(Ce.position.setFromMatrixPosition(ke.matrixWorld),Ce.color.copy(Qe).multiplyScalar(tt),Ce.distance=ut,Ce.coneCos=Math.cos(ke.angle),Ce.penumbraCos=Math.cos(ke.angle*(1-ke.penumbra)),Ce.decay=ke.decay,ke.castShadow){const Fe=ke.shadow,je=p.get(ke);je.shadowBias=Fe.bias,je.shadowNormalBias=Fe.normalBias,je.shadowRadius=Fe.radius,je.shadowMapSize=Fe.mapSize,v.spotShadow[ie]=je,v.spotShadowMap[ie]=Ze,v.spotShadowMatrix[ie]=ke.shadow.matrix,Se++}v.spot[ie]=Ce,ie++}else if(ke.isRectAreaLight){const Ce=l.get(ke);Ce.color.copy(Qe).multiplyScalar(tt),Ce.halfWidth.set(.5*ke.width,0,0),Ce.halfHeight.set(0,.5*ke.height,0),v.rectArea[$]=Ce,$++}else if(ke.isPointLight){const Ce=l.get(ke);if(Ce.color.copy(ke.color).multiplyScalar(ke.intensity),Ce.distance=ke.distance,Ce.decay=ke.decay,ke.castShadow){const Fe=ke.shadow,je=p.get(ke);je.shadowBias=Fe.bias,je.shadowNormalBias=Fe.normalBias,je.shadowRadius=Fe.radius,je.shadowMapSize=Fe.mapSize,je.shadowCameraNear=Fe.camera.near,je.shadowCameraFar=Fe.camera.far,v.pointShadow[re]=je,v.pointShadowMap[re]=Ze,v.pointShadowMatrix[re]=ke.shadow.matrix,Ie++}v.point[re]=Ce,re++}else if(ke.isHemisphereLight){const Ce=l.get(ke);Ce.skyColor.copy(ke.color).multiplyScalar(tt),Ce.groundColor.copy(ke.groundColor).multiplyScalar(tt),v.hemi[q]=Ce,q++}}$>0&&(o.isWebGL2||!0===a.has("OES_texture_float_linear")?(v.rectAreaLTC1=fn.LTC_FLOAT_1,v.rectAreaLTC2=fn.LTC_FLOAT_2):!0===a.has("OES_texture_half_float_linear")?(v.rectAreaLTC1=fn.LTC_HALF_1,v.rectAreaLTC2=fn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),v.ambient[0]=k,v.ambient[1]=U,v.ambient[2]=G;const he=v.hash;(he.directionalLength!==Y||he.pointLength!==re||he.spotLength!==ie||he.rectAreaLength!==$||he.hemiLength!==q||he.numDirectionalShadows!==Ae||he.numPointShadows!==Ie||he.numSpotShadows!==Se)&&(v.directional.length=Y,v.spot.length=ie,v.rectArea.length=$,v.point.length=re,v.hemi.length=q,v.directionalShadow.length=Ae,v.directionalShadowMap.length=Ae,v.pointShadow.length=Ie,v.pointShadowMap.length=Ie,v.spotShadow.length=Se,v.spotShadowMap.length=Se,v.directionalShadowMatrix.length=Ae,v.pointShadowMatrix.length=Ie,v.spotShadowMatrix.length=Se,he.directionalLength=Y,he.pointLength=re,he.spotLength=ie,he.rectAreaLength=$,he.hemiLength=q,he.numDirectionalShadows=Ae,he.numPointShadows=Ie,he.numSpotShadows=Se,v.version=kh++)},setupView:function R(F,k){let U=0,G=0,Y=0,re=0,ie=0;const $=k.matrixWorldInverse;for(let q=0,Ae=F.length;q<Ae;q++){const Ie=F[q];if(Ie.isDirectionalLight){const Se=v.directional[U];Se.direction.setFromMatrixPosition(Ie.matrixWorld),y.setFromMatrixPosition(Ie.target.matrixWorld),Se.direction.sub(y),Se.direction.transformDirection($),U++}else if(Ie.isSpotLight){const Se=v.spot[Y];Se.position.setFromMatrixPosition(Ie.matrixWorld),Se.position.applyMatrix4($),Se.direction.setFromMatrixPosition(Ie.matrixWorld),y.setFromMatrixPosition(Ie.target.matrixWorld),Se.direction.sub(y),Se.direction.transformDirection($),Y++}else if(Ie.isRectAreaLight){const Se=v.rectArea[re];Se.position.setFromMatrixPosition(Ie.matrixWorld),Se.position.applyMatrix4($),E.identity(),x.copy(Ie.matrixWorld),x.premultiply($),E.extractRotation(x),Se.halfWidth.set(.5*Ie.width,0,0),Se.halfHeight.set(0,.5*Ie.height,0),Se.halfWidth.applyMatrix4(E),Se.halfHeight.applyMatrix4(E),re++}else if(Ie.isPointLight){const Se=v.point[G];Se.position.setFromMatrixPosition(Ie.matrixWorld),Se.position.applyMatrix4($),G++}else if(Ie.isHemisphereLight){const Se=v.hemi[ie];Se.direction.setFromMatrixPosition(Ie.matrixWorld),Se.direction.transformDirection($),Se.direction.normalize(),ie++}}},state:v}}function qm(a,o){const l=new Nv(a,o),p=[],v=[];return{init:function y(){p.length=0,v.length=0},state:{lightsArray:p,shadowsArray:v,lights:l},setupLights:function I(){l.setup(p)},setupLightsView:function R(k){l.setupView(p,k)},pushLight:function x(k){p.push(k)},pushShadow:function E(k){v.push(k)}}}function x0(a,o){let l=new WeakMap;return{get:function p(y,x=0){let E;return!1===l.has(y)?(E=new qm(a,o),l.set(y,[]),l.get(y).push(E)):x>=l.get(y).length?(E=new qm(a,o),l.get(y).push(E)):E=l.get(y)[x],E},dispose:function v(){l=new WeakMap}}}function gl(a){_i.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(a)}function wu(a){_i.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new xe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(a)}(gl.prototype=Object.create(_i.prototype)).constructor=gl,gl.prototype.isMeshDepthMaterial=!0,gl.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.depthPacking=a.depthPacking,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this},(wu.prototype=Object.create(_i.prototype)).constructor=wu,wu.prototype.isMeshDistanceMaterial=!0,wu.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.referencePosition.copy(a.referencePosition),this.nearDistance=a.nearDistance,this.farDistance=a.farDistance,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this};function Xm(a,o,l){let p=new Hf;const v=new qe,y=new qe,x=new Hr,E=[],I=[],R={},F={0:1,1:0,2:2},k=new Ws({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new qe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),U=k.clone();U.defines.HORIZONTAL_PASS=1;const G=new xi;G.setAttribute("position",new Ii(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Y=new Zr(G,k),re=this;function ie(Se,he){const De=o.update(Y);k.uniforms.shadow_pass.value=Se.map.texture,k.uniforms.resolution.value=Se.mapSize,k.uniforms.radius.value=Se.radius,a.setRenderTarget(Se.mapPass),a.clear(),a.renderBufferDirect(he,null,De,k,Y,null),U.uniforms.shadow_pass.value=Se.mapPass.texture,U.uniforms.resolution.value=Se.mapSize,U.uniforms.radius.value=Se.radius,a.setRenderTarget(Se.map),a.clear(),a.renderBufferDirect(he,null,De,U,Y,null)}function $(Se,he,De){const vt=Se<<0|he<<1|De<<2;let ke=E[vt];return void 0===ke&&(ke=new gl({depthPacking:3201,morphTargets:Se,skinning:he}),E[vt]=ke),ke}function q(Se,he,De){const vt=Se<<0|he<<1|De<<2;let ke=I[vt];return void 0===ke&&(ke=new wu({morphTargets:Se,skinning:he}),I[vt]=ke),ke}function Ae(Se,he,De,vt,ke,Qe,tt){let ut=null,Ze=$,Ce=Se.customDepthMaterial;if(!0===vt.isPointLight&&(Ze=q,Ce=Se.customDistanceMaterial),void 0===Ce){let Fe=!1;!0===De.morphTargets&&(Fe=he.morphAttributes&&he.morphAttributes.position&&he.morphAttributes.position.length>0);let je=!1;!0===Se.isSkinnedMesh&&(!0===De.skinning?je=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Se)),ut=Ze(Fe,je,!0===Se.isInstancedMesh)}else ut=Ce;if(a.localClippingEnabled&&!0===De.clipShadows&&0!==De.clippingPlanes.length){const Fe=ut.uuid,je=De.uuid;let at=R[Fe];void 0===at&&(at={},R[Fe]=at);let Pt=at[je];void 0===Pt&&(Pt=ut.clone(),at[je]=Pt),ut=Pt}return ut.visible=De.visible,ut.wireframe=De.wireframe,ut.side=3===tt?null!==De.shadowSide?De.shadowSide:De.side:null!==De.shadowSide?De.shadowSide:F[De.side],ut.clipShadows=De.clipShadows,ut.clippingPlanes=De.clippingPlanes,ut.clipIntersection=De.clipIntersection,ut.wireframeLinewidth=De.wireframeLinewidth,ut.linewidth=De.linewidth,!0===vt.isPointLight&&!0===ut.isMeshDistanceMaterial&&(ut.referencePosition.setFromMatrixPosition(vt.matrixWorld),ut.nearDistance=ke,ut.farDistance=Qe),ut}function Ie(Se,he,De,vt,ke){if(!1===Se.visible)return;if(Se.layers.test(he.layers)&&(Se.isMesh||Se.isLine||Se.isPoints)&&(Se.castShadow||Se.receiveShadow&&3===ke)&&(!Se.frustumCulled||p.intersectsObject(Se))){Se.modelViewMatrix.multiplyMatrices(De.matrixWorldInverse,Se.matrixWorld);const ut=o.update(Se),Ze=Se.material;if(Array.isArray(Ze)){const Ce=ut.groups;for(let Fe=0,je=Ce.length;Fe<je;Fe++){const at=Ce[Fe],Pt=Ze[at.materialIndex];if(Pt&&Pt.visible){const xt=Ae(Se,ut,Pt,vt,De.near,De.far,ke);a.renderBufferDirect(De,null,ut,xt,Se,at)}}}else if(Ze.visible){const Ce=Ae(Se,ut,Ze,vt,De.near,De.far,ke);a.renderBufferDirect(De,null,ut,Ce,Se,null)}}const tt=Se.children;for(let ut=0,Ze=tt.length;ut<Ze;ut++)Ie(tt[ut],he,De,vt,ke)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(Se,he,De){if(!1===re.enabled||!1===re.autoUpdate&&!1===re.needsUpdate||0===Se.length)return;const vt=a.getRenderTarget(),ke=a.getActiveCubeFace(),Qe=a.getActiveMipmapLevel(),tt=a.state;tt.setBlending(0),tt.buffers.color.setClear(1,1,1,1),tt.buffers.depth.setTest(!0),tt.setScissorTest(!1);for(let ut=0,Ze=Se.length;ut<Ze;ut++){const Ce=Se[ut],Fe=Ce.shadow;if(void 0===Fe){console.warn("THREE.WebGLShadowMap:",Ce,"has no shadow.");continue}if(!1===Fe.autoUpdate&&!1===Fe.needsUpdate)continue;v.copy(Fe.mapSize);const je=Fe.getFrameExtents();if(v.multiply(je),y.copy(Fe.mapSize),(v.x>l||v.y>l)&&(v.x>l&&(y.x=Math.floor(l/je.x),v.x=y.x*je.x,Fe.mapSize.x=y.x),v.y>l&&(y.y=Math.floor(l/je.y),v.y=y.y*je.y,Fe.mapSize.y=y.y)),null===Fe.map&&!Fe.isPointLightShadow&&3===this.type){const Pt={minFilter:oe,magFilter:oe,format:_r};Fe.map=new Of(v.x,v.y,Pt),Fe.map.texture.name=Ce.name+".shadowMap",Fe.mapPass=new Of(v.x,v.y,Pt),Fe.camera.updateProjectionMatrix()}null===Fe.map&&(Fe.map=new Of(v.x,v.y,{minFilter:ba,magFilter:ba,format:_r}),Fe.map.texture.name=Ce.name+".shadowMap",Fe.camera.updateProjectionMatrix()),a.setRenderTarget(Fe.map),a.clear();const at=Fe.getViewportCount();for(let Pt=0;Pt<at;Pt++){const xt=Fe.getViewport(Pt);x.set(y.x*xt.x,y.y*xt.y,y.x*xt.z,y.y*xt.w),tt.viewport(x),Fe.updateMatrices(Ce,Pt),p=Fe.getFrustum(),Ie(he,De,Fe.camera,Ce,this.type)}!Fe.isPointLightShadow&&3===this.type&&ie(Fe,De),Fe.needsUpdate=!1}re.needsUpdate=!1,a.setRenderTarget(vt,ke,Qe)}}function Pv(a,o,l){const p=l.isWebGL2;const E=new function v(){let Le=!1;const Gt=new Hr;let An=null;const Gn=new Hr(0,0,0,0);return{setMask:function(mn){An!==mn&&!Le&&(a.colorMask(mn,mn,mn,mn),An=mn)},setLocked:function(mn){Le=mn},setClear:function(mn,Vn,$n,Si,Cn){!0===Cn&&(mn*=Si,Vn*=Si,$n*=Si),Gt.set(mn,Vn,$n,Si),!1===Gn.equals(Gt)&&(a.clearColor(mn,Vn,$n,Si),Gn.copy(Gt))},reset:function(){Le=!1,An=null,Gn.set(-1,0,0,0)}}},I=new function y(){let Le=!1,Gt=null,An=null,Gn=null;return{setTest:function(mn){mn?Ut(2929):qt(2929)},setMask:function(mn){Gt!==mn&&!Le&&(a.depthMask(mn),Gt=mn)},setFunc:function(mn){if(An!==mn){if(mn)switch(mn){case 0:a.depthFunc(512);break;case 1:a.depthFunc(519);break;case 2:a.depthFunc(513);break;case 3:default:a.depthFunc(515);break;case 4:a.depthFunc(514);break;case 5:a.depthFunc(518);break;case 6:a.depthFunc(516);break;case 7:a.depthFunc(517)}else a.depthFunc(515);An=mn}},setLocked:function(mn){Le=mn},setClear:function(mn){Gn!==mn&&(a.clearDepth(mn),Gn=mn)},reset:function(){Le=!1,Gt=null,An=null,Gn=null}}},R=new function x(){let Le=!1,Gt=null,An=null,Gn=null,mn=null,Vn=null,$n=null,Si=null,Cn=null;return{setTest:function(li){Le||(li?Ut(2960):qt(2960))},setMask:function(li){Gt!==li&&!Le&&(a.stencilMask(li),Gt=li)},setFunc:function(li,ar,Bs){(An!==li||Gn!==ar||mn!==Bs)&&(a.stencilFunc(li,ar,Bs),An=li,Gn=ar,mn=Bs)},setOp:function(li,ar,Bs){(Vn!==li||$n!==ar||Si!==Bs)&&(a.stencilOp(li,ar,Bs),Vn=li,$n=ar,Si=Bs)},setLocked:function(li){Le=li},setClear:function(li){Cn!==li&&(a.clearStencil(li),Cn=li)},reset:function(){Le=!1,Gt=null,An=null,Gn=null,mn=null,Vn=null,$n=null,Si=null,Cn=null}}};let F={},k=null,U=null,G=null,Y=null,re=null,ie=null,$=null,q=null,Ae=null,Ie=!1,Se=null,he=null,De=null,vt=null,ke=null;const Qe=a.getParameter(35661);let tt=!1,ut=0;const Ze=a.getParameter(7938);-1!==Ze.indexOf("WebGL")?(ut=parseFloat(/^WebGL (\d)/.exec(Ze)[1]),tt=ut>=1):-1!==Ze.indexOf("OpenGL ES")&&(ut=parseFloat(/^OpenGL ES (\d)/.exec(Ze)[1]),tt=ut>=2);let Ce=null,Fe={};const je=new Hr,at=new Hr;function Pt(Le,Gt,An){const Gn=new Uint8Array(4),mn=a.createTexture();a.bindTexture(Le,mn),a.texParameteri(Le,10241,9728),a.texParameteri(Le,10240,9728);for(let Vn=0;Vn<An;Vn++)a.texImage2D(Gt+Vn,0,6408,1,1,0,6408,5121,Gn);return mn}const xt={};function Ut(Le){!0!==F[Le]&&(a.enable(Le),F[Le]=!0)}function qt(Le){!1!==F[Le]&&(a.disable(Le),F[Le]=!1)}xt[3553]=Pt(3553,3553,1),xt[34067]=Pt(34067,34069,6),E.setClear(0,0,0,1),I.setClear(1),R.setClear(0),Ut(2929),I.setFunc(3),Kn(!1),Ni(1),Ut(2884),mt(0);const Un={100:32774,101:32778,102:32779};if(p)Un[103]=32775,Un[104]=32776;else{const Le=o.get("EXT_blend_minmax");null!==Le&&(Un[103]=Le.MIN_EXT,Un[104]=Le.MAX_EXT)}const ki={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function mt(Le,Gt,An,Gn,mn,Vn,$n,Si){if(0!==Le){if(U||(Ut(3042),U=!0),5===Le)mn=mn||Gt,Vn=Vn||An,$n=$n||Gn,(Gt!==Y||mn!==$)&&(a.blendEquationSeparate(Un[Gt],Un[mn]),Y=Gt,$=mn),(An!==re||Gn!==ie||Vn!==q||$n!==Ae)&&(a.blendFuncSeparate(ki[An],ki[Gn],ki[Vn],ki[$n]),re=An,ie=Gn,q=Vn,Ae=$n),G=Le,Ie=null;else if(Le!==G||Si!==Ie){if((100!==Y||100!==$)&&(a.blendEquation(32774),Y=100,$=100),Si)switch(Le){case 1:a.blendFuncSeparate(1,771,1,771);break;case 2:a.blendFunc(1,1);break;case 3:a.blendFuncSeparate(0,0,769,771);break;case 4:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Le)}else switch(Le){case 1:a.blendFuncSeparate(770,771,1,771);break;case 2:a.blendFunc(770,1);break;case 3:a.blendFunc(0,769);break;case 4:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Le)}re=null,ie=null,q=null,Ae=null,G=Le,Ie=Si}}else U&&(qt(3042),U=!1)}function Kn(Le){Se!==Le&&(a.frontFace(Le?2304:2305),Se=Le)}function Ni(Le){0!==Le?(Ut(2884),Le!==he&&a.cullFace(1===Le?1029:2===Le?1028:1032)):qt(2884),he=Le}function Hi(Le,Gt,An){Le?(Ut(32823),(vt!==Gt||ke!==An)&&(a.polygonOffset(Gt,An),vt=Gt,ke=An)):qt(32823)}function Vt(Le){void 0===Le&&(Le=33984+Qe-1),Ce!==Le&&(a.activeTexture(Le),Ce=Le)}return{buffers:{color:E,depth:I,stencil:R},enable:Ut,disable:qt,useProgram:function Qn(Le){return k!==Le&&(a.useProgram(Le),k=Le,!0)},setBlending:mt,setMaterial:function is(Le,Gt){2===Le.side?qt(2884):Ut(2884);let An=1===Le.side;Gt&&(An=!An),Kn(An),1===Le.blending&&!1===Le.transparent?mt(0):mt(Le.blending,Le.blendEquation,Le.blendSrc,Le.blendDst,Le.blendEquationAlpha,Le.blendSrcAlpha,Le.blendDstAlpha,Le.premultipliedAlpha),I.setFunc(Le.depthFunc),I.setTest(Le.depthTest),I.setMask(Le.depthWrite),E.setMask(Le.colorWrite);const Gn=Le.stencilWrite;R.setTest(Gn),Gn&&(R.setMask(Le.stencilWriteMask),R.setFunc(Le.stencilFunc,Le.stencilRef,Le.stencilFuncMask),R.setOp(Le.stencilFail,Le.stencilZFail,Le.stencilZPass)),Hi(Le.polygonOffset,Le.polygonOffsetFactor,Le.polygonOffsetUnits)},setFlipSided:Kn,setCullFace:Ni,setLineWidth:function ri(Le){Le!==De&&(tt&&a.lineWidth(Le),De=Le)},setPolygonOffset:Hi,setScissorTest:function si(Le){Le?Ut(3089):qt(3089)},activeTexture:Vt,bindTexture:function Zt(Le,Gt){null===Ce&&Vt();let An=Fe[Ce];void 0===An&&(An={type:void 0,texture:void 0},Fe[Ce]=An),(An.type!==Le||An.texture!==Gt)&&(a.bindTexture(Le,Gt||xt[Le]),An.type=Le,An.texture=Gt)},unbindTexture:function un(){const Le=Fe[Ce];void 0!==Le&&void 0!==Le.type&&(a.bindTexture(Le.type,null),Le.type=void 0,Le.texture=void 0)},compressedTexImage2D:function On(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}},texImage2D:function Ve(){try{a.texImage2D.apply(a,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}},texImage3D:function _e(){try{a.texImage3D.apply(a,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}},scissor:function me(Le){!1===je.equals(Le)&&(a.scissor(Le.x,Le.y,Le.z,Le.w),je.copy(Le))},viewport:function Et(Le){!1===at.equals(Le)&&(a.viewport(Le.x,Le.y,Le.z,Le.w),at.copy(Le))},reset:function _t(){F={},Ce=null,Fe={},k=null,U=null,G=null,Y=null,re=null,ie=null,$=null,q=null,Ae=null,Ie=!1,Se=null,he=null,De=null,vt=null,ke=null,E.reset(),I.reset(),R.reset()}}}function sp(a,o,l,p,v,y,x){const E=v.isWebGL2,I=v.maxTextures,R=v.maxCubemapSize,F=v.maxTextureSize,k=v.maxSamples,U=new WeakMap;let G,Y=!1;try{Y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function re(_e,me){return Y?new OffscreenCanvas(_e,me):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function ie(_e,me,Et,_t){let Le=1;if((_e.width>_t||_e.height>_t)&&(Le=_t/Math.max(_e.width,_e.height)),Le<1||!0===me){if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap){const Gt=me?pi.floorPowerOfTwo:Math.floor,An=Gt(Le*_e.width),Gn=Gt(Le*_e.height);void 0===G&&(G=re(An,Gn));const mn=Et?re(An,Gn):G;return mn.width=An,mn.height=Gn,mn.getContext("2d").drawImage(_e,0,0,An,Gn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+_e.width+"x"+_e.height+") to ("+An+"x"+Gn+")."),mn}return"data"in _e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+_e.width+"x"+_e.height+")."),_e}return _e}function $(_e){return pi.isPowerOfTwo(_e.width)&&pi.isPowerOfTwo(_e.height)}function Ae(_e,me){return _e.generateMipmaps&&me&&_e.minFilter!==ba&&_e.minFilter!==oe}function Ie(_e,me,Et,_t){a.generateMipmap(_e),p.get(me).__maxMipLevel=Math.log(Math.max(Et,_t))*Math.LOG2E}function Se(_e,me,Et){if(!1===E)return me;if(null!==_e){if(void 0!==a[_e])return a[_e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+_e+"'")}let _t=me;return 6403===me&&(5126===Et&&(_t=33326),5131===Et&&(_t=33325),5121===Et&&(_t=33321)),6407===me&&(5126===Et&&(_t=34837),5131===Et&&(_t=34843),5121===Et&&(_t=32849)),6408===me&&(5126===Et&&(_t=34836),5131===Et&&(_t=34842),5121===Et&&(_t=32856)),(33325===_t||33326===_t||34842===_t||34836===_t)&&o.get("EXT_color_buffer_float"),_t}function he(_e){return _e===ba||1004===_e||1005===_e?9728:9729}function De(_e){const me=_e.target;me.removeEventListener("dispose",De),function ke(_e){const me=p.get(_e);void 0!==me.__webglInit&&(a.deleteTexture(me.__webglTexture),p.remove(_e))}(me),me.isVideoTexture&&U.delete(me),x.memory.textures--}function vt(_e){const me=_e.target;me.removeEventListener("dispose",vt),function Qe(_e){const me=p.get(_e),Et=p.get(_e.texture);if(_e){if(void 0!==Et.__webglTexture&&a.deleteTexture(Et.__webglTexture),_e.depthTexture&&_e.depthTexture.dispose(),_e.isWebGLCubeRenderTarget)for(let _t=0;_t<6;_t++)a.deleteFramebuffer(me.__webglFramebuffer[_t]),me.__webglDepthbuffer&&a.deleteRenderbuffer(me.__webglDepthbuffer[_t]);else a.deleteFramebuffer(me.__webglFramebuffer),me.__webglDepthbuffer&&a.deleteRenderbuffer(me.__webglDepthbuffer),me.__webglMultisampledFramebuffer&&a.deleteFramebuffer(me.__webglMultisampledFramebuffer),me.__webglColorRenderbuffer&&a.deleteRenderbuffer(me.__webglColorRenderbuffer),me.__webglDepthRenderbuffer&&a.deleteRenderbuffer(me.__webglDepthRenderbuffer);p.remove(_e.texture),p.remove(_e)}}(me),x.memory.textures--}let tt=0;function Ce(_e,me){const Et=p.get(_e);if(_e.isVideoTexture&&function Vt(_e){const me=x.render.frame;U.get(_e)!==me&&(U.set(_e,me),_e.update())}(_e),_e.version>0&&Et.__version!==_e.version){const _t=_e.image;if(void 0===_t)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==_t.complete)return void Qn(Et,_e,me);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}l.activeTexture(33984+me),l.bindTexture(3553,Et.__webglTexture)}function at(_e,me){const Et=p.get(_e);_e.version>0&&Et.__version!==_e.version?function Un(_e,me,Et){if(6!==me.image.length)return;qt(_e,me),l.activeTexture(33984+Et),l.bindTexture(34067,_e.__webglTexture),a.pixelStorei(37440,me.flipY),a.pixelStorei(37441,me.premultiplyAlpha),a.pixelStorei(3317,me.unpackAlignment);const _t=me&&(me.isCompressedTexture||me.image[0].isCompressedTexture),Le=me.image[0]&&me.image[0].isDataTexture,Gt=[];for(let Cn=0;Cn<6;Cn++)Gt[Cn]=_t||Le?Le?me.image[Cn].image:me.image[Cn]:ie(me.image[Cn],!1,!0,R);const An=Gt[0],Gn=$(An)||E,mn=y.convert(me.format),Vn=y.convert(me.type),$n=Se(me.internalFormat,mn,Vn);let Si;if(Ut(34067,me,Gn),_t){for(let Cn=0;Cn<6;Cn++){Si=Gt[Cn].mipmaps;for(let li=0;li<Si.length;li++){const ar=Si[li];me.format!==_r&&me.format!==To?null!==mn?l.compressedTexImage2D(34069+Cn,li,$n,ar.width,ar.height,0,ar.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):l.texImage2D(34069+Cn,li,$n,ar.width,ar.height,0,mn,Vn,ar.data)}}_e.__maxMipLevel=Si.length-1}else{Si=me.mipmaps;for(let Cn=0;Cn<6;Cn++)if(Le){l.texImage2D(34069+Cn,0,$n,Gt[Cn].width,Gt[Cn].height,0,mn,Vn,Gt[Cn].data);for(let li=0;li<Si.length;li++){const Bs=Si[li].image[Cn].image;l.texImage2D(34069+Cn,li+1,$n,Bs.width,Bs.height,0,mn,Vn,Bs.data)}}else{l.texImage2D(34069+Cn,0,$n,mn,Vn,Gt[Cn]);for(let li=0;li<Si.length;li++)l.texImage2D(34069+Cn,li+1,$n,mn,Vn,Si[li].image[Cn])}_e.__maxMipLevel=Si.length}Ae(me,Gn)&&Ie(34067,me,An.width,An.height),_e.__version=me.version,me.onUpdate&&me.onUpdate(me)}(Et,_e,me):(l.activeTexture(33984+me),l.bindTexture(34067,Et.__webglTexture))}const Pt={1e3:10497,[Hs]:33071,1002:33648},xt={[ba]:9728,1004:9984,1005:9986,[oe]:9729,1007:9985,1008:9987};function Ut(_e,me,Et){Et?(a.texParameteri(_e,10242,Pt[me.wrapS]),a.texParameteri(_e,10243,Pt[me.wrapT]),(32879===_e||35866===_e)&&a.texParameteri(_e,32882,Pt[me.wrapR]),a.texParameteri(_e,10240,xt[me.magFilter]),a.texParameteri(_e,10241,xt[me.minFilter])):(a.texParameteri(_e,10242,33071),a.texParameteri(_e,10243,33071),(32879===_e||35866===_e)&&a.texParameteri(_e,32882,33071),(me.wrapS!==Hs||me.wrapT!==Hs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(_e,10240,he(me.magFilter)),a.texParameteri(_e,10241,he(me.minFilter)),me.minFilter!==ba&&me.minFilter!==oe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const _t=o.get("EXT_texture_filter_anisotropic");if(_t){if(me.type===oa&&null===o.get("OES_texture_float_linear")||1016===me.type&&null===(E||o.get("OES_texture_half_float_linear")))return;(me.anisotropy>1||p.get(me).__currentAnisotropy)&&(a.texParameterf(_e,_t.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(me.anisotropy,v.getMaxAnisotropy())),p.get(me).__currentAnisotropy=me.anisotropy)}}function qt(_e,me){void 0===_e.__webglInit&&(_e.__webglInit=!0,me.addEventListener("dispose",De),_e.__webglTexture=a.createTexture(),x.memory.textures++)}function Qn(_e,me,Et){let _t=3553;me.isDataTexture2DArray&&(_t=35866),me.isDataTexture3D&&(_t=32879),qt(_e,me),l.activeTexture(33984+Et),l.bindTexture(_t,_e.__webglTexture),a.pixelStorei(37440,me.flipY),a.pixelStorei(37441,me.premultiplyAlpha),a.pixelStorei(3317,me.unpackAlignment);const Le=function q(_e){return!E&&(_e.wrapS!==Hs||_e.wrapT!==Hs||_e.minFilter!==ba&&_e.minFilter!==oe)}(me)&&!1===$(me.image),Gt=ie(me.image,Le,!1,F),An=$(Gt)||E,Gn=y.convert(me.format);let $n,mn=y.convert(me.type),Vn=Se(me.internalFormat,Gn,mn);Ut(_t,me,An);const Si=me.mipmaps;if(me.isDepthTexture)Vn=6402,E?Vn=me.type===oa?36012:1014===me.type?33190:me.type===Qr?35056:33189:me.type===oa&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),me.format===Bo&&6402===Vn&&1012!==me.type&&1014!==me.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),me.type=1012,mn=y.convert(me.type)),me.format===If&&6402===Vn&&(Vn=34041,me.type!==Qr&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),me.type=Qr,mn=y.convert(me.type))),l.texImage2D(3553,0,Vn,Gt.width,Gt.height,0,Gn,mn,null);else if(me.isDataTexture)if(Si.length>0&&An){for(let Cn=0,li=Si.length;Cn<li;Cn++)$n=Si[Cn],l.texImage2D(3553,Cn,Vn,$n.width,$n.height,0,Gn,mn,$n.data);me.generateMipmaps=!1,_e.__maxMipLevel=Si.length-1}else l.texImage2D(3553,0,Vn,Gt.width,Gt.height,0,Gn,mn,Gt.data),_e.__maxMipLevel=0;else if(me.isCompressedTexture){for(let Cn=0,li=Si.length;Cn<li;Cn++)$n=Si[Cn],me.format!==_r&&me.format!==To?null!==Gn?l.compressedTexImage2D(3553,Cn,Vn,$n.width,$n.height,0,$n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):l.texImage2D(3553,Cn,Vn,$n.width,$n.height,0,Gn,mn,$n.data);_e.__maxMipLevel=Si.length-1}else if(me.isDataTexture2DArray)l.texImage3D(35866,0,Vn,Gt.width,Gt.height,Gt.depth,0,Gn,mn,Gt.data),_e.__maxMipLevel=0;else if(me.isDataTexture3D)l.texImage3D(32879,0,Vn,Gt.width,Gt.height,Gt.depth,0,Gn,mn,Gt.data),_e.__maxMipLevel=0;else if(Si.length>0&&An){for(let Cn=0,li=Si.length;Cn<li;Cn++)$n=Si[Cn],l.texImage2D(3553,Cn,Vn,Gn,mn,$n);me.generateMipmaps=!1,_e.__maxMipLevel=Si.length-1}else l.texImage2D(3553,0,Vn,Gn,mn,Gt),_e.__maxMipLevel=0;Ae(me,An)&&Ie(_t,me,Gt.width,Gt.height),_e.__version=me.version,me.onUpdate&&me.onUpdate(me)}function ki(_e,me,Et,_t){const Le=y.convert(me.texture.format),Gt=y.convert(me.texture.type),An=Se(me.texture.internalFormat,Le,Gt);l.texImage2D(_t,0,An,me.width,me.height,0,Le,Gt,null),a.bindFramebuffer(36160,_e),a.framebufferTexture2D(36160,Et,_t,p.get(me.texture).__webglTexture,0),a.bindFramebuffer(36160,null)}function mt(_e,me,Et){if(a.bindRenderbuffer(36161,_e),me.depthBuffer&&!me.stencilBuffer){let _t=33189;if(Et){const Le=me.depthTexture;Le&&Le.isDepthTexture&&(Le.type===oa?_t=36012:1014===Le.type&&(_t=33190));const Gt=si(me);a.renderbufferStorageMultisample(36161,Gt,_t,me.width,me.height)}else a.renderbufferStorage(36161,_t,me.width,me.height);a.framebufferRenderbuffer(36160,36096,36161,_e)}else if(me.depthBuffer&&me.stencilBuffer){if(Et){const _t=si(me);a.renderbufferStorageMultisample(36161,_t,35056,me.width,me.height)}else a.renderbufferStorage(36161,34041,me.width,me.height);a.framebufferRenderbuffer(36160,33306,36161,_e)}else{const _t=y.convert(me.texture.format),Le=y.convert(me.texture.type),Gt=Se(me.texture.internalFormat,_t,Le);if(Et){const An=si(me);a.renderbufferStorageMultisample(36161,An,Gt,me.width,me.height)}else a.renderbufferStorage(36161,Gt,me.width,me.height)}a.bindRenderbuffer(36161,null)}function Kn(_e){const me=p.get(_e),Et=!0===_e.isWebGLCubeRenderTarget;if(_e.depthTexture){if(Et)throw new Error("target.depthTexture not supported in Cube render targets");!function is(_e,me){if(me&&me.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(a.bindFramebuffer(36160,_e),!me.depthTexture||!me.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!p.get(me.depthTexture).__webglTexture||me.depthTexture.image.width!==me.width||me.depthTexture.image.height!==me.height)&&(me.depthTexture.image.width=me.width,me.depthTexture.image.height=me.height,me.depthTexture.needsUpdate=!0),Ce(me.depthTexture,0);const _t=p.get(me.depthTexture).__webglTexture;if(me.depthTexture.format===Bo)a.framebufferTexture2D(36160,36096,3553,_t,0);else{if(me.depthTexture.format!==If)throw new Error("Unknown depthTexture format");a.framebufferTexture2D(36160,33306,3553,_t,0)}}(me.__webglFramebuffer,_e)}else if(Et){me.__webglDepthbuffer=[];for(let _t=0;_t<6;_t++)a.bindFramebuffer(36160,me.__webglFramebuffer[_t]),me.__webglDepthbuffer[_t]=a.createRenderbuffer(),mt(me.__webglDepthbuffer[_t],_e,!1)}else a.bindFramebuffer(36160,me.__webglFramebuffer),me.__webglDepthbuffer=a.createRenderbuffer(),mt(me.__webglDepthbuffer,_e,!1);a.bindFramebuffer(36160,null)}function si(_e){return E&&_e.isWebGLMultisampleRenderTarget?Math.min(k,_e.samples):0}let Zt=!1,un=!1;this.allocateTextureUnit=function Ze(){const _e=tt;return _e>=I&&console.warn("THREE.WebGLTextures: Trying to use "+_e+" texture units while this GPU supports only "+I),tt+=1,_e},this.resetTextureUnits=function ut(){tt=0},this.setTexture2D=Ce,this.setTexture2DArray=function Fe(_e,me){const Et=p.get(_e);_e.version>0&&Et.__version!==_e.version?Qn(Et,_e,me):(l.activeTexture(33984+me),l.bindTexture(35866,Et.__webglTexture))},this.setTexture3D=function je(_e,me){const Et=p.get(_e);_e.version>0&&Et.__version!==_e.version?Qn(Et,_e,me):(l.activeTexture(33984+me),l.bindTexture(32879,Et.__webglTexture))},this.setTextureCube=at,this.setupRenderTarget=function Ni(_e){const me=p.get(_e),Et=p.get(_e.texture);_e.addEventListener("dispose",vt),Et.__webglTexture=a.createTexture(),x.memory.textures++;const _t=!0===_e.isWebGLCubeRenderTarget,Le=!0===_e.isWebGLMultisampleRenderTarget,Gt=$(_e)||E;if(E&&_e.texture.format===To&&(_e.texture.type===oa||1016===_e.texture.type)&&(_e.texture.format=_r,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),_t){me.__webglFramebuffer=[];for(let An=0;An<6;An++)me.__webglFramebuffer[An]=a.createFramebuffer()}else if(me.__webglFramebuffer=a.createFramebuffer(),Le)if(E){me.__webglMultisampledFramebuffer=a.createFramebuffer(),me.__webglColorRenderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,me.__webglColorRenderbuffer);const An=y.convert(_e.texture.format),Gn=y.convert(_e.texture.type),mn=Se(_e.texture.internalFormat,An,Gn),Vn=si(_e);a.renderbufferStorageMultisample(36161,Vn,mn,_e.width,_e.height),a.bindFramebuffer(36160,me.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064,36161,me.__webglColorRenderbuffer),a.bindRenderbuffer(36161,null),_e.depthBuffer&&(me.__webglDepthRenderbuffer=a.createRenderbuffer(),mt(me.__webglDepthRenderbuffer,_e,!0)),a.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(_t){l.bindTexture(34067,Et.__webglTexture),Ut(34067,_e.texture,Gt);for(let An=0;An<6;An++)ki(me.__webglFramebuffer[An],_e,36064,34069+An);Ae(_e.texture,Gt)&&Ie(34067,_e.texture,_e.width,_e.height),l.bindTexture(34067,null)}else l.bindTexture(3553,Et.__webglTexture),Ut(3553,_e.texture,Gt),ki(me.__webglFramebuffer,_e,36064,3553),Ae(_e.texture,Gt)&&Ie(3553,_e.texture,_e.width,_e.height),l.bindTexture(3553,null);_e.depthBuffer&&Kn(_e)},this.updateRenderTargetMipmap=function ri(_e){const me=_e.texture;if(Ae(me,$(_e)||E)){const _t=_e.isWebGLCubeRenderTarget?34067:3553,Le=p.get(me).__webglTexture;l.bindTexture(_t,Le),Ie(_t,me,_e.width,_e.height),l.bindTexture(_t,null)}},this.updateMultisampleRenderTarget=function Hi(_e){if(_e.isWebGLMultisampleRenderTarget)if(E){const me=p.get(_e);a.bindFramebuffer(36008,me.__webglMultisampledFramebuffer),a.bindFramebuffer(36009,me.__webglFramebuffer);const Et=_e.width,_t=_e.height;let Le=16384;_e.depthBuffer&&(Le|=256),_e.stencilBuffer&&(Le|=1024),a.blitFramebuffer(0,0,Et,_t,0,0,Et,_t,Le,9728),a.bindFramebuffer(36160,me.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function On(_e,me){_e&&_e.isWebGLRenderTarget&&(!1===Zt&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Zt=!0),_e=_e.texture),Ce(_e,me)},this.safeSetTextureCube=function Ve(_e,me){_e&&_e.isWebGLCubeRenderTarget&&(!1===un&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),un=!0),_e=_e.texture),at(_e,me)}}function Dd(a,o,l){const p=l.isWebGL2;return{convert:function v(y){let x;if(1009===y)return 5121;if(1017===y)return 32819;if(1018===y)return 32820;if(1019===y)return 33635;if(1010===y)return 5120;if(1011===y)return 5122;if(1012===y)return 5123;if(1013===y)return 5124;if(1014===y)return 5125;if(y===oa)return 5126;if(1016===y)return p?5131:(x=o.get("OES_texture_half_float"),null!==x?x.HALF_FLOAT_OES:null);if(1021===y)return 6406;if(y===To)return 6407;if(y===_r)return 6408;if(1024===y)return 6409;if(1025===y)return 6410;if(y===Bo)return 6402;if(y===If)return 34041;if(1028===y)return 6403;if(1029===y)return 36244;if(1030===y)return 33319;if(1031===y)return 33320;if(1032===y)return 36248;if(1033===y)return 36249;if(33776===y||33777===y||33778===y||33779===y){if(x=o.get("WEBGL_compressed_texture_s3tc"),null===x)return null;if(33776===y)return x.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===y)return x.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===y)return x.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===y)return x.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===y||35841===y||35842===y||35843===y){if(x=o.get("WEBGL_compressed_texture_pvrtc"),null===x)return null;if(35840===y)return x.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===y)return x.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===y)return x.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===y)return x.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===y)return x=o.get("WEBGL_compressed_texture_etc1"),null!==x?x.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===y||37496===y)&&(x=o.get("WEBGL_compressed_texture_etc"),null!==x)){if(37492===y)return x.COMPRESSED_RGB8_ETC2;if(37496===y)return x.COMPRESSED_RGBA8_ETC2_EAC}return 37808===y||37809===y||37810===y||37811===y||37812===y||37813===y||37814===y||37815===y||37816===y||37817===y||37818===y||37819===y||37820===y||37821===y||37840===y||37841===y||37842===y||37843===y||37844===y||37845===y||37846===y||37847===y||37848===y||37849===y||37850===y||37851===y||37852===y||37853===y?(x=o.get("WEBGL_compressed_texture_astc"),null!==x?y:null):36492===y?(x=o.get("EXT_texture_compression_bptc"),null!==x?y:null):y===Qr?p?34042:(x=o.get("WEBGL_depth_texture"),null!==x?x.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function Ov(a=[]){ks.call(this),this.cameras=a}function Bc(){Jn.call(this),this.type="Group"}function Uc(){this._targetRay=null,this._grip=null,this._hand=null}function Lv(a,o){const l=this;let p=null,v=1,y=null,x="local-floor",E=null;const I=[],R=new Map,F=new ks;F.layers.enable(1),F.viewport=new Hr;const k=new ks;k.layers.enable(2),k.viewport=new Hr;const U=[F,k],G=new Ov;G.layers.enable(1),G.layers.enable(2);let Y=null,re=null;function ie(Qe){const tt=R.get(Qe.inputSource);tt&&tt.dispatchEvent({type:Qe.type,data:Qe.inputSource})}function $(){R.forEach(function(Qe,tt){Qe.disconnect(tt)}),R.clear(),Y=null,re=null,a.setFramebuffer(null),a.setRenderTarget(a.getRenderTarget()),ke.stop(),l.isPresenting=!1,l.dispatchEvent({type:"sessionend"})}function q(Qe){const tt=p.inputSources;for(let ut=0;ut<I.length;ut++)R.set(tt[ut],I[ut]);for(let ut=0;ut<Qe.removed.length;ut++){const Ze=Qe.removed[ut],Ce=R.get(Ze);Ce&&(Ce.dispatchEvent({type:"disconnected",data:Ze}),R.delete(Ze))}for(let ut=0;ut<Qe.added.length;ut++){const Ze=Qe.added[ut],Ce=R.get(Ze);Ce&&Ce.dispatchEvent({type:"connected",data:Ze})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(Qe){let tt=I[Qe];return void 0===tt&&(tt=new Uc,I[Qe]=tt),tt.getTargetRaySpace()},this.getControllerGrip=function(Qe){let tt=I[Qe];return void 0===tt&&(tt=new Uc,I[Qe]=tt),tt.getGripSpace()},this.getHand=function(Qe){let tt=I[Qe];return void 0===tt&&(tt=new Uc,I[Qe]=tt),tt.getHandSpace()},this.setFramebufferScaleFactor=function(Qe){v=Qe,!0===l.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Qe){x=Qe,!0===l.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y},this.getSession=function(){return p},this.setSession=function(){var Qe=ht(function*(tt){if(p=tt,null!==p){p.addEventListener("select",ie),p.addEventListener("selectstart",ie),p.addEventListener("selectend",ie),p.addEventListener("squeeze",ie),p.addEventListener("squeezestart",ie),p.addEventListener("squeezeend",ie),p.addEventListener("end",$),p.addEventListener("inputsourceschange",q);const ut=o.getContextAttributes();!0!==ut.xrCompatible&&(yield o.makeXRCompatible());const Ce=new XRWebGLLayer(p,o,{antialias:ut.antialias,alpha:ut.alpha,depth:ut.depth,stencil:ut.stencil,framebufferScaleFactor:v});p.updateRenderState({baseLayer:Ce}),y=yield p.requestReferenceSpace(x),ke.setContext(p),ke.start(),l.isPresenting=!0,l.dispatchEvent({type:"sessionstart"})}});return function(tt){return Qe.apply(this,arguments)}}();const Ae=new xe,Ie=new xe;function he(Qe,tt){null===tt?Qe.matrixWorld.copy(Qe.matrix):Qe.matrixWorld.multiplyMatrices(tt.matrixWorld,Qe.matrix),Qe.matrixWorldInverse.copy(Qe.matrixWorld).invert()}this.getCamera=function(Qe){G.near=k.near=F.near=Qe.near,G.far=k.far=F.far=Qe.far,(Y!==G.near||re!==G.far)&&(p.updateRenderState({depthNear:G.near,depthFar:G.far}),Y=G.near,re=G.far);const tt=Qe.parent,ut=G.cameras;he(G,tt);for(let Ce=0;Ce<ut.length;Ce++)he(ut[Ce],tt);Qe.matrixWorld.copy(G.matrixWorld),Qe.matrix.copy(G.matrix),Qe.matrix.decompose(Qe.position,Qe.quaternion,Qe.scale);const Ze=Qe.children;for(let Ce=0,Fe=Ze.length;Ce<Fe;Ce++)Ze[Ce].updateMatrixWorld(!0);return 2===ut.length?function Se(Qe,tt,ut){Ae.setFromMatrixPosition(tt.matrixWorld),Ie.setFromMatrixPosition(ut.matrixWorld);const Ze=Ae.distanceTo(Ie),Ce=tt.projectionMatrix.elements,Fe=ut.projectionMatrix.elements,je=Ce[14]/(Ce[10]-1),at=Ce[14]/(Ce[10]+1),Pt=(Ce[9]+1)/Ce[5],xt=(Ce[9]-1)/Ce[5],Ut=(Ce[8]-1)/Ce[0],qt=(Fe[8]+1)/Fe[0],Qn=je*Ut,Un=je*qt,ki=Ze/(-Ut+qt),mt=ki*-Ut;tt.matrixWorld.decompose(Qe.position,Qe.quaternion,Qe.scale),Qe.translateX(mt),Qe.translateZ(ki),Qe.matrixWorld.compose(Qe.position,Qe.quaternion,Qe.scale),Qe.matrixWorldInverse.copy(Qe.matrixWorld).invert();const is=je+ki,Kn=at+ki;Qe.projectionMatrix.makePerspective(Qn-mt,Un+(Ze-mt),Pt*at/Kn*is,xt*at/Kn*is,is,Kn)}(G,F,k):G.projectionMatrix.copy(F.projectionMatrix),G};let De=null;const ke=new Gf;ke.setAnimationLoop(function vt(Qe,tt){if(E=tt.getViewerPose(y),null!==E){const Ze=E.views,Ce=p.renderState.baseLayer;a.setFramebuffer(Ce.framebuffer);let Fe=!1;Ze.length!==G.cameras.length&&(G.cameras.length=0,Fe=!0);for(let je=0;je<Ze.length;je++){const at=Ze[je],Pt=Ce.getViewport(at),xt=U[je];xt.matrix.fromArray(at.transform.matrix),xt.projectionMatrix.fromArray(at.projectionMatrix),xt.viewport.set(Pt.x,Pt.y,Pt.width,Pt.height),0===je&&G.matrix.copy(xt.matrix),!0===Fe&&G.cameras.push(xt)}}const ut=p.inputSources;for(let Ze=0;Ze<I.length;Ze++)I[Ze].update(ut[Ze],tt,y);De&&De(Qe,tt)}),this.setAnimationLoop=function(Qe){De=Qe},this.dispose=function(){}}function Ym(a){function p($,q){$.opacity.value=q.opacity,q.color&&$.diffuse.value.copy(q.color),q.emissive&&$.emissive.value.copy(q.emissive).multiplyScalar(q.emissiveIntensity),q.map&&($.map.value=q.map),q.alphaMap&&($.alphaMap.value=q.alphaMap),q.specularMap&&($.specularMap.value=q.specularMap);const Ae=a.get(q).envMap;if(Ae){$.envMap.value=Ae,$.flipEnvMap.value=Ae.isCubeTexture&&Ae._needsFlipEnvMap?-1:1,$.reflectivity.value=q.reflectivity,$.refractionRatio.value=q.refractionRatio;const he=a.get(Ae).__maxMipLevel;void 0!==he&&($.maxMipLevel.value=he)}let Ie,Se;q.lightMap&&($.lightMap.value=q.lightMap,$.lightMapIntensity.value=q.lightMapIntensity),q.aoMap&&($.aoMap.value=q.aoMap,$.aoMapIntensity.value=q.aoMapIntensity),q.map?Ie=q.map:q.specularMap?Ie=q.specularMap:q.displacementMap?Ie=q.displacementMap:q.normalMap?Ie=q.normalMap:q.bumpMap?Ie=q.bumpMap:q.roughnessMap?Ie=q.roughnessMap:q.metalnessMap?Ie=q.metalnessMap:q.alphaMap?Ie=q.alphaMap:q.emissiveMap?Ie=q.emissiveMap:q.clearcoatMap?Ie=q.clearcoatMap:q.clearcoatNormalMap?Ie=q.clearcoatNormalMap:q.clearcoatRoughnessMap&&(Ie=q.clearcoatRoughnessMap),void 0!==Ie&&(Ie.isWebGLRenderTarget&&(Ie=Ie.texture),!0===Ie.matrixAutoUpdate&&Ie.updateMatrix(),$.uvTransform.value.copy(Ie.matrix)),q.aoMap?Se=q.aoMap:q.lightMap&&(Se=q.lightMap),void 0!==Se&&(Se.isWebGLRenderTarget&&(Se=Se.texture),!0===Se.matrixAutoUpdate&&Se.updateMatrix(),$.uv2Transform.value.copy(Se.matrix))}function k($,q){$.roughness.value=q.roughness,$.metalness.value=q.metalness,q.roughnessMap&&($.roughnessMap.value=q.roughnessMap),q.metalnessMap&&($.metalnessMap.value=q.metalnessMap),q.emissiveMap&&($.emissiveMap.value=q.emissiveMap),q.bumpMap&&($.bumpMap.value=q.bumpMap,$.bumpScale.value=q.bumpScale,1===q.side&&($.bumpScale.value*=-1)),q.normalMap&&($.normalMap.value=q.normalMap,$.normalScale.value.copy(q.normalScale),1===q.side&&$.normalScale.value.negate()),q.displacementMap&&($.displacementMap.value=q.displacementMap,$.displacementScale.value=q.displacementScale,$.displacementBias.value=q.displacementBias),a.get(q).envMap&&($.envMapIntensity.value=q.envMapIntensity)}return{refreshFogUniforms:function o($,q){$.fogColor.value.copy(q.color),q.isFog?($.fogNear.value=q.near,$.fogFar.value=q.far):q.isFogExp2&&($.fogDensity.value=q.density)},refreshMaterialUniforms:function l($,q,Ae,Ie){q.isMeshBasicMaterial?p($,q):q.isMeshLambertMaterial?(p($,q),function I($,q){q.emissiveMap&&($.emissiveMap.value=q.emissiveMap)}($,q)):q.isMeshToonMaterial?(p($,q),function F($,q){q.gradientMap&&($.gradientMap.value=q.gradientMap),q.emissiveMap&&($.emissiveMap.value=q.emissiveMap),q.bumpMap&&($.bumpMap.value=q.bumpMap,$.bumpScale.value=q.bumpScale,1===q.side&&($.bumpScale.value*=-1)),q.normalMap&&($.normalMap.value=q.normalMap,$.normalScale.value.copy(q.normalScale),1===q.side&&$.normalScale.value.negate()),q.displacementMap&&($.displacementMap.value=q.displacementMap,$.displacementScale.value=q.displacementScale,$.displacementBias.value=q.displacementBias)}($,q)):q.isMeshPhongMaterial?(p($,q),function R($,q){$.specular.value.copy(q.specular),$.shininess.value=Math.max(q.shininess,1e-4),q.emissiveMap&&($.emissiveMap.value=q.emissiveMap),q.bumpMap&&($.bumpMap.value=q.bumpMap,$.bumpScale.value=q.bumpScale,1===q.side&&($.bumpScale.value*=-1)),q.normalMap&&($.normalMap.value=q.normalMap,$.normalScale.value.copy(q.normalScale),1===q.side&&$.normalScale.value.negate()),q.displacementMap&&($.displacementMap.value=q.displacementMap,$.displacementScale.value=q.displacementScale,$.displacementBias.value=q.displacementBias)}($,q)):q.isMeshStandardMaterial?(p($,q),q.isMeshPhysicalMaterial?function U($,q){k($,q),$.reflectivity.value=q.reflectivity,$.clearcoat.value=q.clearcoat,$.clearcoatRoughness.value=q.clearcoatRoughness,q.sheen&&$.sheen.value.copy(q.sheen),q.clearcoatMap&&($.clearcoatMap.value=q.clearcoatMap),q.clearcoatRoughnessMap&&($.clearcoatRoughnessMap.value=q.clearcoatRoughnessMap),q.clearcoatNormalMap&&($.clearcoatNormalScale.value.copy(q.clearcoatNormalScale),$.clearcoatNormalMap.value=q.clearcoatNormalMap,1===q.side&&$.clearcoatNormalScale.value.negate()),$.transmission.value=q.transmission,q.transmissionMap&&($.transmissionMap.value=q.transmissionMap)}($,q):k($,q)):q.isMeshMatcapMaterial?(p($,q),function G($,q){q.matcap&&($.matcap.value=q.matcap),q.bumpMap&&($.bumpMap.value=q.bumpMap,$.bumpScale.value=q.bumpScale,1===q.side&&($.bumpScale.value*=-1)),q.normalMap&&($.normalMap.value=q.normalMap,$.normalScale.value.copy(q.normalScale),1===q.side&&$.normalScale.value.negate()),q.displacementMap&&($.displacementMap.value=q.displacementMap,$.displacementScale.value=q.displacementScale,$.displacementBias.value=q.displacementBias)}($,q)):q.isMeshDepthMaterial?(p($,q),function Y($,q){q.displacementMap&&($.displacementMap.value=q.displacementMap,$.displacementScale.value=q.displacementScale,$.displacementBias.value=q.displacementBias)}($,q)):q.isMeshDistanceMaterial?(p($,q),function re($,q){q.displacementMap&&($.displacementMap.value=q.displacementMap,$.displacementScale.value=q.displacementScale,$.displacementBias.value=q.displacementBias),$.referencePosition.value.copy(q.referencePosition),$.nearDistance.value=q.nearDistance,$.farDistance.value=q.farDistance}($,q)):q.isMeshNormalMaterial?(p($,q),function ie($,q){q.bumpMap&&($.bumpMap.value=q.bumpMap,$.bumpScale.value=q.bumpScale,1===q.side&&($.bumpScale.value*=-1)),q.normalMap&&($.normalMap.value=q.normalMap,$.normalScale.value.copy(q.normalScale),1===q.side&&$.normalScale.value.negate()),q.displacementMap&&($.displacementMap.value=q.displacementMap,$.displacementScale.value=q.displacementScale,$.displacementBias.value=q.displacementBias)}($,q)):q.isLineBasicMaterial?(function v($,q){$.diffuse.value.copy(q.color),$.opacity.value=q.opacity}($,q),q.isLineDashedMaterial&&function y($,q){$.dashSize.value=q.dashSize,$.totalSize.value=q.dashSize+q.gapSize,$.scale.value=q.scale}($,q)):q.isPointsMaterial?function x($,q,Ae,Ie){let Se;$.diffuse.value.copy(q.color),$.opacity.value=q.opacity,$.size.value=q.size*Ae,$.scale.value=.5*Ie,q.map&&($.map.value=q.map),q.alphaMap&&($.alphaMap.value=q.alphaMap),q.map?Se=q.map:q.alphaMap&&(Se=q.alphaMap),void 0!==Se&&(!0===Se.matrixAutoUpdate&&Se.updateMatrix(),$.uvTransform.value.copy(Se.matrix))}($,q,Ae,Ie):q.isSpriteMaterial?function E($,q){let Ae;$.diffuse.value.copy(q.color),$.opacity.value=q.opacity,$.rotation.value=q.rotation,q.map&&($.map.value=q.map),q.alphaMap&&($.alphaMap.value=q.alphaMap),q.map?Ae=q.map:q.alphaMap&&(Ae=q.alphaMap),void 0!==Ae&&(!0===Ae.matrixAutoUpdate&&Ae.updateMatrix(),$.uvTransform.value.copy(Ae.matrix))}($,q):q.isShadowMaterial?($.color.value.copy(q.color),$.opacity.value=q.opacity):q.isShaderMaterial&&(q.uniformsNeedUpdate=!1)}}}function Do(a){const o=void 0!==(a=a||{}).canvas?a.canvas:function ap(){const a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return a.style.display="block",a}(),l=void 0!==a.context?a.context:null,p=void 0!==a.alpha&&a.alpha,v=void 0===a.depth||a.depth,y=void 0===a.stencil||a.stencil,x=void 0!==a.antialias&&a.antialias,E=void 0===a.premultipliedAlpha||a.premultipliedAlpha,I=void 0!==a.preserveDrawingBuffer&&a.preserveDrawingBuffer,R=void 0!==a.powerPreference?a.powerPreference:"default",F=void 0!==a.failIfMajorPerformanceCaveat&&a.failIfMajorPerformanceCaveat;let k=null,U=null;const G=[];this.domElement=o,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Il,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const Y=this;let re=!1,ie=null,$=0,q=0,Ae=null,Ie=null,Se=-1,he=null;const De=new Hr,vt=new Hr;let ke=null,Qe=o.width,tt=o.height,ut=1,Ze=null,Ce=null;const Fe=new Hr(0,0,Qe,tt),je=new Hr(0,0,Qe,tt);let at=!1;const Pt=new Hf;let xt=!1,Ut=!1;const qt=new Kt,Qn=new xe,Un={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ki(){return null===Ae?ut:1}let Kn,Ni,ri,Hi,si,Vt,Zt,un,On,Ve,_e,me,Et,_t,Le,Gt,An,Gn,mn,Vn,$n,mt=l;function is(be,Xe){for(let nt=0;nt<be.length;nt++){const vn=o.getContext(be[nt],Xe);if(null!==vn)return vn}return null}try{const be={alpha:p,depth:v,stencil:y,antialias:x,premultipliedAlpha:E,preserveDrawingBuffer:I,powerPreference:R,failIfMajorPerformanceCaveat:F};if(o.addEventListener("webglcontextlost",ar,!1),o.addEventListener("webglcontextrestored",Bs,!1),null===mt){const Xe=["webgl2","webgl","experimental-webgl"];if(!0===Y.isWebGL1Renderer&&Xe.shift(),mt=is(Xe,be),null===mt)throw is(Xe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===mt.getShaderPrecisionFormat&&(mt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(be){throw console.error("THREE.WebGLRenderer: "+be.message),be}function Si(){Kn=new wd(mt),Ni=new Rm(mt,Kn,a),Kn.init(Ni),Vn=new Dd(mt,Kn,Ni),ri=new Pv(mt,Kn,Ni),ri.scissor(vt.copy(je).multiplyScalar(ut).floor()),ri.viewport(De.copy(Fe).multiplyScalar(ut).floor()),Hi=new Mh(mt),si=new gb,Vt=new sp(mt,Kn,ri,si,Ni,Vn,Hi),Zt=new dv(Y),un=new Rt(mt,Ni),$n=new cv(mt,Kn,un,Ni),On=new ab(mt,un,Hi,$n),Ve=new f0(mt,On,un,Hi),An=new h0(mt),Le=new yu(si),_e=new Wm(Y,Zt,Kn,Ni,$n,Le),me=new Ym(si),Et=new A0(si),_t=new x0(Kn,Ni),Gt=new c0(Y,Zt,ri,Ve,E),Gn=new d0(mt,Kn,Hi,Ni),mn=new Jf(mt,Kn,Hi,Ni),Hi.programs=_e.programs,Y.capabilities=Ni,Y.extensions=Kn,Y.properties=si,Y.renderLists=Et,Y.state=ri,Y.info=Hi}Si();const Cn=new Lv(Y,mt);this.xr=Cn;const li=new Xm(Y,Ve,Ni.maxTextureSize);function ar(be){be.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),re=!0}function Bs(){console.log("THREE.WebGLRenderer: Context Restored."),re=!1,Si()}function nl(be){const Xe=be.target;Xe.removeEventListener("dispose",nl),function Ql(be){No(be),si.remove(be)}(Xe)}function No(be){const Xe=si.get(be).program;void 0!==Xe&&_e.releaseProgram(Xe)}this.shadowMap=li,this.getContext=function(){return mt},this.getContextAttributes=function(){return mt.getContextAttributes()},this.forceContextLoss=function(){const be=Kn.get("WEBGL_lose_context");be&&be.loseContext()},this.forceContextRestore=function(){const be=Kn.get("WEBGL_lose_context");be&&be.restoreContext()},this.getPixelRatio=function(){return ut},this.setPixelRatio=function(be){void 0!==be&&(ut=be,this.setSize(Qe,tt,!1))},this.getSize=function(be){return void 0===be&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),be=new qe),be.set(Qe,tt)},this.setSize=function(be,Xe,nt){Cn.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Qe=be,tt=Xe,o.width=Math.floor(be*ut),o.height=Math.floor(Xe*ut),!1!==nt&&(o.style.width=be+"px",o.style.height=Xe+"px"),this.setViewport(0,0,be,Xe))},this.getDrawingBufferSize=function(be){return void 0===be&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),be=new qe),be.set(Qe*ut,tt*ut).floor()},this.setDrawingBufferSize=function(be,Xe,nt){Qe=be,tt=Xe,ut=nt,o.width=Math.floor(be*nt),o.height=Math.floor(Xe*nt),this.setViewport(0,0,be,Xe)},this.getCurrentViewport=function(be){return void 0===be&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),be=new Hr),be.copy(De)},this.getViewport=function(be){return be.copy(Fe)},this.setViewport=function(be,Xe,nt,bt){be.isVector4?Fe.set(be.x,be.y,be.z,be.w):Fe.set(be,Xe,nt,bt),ri.viewport(De.copy(Fe).multiplyScalar(ut).floor())},this.getScissor=function(be){return be.copy(je)},this.setScissor=function(be,Xe,nt,bt){be.isVector4?je.set(be.x,be.y,be.z,be.w):je.set(be,Xe,nt,bt),ri.scissor(vt.copy(je).multiplyScalar(ut).floor())},this.getScissorTest=function(){return at},this.setScissorTest=function(be){ri.setScissorTest(at=be)},this.setOpaqueSort=function(be){Ze=be},this.setTransparentSort=function(be){Ce=be},this.getClearColor=function(be){return void 0===be&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),be=new ei),be.copy(Gt.getClearColor())},this.setClearColor=function(){Gt.setClearColor.apply(Gt,arguments)},this.getClearAlpha=function(){return Gt.getClearAlpha()},this.setClearAlpha=function(){Gt.setClearAlpha.apply(Gt,arguments)},this.clear=function(be,Xe,nt){let bt=0;(void 0===be||be)&&(bt|=16384),(void 0===Xe||Xe)&&(bt|=256),(void 0===nt||nt)&&(bt|=1024),mt.clear(bt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){o.removeEventListener("webglcontextlost",ar,!1),o.removeEventListener("webglcontextrestored",Bs,!1),Et.dispose(),_t.dispose(),si.dispose(),Zt.dispose(),Ve.dispose(),$n.dispose(),Cn.dispose(),Kl.stop()},this.renderBufferImmediate=function(be,Xe){$n.initAttributes();const nt=si.get(be);be.hasPositions&&!nt.position&&(nt.position=mt.createBuffer()),be.hasNormals&&!nt.normal&&(nt.normal=mt.createBuffer()),be.hasUvs&&!nt.uv&&(nt.uv=mt.createBuffer()),be.hasColors&&!nt.color&&(nt.color=mt.createBuffer());const bt=Xe.getAttributes();be.hasPositions&&(mt.bindBuffer(34962,nt.position),mt.bufferData(34962,be.positionArray,35048),$n.enableAttribute(bt.position),mt.vertexAttribPointer(bt.position,3,5126,!1,0,0)),be.hasNormals&&(mt.bindBuffer(34962,nt.normal),mt.bufferData(34962,be.normalArray,35048),$n.enableAttribute(bt.normal),mt.vertexAttribPointer(bt.normal,3,5126,!1,0,0)),be.hasUvs&&(mt.bindBuffer(34962,nt.uv),mt.bufferData(34962,be.uvArray,35048),$n.enableAttribute(bt.uv),mt.vertexAttribPointer(bt.uv,2,5126,!1,0,0)),be.hasColors&&(mt.bindBuffer(34962,nt.color),mt.bufferData(34962,be.colorArray,35048),$n.enableAttribute(bt.color),mt.vertexAttribPointer(bt.color,3,5126,!1,0,0)),$n.disableUnusedAttributes(),mt.drawArrays(4,0,be.count),be.count=0},this.renderBufferDirect=function(be,Xe,nt,bt,vn,Pi){null===Xe&&(Xe=Un);const Fi=vn.isMesh&&vn.matrixWorld.determinant()<0,hi=Zl(be,Xe,bt,vn);ri.setMaterial(bt,Fi);let Gi=nt.index;const qr=nt.attributes.position;if(null===Gi){if(void 0===qr||0===qr.count)return}else if(0===Gi.count)return;let os=1;!0===bt.wireframe&&(Gi=On.getWireframeAttribute(nt),os=2),(bt.morphTargets||bt.morphNormals)&&An.update(vn,nt,bt,hi),$n.setup(vn,bt,hi,nt,Gi);let fi,ai=Gn;null!==Gi&&(fi=un.get(Gi),ai=mn,ai.setIndex(fi));const fo=null!==Gi?Gi.count:qr.count,mr=nt.drawRange.start*os,pc=nt.drawRange.count*os,bs=null!==Pi?Pi.start*os:0,Ip=null!==Pi?Pi.count*os:1/0,Qi=Math.max(mr,bs),Jl=Math.min(fo,mr+pc,bs+Ip)-1,Ts=Math.max(0,Jl-Qi+1);if(0!==Ts){if(vn.isMesh)!0===bt.wireframe?(ri.setLineWidth(bt.wireframeLinewidth*ki()),ai.setMode(1)):ai.setMode(4);else if(vn.isLine){let il=bt.linewidth;void 0===il&&(il=1),ri.setLineWidth(il*ki()),ai.setMode(vn.isLineSegments?1:vn.isLineLoop?2:3)}else vn.isPoints?ai.setMode(0):vn.isSprite&&ai.setMode(4);if(vn.isInstancedMesh)ai.renderInstances(Qi,Ts,vn.count);else if(nt.isInstancedBufferGeometry){const il=Math.min(nt.instanceCount,nt._maxInstanceCount);ai.renderInstances(Qi,Ts,il)}else ai.render(Qi,Ts)}},this.compile=function(be,Xe){U=_t.get(be),U.init(),be.traverseVisible(function(bt){bt.isLight&&bt.layers.test(Xe.layers)&&(U.pushLight(bt),bt.castShadow&&U.pushShadow(bt))}),U.setupLights();const nt=new WeakMap;be.traverse(function(bt){const vn=bt.material;if(vn)if(Array.isArray(vn))for(let Pi=0;Pi<vn.length;Pi++){const Fi=vn[Pi];!1===nt.has(Fi)&&(ur(Fi,be,bt),nt.set(Fi))}else!1===nt.has(vn)&&(ur(vn,be,bt),nt.set(vn))})};let $r=null;const Kl=new Gf;function s_(be,Xe,nt,bt){if(!1===be.visible)return;if(be.layers.test(Xe.layers))if(be.isGroup)nt=be.renderOrder;else if(be.isLOD)!0===be.autoUpdate&&be.update(Xe);else if(be.isLight)U.pushLight(be),be.castShadow&&U.pushShadow(be);else if(be.isSprite){if(!be.frustumCulled||Pt.intersectsSprite(be)){bt&&Qn.setFromMatrixPosition(be.matrixWorld).applyMatrix4(qt);const Fi=Ve.update(be),hi=be.material;hi.visible&&k.push(be,Fi,hi,nt,Qn.z,null)}}else if(be.isImmediateRenderObject)bt&&Qn.setFromMatrixPosition(be.matrixWorld).applyMatrix4(qt),k.push(be,null,be.material,nt,Qn.z,null);else if((be.isMesh||be.isLine||be.isPoints)&&(be.isSkinnedMesh&&be.skeleton.frame!==Hi.render.frame&&(be.skeleton.update(),be.skeleton.frame=Hi.render.frame),!be.frustumCulled||Pt.intersectsObject(be))){bt&&Qn.setFromMatrixPosition(be.matrixWorld).applyMatrix4(qt);const Fi=Ve.update(be),hi=be.material;if(Array.isArray(hi)){const Gi=Fi.groups;for(let qr=0,os=Gi.length;qr<os;qr++){const fi=Gi[qr],ai=hi[fi.materialIndex];ai&&ai.visible&&k.push(be,Fi,ai,nt,Qn.z,fi)}}else hi.visible&&k.push(be,Fi,hi,nt,Qn.z,null)}const Pi=be.children;for(let Fi=0,hi=Pi.length;Fi<hi;Fi++)s_(Pi[Fi],Xe,nt,bt)}function yg(be,Xe,nt){const bt=!0===Xe.isScene?Xe.overrideMaterial:null;for(let vn=0,Pi=be.length;vn<Pi;vn++){const Fi=be[vn],hi=Fi.object,Gi=Fi.geometry,qr=null===bt?Fi.material:bt,os=Fi.group;if(nt.isArrayCamera){const fi=nt.cameras;for(let ai=0,fo=fi.length;ai<fo;ai++){const mr=fi[ai];hi.layers.test(mr.layers)&&(ri.viewport(De.copy(mr.viewport)),U.setupLightsView(mr),Mp(hi,Xe,mr,Gi,qr,os))}}else Mp(hi,Xe,nt,Gi,qr,os)}}function Mp(be,Xe,nt,bt,vn,Pi){if(be.onBeforeRender(Y,Xe,nt,bt,vn,Pi),be.modelViewMatrix.multiplyMatrices(nt.matrixWorldInverse,be.matrixWorld),be.normalMatrix.getNormalMatrix(be.modelViewMatrix),be.isImmediateRenderObject){const Fi=Zl(nt,Xe,vn,be);ri.setMaterial(vn),$n.reset(),function Al(be,Xe){be.render(function(nt){Y.renderBufferImmediate(nt,Xe)})}(be,Fi)}else Y.renderBufferDirect(nt,Xe,bt,vn,be,Pi);be.onAfterRender(Y,Xe,nt,bt,vn,Pi)}function ur(be,Xe,nt){!0!==Xe.isScene&&(Xe=Un);const bt=si.get(be),vn=U.state.lights,Fi=vn.state.version,hi=_e.getParameters(be,vn.state,U.state.shadowsArray,Xe,nt),Gi=_e.getProgramCacheKey(hi);let qr=bt.program,os=!0;if(bt.environment=be.isMeshStandardMaterial?Xe.environment:null,bt.fog=Xe.fog,bt.envMap=Zt.get(be.envMap||bt.environment),void 0===qr)be.addEventListener("dispose",nl);else if(qr.cacheKey!==Gi)No(be);else if(bt.lightsStateVersion!==Fi)os=!1;else{if(void 0!==hi.shaderID)return;os=!1}os&&(hi.uniforms=_e.getUniforms(be),be.onBeforeCompile(hi,Y),qr=_e.acquireProgram(hi,Gi),bt.program=qr,bt.uniforms=hi.uniforms,bt.outputEncoding=hi.outputEncoding);const fi=bt.uniforms;(!be.isShaderMaterial&&!be.isRawShaderMaterial||!0===be.clipping)&&(bt.numClippingPlanes=Le.numPlanes,bt.numIntersection=Le.numIntersection,fi.clippingPlanes=Le.uniform),bt.needsLights=function fc(be){return be.isMeshLambertMaterial||be.isMeshToonMaterial||be.isMeshPhongMaterial||be.isMeshStandardMaterial||be.isShadowMaterial||be.isShaderMaterial&&!0===be.lights}(be),bt.lightsStateVersion=Fi,bt.needsLights&&(fi.ambientLightColor.value=vn.state.ambient,fi.lightProbe.value=vn.state.probe,fi.directionalLights.value=vn.state.directional,fi.directionalLightShadows.value=vn.state.directionalShadow,fi.spotLights.value=vn.state.spot,fi.spotLightShadows.value=vn.state.spotShadow,fi.rectAreaLights.value=vn.state.rectArea,fi.ltc_1.value=vn.state.rectAreaLTC1,fi.ltc_2.value=vn.state.rectAreaLTC2,fi.pointLights.value=vn.state.point,fi.pointLightShadows.value=vn.state.pointShadow,fi.hemisphereLights.value=vn.state.hemi,fi.directionalShadowMap.value=vn.state.directionalShadowMap,fi.directionalShadowMatrix.value=vn.state.directionalShadowMatrix,fi.spotShadowMap.value=vn.state.spotShadowMap,fi.spotShadowMatrix.value=vn.state.spotShadowMatrix,fi.pointShadowMap.value=vn.state.pointShadowMap,fi.pointShadowMatrix.value=vn.state.pointShadowMatrix);const ai=bt.program.getUniforms(),fo=_s.seqWithValue(ai.seq,fi);bt.uniformsList=fo}function Zl(be,Xe,nt,bt){!0!==Xe.isScene&&(Xe=Un),Vt.resetTextureUnits();const vn=Xe.fog,Pi=nt.isMeshStandardMaterial?Xe.environment:null,Fi=null===Ae?Y.outputEncoding:Ae.texture.encoding,hi=Zt.get(nt.envMap||Pi),Gi=si.get(nt),qr=U.state.lights;!0!==xt||!0!==Ut&&be===he||Le.setState(nt,be,be===he&&nt.id===Se),nt.version===Gi.__version?(nt.fog&&Gi.fog!==vn||Gi.environment!==Pi||Gi.needsLights&&Gi.lightsStateVersion!==qr.state.version||void 0!==Gi.numClippingPlanes&&(Gi.numClippingPlanes!==Le.numPlanes||Gi.numIntersection!==Le.numIntersection)||Gi.outputEncoding!==Fi||Gi.envMap!==hi)&&ur(nt,Xe,bt):(ur(nt,Xe,bt),Gi.__version=nt.version);let os=!1,fi=!1,ai=!1;const fo=Gi.program,mr=fo.getUniforms(),pc=Gi.uniforms;if(ri.useProgram(fo.program)&&(os=!0,fi=!0,ai=!0),nt.id!==Se&&(Se=nt.id,fi=!0),os||he!==be){if(mr.setValue(mt,"projectionMatrix",be.projectionMatrix),Ni.logarithmicDepthBuffer&&mr.setValue(mt,"logDepthBufFC",2/(Math.log(be.far+1)/Math.LN2)),he!==be&&(he=be,fi=!0,ai=!0),nt.isShaderMaterial||nt.isMeshPhongMaterial||nt.isMeshToonMaterial||nt.isMeshStandardMaterial||nt.envMap){const bs=mr.map.cameraPosition;void 0!==bs&&bs.setValue(mt,Qn.setFromMatrixPosition(be.matrixWorld))}(nt.isMeshPhongMaterial||nt.isMeshToonMaterial||nt.isMeshLambertMaterial||nt.isMeshBasicMaterial||nt.isMeshStandardMaterial||nt.isShaderMaterial)&&mr.setValue(mt,"isOrthographic",!0===be.isOrthographicCamera),(nt.isMeshPhongMaterial||nt.isMeshToonMaterial||nt.isMeshLambertMaterial||nt.isMeshBasicMaterial||nt.isMeshStandardMaterial||nt.isShaderMaterial||nt.isShadowMaterial||nt.skinning)&&mr.setValue(mt,"viewMatrix",be.matrixWorldInverse)}if(nt.skinning){mr.setOptional(mt,bt,"bindMatrix"),mr.setOptional(mt,bt,"bindMatrixInverse");const bs=bt.skeleton;if(bs){const Ip=bs.bones;if(Ni.floatVertexTextures){if(null===bs.boneTexture){let Qi=Math.sqrt(4*Ip.length);Qi=pi.ceilPowerOfTwo(Qi),Qi=Math.max(Qi,4);const Jl=new Float32Array(Qi*Qi*4);Jl.set(bs.boneMatrices);const Ts=new Dr(Jl,Qi,Qi,_r,oa);bs.boneMatrices=Jl,bs.boneTexture=Ts,bs.boneTextureSize=Qi}mr.setValue(mt,"boneTexture",bs.boneTexture,Vt),mr.setValue(mt,"boneTextureSize",bs.boneTextureSize)}else mr.setOptional(mt,bs,"boneMatrices")}}return(fi||Gi.receiveShadow!==bt.receiveShadow)&&(Gi.receiveShadow=bt.receiveShadow,mr.setValue(mt,"receiveShadow",bt.receiveShadow)),fi&&(mr.setValue(mt,"toneMappingExposure",Y.toneMappingExposure),Gi.needsLights&&function af(be,Xe){be.ambientLightColor.needsUpdate=Xe,be.lightProbe.needsUpdate=Xe,be.directionalLights.needsUpdate=Xe,be.directionalLightShadows.needsUpdate=Xe,be.pointLights.needsUpdate=Xe,be.pointLightShadows.needsUpdate=Xe,be.spotLights.needsUpdate=Xe,be.spotLightShadows.needsUpdate=Xe,be.rectAreaLights.needsUpdate=Xe,be.hemisphereLights.needsUpdate=Xe}(pc,ai),vn&&nt.fog&&me.refreshFogUniforms(pc,vn),me.refreshMaterialUniforms(pc,nt,ut,tt),_s.upload(mt,Gi.uniformsList,pc,Vt)),nt.isShaderMaterial&&!0===nt.uniformsNeedUpdate&&(_s.upload(mt,Gi.uniformsList,pc,Vt),nt.uniformsNeedUpdate=!1),nt.isSpriteMaterial&&mr.setValue(mt,"center",bt.center),mr.setValue(mt,"modelViewMatrix",bt.modelViewMatrix),mr.setValue(mt,"normalMatrix",bt.normalMatrix),mr.setValue(mt,"modelMatrix",bt.matrixWorld),fo}Kl.setAnimationLoop(function tr(be){Cn.isPresenting||$r&&$r(be)}),typeof window<"u"&&Kl.setContext(window),this.setAnimationLoop=function(be){$r=be,Cn.setAnimationLoop(be),null===be?Kl.stop():Kl.start()},this.render=function(be,Xe){let nt,bt;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),nt=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),bt=arguments[3]),void 0!==Xe&&!0!==Xe.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===re)return;$n.resetDefaultState(),Se=-1,he=null,!0===be.autoUpdate&&be.updateMatrixWorld(),null===Xe.parent&&Xe.updateMatrixWorld(),!0===Cn.enabled&&!0===Cn.isPresenting&&(Xe=Cn.getCamera(Xe)),!0===be.isScene&&be.onBeforeRender(Y,be,Xe,nt||Ae),U=_t.get(be,G.length),U.init(),G.push(U),qt.multiplyMatrices(Xe.projectionMatrix,Xe.matrixWorldInverse),Pt.setFromProjectionMatrix(qt),Ut=this.localClippingEnabled,xt=Le.init(this.clippingPlanes,Ut,Xe),k=Et.get(be,Xe),k.init(),s_(be,Xe,0,Y.sortObjects),k.finish(),!0===Y.sortObjects&&k.sort(Ze,Ce),!0===xt&&Le.beginShadows(),li.render(U.state.shadowsArray,be,Xe),U.setupLights(),U.setupLightsView(Xe),!0===xt&&Le.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==nt&&this.setRenderTarget(nt),Gt.render(k,be,Xe,bt);const Pi=k.opaque,Fi=k.transparent;Pi.length>0&&yg(Pi,be,Xe),Fi.length>0&&yg(Fi,be,Xe),!0===be.isScene&&be.onAfterRender(Y,be,Xe),null!==Ae&&(Vt.updateRenderTargetMipmap(Ae),Vt.updateMultisampleRenderTarget(Ae)),ri.buffers.depth.setTest(!0),ri.buffers.depth.setMask(!0),ri.buffers.color.setMask(!0),ri.setPolygonOffset(!1),G.pop(),U=G.length>0?G[G.length-1]:null,k=null},this.setFramebuffer=function(be){ie!==be&&null===Ae&&mt.bindFramebuffer(36160,be),ie=be},this.getActiveCubeFace=function(){return $},this.getActiveMipmapLevel=function(){return q},this.getRenderList=function(){return k},this.setRenderList=function(be){k=be},this.getRenderTarget=function(){return Ae},this.setRenderTarget=function(be,Xe=0,nt=0){Ae=be,$=Xe,q=nt,be&&void 0===si.get(be).__webglFramebuffer&&Vt.setupRenderTarget(be);let bt=ie,vn=!1;if(be){const Pi=si.get(be).__webglFramebuffer;be.isWebGLCubeRenderTarget?(bt=Pi[Xe],vn=!0):bt=be.isWebGLMultisampleRenderTarget?si.get(be).__webglMultisampledFramebuffer:Pi,De.copy(be.viewport),vt.copy(be.scissor),ke=be.scissorTest}else De.copy(Fe).multiplyScalar(ut).floor(),vt.copy(je).multiplyScalar(ut).floor(),ke=at;if(Ie!==bt&&(mt.bindFramebuffer(36160,bt),Ie=bt),ri.viewport(De),ri.scissor(vt),ri.setScissorTest(ke),vn){const Pi=si.get(be.texture);mt.framebufferTexture2D(36160,36064,34069+Xe,Pi.__webglTexture,nt)}},this.readRenderTargetPixels=function(be,Xe,nt,bt,vn,Pi,Fi){if(!be||!be.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let hi=si.get(be).__webglFramebuffer;if(be.isWebGLCubeRenderTarget&&void 0!==Fi&&(hi=hi[Fi]),hi){let Gi=!1;hi!==Ie&&(mt.bindFramebuffer(36160,hi),Gi=!0);try{const qr=be.texture,os=qr.format,fi=qr.type;if(os!==_r&&Vn.convert(os)!==mt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ai=1016===fi&&(Kn.has("EXT_color_buffer_half_float")||Ni.isWebGL2&&Kn.has("EXT_color_buffer_float"));if(!(1009===fi||Vn.convert(fi)===mt.getParameter(35738)||fi===oa&&(Ni.isWebGL2||Kn.has("OES_texture_float")||Kn.has("WEBGL_color_buffer_float"))||ai))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===mt.checkFramebufferStatus(36160)?Xe>=0&&Xe<=be.width-bt&&nt>=0&&nt<=be.height-vn&&mt.readPixels(Xe,nt,bt,vn,Vn.convert(os),Vn.convert(fi),Pi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Gi&&mt.bindFramebuffer(36160,Ie)}}},this.copyFramebufferToTexture=function(be,Xe,nt=0){const bt=Math.pow(2,-nt),vn=Math.floor(Xe.image.width*bt),Pi=Math.floor(Xe.image.height*bt),Fi=Vn.convert(Xe.format);Vt.setTexture2D(Xe,0),mt.copyTexImage2D(3553,nt,Fi,be.x,be.y,vn,Pi,0),ri.unbindTexture()},this.copyTextureToTexture=function(be,Xe,nt,bt=0){const vn=Xe.image.width,Pi=Xe.image.height,Fi=Vn.convert(nt.format),hi=Vn.convert(nt.type);Vt.setTexture2D(nt,0),mt.pixelStorei(37440,nt.flipY),mt.pixelStorei(37441,nt.premultiplyAlpha),mt.pixelStorei(3317,nt.unpackAlignment),Xe.isDataTexture?mt.texSubImage2D(3553,bt,be.x,be.y,vn,Pi,Fi,hi,Xe.image.data):Xe.isCompressedTexture?mt.compressedTexSubImage2D(3553,bt,be.x,be.y,Xe.mipmaps[0].width,Xe.mipmaps[0].height,Fi,Xe.mipmaps[0].data):mt.texSubImage2D(3553,bt,be.x,be.y,Fi,hi,Xe.image),0===bt&&nt.generateMipmaps&&mt.generateMipmap(3553),ri.unbindTexture()},this.initTexture=function(be){Vt.setTexture2D(be,0),ri.unbindTexture()},this.resetState=function(){ri.reset(),$n.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function op(a){Do.call(this,a)}Ov.prototype=Object.assign(Object.create(ks.prototype),{constructor:Ov,isArrayCamera:!0}),Bc.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Bc,isGroup:!0}),Object.assign(Uc.prototype,{constructor:Uc,getHandSpace:function(){return null===this._hand&&(this._hand=new Bc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Bc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Bc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(a){return null!==this._targetRay&&this._targetRay.dispatchEvent(a),null!==this._grip&&this._grip.dispatchEvent(a),null!==this._hand&&this._hand.dispatchEvent(a),this},disconnect:function(a){return this.dispatchEvent({type:"disconnected",data:a}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(a,o,l){let p=null,v=null,y=null;const x=this._targetRay,E=this._grip,I=this._hand;if(a&&"visible-blurred"!==o.session.visibilityState)if(I&&a.hand){y=!0;for(const Y of a.hand.values()){const re=o.getJointPose(Y,l);if(void 0===I.joints[Y.jointName]){const $=new Bc;$.matrixAutoUpdate=!1,$.visible=!1,I.joints[Y.jointName]=$,I.add($)}const ie=I.joints[Y.jointName];null!==re&&(ie.matrix.fromArray(re.transform.matrix),ie.matrix.decompose(ie.position,ie.rotation,ie.scale),ie.jointRadius=re.radius),ie.visible=null!==re}const k=I.joints["index-finger-tip"].position.distanceTo(I.joints["thumb-tip"].position),U=.02,G=.005;I.inputState.pinching&&k>U+G?(I.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!I.inputState.pinching&&k<=U-G&&(I.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else null!==x&&(p=o.getPose(a.targetRaySpace,l),null!==p&&(x.matrix.fromArray(p.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale))),null!==E&&a.gripSpace&&(v=o.getPose(a.gripSpace,l),null!==v&&(E.matrix.fromArray(v.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale)));return null!==x&&(x.visible=null!==p),null!==E&&(E.visible=null!==v),null!==I&&(I.visible=null!==y),this}}),Object.assign(Lv.prototype,Go.prototype),op.prototype=Object.assign(Object.create(Do.prototype),{constructor:op,isWebGL1Renderer:!0});class Zu extends Jn{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(o,l){return super.copy(o,l),null!==o.background&&(this.background=o.background.clone()),null!==o.environment&&(this.environment=o.environment.clone()),null!==o.fog&&(this.fog=o.fog.clone()),null!==o.overrideMaterial&&(this.overrideMaterial=o.overrideMaterial.clone()),this.autoUpdate=o.autoUpdate,this.matrixAutoUpdate=o.matrixAutoUpdate,this}toJSON(o){const l=super.toJSON(o);return null!==this.background&&(l.object.background=this.background.toJSON(o)),null!==this.environment&&(l.object.environment=this.environment.toJSON(o)),null!==this.fog&&(l.object.fog=this.fog.toJSON()),l}}function vl(a,o){this.array=a,this.stride=o,this.count=void 0!==a?a.length/o:0,this.usage=Cr,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=pi.generateUUID()}Object.defineProperty(vl.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),Object.assign(vl.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(a){return this.usage=a,this},copy:function(a){return this.array=new a.array.constructor(a.array),this.count=a.count,this.stride=a.stride,this.usage=a.usage,this},copyAt:function(a,o,l){a*=this.stride,l*=o.stride;for(let p=0,v=this.stride;p<v;p++)this.array[a+p]=o.array[l+p];return this},set:function(a,o=0){return this.array.set(a,o),this},clone:function(a){void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pi.generateUUID()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const l=new vl(new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]),this.stride);return l.setUsage(this.usage),l},onUpload:function(a){return this.onUploadCallback=a,this},toJSON:function(a){return void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pi.generateUUID()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Md=new xe;function Au(a,o,l,p){this.name="",this.data=a,this.itemSize=o,this.offset=l,this.normalized=!0===p}function Qo(a){_i.call(this),this.type="SpriteMaterial",this.color=new ei(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(a)}let Fh;Object.defineProperties(Au.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(a){this.data.needsUpdate=a}}}),Object.assign(Au.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(a){for(let o=0,l=this.data.count;o<l;o++)Md.x=this.getX(o),Md.y=this.getY(o),Md.z=this.getZ(o),Md.applyMatrix4(a),this.setXYZ(o,Md.x,Md.y,Md.z);return this},setX:function(a,o){return this.data.array[a*this.data.stride+this.offset]=o,this},setY:function(a,o){return this.data.array[a*this.data.stride+this.offset+1]=o,this},setZ:function(a,o){return this.data.array[a*this.data.stride+this.offset+2]=o,this},setW:function(a,o){return this.data.array[a*this.data.stride+this.offset+3]=o,this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,o,l){return this.data.array[(a=a*this.data.stride+this.offset)+0]=o,this.data.array[a+1]=l,this},setXYZ:function(a,o,l,p){return this.data.array[(a=a*this.data.stride+this.offset)+0]=o,this.data.array[a+1]=l,this.data.array[a+2]=p,this},setXYZW:function(a,o,l,p,v){return this.data.array[(a=a*this.data.stride+this.offset)+0]=o,this.data.array[a+1]=l,this.data.array[a+2]=p,this.data.array[a+3]=v,this},clone:function(a){if(void 0===a){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const o=[];for(let l=0;l<this.count;l++){const p=l*this.data.stride+this.offset;for(let v=0;v<this.itemSize;v++)o.push(this.data.array[p+v])}return new Ii(new this.array.constructor(o),this.itemSize,this.normalized)}return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a)),new Au(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(a){if(void 0===a){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const o=[];for(let l=0;l<this.count;l++){const p=l*this.data.stride+this.offset;for(let v=0;v<this.itemSize;v++)o.push(this.data.array[p+v])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:o,normalized:this.normalized}}return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),(Qo.prototype=Object.create(_i.prototype)).constructor=Qo,Qo.prototype.isSpriteMaterial=!0,Qo.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this};const Id=new xe,Bh=new xe,Uh=new xe,Vc=new qe,Vh=new qe,Hh=new Kt,lp=new xe,Rd=new xe,kv=new xe,S0=new qe,Nd=new qe,Fv=new qe;function Pd(a){if(Jn.call(this),this.type="Sprite",void 0===Fh){Fh=new xi;const l=new vl(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Fh.setIndex([0,1,2,0,2,3]),Fh.setAttribute("position",new Au(l,3,0,!1)),Fh.setAttribute("uv",new Au(l,2,3,!1))}this.geometry=Fh,this.material=void 0!==a?a:new Qo,this.center=new qe(.5,.5)}function Pr(a,o,l,p,v,y){Vc.subVectors(a,l).addScalar(.5).multiply(p),void 0!==v?(Vh.x=y*Vc.x-v*Vc.y,Vh.y=v*Vc.x+y*Vc.y):Vh.copy(Vc),a.copy(o),a.x+=Vh.x,a.y+=Vh.y,a.applyMatrix4(Hh)}Pd.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Pd,isSprite:!0,raycast:function(a,o){null===a.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Bh.setFromMatrixScale(this.matrixWorld),Hh.copy(a.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld),Uh.setFromMatrixPosition(this.modelViewMatrix),a.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Bh.multiplyScalar(-Uh.z);const l=this.material.rotation;let p,v;0!==l&&(v=Math.cos(l),p=Math.sin(l));const y=this.center;Pr(lp.set(-.5,-.5,0),Uh,y,Bh,p,v),Pr(Rd.set(.5,-.5,0),Uh,y,Bh,p,v),Pr(kv.set(.5,.5,0),Uh,y,Bh,p,v),S0.set(0,0),Nd.set(1,0),Fv.set(1,1);let x=a.ray.intersectTriangle(lp,Rd,kv,!1,Id);if(null===x&&(Pr(Rd.set(-.5,.5,0),Uh,y,Bh,p,v),Nd.set(0,1),x=a.ray.intersectTriangle(lp,kv,Rd,!1,Id),null===x))return;const E=a.ray.origin.distanceTo(Id);E<a.near||E>a.far||o.push({distance:E,point:Id.clone(),uv:za.getUV(Id,lp,Rd,kv,S0,Nd,Fv,new qe),face:null,object:this})},copy:function(a){return Jn.prototype.copy.call(this,a),void 0!==a.center&&this.center.copy(a.center),this.material=a.material,this}});const Qm=new xe,bb=new xe;function Hc(){Jn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Hc.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Hc,isLOD:!0,copy:function(a){Jn.prototype.copy.call(this,a,!1);const o=a.levels;for(let l=0,p=o.length;l<p;l++){const v=o[l];this.addLevel(v.object.clone(),v.distance)}return this.autoUpdate=a.autoUpdate,this},addLevel:function(a,o=0){o=Math.abs(o);const l=this.levels;let p;for(p=0;p<l.length&&!(o<l[p].distance);p++);return l.splice(p,0,{distance:o,object:a}),this.add(a),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(a){const o=this.levels;if(o.length>0){let l,p;for(l=1,p=o.length;l<p&&!(a<o[l].distance);l++);return o[l-1].object}return null},raycast:function(a,o){if(this.levels.length>0){Qm.setFromMatrixPosition(this.matrixWorld);const p=a.ray.origin.distanceTo(Qm);this.getObjectForDistance(p).raycast(a,o)}},update:function(a){const o=this.levels;if(o.length>1){Qm.setFromMatrixPosition(a.matrixWorld),bb.setFromMatrixPosition(this.matrixWorld);const l=Qm.distanceTo(bb)/a.zoom;let p,v;for(o[0].object.visible=!0,p=1,v=o.length;p<v&&l>=o[p].distance;p++)o[p-1].object.visible=!1,o[p].object.visible=!0;for(this._currentLevel=p-1;p<v;p++)o[p].object.visible=!1}},toJSON:function(a){const o=Jn.prototype.toJSON.call(this,a);!1===this.autoUpdate&&(o.object.autoUpdate=!1),o.object.levels=[];const l=this.levels;for(let p=0,v=l.length;p<v;p++){const y=l[p];o.object.levels.push({object:y.object.uuid,distance:y.distance})}return o}});const _l=new xe,E0=new Hr,C0=new Hr,Ju=new xe,D0=new Kt;function up(a,o){a&&a.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Zr.call(this,a,o),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Kt,this.bindMatrixInverse=new Kt}function Km(){Jn.call(this),this.type="Bone"}up.prototype=Object.assign(Object.create(Zr.prototype),{constructor:up,isSkinnedMesh:!0,copy:function(a){return Zr.prototype.copy.call(this,a),this.bindMode=a.bindMode,this.bindMatrix.copy(a.bindMatrix),this.bindMatrixInverse.copy(a.bindMatrixInverse),this.skeleton=a.skeleton,this},bind:function(a,o){this.skeleton=a,void 0===o&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),o=this.matrixWorld),this.bindMatrix.copy(o),this.bindMatrixInverse.copy(o).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const a=new Hr,o=this.geometry.attributes.skinWeight;for(let l=0,p=o.count;l<p;l++){a.x=o.getX(l),a.y=o.getY(l),a.z=o.getZ(l),a.w=o.getW(l);const v=1/a.manhattanLength();v!==1/0?a.multiplyScalar(v):a.set(1,0,0,0),o.setXYZW(l,a.x,a.y,a.z,a.w)}},updateMatrixWorld:function(a){Zr.prototype.updateMatrixWorld.call(this,a),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(a,o){const l=this.skeleton,p=this.geometry;E0.fromBufferAttribute(p.attributes.skinIndex,a),C0.fromBufferAttribute(p.attributes.skinWeight,a),_l.fromBufferAttribute(p.attributes.position,a).applyMatrix4(this.bindMatrix),o.set(0,0,0);for(let v=0;v<4;v++){const y=C0.getComponent(v);if(0!==y){const x=E0.getComponent(v);D0.multiplyMatrices(l.bones[x].matrixWorld,l.boneInverses[x]),o.addScaledVector(Ju.copy(_l).applyMatrix4(D0),y)}}return o.applyMatrix4(this.bindMatrixInverse)}}),Km.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Km,isBone:!0});const Bv=new Kt,Uv=new Kt;function M0(a=[],o=[]){this.uuid=pi.generateUUID(),this.bones=a.slice(0),this.boneInverses=o,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(M0.prototype,{init:function(){const a=this.bones,o=this.boneInverses;if(this.boneMatrices=new Float32Array(16*a.length),0===o.length)this.calculateInverses();else if(a.length!==o.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let l=0,p=this.bones.length;l<p;l++)this.boneInverses.push(new Kt)}},calculateInverses:function(){this.boneInverses.length=0;for(let a=0,o=this.bones.length;a<o;a++){const l=new Kt;this.bones[a]&&l.copy(this.bones[a].matrixWorld).invert(),this.boneInverses.push(l)}},pose:function(){for(let a=0,o=this.bones.length;a<o;a++){const l=this.bones[a];l&&l.matrixWorld.copy(this.boneInverses[a]).invert()}for(let a=0,o=this.bones.length;a<o;a++){const l=this.bones[a];l&&(l.parent&&l.parent.isBone?(l.matrix.copy(l.parent.matrixWorld).invert(),l.matrix.multiply(l.matrixWorld)):l.matrix.copy(l.matrixWorld),l.matrix.decompose(l.position,l.quaternion,l.scale))}},update:function(){const a=this.bones,o=this.boneInverses,l=this.boneMatrices,p=this.boneTexture;for(let v=0,y=a.length;v<y;v++)Bv.multiplyMatrices(a[v]?a[v].matrixWorld:Uv,o[v]),Bv.toArray(l,16*v);null!==p&&(p.needsUpdate=!0)},clone:function(){return new M0(this.bones,this.boneInverses)},getBoneByName:function(a){for(let o=0,l=this.bones.length;o<l;o++){const p=this.bones[o];if(p.name===a)return p}},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(a,o){this.uuid=a.uuid;for(let l=0,p=a.bones.length;l<p;l++){const v=a.bones[l];let y=o[v];void 0===y&&(console.warn("THREE.Skeleton: No bone found with UUID:",v),y=new Km),this.bones.push(y),this.boneInverses.push((new Kt).fromArray(a.boneInverses[l]))}return this.init(),this},toJSON:function(){const a={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};a.uuid=this.uuid;const o=this.bones,l=this.boneInverses;for(let p=0,v=o.length;p<v;p++)a.bones.push(o[p].uuid),a.boneInverses.push(l[p].toArray());return a}});const Tb=new Kt,cp=new Kt,Vv=[],Gh=new Zr;function Sa(a,o,l){Zr.call(this,a,o),this.instanceMatrix=new Ii(new Float32Array(16*l),16),this.instanceColor=null,this.count=l,this.frustumCulled=!1}function jl(a){_i.call(this),this.type="LineBasicMaterial",this.color=new ei(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(a)}Sa.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Sa,isInstancedMesh:!0,copy:function(a){return Zr.prototype.copy.call(this,a),this.instanceMatrix.copy(a.instanceMatrix),null!==a.instanceColor&&(this.instanceColor=a.instanceColor.clone()),this.count=a.count,this},getColorAt:function(a,o){o.fromArray(this.instanceColor.array,3*a)},getMatrixAt:function(a,o){o.fromArray(this.instanceMatrix.array,16*a)},raycast:function(a,o){const l=this.matrixWorld,p=this.count;if(Gh.geometry=this.geometry,Gh.material=this.material,void 0!==Gh.material)for(let v=0;v<p;v++){this.getMatrixAt(v,Tb),cp.multiplyMatrices(l,Tb),Gh.matrixWorld=cp,Gh.raycast(a,Vv);for(let y=0,x=Vv.length;y<x;y++){const E=Vv[y];E.instanceId=v,E.object=this,o.push(E)}Vv.length=0}},setColorAt:function(a,o){null===this.instanceColor&&(this.instanceColor=new Ii(new Float32Array(3*this.count),3)),o.toArray(this.instanceColor.array,3*a)},setMatrixAt:function(a,o){o.toArray(this.instanceMatrix.array,16*a)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(jl.prototype=Object.create(_i.prototype)).constructor=jl,jl.prototype.isLineBasicMaterial=!0,jl.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.morphTargets=a.morphTargets,this};const I0=new xe,R0=new xe,Zm=new Kt,jh=new Nl,zh=new io;function Od(a=new xi,o=new jl){Jn.call(this),this.type="Line",this.geometry=a,this.material=o,this.updateMorphTargets()}Od.prototype=Object.assign(Object.create(Jn.prototype),{constructor:Od,isLine:!0,copy:function(a){return Jn.prototype.copy.call(this,a),this.material=a.material,this.geometry=a.geometry,this},computeLineDistances:function(){const a=this.geometry;if(a.isBufferGeometry)if(null===a.index){const o=a.attributes.position,l=[0];for(let p=1,v=o.count;p<v;p++)I0.fromBufferAttribute(o,p-1),R0.fromBufferAttribute(o,p),l[p]=l[p-1],l[p]+=I0.distanceTo(R0);a.setAttribute("lineDistance",new zi(l,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else a.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(a,o){const l=this.geometry,p=this.matrixWorld,v=a.params.Line.threshold;if(null===l.boundingSphere&&l.computeBoundingSphere(),zh.copy(l.boundingSphere),zh.applyMatrix4(p),zh.radius+=v,!1===a.ray.intersectsSphere(zh))return;Zm.copy(p).invert(),jh.copy(a.ray).applyMatrix4(Zm);const y=v/((this.scale.x+this.scale.y+this.scale.z)/3),x=y*y,E=new xe,I=new xe,R=new xe,F=new xe,k=this.isLineSegments?2:1;if(l.isBufferGeometry){const U=l.index,Y=l.attributes.position;if(null!==U){const re=U.array;for(let ie=0,$=re.length-1;ie<$;ie+=k){const Ae=re[ie+1];if(E.fromBufferAttribute(Y,re[ie]),I.fromBufferAttribute(Y,Ae),jh.distanceSqToSegment(E,I,F,R)>x)continue;F.applyMatrix4(this.matrixWorld);const Se=a.ray.origin.distanceTo(F);Se<a.near||Se>a.far||o.push({distance:Se,point:R.clone().applyMatrix4(this.matrixWorld),index:ie,face:null,faceIndex:null,object:this})}}else for(let re=0,ie=Y.count-1;re<ie;re+=k){if(E.fromBufferAttribute(Y,re),I.fromBufferAttribute(Y,re+1),jh.distanceSqToSegment(E,I,F,R)>x)continue;F.applyMatrix4(this.matrixWorld);const q=a.ray.origin.distanceTo(F);q<a.near||q>a.far||o.push({distance:q,point:R.clone().applyMatrix4(this.matrixWorld),index:re,face:null,faceIndex:null,object:this})}}else l.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const a=this.geometry;if(a.isBufferGeometry){const o=a.morphAttributes,l=Object.keys(o);if(l.length>0){const p=o[l[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let v=0,y=p.length;v<y;v++){const x=p[v].name||String(v);this.morphTargetInfluences.push(0),this.morphTargetDictionary[x]=v}}}}else{const o=a.morphTargets;void 0!==o&&o.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Hv=new xe,Jm=new xe;function eg(a,o){Od.call(this,a,o),this.type="LineSegments"}function tg(a,o){Od.call(this,a,o),this.type="LineLoop"}function uo(a){_i.call(this),this.type="PointsMaterial",this.color=new ei(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(a)}eg.prototype=Object.assign(Object.create(Od.prototype),{constructor:eg,isLineSegments:!0,computeLineDistances:function(){const a=this.geometry;if(a.isBufferGeometry)if(null===a.index){const o=a.attributes.position,l=[];for(let p=0,v=o.count;p<v;p+=2)Hv.fromBufferAttribute(o,p),Jm.fromBufferAttribute(o,p+1),l[p]=0===p?0:l[p-1],l[p+1]=l[p]+Hv.distanceTo(Jm);a.setAttribute("lineDistance",new zi(l,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else a.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}),tg.prototype=Object.assign(Object.create(Od.prototype),{constructor:tg,isLineLoop:!0}),(uo.prototype=Object.create(_i.prototype)).constructor=uo,uo.prototype.isPointsMaterial=!0,uo.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.morphTargets=a.morphTargets,this};const Gv=new Kt,ng=new Nl,dp=new io,hp=new xe;function N0(a=new xi,o=new uo){Jn.call(this),this.type="Points",this.geometry=a,this.material=o,this.updateMorphTargets()}function jv(a,o,l,p,v,y,x){const E=ng.distanceSqToPoint(a);if(E<l){const I=new xe;ng.closestPointToPoint(a,I),I.applyMatrix4(p);const R=v.ray.origin.distanceTo(I);if(R<v.near||R>v.far)return;y.push({distance:R,distanceToRay:Math.sqrt(E),point:I,index:o,face:null,object:x})}}function zv(a,o,l,p,v,y,x,E,I){Li.call(this,a,o,l,p,v,y,x,E,I),this.format=void 0!==x?x:To,this.minFilter=void 0!==y?y:oe,this.magFilter=void 0!==v?v:oe,this.generateMipmaps=!1;const R=this;"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(function F(){R.needsUpdate=!0,a.requestVideoFrameCallback(F)})}function Ld(a,o,l,p,v,y,x,E,I,R,F,k){Li.call(this,null,y,x,E,I,R,p,v,F,k),this.image={width:o,height:l},this.mipmaps=a,this.flipY=!1,this.generateMipmaps=!1}function ec(a,o,l,p,v,y,x,E,I){Li.call(this,a,o,l,p,v,y,x,E,I),this.needsUpdate=!0}function Ko(a,o,l,p,v,y,x,E,I,R){if((R=void 0!==R?R:Bo)!==Bo&&R!==If)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===l&&R===Bo&&(l=1012),void 0===l&&R===If&&(l=Qr),Li.call(this,null,p,v,y,x,E,R,l,I),this.image={width:a,height:o},this.magFilter=void 0!==x?x:ba,this.minFilter=void 0!==E?E:ba,this.flipY=!1,this.generateMipmaps=!1}N0.prototype=Object.assign(Object.create(Jn.prototype),{constructor:N0,isPoints:!0,copy:function(a){return Jn.prototype.copy.call(this,a),this.material=a.material,this.geometry=a.geometry,this},raycast:function(a,o){const l=this.geometry,p=this.matrixWorld,v=a.params.Points.threshold;if(null===l.boundingSphere&&l.computeBoundingSphere(),dp.copy(l.boundingSphere),dp.applyMatrix4(p),dp.radius+=v,!1===a.ray.intersectsSphere(dp))return;Gv.copy(p).invert(),ng.copy(a.ray).applyMatrix4(Gv);const y=v/((this.scale.x+this.scale.y+this.scale.z)/3),x=y*y;if(l.isBufferGeometry){const E=l.index,R=l.attributes.position;if(null!==E){const F=E.array;for(let k=0,U=F.length;k<U;k++){const G=F[k];hp.fromBufferAttribute(R,G),jv(hp,G,x,p,a,o,this)}}else for(let F=0,k=R.count;F<k;F++)hp.fromBufferAttribute(R,F),jv(hp,F,x,p,a,o,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const a=this.geometry;if(a.isBufferGeometry){const o=a.morphAttributes,l=Object.keys(o);if(l.length>0){const p=o[l[0]];if(void 0!==p){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let v=0,y=p.length;v<y;v++){const x=p[v].name||String(v);this.morphTargetInfluences.push(0),this.morphTargetDictionary[x]=v}}}}else{const o=a.morphTargets;void 0!==o&&o.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),zv.prototype=Object.assign(Object.create(Li.prototype),{constructor:zv,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){const a=this.image;"requestVideoFrameCallback"in a==0&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(Ld.prototype=Object.create(Li.prototype)).constructor=Ld,Ld.prototype.isCompressedTexture=!0,(ec.prototype=Object.create(Li.prototype)).constructor=ec,ec.prototype.isCanvasTexture=!0,(Ko.prototype=Object.create(Li.prototype)).constructor=Ko,Ko.prototype.isDepthTexture=!0,new xe,new xe,new xe,new za;const L0_triangulate=function(a,o,l){l=l||2;const p=o&&o.length,v=p?o[0]*l:a.length;let y=La(a,0,v,l,!0);const x=[];if(!y||y.next===y.prev)return x;let E,I,R,F,k,U,G;if(p&&(y=function Ab(a,o,l,p){const v=[];let y,x,E,I,R;for(y=0,x=o.length;y<x;y++)E=o[y]*p,I=y<x-1?o[y+1]*p:a.length,R=La(a,E,I,p,!1),R===R.next&&(R.steiner=!0),v.push(ig(R));for(v.sort(xb),y=0;y<v.length;y++)k0(v[y],l),l=xu(l,l.next);return l}(a,o,y,l)),a.length>80*l){E=R=a[0],I=F=a[1];for(let Y=l;Y<v;Y+=l)k=a[Y],U=a[Y+1],k<E&&(E=k),U<I&&(I=U),k>R&&(R=k),U>F&&(F=U);G=Math.max(R-E,F-I),G=0!==G?1/G:0}return Wh(y,x,l,E,I,G),x};function La(a,o,l,p,v){let y,x;if(v===function Db(a,o,l,p){let v=0;for(let y=o,x=l-p;y<l;y+=p)v+=(a[x]-a[y])*(a[y+1]+a[x+1]),x=y;return v}(a,o,l,p)>0)for(y=o;y<l;y+=p)x=co(y,a[y],a[y+1],x);else for(y=l-p;y>=o;y-=p)x=co(y,a[y],a[y+1],x);return x&&Su(x,x.next)&&(kd(x),x=x.next),x}function xu(a,o){if(!a)return a;o||(o=a);let p,l=a;do{if(p=!1,l.steiner||!Su(l,l.next)&&0!==ss(l.prev,l,l.next))l=l.next;else{if(kd(l),l=o=l.prev,l===l.next)break;p=!0}}while(p||l!==o);return o}function Wh(a,o,l,p,v,y,x){if(!a)return;!x&&y&&function Eb(a,o,l,p){let v=a;do{null===v.z&&(v.z=Xv(v.x,v.y,o,l,p)),v.prevZ=v.prev,v.nextZ=v.next,v=v.next}while(v!==a);v.prevZ.nextZ=null,v.prevZ=null,function qv(a){let o,l,p,v,y,x,E,I,R=1;do{for(l=a,a=null,y=null,x=0;l;){for(x++,p=l,E=0,o=0;o<R&&(E++,p=p.nextZ,p);o++);for(I=R;E>0||I>0&&p;)0!==E&&(0===I||!p||l.z<=p.z)?(v=l,l=l.nextZ,E--):(v=p,p=p.nextZ,I--),y?y.nextZ=v:a=v,v.prevZ=y,y=v;l=p}y.nextZ=null,R*=2}while(x>1);return a}(v)}(a,p,v,y);let I,R,E=a;for(;a.prev!==a.next;)if(I=a.prev,R=a.next,y?ka(a,p,v,y):Wv(a))o.push(I.i/l),o.push(a.i/l),o.push(R.i/l),kd(a),a=R.next,E=R.next;else if((a=R)===E){x?1===x?Wh(a=$h(xu(a),o,l),o,l,p,v,y,2):2===x&&$v(a,o,l,p,v,y):Wh(xu(a),o,l,p,v,y,1);break}}function Wv(a){const o=a.prev,l=a,p=a.next;if(ss(o,l,p)>=0)return!1;let v=a.next.next;for(;v!==a.prev;){if(tc(o.x,o.y,l.x,l.y,p.x,p.y,v.x,v.y)&&ss(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function ka(a,o,l,p){const v=a.prev,y=a,x=a.next;if(ss(v,y,x)>=0)return!1;const R=v.x>y.x?v.x>x.x?v.x:x.x:y.x>x.x?y.x:x.x,F=v.y>y.y?v.y>x.y?v.y:x.y:y.y>x.y?y.y:x.y,k=Xv(v.x<y.x?v.x<x.x?v.x:x.x:y.x<x.x?y.x:x.x,v.y<y.y?v.y<x.y?v.y:x.y:y.y<x.y?y.y:x.y,o,l,p),U=Xv(R,F,o,l,p);let G=a.prevZ,Y=a.nextZ;for(;G&&G.z>=k&&Y&&Y.z<=U;){if(G!==a.prev&&G!==a.next&&tc(v.x,v.y,y.x,y.y,x.x,x.y,G.x,G.y)&&ss(G.prev,G,G.next)>=0||(G=G.prevZ,Y!==a.prev&&Y!==a.next&&tc(v.x,v.y,y.x,y.y,x.x,x.y,Y.x,Y.y)&&ss(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;G&&G.z>=k;){if(G!==a.prev&&G!==a.next&&tc(v.x,v.y,y.x,y.y,x.x,x.y,G.x,G.y)&&ss(G.prev,G,G.next)>=0)return!1;G=G.prevZ}for(;Y&&Y.z<=U;){if(Y!==a.prev&&Y!==a.next&&tc(v.x,v.y,y.x,y.y,x.x,x.y,Y.x,Y.y)&&ss(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function $h(a,o,l){let p=a;do{const v=p.prev,y=p.next.next;!Su(v,y)&&Zo(v,p,p.next,y)&&pp(v,y)&&pp(y,v)&&(o.push(v.i/l),o.push(p.i/l),o.push(y.i/l),kd(p),kd(p.next),p=a=y),p=p.next}while(p!==a);return xu(p)}function $v(a,o,l,p,v,y){let x=a;do{let E=x.next.next;for(;E!==x.prev;){if(x.i!==E.i&&fp(x,E)){let I=Cb(x,E);return x=xu(x,x.next),I=xu(I,I.next),Wh(x,o,l,p,v,y),void Wh(I,o,l,p,v,y)}E=E.next}x=x.next}while(x!==a)}function xb(a,o){return a.x-o.x}function k0(a,o){if(o=function Sb(a,o){let l=o;const p=a.x,v=a.y;let x,y=-1/0;do{if(v<=l.y&&v>=l.next.y&&l.next.y!==l.y){const U=l.x+(v-l.y)*(l.next.x-l.x)/(l.next.y-l.y);if(U<=p&&U>y){if(y=U,U===p){if(v===l.y)return l;if(v===l.next.y)return l.next}x=l.x<l.next.x?l:l.next}}l=l.next}while(l!==o);if(!x)return null;if(p===y)return x;const E=x,I=x.x,R=x.y;let k,F=1/0;l=x;do{p>=l.x&&l.x>=I&&p!==l.x&&tc(v<R?p:y,v,I,R,v<R?y:p,v,l.x,l.y)&&(k=Math.abs(v-l.y)/(p-l.x),pp(l,a)&&(k<F||k===F&&(l.x>x.x||l.x===x.x&&F0(x,l)))&&(x=l,F=k)),l=l.next}while(l!==E);return x}(a,o)){const l=Cb(o,a);xu(o,o.next),xu(l,l.next)}}function F0(a,o){return ss(a.prev,a,o.prev)<0&&ss(o.next,a,a.next)<0}function Xv(a,o,l,p,v){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-l)*v)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-p)*v)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function ig(a){let o=a,l=a;do{(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next}while(o!==a);return l}function tc(a,o,l,p,v,y,x,E){return(v-x)*(o-E)-(a-x)*(y-E)>=0&&(a-x)*(p-E)-(l-x)*(o-E)>=0&&(l-x)*(y-E)-(v-x)*(p-E)>=0}function fp(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function pT(a,o){let l=a;do{if(l.i!==a.i&&l.next.i!==a.i&&l.i!==o.i&&l.next.i!==o.i&&Zo(l,l.next,a,o))return!0;l=l.next}while(l!==a);return!1}(a,o)&&(pp(a,o)&&pp(o,a)&&function Yv(a,o){let l=a,p=!1;const v=(a.x+o.x)/2,y=(a.y+o.y)/2;do{l.y>y!=l.next.y>y&&l.next.y!==l.y&&v<(l.next.x-l.x)*(y-l.y)/(l.next.y-l.y)+l.x&&(p=!p),l=l.next}while(l!==a);return p}(a,o)&&(ss(a.prev,a,o.prev)||ss(a,o.prev,o))||Su(a,o)&&ss(a.prev,a,a.next)>0&&ss(o.prev,o,o.next)>0)}function ss(a,o,l){return(o.y-a.y)*(l.x-o.x)-(o.x-a.x)*(l.y-o.y)}function Su(a,o){return a.x===o.x&&a.y===o.y}function Zo(a,o,l,p){const v=qh(ss(a,o,l)),y=qh(ss(a,o,p)),x=qh(ss(l,p,a)),E=qh(ss(l,p,o));return!!(v!==y&&x!==E||0===v&&nc(a,l,o)||0===y&&nc(a,p,o)||0===x&&nc(l,a,p)||0===E&&nc(l,o,p))}function nc(a,o,l){return o.x<=Math.max(a.x,l.x)&&o.x>=Math.min(a.x,l.x)&&o.y<=Math.max(a.y,l.y)&&o.y>=Math.min(a.y,l.y)}function qh(a){return a>0?1:a<0?-1:0}function pp(a,o){return ss(a.prev,a,a.next)<0?ss(a,o,a.next)>=0&&ss(a,a.prev,o)>=0:ss(a,o,a.prev)<0||ss(a,a.next,o)<0}function Cb(a,o){const l=new mp(a.i,a.x,a.y),p=new mp(o.i,o.x,o.y),v=a.next,y=o.prev;return a.next=o,o.prev=a,l.next=v,v.prev=l,p.next=l,l.prev=p,y.next=p,p.prev=y,p}function co(a,o,l,p){const v=new mp(a,o,l);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function kd(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function mp(a,o,l){this.i=a,this.x=o,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const ic={area:function(a){const o=a.length;let l=0;for(let p=o-1,v=0;v<o;p=v++)l+=a[p].x*a[v].y-a[v].x*a[p].y;return.5*l},isClockWise:function(a){return ic.area(a)<0},triangulateShape:function(a,o){const l=[],p=[],v=[];B0(a),Xh(l,a);let y=a.length;o.forEach(B0);for(let E=0;E<o.length;E++)p.push(y),y+=o[E].length,Xh(l,o[E]);const x=L0_triangulate(l,p);for(let E=0;E<x.length;E+=3)v.push(x.slice(E,E+3));return v}};function B0(a){const o=a.length;o>2&&a[o-1].equals(a[0])&&a.pop()}function Xh(a,o){for(let l=0;l<o.length;l++)a.push(o[l].x),a.push(o[l].y)}class U0 extends xi{constructor(o,l){super(),this.type="ExtrudeGeometry",this.parameters={shapes:o,options:l},o=Array.isArray(o)?o:[o];const p=this,v=[],y=[];for(let E=0,I=o.length;E<I;E++)x(o[E]);function x(E){const I=[],R=void 0!==l.curveSegments?l.curveSegments:12,F=void 0!==l.steps?l.steps:1;let k=void 0!==l.depth?l.depth:100,U=void 0===l.bevelEnabled||l.bevelEnabled,G=void 0!==l.bevelThickness?l.bevelThickness:6,Y=void 0!==l.bevelSize?l.bevelSize:G-2,re=void 0!==l.bevelOffset?l.bevelOffset:0,ie=void 0!==l.bevelSegments?l.bevelSegments:3;const $=l.extrudePath,q=void 0!==l.UVGenerator?l.UVGenerator:gp;void 0!==l.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),k=l.amount);let Ae,Se,he,De,vt,Ie=!1;$&&(Ae=$.getSpacedPoints(F),Ie=!0,U=!1,Se=$.computeFrenetFrames(F,!1),he=new xe,De=new xe,vt=new xe),U||(ie=0,G=0,Y=0,re=0);const ke=E.extractPoints(R);let Qe=ke.shape;const tt=ke.holes;if(!ic.isClockWise(Qe)){Qe=Qe.reverse();for(let Vt=0,Zt=tt.length;Vt<Zt;Vt++){const un=tt[Vt];ic.isClockWise(un)&&(tt[Vt]=un.reverse())}}const Ze=ic.triangulateShape(Qe,tt),Ce=Qe;for(let Vt=0,Zt=tt.length;Vt<Zt;Vt++)Qe=Qe.concat(tt[Vt]);function Fe(Vt,Zt,un){return Zt||console.error("THREE.ExtrudeGeometry: vec does not exist"),Zt.clone().multiplyScalar(un).add(Vt)}const je=Qe.length,at=Ze.length;function Pt(Vt,Zt,un){let On,Ve,_e;const me=Vt.x-Zt.x,Et=Vt.y-Zt.y,_t=un.x-Vt.x,Le=un.y-Vt.y,Gt=me*me+Et*Et;if(Math.abs(me*Le-Et*_t)>Number.EPSILON){const Gn=Math.sqrt(Gt),mn=Math.sqrt(_t*_t+Le*Le),Vn=Zt.x-Et/Gn,$n=Zt.y+me/Gn,li=((un.x-Le/mn-Vn)*Le-(un.y+_t/mn-$n)*_t)/(me*Le-Et*_t);On=Vn+me*li-Vt.x,Ve=$n+Et*li-Vt.y;const ar=On*On+Ve*Ve;if(ar<=2)return new qe(On,Ve);_e=Math.sqrt(ar/2)}else{let Gn=!1;me>Number.EPSILON?_t>Number.EPSILON&&(Gn=!0):me<-Number.EPSILON?_t<-Number.EPSILON&&(Gn=!0):Math.sign(Et)===Math.sign(Le)&&(Gn=!0),Gn?(On=-Et,Ve=me,_e=Math.sqrt(Gt)):(On=me,Ve=Et,_e=Math.sqrt(Gt/2))}return new qe(On/_e,Ve/_e)}const xt=[];for(let Vt=0,Zt=Ce.length,un=Zt-1,On=Vt+1;Vt<Zt;Vt++,un++,On++)un===Zt&&(un=0),On===Zt&&(On=0),xt[Vt]=Pt(Ce[Vt],Ce[un],Ce[On]);const Ut=[];let qt,Qn=xt.concat();for(let Vt=0,Zt=tt.length;Vt<Zt;Vt++){const un=tt[Vt];qt=[];for(let On=0,Ve=un.length,_e=Ve-1,me=On+1;On<Ve;On++,_e++,me++)_e===Ve&&(_e=0),me===Ve&&(me=0),qt[On]=Pt(un[On],un[_e],un[me]);Ut.push(qt),Qn=Qn.concat(qt)}for(let Vt=0;Vt<ie;Vt++){const Zt=Vt/ie,un=G*Math.cos(Zt*Math.PI/2),On=Y*Math.sin(Zt*Math.PI/2)+re;for(let Ve=0,_e=Ce.length;Ve<_e;Ve++){const me=Fe(Ce[Ve],xt[Ve],On);Kn(me.x,me.y,-un)}for(let Ve=0,_e=tt.length;Ve<_e;Ve++){const me=tt[Ve];qt=Ut[Ve];for(let Et=0,_t=me.length;Et<_t;Et++){const Le=Fe(me[Et],qt[Et],On);Kn(Le.x,Le.y,-un)}}}const Un=Y+re;for(let Vt=0;Vt<je;Vt++){const Zt=U?Fe(Qe[Vt],Qn[Vt],Un):Qe[Vt];Ie?(De.copy(Se.normals[0]).multiplyScalar(Zt.x),he.copy(Se.binormals[0]).multiplyScalar(Zt.y),vt.copy(Ae[0]).add(De).add(he),Kn(vt.x,vt.y,vt.z)):Kn(Zt.x,Zt.y,0)}for(let Vt=1;Vt<=F;Vt++)for(let Zt=0;Zt<je;Zt++){const un=U?Fe(Qe[Zt],Qn[Zt],Un):Qe[Zt];Ie?(De.copy(Se.normals[Vt]).multiplyScalar(un.x),he.copy(Se.binormals[Vt]).multiplyScalar(un.y),vt.copy(Ae[Vt]).add(De).add(he),Kn(vt.x,vt.y,vt.z)):Kn(un.x,un.y,k/F*Vt)}for(let Vt=ie-1;Vt>=0;Vt--){const Zt=Vt/ie,un=G*Math.cos(Zt*Math.PI/2),On=Y*Math.sin(Zt*Math.PI/2)+re;for(let Ve=0,_e=Ce.length;Ve<_e;Ve++){const me=Fe(Ce[Ve],xt[Ve],On);Kn(me.x,me.y,k+un)}for(let Ve=0,_e=tt.length;Ve<_e;Ve++){const me=tt[Ve];qt=Ut[Ve];for(let Et=0,_t=me.length;Et<_t;Et++){const Le=Fe(me[Et],qt[Et],On);Ie?Kn(Le.x,Le.y+Ae[F-1].y,Ae[F-1].x+un):Kn(Le.x,Le.y,k+un)}}}function is(Vt,Zt){let un=Vt.length;for(;--un>=0;){const On=un;let Ve=un-1;Ve<0&&(Ve=Vt.length-1);for(let _e=0,me=F+2*ie;_e<me;_e++){const Et=je*_e,_t=je*(_e+1);ri(Zt+On+Et,Zt+Ve+Et,Zt+Ve+_t,Zt+On+_t)}}}function Kn(Vt,Zt,un){I.push(Vt),I.push(Zt),I.push(un)}function Ni(Vt,Zt,un){Hi(Vt),Hi(Zt),Hi(un);const On=v.length/3,Ve=q.generateTopUV(p,v,On-3,On-2,On-1);si(Ve[0]),si(Ve[1]),si(Ve[2])}function ri(Vt,Zt,un,On){Hi(Vt),Hi(Zt),Hi(On),Hi(Zt),Hi(un),Hi(On);const Ve=v.length/3,_e=q.generateSideWallUV(p,v,Ve-6,Ve-3,Ve-2,Ve-1);si(_e[0]),si(_e[1]),si(_e[3]),si(_e[1]),si(_e[2]),si(_e[3])}function Hi(Vt){v.push(I[3*Vt+0]),v.push(I[3*Vt+1]),v.push(I[3*Vt+2])}function si(Vt){y.push(Vt.x),y.push(Vt.y)}(function ki(){const Vt=v.length/3;if(U){let Zt=0,un=je*Zt;for(let On=0;On<at;On++){const Ve=Ze[On];Ni(Ve[2]+un,Ve[1]+un,Ve[0]+un)}Zt=F+2*ie,un=je*Zt;for(let On=0;On<at;On++){const Ve=Ze[On];Ni(Ve[0]+un,Ve[1]+un,Ve[2]+un)}}else{for(let Zt=0;Zt<at;Zt++){const un=Ze[Zt];Ni(un[2],un[1],un[0])}for(let Zt=0;Zt<at;Zt++){const un=Ze[Zt];Ni(un[0]+je*F,un[1]+je*F,un[2]+je*F)}}p.addGroup(Vt,v.length/3-Vt,0)})(),function mt(){const Vt=v.length/3;let Zt=0;is(Ce,Zt),Zt+=Ce.length;for(let un=0,On=tt.length;un<On;un++){const Ve=tt[un];is(Ve,Zt),Zt+=Ve.length}p.addGroup(Vt,v.length/3-Vt,1)}()}this.setAttribute("position",new zi(v,3)),this.setAttribute("uv",new zi(y,2)),this.computeVertexNormals()}toJSON(){const o=xi.prototype.toJSON.call(this);return function Qv(a,o,l){if(l.shapes=[],Array.isArray(a))for(let p=0,v=a.length;p<v;p++)l.shapes.push(a[p].uuid);else l.shapes.push(a.uuid);return void 0!==o.extrudePath&&(l.options.extrudePath=o.extrudePath.toJSON()),l}(this.parameters.shapes,this.parameters.options,o)}}const gp={generateTopUV:function(a,o,l,p,v){const E=o[3*p],I=o[3*p+1],R=o[3*v],F=o[3*v+1];return[new qe(o[3*l],o[3*l+1]),new qe(E,I),new qe(R,F)]},generateSideWallUV:function(a,o,l,p,v,y){const x=o[3*l],E=o[3*l+1],I=o[3*l+2],R=o[3*p],F=o[3*p+1],k=o[3*p+2],U=o[3*v],G=o[3*v+1],Y=o[3*v+2],re=o[3*y],ie=o[3*y+1],$=o[3*y+2];return Math.abs(E-F)<.01?[new qe(x,1-I),new qe(R,1-k),new qe(U,1-Y),new qe(re,1-$)]:[new qe(E,1-I),new qe(F,1-k),new qe(G,1-Y),new qe(ie,1-$)]}};function vp(a,o,l){xi.call(this),this.type="ParametricGeometry",this.parameters={func:a,slices:o,stacks:l};const p=[],v=[],y=[],x=[],E=1e-5,I=new xe,R=new xe,F=new xe,k=new xe,U=new xe;a.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const G=o+1;for(let Y=0;Y<=l;Y++){const re=Y/l;for(let ie=0;ie<=o;ie++){const $=ie/o;a($,re,R),v.push(R.x,R.y,R.z),$-E>=0?(a($-E,re,F),k.subVectors(R,F)):(a($+E,re,F),k.subVectors(F,R)),re-E>=0?(a($,re-E,F),U.subVectors(R,F)):(a($,re+E,F),U.subVectors(F,R)),I.crossVectors(k,U).normalize(),y.push(I.x,I.y,I.z),x.push($,re)}}for(let Y=0;Y<l;Y++)for(let re=0;re<o;re++){const $=Y*G+re+1,q=(Y+1)*G+re+1,Ae=(Y+1)*G+re;p.push(Y*G+re,$,Ae),p.push($,q,Ae)}this.setIndex(p),this.setAttribute("position",new zi(v,3)),this.setAttribute("normal",new zi(y,3)),this.setAttribute("uv",new zi(x,2))}(vp.prototype=Object.create(xi.prototype)).constructor=vp;class V0 extends xi{constructor(o,l=12){super(),this.type="ShapeGeometry",this.parameters={shapes:o,curveSegments:l};const p=[],v=[],y=[],x=[];let E=0,I=0;if(!1===Array.isArray(o))R(o);else for(let F=0;F<o.length;F++)R(o[F]),this.addGroup(E,I,F),E+=I,I=0;function R(F){const k=v.length/3,U=F.extractPoints(l);let G=U.shape;const Y=U.holes;!1===ic.isClockWise(G)&&(G=G.reverse());for(let ie=0,$=Y.length;ie<$;ie++){const q=Y[ie];!0===ic.isClockWise(q)&&(Y[ie]=q.reverse())}const re=ic.triangulateShape(G,Y);for(let ie=0,$=Y.length;ie<$;ie++)G=G.concat(Y[ie]);for(let ie=0,$=G.length;ie<$;ie++){const q=G[ie];v.push(q.x,q.y,0),y.push(0,0,1),x.push(q.x,q.y)}for(let ie=0,$=re.length;ie<$;ie++){const q=re[ie];p.push(q[0]+k,q[1]+k,q[2]+k),I+=3}}this.setIndex(p),this.setAttribute("position",new zi(v,3)),this.setAttribute("normal",new zi(y,3)),this.setAttribute("uv",new zi(x,2))}toJSON(){const o=xi.prototype.toJSON.call(this);return function mT(a,o){if(o.shapes=[],Array.isArray(a))for(let l=0,p=a.length;l<p;l++)o.shapes.push(a[l].uuid);else o.shapes.push(a.uuid);return o}(this.parameters.shapes,o)}}class Eu extends xi{constructor(o=1,l=8,p=6,v=0,y=2*Math.PI,x=0,E=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:o,widthSegments:l,heightSegments:p,phiStart:v,phiLength:y,thetaStart:x,thetaLength:E},l=Math.max(3,Math.floor(l)),p=Math.max(2,Math.floor(p));const I=Math.min(x+E,Math.PI);let R=0;const F=[],k=new xe,U=new xe,G=[],Y=[],re=[],ie=[];for(let $=0;$<=p;$++){const q=[],Ae=$/p;let Ie=0;0==$&&0==x?Ie=.5/l:$==p&&I==Math.PI&&(Ie=-.5/l);for(let Se=0;Se<=l;Se++){const he=Se/l;k.x=-o*Math.cos(v+he*y)*Math.sin(x+Ae*E),k.y=o*Math.cos(x+Ae*E),k.z=o*Math.sin(v+he*y)*Math.sin(x+Ae*E),Y.push(k.x,k.y,k.z),U.copy(k).normalize(),re.push(U.x,U.y,U.z),ie.push(he+Ie,1-Ae),q.push(R++)}F.push(q)}for(let $=0;$<p;$++)for(let q=0;q<l;q++){const Ae=F[$][q+1],Ie=F[$][q],Se=F[$+1][q],he=F[$+1][q+1];(0!==$||x>0)&&G.push(Ae,Ie,he),($!==p-1||I<Math.PI)&&G.push(Ie,Se,he)}this.setIndex(G),this.setAttribute("position",new zi(Y,3)),this.setAttribute("normal",new zi(re,3)),this.setAttribute("uv",new zi(ie,2))}}function rc(a){_i.call(this),this.type="ShadowMaterial",this.color=new ei(0),this.transparent=!0,this.setValues(a)}function Yh(a){Ws.call(this,a),this.type="RawShaderMaterial"}function Jo(a){_i.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ei(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(a)}function sc(a){Jo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new qe(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(o){this.reflectivity=pi.clamp(2.5*(o-1)/(o+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(a)}function Gc(a){_i.call(this),this.type="MeshPhongMaterial",this.color=new ei(16777215),this.specular=new ei(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function ac(a){_i.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ei(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function Qh(a){_i.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function Kh(a){_i.call(this),this.type="MeshLambertMaterial",this.color=new ei(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function zl(a){_i.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ei(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function Fd(a){jl.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}(rc.prototype=Object.create(_i.prototype)).constructor=rc,rc.prototype.isShadowMaterial=!0,rc.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this},(Yh.prototype=Object.create(Ws.prototype)).constructor=Yh,Yh.prototype.isRawShaderMaterial=!0,(Jo.prototype=Object.create(_i.prototype)).constructor=Jo,Jo.prototype.isMeshStandardMaterial=!0,Jo.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapIntensity=a.envMapIntensity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.vertexTangents=a.vertexTangents,this},(sc.prototype=Object.create(Jo.prototype)).constructor=sc,sc.prototype.isMeshPhysicalMaterial=!0,sc.prototype.copy=function(a){return Jo.prototype.copy.call(this,a),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.reflectivity=a.reflectivity,this.sheen=a.sheen?(this.sheen||new ei).copy(a.sheen):null,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this},(Gc.prototype=Object.create(_i.prototype)).constructor=Gc,Gc.prototype.isMeshPhongMaterial=!0,Gc.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},(ac.prototype=Object.create(_i.prototype)).constructor=ac,ac.prototype.isMeshToonMaterial=!0,ac.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},(Qh.prototype=Object.create(_i.prototype)).constructor=Qh,Qh.prototype.isMeshNormalMaterial=!0,Qh.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},(Kh.prototype=Object.create(_i.prototype)).constructor=Kh,Kh.prototype.isMeshLambertMaterial=!0,Kh.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},(zl.prototype=Object.create(_i.prototype)).constructor=zl,zl.prototype.isMeshMatcapMaterial=!0,zl.prototype.copy=function(a){return _i.prototype.copy.call(this,a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},(Fd.prototype=Object.create(jl.prototype)).constructor=Fd,Fd.prototype.isLineDashedMaterial=!0,Fd.prototype.copy=function(a){return jl.prototype.copy.call(this,a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this};var H0=Object.freeze({__proto__:null,ShadowMaterial:rc,SpriteMaterial:Qo,RawShaderMaterial:Yh,ShaderMaterial:Ws,PointsMaterial:uo,MeshPhysicalMaterial:sc,MeshStandardMaterial:Jo,MeshPhongMaterial:Gc,MeshToonMaterial:ac,MeshNormalMaterial:Qh,MeshLambertMaterial:Kh,MeshDepthMaterial:gl,MeshDistanceMaterial:wu,MeshBasicMaterial:Pa,MeshMatcapMaterial:zl,LineDashedMaterial:Fd,LineBasicMaterial:jl,Material:_i});const ts={arraySlice:function(a,o,l){return ts.isTypedArray(a)?new a.constructor(a.subarray(o,void 0!==l?l:a.length)):a.slice(o,l)},convertArray:function(a,o,l){return!a||!l&&a.constructor===o?a:"number"==typeof o.BYTES_PER_ELEMENT?new o(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){const l=a.length,p=new Array(l);for(let v=0;v!==l;++v)p[v]=v;return p.sort(function o(v,y){return a[v]-a[y]}),p},sortedArray:function(a,o,l){const p=a.length,v=new a.constructor(p);for(let y=0,x=0;x!==p;++y){const E=l[y]*o;for(let I=0;I!==o;++I)v[x++]=a[E+I]}return v},flattenJSON:function(a,o,l,p){let v=1,y=a[0];for(;void 0!==y&&void 0===y[p];)y=a[v++];if(void 0===y)return;let x=y[p];if(void 0!==x)if(Array.isArray(x))do{x=y[p],void 0!==x&&(o.push(y.time),l.push.apply(l,x)),y=a[v++]}while(void 0!==y);else if(void 0!==x.toArray)do{x=y[p],void 0!==x&&(o.push(y.time),x.toArray(l,l.length)),y=a[v++]}while(void 0!==y);else do{x=y[p],void 0!==x&&(o.push(y.time),l.push(x)),y=a[v++]}while(void 0!==y)},subclip:function(a,o,l,p,v=30){const y=a.clone();y.name=o;const x=[];for(let I=0;I<y.tracks.length;++I){const R=y.tracks[I],F=R.getValueSize(),k=[],U=[];for(let G=0;G<R.times.length;++G){const Y=R.times[G]*v;if(!(Y<l||Y>=p)){k.push(R.times[G]);for(let re=0;re<F;++re)U.push(R.values[G*F+re])}}0!==k.length&&(R.times=ts.convertArray(k,R.times.constructor),R.values=ts.convertArray(U,R.values.constructor),x.push(R))}y.tracks=x;let E=1/0;for(let I=0;I<y.tracks.length;++I)E>y.tracks[I].times[0]&&(E=y.tracks[I].times[0]);for(let I=0;I<y.tracks.length;++I)y.tracks[I].shift(-1*E);return y.resetDuration(),y},makeClipAdditive:function(a,o=0,l=a,p=30){p<=0&&(p=30);const v=l.tracks.length,y=o/p;for(let x=0;x<v;++x){const E=l.tracks[x],I=E.ValueTypeName;if("bool"===I||"string"===I)continue;const R=a.tracks.find(function($){return $.name===E.name&&$.ValueTypeName===I});if(void 0===R)continue;let F=0;const k=E.getValueSize();E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(F=k/3);let U=0;const G=R.getValueSize();R.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(U=G/3);const Y=E.times.length-1;let re;if(y<=E.times[0])re=ts.arraySlice(E.values,F,k-F);else if(y>=E.times[Y]){const $=Y*k+F;re=ts.arraySlice(E.values,$,$+k-F)}else{const $=E.createInterpolant(),q=F,Ae=k-F;$.evaluate(y),re=ts.arraySlice($.resultBuffer,q,Ae)}"quaternion"===I&&(new ci).fromArray(re).normalize().conjugate().toArray(re);const ie=R.times.length;for(let $=0;$<ie;++$){const q=$*G+U;if("quaternion"===I)ci.multiplyQuaternionsFlat(R.values,q,re,0,R.values,q);else{const Ae=G-2*U;for(let Ie=0;Ie<Ae;++Ie)R.values[q+Ie]-=re[Ie]}}}return a.blendMode=2501,a}};function el(a,o,l,p){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=void 0!==p?p:new o.constructor(l),this.sampleValues=o,this.valueSize=l}function Zh(a,o,l,p){el.call(this,a,o,l,p),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function rg(a,o,l,p){el.call(this,a,o,l,p)}function _p(a,o,l,p){el.call(this,a,o,l,p)}function ps(a,o,l,p){if(void 0===a)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===o||0===o.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=ts.convertArray(o,this.TimeBufferType),this.values=ts.convertArray(l,this.ValueBufferType),this.setInterpolation(p||this.DefaultInterpolation)}function yp(a,o,l){ps.call(this,a,o,l)}function oc(a,o,l,p){ps.call(this,a,o,l,p)}function jc(a,o,l,p){ps.call(this,a,o,l,p)}function sg(a,o,l,p){el.call(this,a,o,l,p)}function Jh(a,o,l,p){ps.call(this,a,o,l,p)}function Kv(a,o,l,p){ps.call(this,a,o,l,p)}function Fa(a,o,l,p){ps.call(this,a,o,l,p)}function Ds(a,o=-1,l,p=2500){this.name=a,this.tracks=l,this.duration=o,this.blendMode=p,this.uuid=pi.generateUUID(),this.duration<0&&this.resetDuration()}function Zv(a){if(void 0===a.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const o=function Mo(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return jc;case"vector":case"vector2":case"vector3":case"vector4":return Fa;case"color":return oc;case"quaternion":return Jh;case"bool":case"boolean":return yp;case"string":return Kv}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}(a.type);if(void 0===a.times){const l=[],p=[];ts.flattenJSON(a.keys,l,p,"value"),a.times=l,a.values=p}return void 0!==o.parse?o.parse(a):new o(a.name,a.times,a.values,a.interpolation)}Object.assign(el.prototype,{evaluate:function(a){const o=this.parameterPositions;let l=this._cachedIndex,p=o[l],v=o[l-1];e:{t:{let y;n:{i:if(!(a<p)){for(let x=l+2;;){if(void 0===p){if(a<v)break i;return l=o.length,this._cachedIndex=l,this.afterEnd_(l-1,a,v)}if(l===x)break;if(v=p,p=o[++l],a<p)break t}y=o.length;break n}if(a>=v)break e;{const x=o[1];a<x&&(l=2,v=x);for(let E=l-2;;){if(void 0===v)return this._cachedIndex=0,this.beforeStart_(0,a,p);if(l===E)break;if(p=v,v=o[--l-1],a>=v)break t}y=l,l=0}}for(;l<y;){const x=l+y>>>1;a<o[x]?y=x:l=x+1}if(p=o[l],v=o[l-1],void 0===v)return this._cachedIndex=0,this.beforeStart_(0,a,p);if(void 0===p)return l=o.length,this._cachedIndex=l,this.afterEnd_(l-1,v,a)}this._cachedIndex=l,this.intervalChanged_(l,v,p)}return this.interpolate_(l,v,a,p)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(a){const o=this.resultBuffer,l=this.sampleValues,p=this.valueSize,v=a*p;for(let y=0;y!==p;++y)o[y]=l[v+y];return o},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(el.prototype,{beforeStart_:el.prototype.copySampleValue_,afterEnd_:el.prototype.copySampleValue_}),Zh.prototype=Object.assign(Object.create(el.prototype),{constructor:Zh,DefaultSettings_:{endingStart:oh,endingEnd:oh},intervalChanged_:function(a,o,l){const p=this.parameterPositions;let v=a-2,y=a+1,x=p[v],E=p[y];if(void 0===x)switch(this.getSettings_().endingStart){case ad:v=a,x=2*o-l;break;case 2402:v=p.length-2,x=o+p[v]-p[v+1];break;default:v=a,x=l}if(void 0===E)switch(this.getSettings_().endingEnd){case ad:y=a,E=2*l-o;break;case 2402:y=1,E=l+p[1]-p[0];break;default:y=a-1,E=o}const I=.5*(l-o),R=this.valueSize;this._weightPrev=I/(o-x),this._weightNext=I/(E-l),this._offsetPrev=v*R,this._offsetNext=y*R},interpolate_:function(a,o,l,p){const v=this.resultBuffer,y=this.sampleValues,x=this.valueSize,E=a*x,I=E-x,R=this._offsetPrev,F=this._offsetNext,k=this._weightPrev,U=this._weightNext,G=(l-o)/(p-o),Y=G*G,re=Y*G,ie=-k*re+2*k*Y-k*G,$=(1+k)*re+(-1.5-2*k)*Y+(-.5+k)*G+1,q=(-1-U)*re+(1.5+U)*Y+.5*G,Ae=U*re-U*Y;for(let Ie=0;Ie!==x;++Ie)v[Ie]=ie*y[R+Ie]+$*y[I+Ie]+q*y[E+Ie]+Ae*y[F+Ie];return v}}),rg.prototype=Object.assign(Object.create(el.prototype),{constructor:rg,interpolate_:function(a,o,l,p){const v=this.resultBuffer,y=this.sampleValues,x=this.valueSize,E=a*x,I=E-x,R=(l-o)/(p-o),F=1-R;for(let k=0;k!==x;++k)v[k]=y[I+k]*F+y[E+k]*R;return v}}),_p.prototype=Object.assign(Object.create(el.prototype),{constructor:_p,interpolate_:function(a){return this.copySampleValue_(a-1)}}),Object.assign(ps,{toJSON:function(a){const o=a.constructor;let l;if(void 0!==o.toJSON)l=o.toJSON(a);else{l={name:a.name,times:ts.convertArray(a.times,Array),values:ts.convertArray(a.values,Array)};const p=a.getInterpolation();p!==a.DefaultInterpolation&&(l.interpolation=p)}return l.type=a.ValueTypeName,l}}),Object.assign(ps.prototype,{constructor:ps,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(a){return new _p(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new rg(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new Zh(this.times,this.values,this.getValueSize(),a)},setInterpolation:function(a){let o;switch(a){case 2300:o=this.InterpolantFactoryMethodDiscrete;break;case 2301:o=this.InterpolantFactoryMethodLinear;break;case 2302:o=this.InterpolantFactoryMethodSmooth}if(void 0===o){const l="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(a===this.DefaultInterpolation)throw new Error(l);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",l),this}return this.createInterpolant=o,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a){const o=this.times;for(let l=0,p=o.length;l!==p;++l)o[l]+=a}return this},scale:function(a){if(1!==a){const o=this.times;for(let l=0,p=o.length;l!==p;++l)o[l]*=a}return this},trim:function(a,o){const l=this.times,p=l.length;let v=0,y=p-1;for(;v!==p&&l[v]<a;)++v;for(;-1!==y&&l[y]>o;)--y;if(++y,0!==v||y!==p){v>=y&&(y=Math.max(y,1),v=y-1);const x=this.getValueSize();this.times=ts.arraySlice(l,v,y),this.values=ts.arraySlice(this.values,v*x,y*x)}return this},validate:function(){let a=!0;const o=this.getValueSize();o-Math.floor(o)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);const l=this.times,p=this.values,v=l.length;0===v&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let y=null;for(let x=0;x!==v;x++){const E=l[x];if("number"==typeof E&&isNaN(E)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,x,E),a=!1;break}if(null!==y&&y>E){console.error("THREE.KeyframeTrack: Out of order keys.",this,x,E,y),a=!1;break}y=E}if(void 0!==p&&ts.isTypedArray(p))for(let x=0,E=p.length;x!==E;++x){const I=p[x];if(isNaN(I)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,x,I),a=!1;break}}return a},optimize:function(){const a=ts.arraySlice(this.times),o=ts.arraySlice(this.values),l=this.getValueSize(),p=2302===this.getInterpolation(),v=a.length-1;let y=1;for(let x=1;x<v;++x){let E=!1;const I=a[x];if(I!==a[x+1]&&(1!==x||I!==a[0]))if(p)E=!0;else{const F=x*l,k=F-l,U=F+l;for(let G=0;G!==l;++G){const Y=o[F+G];if(Y!==o[k+G]||Y!==o[U+G]){E=!0;break}}}if(E){if(x!==y){a[y]=a[x];const F=x*l,k=y*l;for(let U=0;U!==l;++U)o[k+U]=o[F+U]}++y}}if(v>0){a[y]=a[v];for(let x=v*l,E=y*l,I=0;I!==l;++I)o[E+I]=o[x+I];++y}return y!==a.length?(this.times=ts.arraySlice(a,0,y),this.values=ts.arraySlice(o,0,y*l)):(this.times=a,this.values=o),this},clone:function(){const a=ts.arraySlice(this.times,0),o=ts.arraySlice(this.values,0),p=new(0,this.constructor)(this.name,a,o);return p.createInterpolant=this.createInterpolant,p}}),yp.prototype=Object.assign(Object.create(ps.prototype),{constructor:yp,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),oc.prototype=Object.assign(Object.create(ps.prototype),{constructor:oc,ValueTypeName:"color"}),jc.prototype=Object.assign(Object.create(ps.prototype),{constructor:jc,ValueTypeName:"number"}),sg.prototype=Object.assign(Object.create(el.prototype),{constructor:sg,interpolate_:function(a,o,l,p){const v=this.resultBuffer,y=this.sampleValues,x=this.valueSize,E=(l-o)/(p-o);let I=a*x;for(let R=I+x;I!==R;I+=4)ci.slerpFlat(v,0,y,I-x,y,I,E);return v}}),Jh.prototype=Object.assign(Object.create(ps.prototype),{constructor:Jh,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(a){return new sg(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:void 0}),Kv.prototype=Object.assign(Object.create(ps.prototype),{constructor:Kv,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Fa.prototype=Object.assign(Object.create(ps.prototype),{constructor:Fa,ValueTypeName:"vector"}),Object.assign(Ds,{parse:function(a){const o=[],l=a.tracks,p=1/(a.fps||1);for(let y=0,x=l.length;y!==x;++y)o.push(Zv(l[y]).scale(p));const v=new Ds(a.name,a.duration,o,a.blendMode);return v.uuid=a.uuid,v},toJSON:function(a){const o=[],l=a.tracks,p={name:a.name,duration:a.duration,tracks:o,uuid:a.uuid,blendMode:a.blendMode};for(let v=0,y=l.length;v!==y;++v)o.push(ps.toJSON(l[v]));return p},CreateFromMorphTargetSequence:function(a,o,l,p){const v=o.length,y=[];for(let x=0;x<v;x++){let E=[],I=[];E.push((x+v-1)%v,x,(x+1)%v),I.push(0,1,0);const R=ts.getKeyframeOrder(E);E=ts.sortedArray(E,1,R),I=ts.sortedArray(I,1,R),!p&&0===E[0]&&(E.push(v),I.push(I[0])),y.push(new jc(".morphTargetInfluences["+o[x].name+"]",E,I).scale(1/l))}return new Ds(a,-1,y)},findByName:function(a,o){let l=a;if(!Array.isArray(a)){const p=a;l=p.geometry&&p.geometry.animations||p.animations}for(let p=0;p<l.length;p++)if(l[p].name===o)return l[p];return null},CreateClipsFromMorphTargetSequences:function(a,o,l){const p={},v=/^([\w-]*?)([\d]+)$/;for(let x=0,E=a.length;x<E;x++){const I=a[x],R=I.name.match(v);if(R&&R.length>1){const F=R[1];let k=p[F];k||(p[F]=k=[]),k.push(I)}}const y=[];for(const x in p)y.push(Ds.CreateFromMorphTargetSequence(x,p[x],o,l));return y},parseAnimation:function(a,o){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const l=function(F,k,U,G,Y){if(0!==U.length){const re=[],ie=[];ts.flattenJSON(U,re,ie,G),0!==re.length&&Y.push(new F(k,re,ie))}},p=[],v=a.name||"default",y=a.fps||30,x=a.blendMode;let E=a.length||-1;const I=a.hierarchy||[];for(let F=0;F<I.length;F++){const k=I[F].keys;if(k&&0!==k.length)if(k[0].morphTargets){const U={};let G;for(G=0;G<k.length;G++)if(k[G].morphTargets)for(let Y=0;Y<k[G].morphTargets.length;Y++)U[k[G].morphTargets[Y]]=-1;for(const Y in U){const re=[],ie=[];for(let $=0;$!==k[G].morphTargets.length;++$){const q=k[G];re.push(q.time),ie.push(q.morphTarget===Y?1:0)}p.push(new jc(".morphTargetInfluence["+Y+"]",re,ie))}E=U.length*(y||1)}else{const U=".bones["+o[F].name+"]";l(Fa,U+".position",k,"pos",p),l(Jh,U+".quaternion",k,"rot",p),l(Fa,U+".scale",k,"scl",p)}}return 0===p.length?null:new Ds(v,E,p,x)}}),Object.assign(Ds.prototype,{resetDuration:function(){let o=0;for(let l=0,p=this.tracks.length;l!==p;++l){const v=this.tracks[l];o=Math.max(o,v.times[v.times.length-1])}return this.duration=o,this},trim:function(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},validate:function(){let a=!0;for(let o=0;o<this.tracks.length;o++)a=a&&this.tracks[o].validate();return a},optimize:function(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this},clone:function(){const a=[];for(let o=0;o<this.tracks.length;o++)a.push(this.tracks[o].clone());return new Ds(this.name,this.duration,a,this.blendMode)},toJSON:function(){return Ds.toJSON(this)}});const zc={enabled:!1,files:{},add:function(a,o){!1!==this.enabled&&(this.files[a]=o)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};const Jv=new function ag(a,o,l){const p=this;let E,v=!1,y=0,x=0;const I=[];this.onStart=void 0,this.onLoad=a,this.onProgress=o,this.onError=l,this.itemStart=function(R){x++,!1===v&&void 0!==p.onStart&&p.onStart(R,y,x),v=!0},this.itemEnd=function(R){y++,void 0!==p.onProgress&&p.onProgress(R,y,x),y===x&&(v=!1,void 0!==p.onLoad&&p.onLoad())},this.itemError=function(R){void 0!==p.onError&&p.onError(R)},this.resolveURL=function(R){return E?E(R):R},this.setURLModifier=function(R){return E=R,this},this.addHandler=function(R,F){return I.push(R,F),this},this.removeHandler=function(R){const F=I.indexOf(R);return-1!==F&&I.splice(F,2),this},this.getHandler=function(R){for(let F=0,k=I.length;F<k;F+=2){const U=I[F],G=I[F+1];if(U.global&&(U.lastIndex=0),U.test(R))return G}return null}};function Mr(a){this.manager=void 0!==a?a:Jv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Mr.prototype,{load:function(){},loadAsync:function(a,o){const l=this;return new Promise(function(p,v){l.load(a,p,o,v)})},parse:function(){},setCrossOrigin:function(a){return this.crossOrigin=a,this},setWithCredentials:function(a){return this.withCredentials=a,this},setPath:function(a){return this.path=a,this},setResourcePath:function(a){return this.resourcePath=a,this},setRequestHeader:function(a){return this.requestHeader=a,this}});const Io={};function Cu(a){Mr.call(this,a)}function og(a){Mr.call(this,a)}function lg(a){Mr.call(this,a)}function ef(a){Mr.call(this,a)}function Bd(a){Mr.call(this,a)}function G0(a){Mr.call(this,a)}function ug(a){Mr.call(this,a)}function ti(){this.type="Curve",this.arcLengthDivisions=200}function ho(a,o,l,p,v,y,x,E){ti.call(this),this.type="EllipseCurve",this.aX=a||0,this.aY=o||0,this.xRadius=l||1,this.yRadius=p||1,this.aStartAngle=v||0,this.aEndAngle=y||2*Math.PI,this.aClockwise=x||!1,this.aRotation=E||0}function Wc(a,o,l,p,v,y){ho.call(this,a,o,l,l,p,v,y),this.type="ArcCurve"}function bp(){let a=0,o=0,l=0,p=0;function v(y,x,E,I){a=y,o=E,l=-3*y+3*x-2*E-I,p=2*y-2*x+E+I}return{initCatmullRom:function(y,x,E,I,R){v(x,E,R*(E-y),R*(I-x))},initNonuniformCatmullRom:function(y,x,E,I,R,F,k){let U=(x-y)/R-(E-y)/(R+F)+(E-x)/F,G=(E-x)/F-(I-x)/(F+k)+(I-E)/k;U*=F,G*=F,v(x,E,U,G)},calc:function(y){const x=y*y;return a+o*y+l*x+p*(x*y)}}}Cu.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Cu,load:function(a,o,l,p){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);const v=this,y=zc.get(a);if(void 0!==y)return v.manager.itemStart(a),setTimeout(function(){o&&o(y),v.manager.itemEnd(a)},0),y;if(void 0!==Io[a])return void Io[a].push({onLoad:o,onProgress:l,onError:p});const E=a.match(/^data:(.*?)(;base64)?,(.*)$/);let I;if(E){const R=E[1],F=!!E[2];let k=E[3];k=decodeURIComponent(k),F&&(k=atob(k));try{let U;const G=(this.responseType||"").toLowerCase();switch(G){case"arraybuffer":case"blob":const Y=new Uint8Array(k.length);for(let ie=0;ie<k.length;ie++)Y[ie]=k.charCodeAt(ie);U="blob"===G?new Blob([Y.buffer],{type:R}):Y.buffer;break;case"document":U=(new DOMParser).parseFromString(k,R);break;case"json":U=JSON.parse(k);break;default:U=k}setTimeout(function(){o&&o(U),v.manager.itemEnd(a)},0)}catch(U){setTimeout(function(){p&&p(U),v.manager.itemError(a),v.manager.itemEnd(a)},0)}}else{Io[a]=[],Io[a].push({onLoad:o,onProgress:l,onError:p}),I=new XMLHttpRequest,I.open("GET",a,!0),I.addEventListener("load",function(R){const F=this.response,k=Io[a];if(delete Io[a],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),zc.add(a,F);for(let U=0,G=k.length;U<G;U++){const Y=k[U];Y.onLoad&&Y.onLoad(F)}v.manager.itemEnd(a)}else{for(let U=0,G=k.length;U<G;U++){const Y=k[U];Y.onError&&Y.onError(R)}v.manager.itemError(a),v.manager.itemEnd(a)}},!1),I.addEventListener("progress",function(R){const F=Io[a];for(let k=0,U=F.length;k<U;k++){const G=F[k];G.onProgress&&G.onProgress(R)}},!1),I.addEventListener("error",function(R){const F=Io[a];delete Io[a];for(let k=0,U=F.length;k<U;k++){const G=F[k];G.onError&&G.onError(R)}v.manager.itemError(a),v.manager.itemEnd(a)},!1),I.addEventListener("abort",function(R){const F=Io[a];delete Io[a];for(let k=0,U=F.length;k<U;k++){const G=F[k];G.onError&&G.onError(R)}v.manager.itemError(a),v.manager.itemEnd(a)},!1),void 0!==this.responseType&&(I.responseType=this.responseType),void 0!==this.withCredentials&&(I.withCredentials=this.withCredentials),I.overrideMimeType&&I.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const R in this.requestHeader)I.setRequestHeader(R,this.requestHeader[R]);I.send(null)}return v.manager.itemStart(a),I},setResponseType:function(a){return this.responseType=a,this},setMimeType:function(a){return this.mimeType=a,this}}),og.prototype=Object.assign(Object.create(Mr.prototype),{constructor:og,load:function(a,o,l,p){const v=this,y=new Cu(v.manager);y.setPath(v.path),y.setRequestHeader(v.requestHeader),y.setWithCredentials(v.withCredentials),y.load(a,function(x){try{o(v.parse(JSON.parse(x)))}catch(E){p?p(E):console.error(E),v.manager.itemError(a)}},l,p)},parse:function(a){const o=[];for(let l=0;l<a.length;l++){const p=Ds.parse(a[l]);o.push(p)}return o}}),lg.prototype=Object.assign(Object.create(Mr.prototype),{constructor:lg,load:function(a,o,l,p){const v=this,y=[],x=new Ld,E=new Cu(this.manager);E.setPath(this.path),E.setResponseType("arraybuffer"),E.setRequestHeader(this.requestHeader),E.setWithCredentials(v.withCredentials);let I=0;function R(F){E.load(a[F],function(k){const U=v.parse(k,!0);y[F]={width:U.width,height:U.height,format:U.format,mipmaps:U.mipmaps},I+=1,6===I&&(1===U.mipmapCount&&(x.minFilter=oe),x.image=y,x.format=U.format,x.needsUpdate=!0,o&&o(x))},l,p)}if(Array.isArray(a))for(let F=0,k=a.length;F<k;++F)R(F);else E.load(a,function(F){const k=v.parse(F,!0);if(k.isCubemap){const U=k.mipmaps.length/k.mipmapCount;for(let G=0;G<U;G++){y[G]={mipmaps:[]};for(let Y=0;Y<k.mipmapCount;Y++)y[G].mipmaps.push(k.mipmaps[G*k.mipmapCount+Y]),y[G].format=k.format,y[G].width=k.width,y[G].height=k.height}x.image=y}else x.image.width=k.width,x.image.height=k.height,x.mipmaps=k.mipmaps;1===k.mipmapCount&&(x.minFilter=oe),x.format=k.format,x.needsUpdate=!0,o&&o(x)},l,p);return x}}),ef.prototype=Object.assign(Object.create(Mr.prototype),{constructor:ef,load:function(a,o,l,p){void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);const v=this,y=zc.get(a);if(void 0!==y)return v.manager.itemStart(a),setTimeout(function(){o&&o(y),v.manager.itemEnd(a)},0),y;const x=document.createElementNS("http://www.w3.org/1999/xhtml","img");function E(){x.removeEventListener("load",E,!1),x.removeEventListener("error",I,!1),zc.add(a,this),o&&o(this),v.manager.itemEnd(a)}function I(R){x.removeEventListener("load",E,!1),x.removeEventListener("error",I,!1),p&&p(R),v.manager.itemError(a),v.manager.itemEnd(a)}return x.addEventListener("load",E,!1),x.addEventListener("error",I,!1),"data:"!==a.substr(0,5)&&void 0!==this.crossOrigin&&(x.crossOrigin=this.crossOrigin),v.manager.itemStart(a),x.src=a,x}}),Bd.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Bd,load:function(a,o,l,p){const v=new Rr,y=new ef(this.manager);y.setCrossOrigin(this.crossOrigin),y.setPath(this.path);let x=0;function E(I){y.load(a[I],function(R){v.images[I]=R,x++,6===x&&(v.needsUpdate=!0,o&&o(v))},void 0,p)}for(let I=0;I<a.length;++I)E(I);return v}}),G0.prototype=Object.assign(Object.create(Mr.prototype),{constructor:G0,load:function(a,o,l,p){const v=this,y=new Dr,x=new Cu(this.manager);return x.setResponseType("arraybuffer"),x.setRequestHeader(this.requestHeader),x.setPath(this.path),x.setWithCredentials(v.withCredentials),x.load(a,function(E){const I=v.parse(E);!I||(void 0!==I.image?y.image=I.image:void 0!==I.data&&(y.image.width=I.width,y.image.height=I.height,y.image.data=I.data),y.wrapS=void 0!==I.wrapS?I.wrapS:Hs,y.wrapT=void 0!==I.wrapT?I.wrapT:Hs,y.magFilter=void 0!==I.magFilter?I.magFilter:oe,y.minFilter=void 0!==I.minFilter?I.minFilter:oe,y.anisotropy=void 0!==I.anisotropy?I.anisotropy:1,void 0!==I.encoding&&(y.encoding=I.encoding),void 0!==I.flipY&&(y.flipY=I.flipY),void 0!==I.format&&(y.format=I.format),void 0!==I.type&&(y.type=I.type),void 0!==I.mipmaps&&(y.mipmaps=I.mipmaps,y.minFilter=1008),1===I.mipmapCount&&(y.minFilter=oe),y.needsUpdate=!0,o&&o(y,I))},l,p),y}}),ug.prototype=Object.assign(Object.create(Mr.prototype),{constructor:ug,load:function(a,o,l,p){const v=new Li,y=new ef(this.manager);return y.setCrossOrigin(this.crossOrigin),y.setPath(this.path),y.load(a,function(x){v.image=x;const E=a.search(/\.jpe?g($|\?)/i)>0||0===a.search(/^data\:image\/jpeg/);v.format=E?To:_r,v.needsUpdate=!0,void 0!==o&&o(v)},l,p),v}}),Object.assign(ti.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(a,o){const l=this.getUtoTmapping(a);return this.getPoint(l,o)},getPoints:function(a=5){const o=[];for(let l=0;l<=a;l++)o.push(this.getPoint(l/a));return o},getSpacedPoints:function(a=5){const o=[];for(let l=0;l<=a;l++)o.push(this.getPointAt(l/a));return o},getLength:function(){const a=this.getLengths();return a[a.length-1]},getLengths:function(a){if(void 0===a&&(a=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const o=[];let l,p=this.getPoint(0),v=0;o.push(0);for(let y=1;y<=a;y++)l=this.getPoint(y/a),v+=l.distanceTo(p),o.push(v),p=l;return this.cacheArcLengths=o,o},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(a,o){const l=this.getLengths();let p=0;const v=l.length;let y;y=o||a*l[v-1];let I,x=0,E=v-1;for(;x<=E;)if(p=Math.floor(x+(E-x)/2),I=l[p]-y,I<0)x=p+1;else{if(!(I>0)){E=p;break}E=p-1}if(p=E,l[p]===y)return p/(v-1);const R=l[p];return(p+(y-R)/(l[p+1]-R))/(v-1)},getTangent:function(a,o){let p=a-1e-4,v=a+1e-4;p<0&&(p=0),v>1&&(v=1);const y=this.getPoint(p),x=this.getPoint(v),E=o||(y.isVector2?new qe:new xe);return E.copy(x).sub(y).normalize(),E},getTangentAt:function(a,o){const l=this.getUtoTmapping(a);return this.getTangent(l,o)},computeFrenetFrames:function(a,o){const l=new xe,p=[],v=[],y=[],x=new xe,E=new Kt;for(let U=0;U<=a;U++)p[U]=this.getTangentAt(U/a,new xe),p[U].normalize();v[0]=new xe,y[0]=new xe;let I=Number.MAX_VALUE;const R=Math.abs(p[0].x),F=Math.abs(p[0].y),k=Math.abs(p[0].z);R<=I&&(I=R,l.set(1,0,0)),F<=I&&(I=F,l.set(0,1,0)),k<=I&&l.set(0,0,1),x.crossVectors(p[0],l).normalize(),v[0].crossVectors(p[0],x),y[0].crossVectors(p[0],v[0]);for(let U=1;U<=a;U++){if(v[U]=v[U-1].clone(),y[U]=y[U-1].clone(),x.crossVectors(p[U-1],p[U]),x.length()>Number.EPSILON){x.normalize();const G=Math.acos(pi.clamp(p[U-1].dot(p[U]),-1,1));v[U].applyMatrix4(E.makeRotationAxis(x,G))}y[U].crossVectors(p[U],v[U])}if(!0===o){let U=Math.acos(pi.clamp(v[0].dot(v[a]),-1,1));U/=a,p[0].dot(x.crossVectors(v[0],v[a]))>0&&(U=-U);for(let G=1;G<=a;G++)v[G].applyMatrix4(E.makeRotationAxis(p[G],U*G)),y[G].crossVectors(p[G],v[G])}return{tangents:p,normals:v,binormals:y}},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this},toJSON:function(){const a={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a},fromJSON:function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}),(ho.prototype=Object.create(ti.prototype)).constructor=ho,ho.prototype.isEllipseCurve=!0,ho.prototype.getPoint=function(a,o){const l=o||new qe,p=2*Math.PI;let v=this.aEndAngle-this.aStartAngle;const y=Math.abs(v)<Number.EPSILON;for(;v<0;)v+=p;for(;v>p;)v-=p;v<Number.EPSILON&&(v=y?0:p),!0===this.aClockwise&&!y&&(v===p?v=-p:v-=p);const x=this.aStartAngle+a*v;let E=this.aX+this.xRadius*Math.cos(x),I=this.aY+this.yRadius*Math.sin(x);if(0!==this.aRotation){const R=Math.cos(this.aRotation),F=Math.sin(this.aRotation),k=E-this.aX,U=I-this.aY;E=k*R-U*F+this.aX,I=k*F+U*R+this.aY}return l.set(E,I)},ho.prototype.copy=function(a){return ti.prototype.copy.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this},ho.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a},ho.prototype.fromJSON=function(a){return ti.prototype.fromJSON.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this},(Wc.prototype=Object.create(ho.prototype)).constructor=Wc,Wc.prototype.isArcCurve=!0;const Tp=new xe,j0=new bp,Ud=new bp,cg=new bp;function yl(a=[],o=!1,l="centripetal",p=.5){ti.call(this),this.type="CatmullRomCurve3",this.points=a,this.closed=o,this.curveType=l,this.tension=p}function z0(a,o,l,p,v){const y=.5*(p-o),x=.5*(v-l),E=a*a;return(2*l-2*p+y+x)*(a*E)+(-3*l+3*p-2*y-x)*E+y*a+l}function tf(a,o,l,p){return function Mb(a,o){const l=1-a;return l*l*o}(a,o)+function Wl(a,o){return 2*(1-a)*a*o}(a,l)+function Ib(a,o){return a*a*o}(a,p)}function nf(a,o,l,p,v){return function Rb(a,o){const l=1-a;return l*l*l*o}(a,o)+function Nb(a,o){const l=1-a;return 3*l*l*a*o}(a,l)+function lc(a,o){return 3*(1-a)*a*a*o}(a,p)+function Pb(a,o){return a*a*a*o}(a,v)}function Du(a=new qe,o=new qe,l=new qe,p=new qe){ti.call(this),this.type="CubicBezierCurve",this.v0=a,this.v1=o,this.v2=l,this.v3=p}function uc(a=new xe,o=new xe,l=new xe,p=new xe){ti.call(this),this.type="CubicBezierCurve3",this.v0=a,this.v1=o,this.v2=l,this.v3=p}function tl(a=new qe,o=new qe){ti.call(this),this.type="LineCurve",this.v1=a,this.v2=o}function ii(a=new xe,o=new xe){ti.call(this),this.type="LineCurve3",this.v1=a,this.v2=o}function Ri(a=new qe,o=new qe,l=new qe){ti.call(this),this.type="QuadraticBezierCurve",this.v0=a,this.v1=o,this.v2=l}function $l(a=new xe,o=new xe,l=new xe){ti.call(this),this.type="QuadraticBezierCurve3",this.v0=a,this.v1=o,this.v2=l}function ql(a=[]){ti.call(this),this.type="SplineCurve",this.points=a}(yl.prototype=Object.create(ti.prototype)).constructor=yl,yl.prototype.isCatmullRomCurve3=!0,yl.prototype.getPoint=function(a,o=new xe){const l=o,p=this.points,v=p.length,y=(v-(this.closed?0:1))*a;let I,R,x=Math.floor(y),E=y-x;this.closed?x+=x>0?0:(Math.floor(Math.abs(x)/v)+1)*v:0===E&&x===v-1&&(x=v-2,E=1),this.closed||x>0?I=p[(x-1)%v]:(Tp.subVectors(p[0],p[1]).add(p[0]),I=Tp);const F=p[x%v],k=p[(x+1)%v];if(this.closed||x+2<v?R=p[(x+2)%v]:(Tp.subVectors(p[v-1],p[v-2]).add(p[v-1]),R=Tp),"centripetal"===this.curveType||"chordal"===this.curveType){const U="chordal"===this.curveType?.5:.25;let G=Math.pow(I.distanceToSquared(F),U),Y=Math.pow(F.distanceToSquared(k),U),re=Math.pow(k.distanceToSquared(R),U);Y<1e-4&&(Y=1),G<1e-4&&(G=Y),re<1e-4&&(re=Y),j0.initNonuniformCatmullRom(I.x,F.x,k.x,R.x,G,Y,re),Ud.initNonuniformCatmullRom(I.y,F.y,k.y,R.y,G,Y,re),cg.initNonuniformCatmullRom(I.z,F.z,k.z,R.z,G,Y,re)}else"catmullrom"===this.curveType&&(j0.initCatmullRom(I.x,F.x,k.x,R.x,this.tension),Ud.initCatmullRom(I.y,F.y,k.y,R.y,this.tension),cg.initCatmullRom(I.z,F.z,k.z,R.z,this.tension));return l.set(j0.calc(E),Ud.calc(E),cg.calc(E)),l},yl.prototype.copy=function(a){ti.prototype.copy.call(this,a),this.points=[];for(let o=0,l=a.points.length;o<l;o++)this.points.push(a.points[o].clone());return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this},yl.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);a.points=[];for(let o=0,l=this.points.length;o<l;o++)a.points.push(this.points[o].toArray());return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a},yl.prototype.fromJSON=function(a){ti.prototype.fromJSON.call(this,a),this.points=[];for(let o=0,l=a.points.length;o<l;o++){const p=a.points[o];this.points.push((new xe).fromArray(p))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this},(Du.prototype=Object.create(ti.prototype)).constructor=Du,Du.prototype.isCubicBezierCurve=!0,Du.prototype.getPoint=function(a,o=new qe){const l=o,p=this.v0,v=this.v1,y=this.v2,x=this.v3;return l.set(nf(a,p.x,v.x,y.x,x.x),nf(a,p.y,v.y,y.y,x.y)),l},Du.prototype.copy=function(a){return ti.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},Du.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},Du.prototype.fromJSON=function(a){return ti.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this},(uc.prototype=Object.create(ti.prototype)).constructor=uc,uc.prototype.isCubicBezierCurve3=!0,uc.prototype.getPoint=function(a,o=new xe){const l=o,p=this.v0,v=this.v1,y=this.v2,x=this.v3;return l.set(nf(a,p.x,v.x,y.x,x.x),nf(a,p.y,v.y,y.y,x.y),nf(a,p.z,v.z,y.z,x.z)),l},uc.prototype.copy=function(a){return ti.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},uc.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},uc.prototype.fromJSON=function(a){return ti.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this},(tl.prototype=Object.create(ti.prototype)).constructor=tl,tl.prototype.isLineCurve=!0,tl.prototype.getPoint=function(a,o=new qe){const l=o;return 1===a?l.copy(this.v2):(l.copy(this.v2).sub(this.v1),l.multiplyScalar(a).add(this.v1)),l},tl.prototype.getPointAt=function(a,o){return this.getPoint(a,o)},tl.prototype.getTangent=function(a,o){const l=o||new qe;return l.copy(this.v2).sub(this.v1).normalize(),l},tl.prototype.copy=function(a){return ti.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},tl.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},tl.prototype.fromJSON=function(a){return ti.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},(ii.prototype=Object.create(ti.prototype)).constructor=ii,ii.prototype.isLineCurve3=!0,ii.prototype.getPoint=function(a,o=new xe){const l=o;return 1===a?l.copy(this.v2):(l.copy(this.v2).sub(this.v1),l.multiplyScalar(a).add(this.v1)),l},ii.prototype.getPointAt=function(a,o){return this.getPoint(a,o)},ii.prototype.copy=function(a){return ti.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},ii.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},ii.prototype.fromJSON=function(a){return ti.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},(Ri.prototype=Object.create(ti.prototype)).constructor=Ri,Ri.prototype.isQuadraticBezierCurve=!0,Ri.prototype.getPoint=function(a,o=new qe){const l=o,p=this.v0,v=this.v1,y=this.v2;return l.set(tf(a,p.x,v.x,y.x),tf(a,p.y,v.y,y.y)),l},Ri.prototype.copy=function(a){return ti.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},Ri.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},Ri.prototype.fromJSON=function(a){return ti.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},($l.prototype=Object.create(ti.prototype)).constructor=$l,$l.prototype.isQuadraticBezierCurve3=!0,$l.prototype.getPoint=function(a,o=new xe){const l=o,p=this.v0,v=this.v1,y=this.v2;return l.set(tf(a,p.x,v.x,y.x),tf(a,p.y,v.y,y.y),tf(a,p.z,v.z,y.z)),l},$l.prototype.copy=function(a){return ti.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},$l.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},$l.prototype.fromJSON=function(a){return ti.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},(ql.prototype=Object.create(ti.prototype)).constructor=ql,ql.prototype.isSplineCurve=!0,ql.prototype.getPoint=function(a,o=new qe){const l=o,p=this.points,v=(p.length-1)*a,y=Math.floor(v),x=v-y,E=p[0===y?y:y-1],I=p[y],R=p[y>p.length-2?p.length-1:y+1],F=p[y>p.length-3?p.length-1:y+2];return l.set(z0(x,E.x,I.x,R.x,F.x),z0(x,E.y,I.y,R.y,F.y)),l},ql.prototype.copy=function(a){ti.prototype.copy.call(this,a),this.points=[];for(let o=0,l=a.points.length;o<l;o++)this.points.push(a.points[o].clone());return this},ql.prototype.toJSON=function(){const a=ti.prototype.toJSON.call(this);a.points=[];for(let o=0,l=this.points.length;o<l;o++)a.points.push(this.points[o].toArray());return a},ql.prototype.fromJSON=function(a){ti.prototype.fromJSON.call(this,a),this.points=[];for(let o=0,l=a.points.length;o<l;o++){const p=a.points[o];this.points.push((new qe).fromArray(p))}return this};var Ob=Object.freeze({__proto__:null,ArcCurve:Wc,CatmullRomCurve3:yl,CubicBezierCurve:Du,CubicBezierCurve3:uc,EllipseCurve:ho,LineCurve:tl,LineCurve3:ii,QuadraticBezierCurve:Ri,QuadraticBezierCurve3:$l,SplineCurve:ql});function Vd(){ti.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Xl(a){Vd.call(this),this.type="Path",this.currentPoint=new qe,a&&this.setFromPoints(a)}function Hd(a){Xl.call(this,a),this.uuid=pi.generateUUID(),this.type="Shape",this.holes=[]}function as(a,o=1){Jn.call(this),this.type="Light",this.color=new ei(a),this.intensity=o}function W0(a,o,l){as.call(this,a,l),this.type="HemisphereLight",this.position.copy(Jn.DefaultUp),this.updateMatrix(),this.groundColor=new ei(o)}function cc(a){this.camera=a,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new qe(512,512),this.map=null,this.mapPass=null,this.matrix=new Kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Hf,this._frameExtents=new qe(1,1),this._viewportCount=1,this._viewports=[new Hr(0,0,1,1)]}function $0(){cc.call(this,new ks(50,1,.5,500)),this.focus=1}function pa(a,o,l,p,v,y){as.call(this,a,o),this.type="SpotLight",this.position.copy(Jn.DefaultUp),this.updateMatrix(),this.target=new Jn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(x){this.intensity=x/Math.PI}}),this.distance=void 0!==l?l:0,this.angle=void 0!==p?p:Math.PI/3,this.penumbra=void 0!==v?v:0,this.decay=void 0!==y?y:1,this.shadow=new $0}function wp(){cc.call(this,new ks(90,1,.5,500)),this._frameExtents=new qe(4,2),this._viewportCount=6,this._viewports=[new Hr(2,1,1,1),new Hr(0,1,1,1),new Hr(3,1,1,1),new Hr(1,1,1,1),new Hr(3,0,1,1),new Hr(1,0,1,1)],this._cubeDirections=[new xe(1,0,0),new xe(-1,0,0),new xe(0,0,1),new xe(0,0,-1),new xe(0,1,0),new xe(0,-1,0)],this._cubeUps=[new xe(0,1,0),new xe(0,1,0),new xe(0,1,0),new xe(0,1,0),new xe(0,0,1),new xe(0,0,-1)]}function Ea(a,o,l,p){as.call(this,a,o),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(v){this.intensity=v/(4*Math.PI)}}),this.distance=void 0!==l?l:0,this.decay=void 0!==p?p:1,this.shadow=new wp}function e_(a=-1,o=1,l=1,p=-1,v=.1,y=2e3){Wu.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=o,this.top=l,this.bottom=p,this.near=v,this.far=y,this.updateProjectionMatrix()}function Ap(){cc.call(this,new e_(-5,5,5,-5,.5,500))}function dg(a,o){as.call(this,a,o),this.type="DirectionalLight",this.position.copy(Jn.DefaultUp),this.updateMatrix(),this.target=new Jn,this.shadow=new Ap}function q0(a,o){as.call(this,a,o),this.type="AmbientLight"}function Lb(a,o,l,p){as.call(this,a,o),this.type="RectAreaLight",this.width=void 0!==l?l:10,this.height=void 0!==p?p:10}Vd.prototype=Object.assign(Object.create(ti.prototype),{constructor:Vd,add:function(a){this.curves.push(a)},closePath:function(){const a=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);a.equals(o)||this.curves.push(new tl(o,a))},getPoint:function(a){const o=a*this.getLength(),l=this.getCurveLengths();let p=0;for(;p<l.length;){if(l[p]>=o){const v=l[p]-o,y=this.curves[p],x=y.getLength();return y.getPointAt(0===x?0:1-v/x)}p++}return null},getLength:function(){const a=this.getCurveLengths();return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const a=[];let o=0;for(let l=0,p=this.curves.length;l<p;l++)o+=this.curves[l].getLength(),a.push(o);return this.cacheLengths=a,a},getSpacedPoints:function(a=40){const o=[];for(let l=0;l<=a;l++)o.push(this.getPoint(l/a));return this.autoClose&&o.push(o[0]),o},getPoints:function(a=12){const o=[];let l;for(let p=0,v=this.curves;p<v.length;p++){const y=v[p],E=y.getPoints(y&&y.isEllipseCurve?2*a:y&&(y.isLineCurve||y.isLineCurve3)?1:y&&y.isSplineCurve?a*y.points.length:a);for(let I=0;I<E.length;I++){const R=E[I];l&&l.equals(R)||(o.push(R),l=R)}}return this.autoClose&&o.length>1&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o},copy:function(a){ti.prototype.copy.call(this,a),this.curves=[];for(let o=0,l=a.curves.length;o<l;o++)this.curves.push(a.curves[o].clone());return this.autoClose=a.autoClose,this},toJSON:function(){const a=ti.prototype.toJSON.call(this);a.autoClose=this.autoClose,a.curves=[];for(let o=0,l=this.curves.length;o<l;o++)a.curves.push(this.curves[o].toJSON());return a},fromJSON:function(a){ti.prototype.fromJSON.call(this,a),this.autoClose=a.autoClose,this.curves=[];for(let o=0,l=a.curves.length;o<l;o++){const p=a.curves[o];this.curves.push((new Ob[p.type]).fromJSON(p))}return this}}),Xl.prototype=Object.assign(Object.create(Vd.prototype),{constructor:Xl,setFromPoints:function(a){this.moveTo(a[0].x,a[0].y);for(let o=1,l=a.length;o<l;o++)this.lineTo(a[o].x,a[o].y);return this},moveTo:function(a,o){return this.currentPoint.set(a,o),this},lineTo:function(a,o){const l=new tl(this.currentPoint.clone(),new qe(a,o));return this.curves.push(l),this.currentPoint.set(a,o),this},quadraticCurveTo:function(a,o,l,p){const v=new Ri(this.currentPoint.clone(),new qe(a,o),new qe(l,p));return this.curves.push(v),this.currentPoint.set(l,p),this},bezierCurveTo:function(a,o,l,p,v,y){const x=new Du(this.currentPoint.clone(),new qe(a,o),new qe(l,p),new qe(v,y));return this.curves.push(x),this.currentPoint.set(v,y),this},splineThru:function(a){const l=new ql([this.currentPoint.clone()].concat(a));return this.curves.push(l),this.currentPoint.copy(a[a.length-1]),this},arc:function(a,o,l,p,v,y){return this.absarc(a+this.currentPoint.x,o+this.currentPoint.y,l,p,v,y),this},absarc:function(a,o,l,p,v,y){return this.absellipse(a,o,l,l,p,v,y),this},ellipse:function(a,o,l,p,v,y,x,E){return this.absellipse(a+this.currentPoint.x,o+this.currentPoint.y,l,p,v,y,x,E),this},absellipse:function(a,o,l,p,v,y,x,E){const I=new ho(a,o,l,p,v,y,x,E);if(this.curves.length>0){const F=I.getPoint(0);F.equals(this.currentPoint)||this.lineTo(F.x,F.y)}this.curves.push(I);const R=I.getPoint(1);return this.currentPoint.copy(R),this},copy:function(a){return Vd.prototype.copy.call(this,a),this.currentPoint.copy(a.currentPoint),this},toJSON:function(){const a=Vd.prototype.toJSON.call(this);return a.currentPoint=this.currentPoint.toArray(),a},fromJSON:function(a){return Vd.prototype.fromJSON.call(this,a),this.currentPoint.fromArray(a.currentPoint),this}}),Hd.prototype=Object.assign(Object.create(Xl.prototype),{constructor:Hd,getPointsHoles:function(a){const o=[];for(let l=0,p=this.holes.length;l<p;l++)o[l]=this.holes[l].getPoints(a);return o},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(a){Xl.prototype.copy.call(this,a),this.holes=[];for(let o=0,l=a.holes.length;o<l;o++)this.holes.push(a.holes[o].clone());return this},toJSON:function(){const a=Xl.prototype.toJSON.call(this);a.uuid=this.uuid,a.holes=[];for(let o=0,l=this.holes.length;o<l;o++)a.holes.push(this.holes[o].toJSON());return a},fromJSON:function(a){Xl.prototype.fromJSON.call(this,a),this.uuid=a.uuid,this.holes=[];for(let o=0,l=a.holes.length;o<l;o++){const p=a.holes[o];this.holes.push((new Xl).fromJSON(p))}return this}}),as.prototype=Object.assign(Object.create(Jn.prototype),{constructor:as,isLight:!0,copy:function(a){return Jn.prototype.copy.call(this,a),this.color.copy(a.color),this.intensity=a.intensity,this},toJSON:function(a){const o=Jn.prototype.toJSON.call(this,a);return o.object.color=this.color.getHex(),o.object.intensity=this.intensity,void 0!==this.groundColor&&(o.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(o.object.distance=this.distance),void 0!==this.angle&&(o.object.angle=this.angle),void 0!==this.decay&&(o.object.decay=this.decay),void 0!==this.penumbra&&(o.object.penumbra=this.penumbra),void 0!==this.shadow&&(o.object.shadow=this.shadow.toJSON()),o}}),W0.prototype=Object.assign(Object.create(as.prototype),{constructor:W0,isHemisphereLight:!0,copy:function(a){return as.prototype.copy.call(this,a),this.groundColor.copy(a.groundColor),this}}),Object.assign(cc.prototype,{_projScreenMatrix:new Kt,_lightPositionWorld:new xe,_lookTarget:new xe,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(a){const o=this.camera,l=this.matrix,p=this._projScreenMatrix,v=this._lookTarget,y=this._lightPositionWorld;y.setFromMatrixPosition(a.matrixWorld),o.position.copy(y),v.setFromMatrixPosition(a.target.matrixWorld),o.lookAt(v),o.updateMatrixWorld(),p.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(p),l.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),l.multiply(o.projectionMatrix),l.multiply(o.matrixWorldInverse)},getViewport:function(a){return this._viewports[a]},getFrameExtents:function(){return this._frameExtents},copy:function(a){return this.camera=a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const a={};return 0!==this.bias&&(a.bias=this.bias),0!==this.normalBias&&(a.normalBias=this.normalBias),1!==this.radius&&(a.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}}),$0.prototype=Object.assign(Object.create(cc.prototype),{constructor:$0,isSpotLightShadow:!0,updateMatrices:function(a){const o=this.camera,l=2*pi.RAD2DEG*a.angle*this.focus,p=this.mapSize.width/this.mapSize.height,v=a.distance||o.far;(l!==o.fov||p!==o.aspect||v!==o.far)&&(o.fov=l,o.aspect=p,o.far=v,o.updateProjectionMatrix()),cc.prototype.updateMatrices.call(this,a)}}),pa.prototype=Object.assign(Object.create(as.prototype),{constructor:pa,isSpotLight:!0,copy:function(a){return as.prototype.copy.call(this,a),this.distance=a.distance,this.angle=a.angle,this.penumbra=a.penumbra,this.decay=a.decay,this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}),wp.prototype=Object.assign(Object.create(cc.prototype),{constructor:wp,isPointLightShadow:!0,updateMatrices:function(a,o=0){const l=this.camera,p=this.matrix,v=this._lightPositionWorld,y=this._lookTarget,x=this._projScreenMatrix;v.setFromMatrixPosition(a.matrixWorld),l.position.copy(v),y.copy(l.position),y.add(this._cubeDirections[o]),l.up.copy(this._cubeUps[o]),l.lookAt(y),l.updateMatrixWorld(),p.makeTranslation(-v.x,-v.y,-v.z),x.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),this._frustum.setFromProjectionMatrix(x)}}),Ea.prototype=Object.assign(Object.create(as.prototype),{constructor:Ea,isPointLight:!0,copy:function(a){return as.prototype.copy.call(this,a),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this}}),e_.prototype=Object.assign(Object.create(Wu.prototype),{constructor:e_,isOrthographicCamera:!0,copy:function(a,o){return Wu.prototype.copy.call(this,a,o),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this},setViewOffset:function(a,o,l,p,v,y){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=o,this.view.offsetX=l,this.view.offsetY=p,this.view.width=v,this.view.height=y,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const a=(this.right-this.left)/(2*this.zoom),o=(this.top-this.bottom)/(2*this.zoom),l=(this.right+this.left)/2,p=(this.top+this.bottom)/2;let v=l-a,y=l+a,x=p+o,E=p-o;if(null!==this.view&&this.view.enabled){const I=(this.right-this.left)/this.view.fullWidth/this.zoom,R=(this.top-this.bottom)/this.view.fullHeight/this.zoom;v+=I*this.view.offsetX,y=v+I*this.view.width,x-=R*this.view.offsetY,E=x-R*this.view.height}this.projectionMatrix.makeOrthographic(v,y,x,E,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(a){const o=Jn.prototype.toJSON.call(this,a);return o.object.zoom=this.zoom,o.object.left=this.left,o.object.right=this.right,o.object.top=this.top,o.object.bottom=this.bottom,o.object.near=this.near,o.object.far=this.far,null!==this.view&&(o.object.view=Object.assign({},this.view)),o}}),Ap.prototype=Object.assign(Object.create(cc.prototype),{constructor:Ap,isDirectionalLightShadow:!0,updateMatrices:function(a){cc.prototype.updateMatrices.call(this,a)}}),dg.prototype=Object.assign(Object.create(as.prototype),{constructor:dg,isDirectionalLight:!0,copy:function(a){return as.prototype.copy.call(this,a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}),q0.prototype=Object.assign(Object.create(as.prototype),{constructor:q0,isAmbientLight:!0}),Lb.prototype=Object.assign(Object.create(as.prototype),{constructor:Lb,isRectAreaLight:!0,copy:function(a){return as.prototype.copy.call(this,a),this.width=a.width,this.height=a.height,this},toJSON:function(a){const o=as.prototype.toJSON.call(this,a);return o.object.width=this.width,o.object.height=this.height,o}});class kb{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let o=0;o<9;o++)this.coefficients.push(new xe)}set(o){for(let l=0;l<9;l++)this.coefficients[l].copy(o[l]);return this}zero(){for(let o=0;o<9;o++)this.coefficients[o].set(0,0,0);return this}getAt(o,l){const p=o.x,v=o.y,y=o.z,x=this.coefficients;return l.copy(x[0]).multiplyScalar(.282095),l.addScaledVector(x[1],.488603*v),l.addScaledVector(x[2],.488603*y),l.addScaledVector(x[3],.488603*p),l.addScaledVector(x[4],p*v*1.092548),l.addScaledVector(x[5],v*y*1.092548),l.addScaledVector(x[6],.315392*(3*y*y-1)),l.addScaledVector(x[7],p*y*1.092548),l.addScaledVector(x[8],.546274*(p*p-v*v)),l}getIrradianceAt(o,l){const p=o.x,v=o.y,y=o.z,x=this.coefficients;return l.copy(x[0]).multiplyScalar(.886227),l.addScaledVector(x[1],1.023328*v),l.addScaledVector(x[2],1.023328*y),l.addScaledVector(x[3],1.023328*p),l.addScaledVector(x[4],.858086*p*v),l.addScaledVector(x[5],.858086*v*y),l.addScaledVector(x[6],.743125*y*y-.247708),l.addScaledVector(x[7],.858086*p*y),l.addScaledVector(x[8],.429043*(p*p-v*v)),l}add(o){for(let l=0;l<9;l++)this.coefficients[l].add(o.coefficients[l]);return this}addScaledSH(o,l){for(let p=0;p<9;p++)this.coefficients[p].addScaledVector(o.coefficients[p],l);return this}scale(o){for(let l=0;l<9;l++)this.coefficients[l].multiplyScalar(o);return this}lerp(o,l){for(let p=0;p<9;p++)this.coefficients[p].lerp(o.coefficients[p],l);return this}equals(o){for(let l=0;l<9;l++)if(!this.coefficients[l].equals(o.coefficients[l]))return!1;return!0}copy(o){return this.set(o.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(o,l=0){const p=this.coefficients;for(let v=0;v<9;v++)p[v].fromArray(o,l+3*v);return this}toArray(o=[],l=0){const p=this.coefficients;for(let v=0;v<9;v++)p[v].toArray(o,l+3*v);return o}static getBasisAt(o,l){const p=o.x,v=o.y,y=o.z;l[0]=.282095,l[1]=.488603*v,l[2]=.488603*y,l[3]=.488603*p,l[4]=1.092548*p*v,l[5]=1.092548*v*y,l[6]=.315392*(3*y*y-1),l[7]=1.092548*p*y,l[8]=.546274*(p*p-v*v)}}function dc(a,o){as.call(this,void 0,o),this.type="LightProbe",this.sh=void 0!==a?a:new kb}function X0(a){Mr.call(this,a),this.textures={}}dc.prototype=Object.assign(Object.create(as.prototype),{constructor:dc,isLightProbe:!0,copy:function(a){return as.prototype.copy.call(this,a),this.sh.copy(a.sh),this},fromJSON:function(a){return this.intensity=a.intensity,this.sh.fromArray(a.sh),this},toJSON:function(a){const o=as.prototype.toJSON.call(this,a);return o.object.sh=this.sh.toArray(),o}}),X0.prototype=Object.assign(Object.create(Mr.prototype),{constructor:X0,load:function(a,o,l,p){const v=this,y=new Cu(v.manager);y.setPath(v.path),y.setRequestHeader(v.requestHeader),y.setWithCredentials(v.withCredentials),y.load(a,function(x){try{o(v.parse(JSON.parse(x)))}catch(E){p?p(E):console.error(E),v.manager.itemError(a)}},l,p)},parse:function(a){const o=this.textures;function l(v){return void 0===o[v]&&console.warn("THREE.MaterialLoader: Undefined texture",v),o[v]}const p=new H0[a.type];if(void 0!==a.uuid&&(p.uuid=a.uuid),void 0!==a.name&&(p.name=a.name),void 0!==a.color&&void 0!==p.color&&p.color.setHex(a.color),void 0!==a.roughness&&(p.roughness=a.roughness),void 0!==a.metalness&&(p.metalness=a.metalness),void 0!==a.sheen&&(p.sheen=(new ei).setHex(a.sheen)),void 0!==a.emissive&&void 0!==p.emissive&&p.emissive.setHex(a.emissive),void 0!==a.specular&&void 0!==p.specular&&p.specular.setHex(a.specular),void 0!==a.shininess&&(p.shininess=a.shininess),void 0!==a.clearcoat&&(p.clearcoat=a.clearcoat),void 0!==a.clearcoatRoughness&&(p.clearcoatRoughness=a.clearcoatRoughness),void 0!==a.fog&&(p.fog=a.fog),void 0!==a.flatShading&&(p.flatShading=a.flatShading),void 0!==a.blending&&(p.blending=a.blending),void 0!==a.combine&&(p.combine=a.combine),void 0!==a.side&&(p.side=a.side),void 0!==a.opacity&&(p.opacity=a.opacity),void 0!==a.transparent&&(p.transparent=a.transparent),void 0!==a.alphaTest&&(p.alphaTest=a.alphaTest),void 0!==a.depthTest&&(p.depthTest=a.depthTest),void 0!==a.depthWrite&&(p.depthWrite=a.depthWrite),void 0!==a.colorWrite&&(p.colorWrite=a.colorWrite),void 0!==a.stencilWrite&&(p.stencilWrite=a.stencilWrite),void 0!==a.stencilWriteMask&&(p.stencilWriteMask=a.stencilWriteMask),void 0!==a.stencilFunc&&(p.stencilFunc=a.stencilFunc),void 0!==a.stencilRef&&(p.stencilRef=a.stencilRef),void 0!==a.stencilFuncMask&&(p.stencilFuncMask=a.stencilFuncMask),void 0!==a.stencilFail&&(p.stencilFail=a.stencilFail),void 0!==a.stencilZFail&&(p.stencilZFail=a.stencilZFail),void 0!==a.stencilZPass&&(p.stencilZPass=a.stencilZPass),void 0!==a.wireframe&&(p.wireframe=a.wireframe),void 0!==a.wireframeLinewidth&&(p.wireframeLinewidth=a.wireframeLinewidth),void 0!==a.wireframeLinecap&&(p.wireframeLinecap=a.wireframeLinecap),void 0!==a.wireframeLinejoin&&(p.wireframeLinejoin=a.wireframeLinejoin),void 0!==a.rotation&&(p.rotation=a.rotation),1!==a.linewidth&&(p.linewidth=a.linewidth),void 0!==a.dashSize&&(p.dashSize=a.dashSize),void 0!==a.gapSize&&(p.gapSize=a.gapSize),void 0!==a.scale&&(p.scale=a.scale),void 0!==a.polygonOffset&&(p.polygonOffset=a.polygonOffset),void 0!==a.polygonOffsetFactor&&(p.polygonOffsetFactor=a.polygonOffsetFactor),void 0!==a.polygonOffsetUnits&&(p.polygonOffsetUnits=a.polygonOffsetUnits),void 0!==a.skinning&&(p.skinning=a.skinning),void 0!==a.morphTargets&&(p.morphTargets=a.morphTargets),void 0!==a.morphNormals&&(p.morphNormals=a.morphNormals),void 0!==a.dithering&&(p.dithering=a.dithering),void 0!==a.vertexTangents&&(p.vertexTangents=a.vertexTangents),void 0!==a.visible&&(p.visible=a.visible),void 0!==a.toneMapped&&(p.toneMapped=a.toneMapped),void 0!==a.userData&&(p.userData=a.userData),void 0!==a.vertexColors&&(p.vertexColors="number"==typeof a.vertexColors?a.vertexColors>0:a.vertexColors),void 0!==a.uniforms)for(const v in a.uniforms){const y=a.uniforms[v];switch(p.uniforms[v]={},y.type){case"t":p.uniforms[v].value=l(y.value);break;case"c":p.uniforms[v].value=(new ei).setHex(y.value);break;case"v2":p.uniforms[v].value=(new qe).fromArray(y.value);break;case"v3":p.uniforms[v].value=(new xe).fromArray(y.value);break;case"v4":p.uniforms[v].value=(new Hr).fromArray(y.value);break;case"m3":p.uniforms[v].value=(new la).fromArray(y.value);break;case"m4":p.uniforms[v].value=(new Kt).fromArray(y.value);break;default:p.uniforms[v].value=y.value}}if(void 0!==a.defines&&(p.defines=a.defines),void 0!==a.vertexShader&&(p.vertexShader=a.vertexShader),void 0!==a.fragmentShader&&(p.fragmentShader=a.fragmentShader),void 0!==a.extensions)for(const v in a.extensions)p.extensions[v]=a.extensions[v];if(void 0!==a.shading&&(p.flatShading=1===a.shading),void 0!==a.size&&(p.size=a.size),void 0!==a.sizeAttenuation&&(p.sizeAttenuation=a.sizeAttenuation),void 0!==a.map&&(p.map=l(a.map)),void 0!==a.matcap&&(p.matcap=l(a.matcap)),void 0!==a.alphaMap&&(p.alphaMap=l(a.alphaMap)),void 0!==a.bumpMap&&(p.bumpMap=l(a.bumpMap)),void 0!==a.bumpScale&&(p.bumpScale=a.bumpScale),void 0!==a.normalMap&&(p.normalMap=l(a.normalMap)),void 0!==a.normalMapType&&(p.normalMapType=a.normalMapType),void 0!==a.normalScale){let v=a.normalScale;!1===Array.isArray(v)&&(v=[v,v]),p.normalScale=(new qe).fromArray(v)}return void 0!==a.displacementMap&&(p.displacementMap=l(a.displacementMap)),void 0!==a.displacementScale&&(p.displacementScale=a.displacementScale),void 0!==a.displacementBias&&(p.displacementBias=a.displacementBias),void 0!==a.roughnessMap&&(p.roughnessMap=l(a.roughnessMap)),void 0!==a.metalnessMap&&(p.metalnessMap=l(a.metalnessMap)),void 0!==a.emissiveMap&&(p.emissiveMap=l(a.emissiveMap)),void 0!==a.emissiveIntensity&&(p.emissiveIntensity=a.emissiveIntensity),void 0!==a.specularMap&&(p.specularMap=l(a.specularMap)),void 0!==a.envMap&&(p.envMap=l(a.envMap)),void 0!==a.envMapIntensity&&(p.envMapIntensity=a.envMapIntensity),void 0!==a.reflectivity&&(p.reflectivity=a.reflectivity),void 0!==a.refractionRatio&&(p.refractionRatio=a.refractionRatio),void 0!==a.lightMap&&(p.lightMap=l(a.lightMap)),void 0!==a.lightMapIntensity&&(p.lightMapIntensity=a.lightMapIntensity),void 0!==a.aoMap&&(p.aoMap=l(a.aoMap)),void 0!==a.aoMapIntensity&&(p.aoMapIntensity=a.aoMapIntensity),void 0!==a.gradientMap&&(p.gradientMap=l(a.gradientMap)),void 0!==a.clearcoatMap&&(p.clearcoatMap=l(a.clearcoatMap)),void 0!==a.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap=l(a.clearcoatRoughnessMap)),void 0!==a.clearcoatNormalMap&&(p.clearcoatNormalMap=l(a.clearcoatNormalMap)),void 0!==a.clearcoatNormalScale&&(p.clearcoatNormalScale=(new qe).fromArray(a.clearcoatNormalScale)),void 0!==a.transmission&&(p.transmission=a.transmission),void 0!==a.transmissionMap&&(p.transmissionMap=l(a.transmissionMap)),p},setTextures:function(a){return this.textures=a,this}});const Y0_extractUrlBase=function(a){const o=a.lastIndexOf("/");return-1===o?"./":a.substr(0,o+1)};function xp(){xi.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function rf(a,o,l,p){"number"==typeof l&&(p=l,l=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ii.call(this,a,o,l),this.meshPerAttribute=p||1}function Gd(a){Mr.call(this,a)}function Q0(a){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Mr.call(this,a),this.options={premultiplyAlpha:"none"}}function t_(){this.type="ShapePath",this.color=new ei,this.subPaths=[],this.currentPath=null}xp.prototype=Object.assign(Object.create(xi.prototype),{constructor:xp,isInstancedBufferGeometry:!0,copy:function(a){return xi.prototype.copy.call(this,a),this.instanceCount=a.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const a=xi.prototype.toJSON.call(this);return a.instanceCount=this.instanceCount,a.isInstancedBufferGeometry=!0,a}}),rf.prototype=Object.assign(Object.create(Ii.prototype),{constructor:rf,isInstancedBufferAttribute:!0,copy:function(a){return Ii.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this},toJSON:function(){const a=Ii.prototype.toJSON.call(this);return a.meshPerAttribute=this.meshPerAttribute,a.isInstancedBufferAttribute=!0,a}}),Gd.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Gd,load:function(a,o,l,p){const v=this,y=new Cu(v.manager);y.setPath(v.path),y.setRequestHeader(v.requestHeader),y.setWithCredentials(v.withCredentials),y.load(a,function(x){try{o(v.parse(JSON.parse(x)))}catch(E){p?p(E):console.error(E),v.manager.itemError(a)}},l,p)},parse:function(a){const o={},l={};function p(U,G){if(void 0!==o[G])return o[G];const re=U.interleavedBuffers[G],ie=function v(U,G){if(void 0!==l[G])return l[G];const ie=new Uint32Array(U.arrayBuffers[G]).buffer;return l[G]=ie,ie}(U,re.buffer),q=new vl(xa(re.type,ie),re.stride);return q.uuid=re.uuid,o[G]=q,q}const y=a.isInstancedBufferGeometry?new xp:new xi,x=a.data.index;if(void 0!==x){const U=xa(x.type,x.array);y.setIndex(new Ii(U,1))}const E=a.data.attributes;for(const U in E){const G=E[U];let Y;if(G.isInterleavedBufferAttribute)Y=new Au(p(a.data,G.data),G.itemSize,G.offset,G.normalized);else{const re=xa(G.type,G.array);Y=new(G.isInstancedBufferAttribute?rf:Ii)(re,G.itemSize,G.normalized)}void 0!==G.name&&(Y.name=G.name),y.setAttribute(U,Y)}const I=a.data.morphAttributes;if(I)for(const U in I){const G=I[U],Y=[];for(let re=0,ie=G.length;re<ie;re++){const $=G[re];let q;q=$.isInterleavedBufferAttribute?new Au(p(a.data,$.data),$.itemSize,$.offset,$.normalized):new Ii(xa($.type,$.array),$.itemSize,$.normalized),void 0!==$.name&&(q.name=$.name),Y.push(q)}y.morphAttributes[U]=Y}a.data.morphTargetsRelative&&(y.morphTargetsRelative=!0);const F=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==F)for(let U=0,G=F.length;U!==G;++U){const Y=F[U];y.addGroup(Y.start,Y.count,Y.materialIndex)}const k=a.data.boundingSphere;if(void 0!==k){const U=new xe;void 0!==k.center&&U.fromArray(k.center),y.boundingSphere=new io(U,k.radius)}return a.name&&(y.name=a.name),a.userData&&(y.userData=a.userData),y}}),Q0.prototype=Object.assign(Object.create(Mr.prototype),{constructor:Q0,isImageBitmapLoader:!0,setOptions:function(o){return this.options=o,this},load:function(a,o,l,p){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);const v=this,y=zc.get(a);if(void 0!==y)return v.manager.itemStart(a),setTimeout(function(){o&&o(y),v.manager.itemEnd(a)},0),y;const x={};x.credentials="anonymous"===this.crossOrigin?"same-origin":"include",fetch(a,x).then(function(E){return E.blob()}).then(function(E){return createImageBitmap(E,v.options)}).then(function(E){zc.add(a,E),o&&o(E),v.manager.itemEnd(a)}).catch(function(E){p&&p(E),v.manager.itemError(a),v.manager.itemEnd(a)}),v.manager.itemStart(a)}}),Object.assign(t_.prototype,{moveTo:function(a,o){return this.currentPath=new Xl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,o),this},lineTo:function(a,o){return this.currentPath.lineTo(a,o),this},quadraticCurveTo:function(a,o,l,p){return this.currentPath.quadraticCurveTo(a,o,l,p),this},bezierCurveTo:function(a,o,l,p,v,y){return this.currentPath.bezierCurveTo(a,o,l,p,v,y),this},splineThru:function(a){return this.currentPath.splineThru(a),this},toShapes:function(a,o){function l($){const q=[];for(let Ae=0,Ie=$.length;Ae<Ie;Ae++){const Se=$[Ae],he=new Hd;he.curves=Se.curves,q.push(he)}return q}function p($,q){const Ae=q.length;let Ie=!1;for(let Se=Ae-1,he=0;he<Ae;Se=he++){let De=q[Se],vt=q[he],ke=vt.x-De.x,Qe=vt.y-De.y;if(Math.abs(Qe)>Number.EPSILON){if(Qe<0&&(De=q[he],ke=-ke,vt=q[Se],Qe=-Qe),$.y<De.y||$.y>vt.y)continue;if($.y===De.y){if($.x===De.x)return!0}else{const tt=Qe*($.x-De.x)-ke*($.y-De.y);if(0===tt)return!0;if(tt<0)continue;Ie=!Ie}}else{if($.y!==De.y)continue;if(vt.x<=$.x&&$.x<=De.x||De.x<=$.x&&$.x<=vt.x)return!0}}return Ie}const v=ic.isClockWise,y=this.subPaths;if(0===y.length)return[];if(!0===o)return l(y);let x,E,I;const R=[];if(1===y.length)return E=y[0],I=new Hd,I.curves=E.curves,R.push(I),R;let F=!v(y[0].getPoints());F=a?!F:F;const k=[],U=[];let re,ie,G=[],Y=0;U[Y]=void 0,G[Y]=[];for(let $=0,q=y.length;$<q;$++)E=y[$],re=E.getPoints(),x=v(re),x=a?!x:x,x?(!F&&U[Y]&&Y++,U[Y]={s:new Hd,p:re},U[Y].s.curves=E.curves,F&&Y++,G[Y]=[]):G[Y].push({h:E,p:re[0]});if(!U[0])return l(y);if(U.length>1){let $=!1;const q=[];for(let Ae=0,Ie=U.length;Ae<Ie;Ae++)k[Ae]=[];for(let Ae=0,Ie=U.length;Ae<Ie;Ae++){const Se=G[Ae];for(let he=0;he<Se.length;he++){const De=Se[he];let vt=!0;for(let ke=0;ke<U.length;ke++)p(De.p,U[ke].p)&&(Ae!==ke&&q.push({froms:Ae,tos:ke,hole:he}),vt?(vt=!1,k[ke].push(De)):$=!0);vt&&k[Ae].push(De)}}q.length>0&&($||(G=k))}for(let $=0,q=U.length;$<q;$++){I=U[$].s,R.push(I),ie=G[$];for(let Ae=0,Ie=ie.length;Ae<Ie;Ae++)I.holes.push(ie[Ae].h)}return R}});class b{constructor(o){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=o}generateShapes(o,l=100){const p=[],v=function d(a,o,l){const p=Array.from?Array.from(a):String(a).split(""),v=o/l.resolution,y=(l.boundingBox.yMax-l.boundingBox.yMin+l.underlineThickness)*v,x=[];let E=0,I=0;for(let R=0;R<p.length;R++){const F=p[R];if("\n"===F)E=0,I-=y;else{const k=f(F,v,E,I,l);E+=k.offsetX,x.push(k.path)}}return x}(o,l,this.data);for(let y=0,x=v.length;y<x;y++)Array.prototype.push.apply(p,v[y].toShapes());return p}}function f(a,o,l,p,v){const y=v.glyphs[a]||v.glyphs["?"];if(!y)return void console.error('THREE.Font: character "'+a+'" does not exists in font family '+v.familyName+".");const x=new t_;let E,I,R,F,k,U,G,Y;if(y.o){const re=y._cachedOutline||(y._cachedOutline=y.o.split(" "));for(let ie=0,$=re.length;ie<$;)switch(re[ie++]){case"m":E=re[ie++]*o+l,I=re[ie++]*o+p,x.moveTo(E,I);break;case"l":E=re[ie++]*o+l,I=re[ie++]*o+p,x.lineTo(E,I);break;case"q":R=re[ie++]*o+l,F=re[ie++]*o+p,k=re[ie++]*o+l,U=re[ie++]*o+p,x.quadraticCurveTo(k,U,R,F);break;case"b":R=re[ie++]*o+l,F=re[ie++]*o+p,k=re[ie++]*o+l,U=re[ie++]*o+p,G=re[ie++]*o+l,Y=re[ie++]*o+p,x.bezierCurveTo(k,U,G,Y,R,F)}}return{offsetX:y.ha*o,path:x}}function h(a){Mr.call(this,a)}let s;h.prototype=Object.assign(Object.create(Mr.prototype),{constructor:h,load:function(a,o,l,p){const v=this,y=new Cu(this.manager);y.setPath(this.path),y.setRequestHeader(this.requestHeader),y.setWithCredentials(v.withCredentials),y.load(a,function(x){let E;try{E=JSON.parse(x)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),E=JSON.parse(x.substring(65,x.length-2))}const I=v.parse(E);o&&o(I)},l,p)},parse:function(a){return new b(a)}});const u_getContext=function(){return void 0===s&&(s=new(window.AudioContext||window.webkitAudioContext)),s};function m(a){Mr.call(this,a)}function T(a,o,l){dc.call(this,void 0,l);const p=(new ei).set(a),v=(new ei).set(o),y=new xe(p.r,p.g,p.b),x=new xe(v.r,v.g,v.b),E=Math.sqrt(Math.PI),I=E*Math.sqrt(.75);this.sh.coefficients[0].copy(y).add(x).multiplyScalar(E),this.sh.coefficients[1].copy(y).sub(x).multiplyScalar(I)}function S(a,o){dc.call(this,void 0,o);const l=(new ei).set(a);this.sh.coefficients[0].set(l.r,l.g,l.b).multiplyScalar(2*Math.sqrt(Math.PI))}m.prototype=Object.assign(Object.create(Mr.prototype),{constructor:m,load:function(a,o,l,p){const v=this,y=new Cu(v.manager);y.setResponseType("arraybuffer"),y.setPath(v.path),y.setRequestHeader(v.requestHeader),y.setWithCredentials(v.withCredentials),y.load(a,function(x){try{const E=x.slice(0);u_getContext().decodeAudioData(E,function(R){o(R)})}catch(E){p?p(E):console.error(E),v.manager.itemError(a)}},l,p)}}),T.prototype=Object.assign(Object.create(dc.prototype),{constructor:T,isHemisphereLightProbe:!0,copy:function(a){return dc.prototype.copy.call(this,a),this},toJSON:function(a){return dc.prototype.toJSON.call(this,a)}}),S.prototype=Object.assign(Object.create(dc.prototype),{constructor:S,isAmbientLightProbe:!0,copy:function(a){return dc.prototype.copy.call(this,a),this},toJSON:function(a){return dc.prototype.toJSON.call(this,a)}});const D=new Kt,P=new Kt;Object.assign(function W(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ks,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ks,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(a){const o=this._cache;if(o.focus!==a.focus||o.fov!==a.fov||o.aspect!==a.aspect*this.aspect||o.near!==a.near||o.far!==a.far||o.zoom!==a.zoom||o.eyeSep!==this.eyeSep){o.focus=a.focus,o.fov=a.fov,o.aspect=a.aspect*this.aspect,o.near=a.near,o.far=a.far,o.zoom=a.zoom,o.eyeSep=this.eyeSep;const p=a.projectionMatrix.clone(),v=o.eyeSep/2,y=v*o.near/o.focus,x=o.near*Math.tan(pi.DEG2RAD*o.fov*.5)/o.zoom;let E,I;P.elements[12]=-v,D.elements[12]=v,E=-x*o.aspect+y,I=x*o.aspect+y,p.elements[0]=2*o.near/(I-E),p.elements[8]=(I+E)/(I-E),this.cameraL.projectionMatrix.copy(p),E=-x*o.aspect-y,I=x*o.aspect-y,p.elements[0]=2*o.near/(I-E),p.elements[8]=(I+E)/(I-E),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(P),this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(D)}});function le(a,o,l){let p,v,y;switch(this.binding=a,this.valueSize=l,o){case"quaternion":p=this._slerp,v=this._slerpAdditive,y=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*l),this._workIndex=5;break;case"string":case"bool":p=this._select,v=this._select,y=this._setAdditiveIdentityOther,this.buffer=new Array(5*l);break;default:p=this._lerp,v=this._lerpAdditive,y=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*l)}this._mixBufferRegion=p,this._mixBufferRegionAdditive=v,this._setIdentity=y,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(le.prototype,{accumulate:function(a,o){const l=this.buffer,p=this.valueSize,v=a*p+p;let y=this.cumulativeWeight;if(0===y){for(let x=0;x!==p;++x)l[v+x]=l[x];y=o}else y+=o,this._mixBufferRegion(l,v,0,o/y,p);this.cumulativeWeight=y},accumulateAdditive:function(a){const o=this.buffer,l=this.valueSize,p=l*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(o,p,0,a,l),this.cumulativeWeightAdditive+=a},apply:function(a){const o=this.valueSize,l=this.buffer,p=a*o+o,v=this.cumulativeWeight,y=this.cumulativeWeightAdditive,x=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,v<1&&this._mixBufferRegion(l,p,o*this._origIndex,1-v,o),y>0&&this._mixBufferRegionAdditive(l,p,this._addIndex*o,1,o);for(let E=o,I=o+o;E!==I;++E)if(l[E]!==l[E+o]){x.setValue(l,p);break}},saveOriginalState:function(){const o=this.buffer,l=this.valueSize,p=l*this._origIndex;this.binding.getValue(o,p);for(let v=l,y=p;v!==y;++v)o[v]=o[p+v%l];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){const a=this._addIndex*this.valueSize,o=a+this.valueSize;for(let l=a;l<o;l++)this.buffer[l]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const a=this._origIndex*this.valueSize,o=this._addIndex*this.valueSize;for(let l=0;l<this.valueSize;l++)this.buffer[o+l]=this.buffer[a+l]},_select:function(a,o,l,p,v){if(p>=.5)for(let y=0;y!==v;++y)a[o+y]=a[l+y]},_slerp:function(a,o,l,p){ci.slerpFlat(a,o,a,o,a,l,p)},_slerpAdditive:function(a,o,l,p,v){const y=this._workIndex*v;ci.multiplyQuaternionsFlat(a,y,a,o,a,l),ci.slerpFlat(a,o,a,o,a,y,p)},_lerp:function(a,o,l,p,v){const y=1-p;for(let x=0;x!==v;++x){const E=o+x;a[E]=a[E]*y+a[l+x]*p}},_lerpAdditive:function(a,o,l,p,v){for(let y=0;y!==v;++y){const x=o+y;a[x]=a[x]+a[l+y]*p}}});const ce="\\[\\]\\.:\\/",fe=new RegExp("["+ce+"]","g"),ue="[^"+ce+"]",At="[^"+ce.replace("\\.","")+"]",sn=/((?:WC+[\/:])*)/.source.replace("WC",ue),rt=/(WCOD+)?/.source.replace("WCOD",At),et=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ue),Ft=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ue),pt=new RegExp("^"+sn+rt+et+Ft+"$"),lt=["material","materials","bones"];function St(a,o,l){const p=l||st.parseTrackName(o);this._targetGroup=a,this._bindings=a.subscribe_(o,p)}function st(a,o,l){this.path=o,this.parsedPath=l||st.parseTrackName(o),this.node=st.findNode(a,this.parsedPath.nodeName)||a,this.rootNode=a}Object.assign(St.prototype,{getValue:function(a,o){this.bind();const p=this._bindings[this._targetGroup.nCachedObjects_];void 0!==p&&p.getValue(a,o)},setValue:function(a,o){const l=this._bindings;for(let p=this._targetGroup.nCachedObjects_,v=l.length;p!==v;++p)l[p].setValue(a,o)},bind:function(){const a=this._bindings;for(let o=this._targetGroup.nCachedObjects_,l=a.length;o!==l;++o)a[o].bind()},unbind:function(){const a=this._bindings;for(let o=this._targetGroup.nCachedObjects_,l=a.length;o!==l;++o)a[o].unbind()}}),Object.assign(st,{Composite:St,create:function(a,o,l){return a&&a.isAnimationObjectGroup?new st.Composite(a,o,l):new st(a,o,l)},sanitizeNodeName:function(a){return a.replace(/\s/g,"_").replace(fe,"")},parseTrackName:function(a){const o=pt.exec(a);if(!o)throw new Error("PropertyBinding: Cannot parse trackName: "+a);const l={nodeName:o[2],objectName:o[3],objectIndex:o[4],propertyName:o[5],propertyIndex:o[6]},p=l.nodeName&&l.nodeName.lastIndexOf(".");if(void 0!==p&&-1!==p){const v=l.nodeName.substring(p+1);-1!==lt.indexOf(v)&&(l.nodeName=l.nodeName.substring(0,p),l.objectName=v)}if(null===l.propertyName||0===l.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+a);return l},findNode:function(a,o){if(!o||""===o||"."===o||-1===o||o===a.name||o===a.uuid)return a;if(a.skeleton){const l=a.skeleton.getBoneByName(o);if(void 0!==l)return l}if(a.children){const l=function(v){for(let y=0;y<v.length;y++){const x=v[y];if(x.name===o||x.uuid===o)return x;const E=l(x.children);if(E)return E}return null},p=l(a.children);if(p)return p}return null}}),Object.assign(st.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(o,l){o[l]=this.node[this.propertyName]},function(o,l){const p=this.resolvedProperty;for(let v=0,y=p.length;v!==y;++v)o[l++]=p[v]},function(o,l){o[l]=this.resolvedProperty[this.propertyIndex]},function(o,l){this.resolvedProperty.toArray(o,l)}],SetterByBindingTypeAndVersioning:[[function(o,l){this.targetObject[this.propertyName]=o[l]},function(o,l){this.targetObject[this.propertyName]=o[l],this.targetObject.needsUpdate=!0},function(o,l){this.targetObject[this.propertyName]=o[l],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,l){const p=this.resolvedProperty;for(let v=0,y=p.length;v!==y;++v)p[v]=o[l++]},function(o,l){const p=this.resolvedProperty;for(let v=0,y=p.length;v!==y;++v)p[v]=o[l++];this.targetObject.needsUpdate=!0},function(o,l){const p=this.resolvedProperty;for(let v=0,y=p.length;v!==y;++v)p[v]=o[l++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,l){this.resolvedProperty[this.propertyIndex]=o[l]},function(o,l){this.resolvedProperty[this.propertyIndex]=o[l],this.targetObject.needsUpdate=!0},function(o,l){this.resolvedProperty[this.propertyIndex]=o[l],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,l){this.resolvedProperty.fromArray(o,l)},function(o,l){this.resolvedProperty.fromArray(o,l),this.targetObject.needsUpdate=!0},function(o,l){this.resolvedProperty.fromArray(o,l),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(o,l){this.bind(),this.getValue(o,l)},setValue:function(o,l){this.bind(),this.setValue(o,l)},bind:function(){let a=this.node;const o=this.parsedPath,l=o.objectName,p=o.propertyName;let v=o.propertyIndex;if(a||(a=st.findNode(this.rootNode,o.nodeName)||this.rootNode,this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!a)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(l){let I=o.objectIndex;switch(l){case"materials":if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);a=a.material.materials;break;case"bones":if(!a.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);a=a.skeleton.bones;for(let R=0;R<a.length;R++)if(a[R].name===I){I=R;break}break;default:if(void 0===a[l])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);a=a[l]}if(void 0!==I){if(void 0===a[I])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);a=a[I]}}const y=a[p];if(void 0===y)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+o.nodeName+"."+p+" but it wasn't found.",a);let x=this.Versioning.None;this.targetObject=a,void 0!==a.needsUpdate?x=this.Versioning.NeedsUpdate:void 0!==a.matrixWorldNeedsUpdate&&(x=this.Versioning.MatrixWorldNeedsUpdate);let E=this.BindingType.Direct;if(void 0!==v){if("morphTargetInfluences"===p){if(!a.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!a.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!a.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==a.morphTargetDictionary[v]&&(v=a.morphTargetDictionary[v])}E=this.BindingType.ArrayElement,this.resolvedProperty=y,this.propertyIndex=v}else void 0!==y.fromArray&&void 0!==y.toArray?(E=this.BindingType.HasFromToArray,this.resolvedProperty=y):Array.isArray(y)?(E=this.BindingType.EntireArray,this.resolvedProperty=y):this.propertyName=p;this.getValue=this.GetterByBindingType[E],this.setValue=this.SetterByBindingTypeAndVersioning[E][x]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(st.prototype,{_getValue_unbound:st.prototype.getValue,_setValue_unbound:st.prototype.setValue}),Object.assign(function Wn(){this.uuid=pi.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const a={};this._indicesByUUID=a;for(let l=0,p=arguments.length;l!==p;++l)a[arguments[l].uuid]=l;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const o=this;this.stats={objects:{get total(){return o._objects.length},get inUse(){return this.total-o.nCachedObjects_}},get bindingsPerObject(){return o._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){const a=this._objects,o=this._indicesByUUID,l=this._paths,p=this._parsedPaths,v=this._bindings,y=v.length;let x,E=a.length,I=this.nCachedObjects_;for(let R=0,F=arguments.length;R!==F;++R){const k=arguments[R],U=k.uuid;let G=o[U];if(void 0===G){G=E++,o[U]=G,a.push(k);for(let Y=0,re=y;Y!==re;++Y)v[Y].push(new st(k,l[Y],p[Y]))}else if(G<I){x=a[G];const Y=--I,re=a[Y];o[re.uuid]=G,a[G]=re,o[U]=Y,a[Y]=k;for(let ie=0,$=y;ie!==$;++ie){const q=v[ie];let Ie=q[G];q[G]=q[Y],void 0===Ie&&(Ie=new st(k,l[ie],p[ie])),q[Y]=Ie}}else a[G]!==x&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=I},remove:function(){const a=this._objects,o=this._indicesByUUID,l=this._bindings,p=l.length;let v=this.nCachedObjects_;for(let y=0,x=arguments.length;y!==x;++y){const E=arguments[y],I=E.uuid,R=o[I];if(void 0!==R&&R>=v){const F=v++,k=a[F];o[k.uuid]=R,a[R]=k,o[I]=F,a[F]=E;for(let U=0,G=p;U!==G;++U){const Y=l[U],ie=Y[R];Y[R]=Y[F],Y[F]=ie}}}this.nCachedObjects_=v},uncache:function(){const a=this._objects,o=this._indicesByUUID,l=this._bindings,p=l.length;let v=this.nCachedObjects_,y=a.length;for(let x=0,E=arguments.length;x!==E;++x){const R=arguments[x].uuid,F=o[R];if(void 0!==F)if(delete o[R],F<v){const k=--v,U=a[k],G=--y,Y=a[G];o[U.uuid]=F,a[F]=U,o[Y.uuid]=k,a[k]=Y,a.pop();for(let re=0,ie=p;re!==ie;++re){const $=l[re],Ae=$[G];$[F]=$[k],$[k]=Ae,$.pop()}}else{const k=--y,U=a[k];k>0&&(o[U.uuid]=F),a[F]=U,a.pop();for(let G=0,Y=p;G!==Y;++G){const re=l[G];re[F]=re[k],re.pop()}}}this.nCachedObjects_=v},subscribe_:function(a,o){const l=this._bindingsIndicesByPath;let p=l[a];const v=this._bindings;if(void 0!==p)return v[p];const y=this._paths,x=this._parsedPaths,E=this._objects,R=this.nCachedObjects_,F=new Array(E.length);p=v.length,l[a]=p,y.push(a),x.push(o),v.push(F);for(let k=R,U=E.length;k!==U;++k)F[k]=new st(E[k],a,o);return F},unsubscribe_:function(a){const o=this._bindingsIndicesByPath,l=o[a];if(void 0!==l){const p=this._paths,v=this._parsedPaths,y=this._bindings,x=y.length-1,E=y[x];o[a[x]]=l,y[l]=E,y.pop(),v[l]=v[x],v.pop(),p[l]=p[x],p.pop()}}});class pn{constructor(o,l,p=null,v=l.blendMode){this._mixer=o,this._clip=l,this._localRoot=p,this.blendMode=v;const y=l.tracks,x=y.length,E=new Array(x),I={endingStart:oh,endingEnd:oh};for(let R=0;R!==x;++R){const F=y[R].createInterpolant(null);E[R]=F,F.settings=I}this._interpolantSettings=I,this._interpolants=E,this._propertyBindings=new Array(x),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(o){return this._startTime=o,this}setLoop(o,l){return this.loop=o,this.repetitions=l,this}setEffectiveWeight(o){return this.weight=o,this._effectiveWeight=this.enabled?o:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(o){return this._scheduleFading(o,0,1)}fadeOut(o){return this._scheduleFading(o,1,0)}crossFadeFrom(o,l,p){if(o.fadeOut(l),this.fadeIn(l),p){const v=this._clip.duration,y=o._clip.duration,E=v/y;o.warp(1,y/v,l),this.warp(E,1,l)}return this}crossFadeTo(o,l,p){return o.crossFadeFrom(this,l,p)}stopFading(){const o=this._weightInterpolant;return null!==o&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(o)),this}setEffectiveTimeScale(o){return this.timeScale=o,this._effectiveTimeScale=this.paused?0:o,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(o){return this.timeScale=this._clip.duration/o,this.stopWarping()}syncWith(o){return this.time=o.time,this.timeScale=o.timeScale,this.stopWarping()}halt(o){return this.warp(this._effectiveTimeScale,0,o)}warp(o,l,p){const v=this._mixer,y=v.time,x=this.timeScale;let E=this._timeScaleInterpolant;null===E&&(E=v._lendControlInterpolant(),this._timeScaleInterpolant=E);const I=E.parameterPositions,R=E.sampleValues;return I[0]=y,I[1]=y+p,R[0]=o/x,R[1]=l/x,this}stopWarping(){const o=this._timeScaleInterpolant;return null!==o&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(o)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(o,l,p,v){if(!this.enabled)return void this._updateWeight(o);const y=this._startTime;if(null!==y){const I=(o-y)*p;if(I<0||0===p)return;this._startTime=null,l=p*I}l*=this._updateTimeScale(o);const x=this._updateTime(l),E=this._updateWeight(o);if(E>0){const I=this._interpolants,R=this._propertyBindings;if(2501===this.blendMode)for(let F=0,k=I.length;F!==k;++F)I[F].evaluate(x),R[F].accumulateAdditive(E);else for(let F=0,k=I.length;F!==k;++F)I[F].evaluate(x),R[F].accumulate(v,E)}}_updateWeight(o){let l=0;if(this.enabled){l=this.weight;const p=this._weightInterpolant;if(null!==p){const v=p.evaluate(o)[0];l*=v,o>p.parameterPositions[1]&&(this.stopFading(),0===v&&(this.enabled=!1))}}return this._effectiveWeight=l,l}_updateTimeScale(o){let l=0;if(!this.paused){l=this.timeScale;const p=this._timeScaleInterpolant;null!==p&&(l*=p.evaluate(o)[0],o>p.parameterPositions[1]&&(this.stopWarping(),0===l?this.paused=!0:this.timeScale=l))}return this._effectiveTimeScale=l,l}_updateTime(o){const l=this._clip.duration,p=this.loop;let v=this.time+o,y=this._loopCount;const x=2202===p;if(0===o)return-1===y?v:x&&1==(1&y)?l-v:v;if(2200===p){-1===y&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(v>=l)v=l;else{if(!(v<0)){this.time=v;break e}v=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=v,this._mixer.dispatchEvent({type:"finished",action:this,direction:o<0?-1:1})}}else{if(-1===y&&(o>=0?(y=0,this._setEndings(!0,0===this.repetitions,x)):this._setEndings(0===this.repetitions,!0,x)),v>=l||v<0){const E=Math.floor(v/l);v-=l*E,y+=Math.abs(E);const I=this.repetitions-y;if(I<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,v=o>0?l:0,this.time=v,this._mixer.dispatchEvent({type:"finished",action:this,direction:o>0?1:-1});else{if(1===I){const R=o<0;this._setEndings(R,!R,x)}else this._setEndings(!1,!1,x);this._loopCount=y,this.time=v,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:E})}}else this.time=v;if(x&&1==(1&y))return l-v}return v}_setEndings(o,l,p){const v=this._interpolantSettings;p?(v.endingStart=ad,v.endingEnd=ad):(v.endingStart=o?this.zeroSlopeAtStart?ad:oh:2402,v.endingEnd=l?this.zeroSlopeAtEnd?ad:oh:2402)}_scheduleFading(o,l,p){const v=this._mixer,y=v.time;let x=this._weightInterpolant;null===x&&(x=v._lendControlInterpolant(),this._weightInterpolant=x);const E=x.parameterPositions,I=x.sampleValues;return E[0]=y,I[0]=l,E[1]=y+o,I[1]=p,this}}function yi(a){this._root=a,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}yi.prototype=Object.assign(Object.create(Go.prototype),{constructor:yi,_bindAction:function(a,o){const l=a._localRoot||this._root,p=a._clip.tracks,v=p.length,y=a._propertyBindings,x=a._interpolants,E=l.uuid,I=this._bindingsByRootAndName;let R=I[E];void 0===R&&(R={},I[E]=R);for(let F=0;F!==v;++F){const k=p[F],U=k.name;let G=R[U];if(void 0!==G)y[F]=G;else{if(G=y[F],void 0!==G){null===G._cacheIndex&&(++G.referenceCount,this._addInactiveBinding(G,E,U));continue}G=new le(st.create(l,U,o&&o._propertyBindings[F].binding.parsedPath),k.ValueTypeName,k.getValueSize()),++G.referenceCount,this._addInactiveBinding(G,E,U),y[F]=G}x[F].resultBuffer=G.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){const l=(a._localRoot||this._root).uuid,p=a._clip.uuid,v=this._actionsByClip[p];this._bindAction(a,v&&v.knownActions[0]),this._addInactiveAction(a,p,l)}const o=a._propertyBindings;for(let l=0,p=o.length;l!==p;++l){const v=o[l];0==v.useCount++&&(this._lendBinding(v),v.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){const o=a._propertyBindings;for(let l=0,p=o.length;l!==p;++l){const v=o[l];0==--v.useCount&&(v.restoreOriginalState(),this._takeBackBinding(v))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(a){const o=a._cacheIndex;return null!==o&&o<this._nActiveActions},_addInactiveAction:function(a,o,l){const p=this._actions,v=this._actionsByClip;let y=v[o];if(void 0===y)y={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,v[o]=y;else{const x=y.knownActions;a._byClipCacheIndex=x.length,x.push(a)}a._cacheIndex=p.length,p.push(a),y.actionByRoot[l]=a},_removeInactiveAction:function(a){const o=this._actions,l=o[o.length-1],p=a._cacheIndex;l._cacheIndex=p,o[p]=l,o.pop(),a._cacheIndex=null;const v=a._clip.uuid,y=this._actionsByClip,x=y[v],E=x.knownActions,I=E[E.length-1],R=a._byClipCacheIndex;I._byClipCacheIndex=R,E[R]=I,E.pop(),a._byClipCacheIndex=null,delete x.actionByRoot[(a._localRoot||this._root).uuid],0===E.length&&delete y[v],this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){const o=a._propertyBindings;for(let l=0,p=o.length;l!==p;++l){const v=o[l];0==--v.referenceCount&&this._removeInactiveBinding(v)}},_lendAction:function(a){const o=this._actions,l=a._cacheIndex,p=this._nActiveActions++,v=o[p];a._cacheIndex=p,o[p]=a,v._cacheIndex=l,o[l]=v},_takeBackAction:function(a){const o=this._actions,l=a._cacheIndex,p=--this._nActiveActions,v=o[p];a._cacheIndex=p,o[p]=a,v._cacheIndex=l,o[l]=v},_addInactiveBinding:function(a,o,l){const p=this._bindingsByRootAndName,v=this._bindings;let y=p[o];void 0===y&&(y={},p[o]=y),y[l]=a,a._cacheIndex=v.length,v.push(a)},_removeInactiveBinding:function(a){const o=this._bindings,l=a.binding,p=l.rootNode.uuid,v=l.path,y=this._bindingsByRootAndName,x=y[p],E=o[o.length-1],I=a._cacheIndex;E._cacheIndex=I,o[I]=E,o.pop(),delete x[v],0===Object.keys(x).length&&delete y[p]},_lendBinding:function(a){const o=this._bindings,l=a._cacheIndex,p=this._nActiveBindings++,v=o[p];a._cacheIndex=p,o[p]=a,v._cacheIndex=l,o[l]=v},_takeBackBinding:function(a){const o=this._bindings,l=a._cacheIndex,p=--this._nActiveBindings,v=o[p];a._cacheIndex=p,o[p]=a,v._cacheIndex=l,o[l]=v},_lendControlInterpolant:function(){const a=this._controlInterpolants,o=this._nActiveControlInterpolants++;let l=a[o];return void 0===l&&(l=new rg(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),l.__cacheIndex=o,a[o]=l),l},_takeBackControlInterpolant:function(a){const o=this._controlInterpolants,l=a.__cacheIndex,p=--this._nActiveControlInterpolants,v=o[p];a.__cacheIndex=p,o[p]=a,v.__cacheIndex=l,o[l]=v},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(a,o,l){const p=o||this._root,v=p.uuid;let y="string"==typeof a?Ds.findByName(p,a):a;const x=null!==y?y.uuid:a,E=this._actionsByClip[x];let I=null;if(void 0===l&&(l=null!==y?y.blendMode:2500),void 0!==E){const F=E.actionByRoot[v];if(void 0!==F&&F.blendMode===l)return F;I=E.knownActions[0],null===y&&(y=I._clip)}if(null===y)return null;const R=new pn(this,y,o,l);return this._bindAction(R,I),this._addInactiveAction(R,x,v),R},existingAction:function(a,o){const l=o||this._root,p=l.uuid,v="string"==typeof a?Ds.findByName(l,a):a,x=this._actionsByClip[v?v.uuid:a];return void 0!==x&&x.actionByRoot[p]||null},stopAllAction:function(){const a=this._actions;for(let l=this._nActiveActions-1;l>=0;--l)a[l].stop();return this},update:function(a){const o=this._actions,l=this._nActiveActions,p=this.time+=a*=this.timeScale,v=Math.sign(a),y=this._accuIndex^=1;for(let I=0;I!==l;++I)o[I]._update(p,a,v,y);const x=this._bindings,E=this._nActiveBindings;for(let I=0;I!==E;++I)x[I].apply(y);return this},setTime:function(a){this.time=0;for(let o=0;o<this._actions.length;o++)this._actions[o].time=0;return this.update(a)},getRoot:function(){return this._root},uncacheClip:function(a){const o=this._actions,l=a.uuid,p=this._actionsByClip,v=p[l];if(void 0!==v){const y=v.knownActions;for(let x=0,E=y.length;x!==E;++x){const I=y[x];this._deactivateAction(I);const R=I._cacheIndex,F=o[o.length-1];I._cacheIndex=null,I._byClipCacheIndex=null,F._cacheIndex=R,o[R]=F,o.pop(),this._removeInactiveBindingsForAction(I)}delete p[l]}},uncacheRoot:function(a){const o=a.uuid,l=this._actionsByClip;for(const y in l){const E=l[y].actionByRoot[o];void 0!==E&&(this._deactivateAction(E),this._removeInactiveAction(E))}const v=this._bindingsByRootAndName[o];if(void 0!==v)for(const y in v){const x=v[y];x.restoreOriginalState(),this._removeInactiveBinding(x)}},uncacheAction:function(a,o){const l=this.existingAction(a,o);null!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}});class Or{constructor(o){"string"==typeof o&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),o=arguments[1]),this.value=o}clone(){return new Or(void 0===this.value.clone?this.value:this.value.clone())}}function ms(a,o,l){vl.call(this,a,o),this.meshPerAttribute=l||1}function gs(a,o,l,p,v){this.buffer=a,this.type=o,this.itemSize=l,this.elementSize=p,this.count=v,this.version=0}function ys(a,o,l,p){this.ray=new Nl(a,o),this.near=l||0,this.far=p||1/0,this.camera=null,this.layers=new wa,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ns(a,o){return a.distance-o.distance}function na(a,o,l,p){if(a.layers.test(o.layers)&&a.raycast(o,l),!0===p){const v=a.children;for(let y=0,x=v.length;y<x;y++)na(v[y],o,l,!0)}}ms.prototype=Object.assign(Object.create(vl.prototype),{constructor:ms,isInstancedInterleavedBuffer:!0,copy:function(a){return vl.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this},clone:function(a){const o=vl.prototype.clone.call(this,a);return o.meshPerAttribute=this.meshPerAttribute,o},toJSON:function(a){const o=vl.prototype.toJSON.call(this,a);return o.isInstancedInterleavedBuffer=!0,o.meshPerAttribute=this.meshPerAttribute,o}}),Object.defineProperty(gs.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),Object.assign(gs.prototype,{isGLBufferAttribute:!0,setBuffer:function(a){return this.buffer=a,this},setType:function(a,o){return this.type=a,this.elementSize=o,this},setItemSize:function(a){return this.itemSize=a,this},setCount:function(a){return this.count=a,this}}),Object.assign(ys.prototype,{set:function(a,o){this.ray.set(a,o)},setFromCamera:function(a,o){o&&o.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(o.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(o).sub(this.ray.origin).normalize(),this.camera=o):o&&o.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(o.near+o.far)/(o.near-o.far)).unproject(o),this.ray.direction.set(0,0,-1).transformDirection(o.matrixWorld),this.camera=o):console.error("THREE.Raycaster: Unsupported camera type: "+o.type)},intersectObject:function(a,o,l){const p=l||[];return na(a,this,p,o),p.sort(ns),p},intersectObjects:function(a,o,l){const p=l||[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),p;for(let v=0,y=a.length;v<y;v++)na(a[v],this,p,o);return p.sort(ns),p}});class fr{constructor(o=1,l=0,p=0){return this.radius=o,this.phi=l,this.theta=p,this}set(o,l,p){return this.radius=o,this.phi=l,this.theta=p,this}clone(){return(new this.constructor).copy(this)}copy(o){return this.radius=o.radius,this.phi=o.phi,this.theta=o.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(o){return this.setFromCartesianCoords(o.x,o.y,o.z)}setFromCartesianCoords(o,l,p){return this.radius=Math.sqrt(o*o+l*l+p*p),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(o,p),this.phi=Math.acos(pi.clamp(l/this.radius,-1,1))),this}}const hg=new qe;function Ro(a){Jn.call(this),this.material=a,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}(Ro.prototype=Object.create(Jn.prototype)).constructor=Ro,Ro.prototype.isImmediateRenderObject=!0;const Tl=new xe,hc=new Kt,zd=new Kt;function fg(a){const o=[];a&&a.isBone&&o.push(a);for(let l=0;l<a.children.length;l++)o.push.apply(o,fg(a.children[l]));return o}const n_=new Pa({side:1,depthWrite:!1,depthTest:!1});function Bb(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),yl.call(this,a),this.type="catmullrom"}new Zr(new Pc,n_),ti.create=function(a,o){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(ti.prototype),a.prototype.constructor=a,a.prototype.getPoint=o,a},Object.assign(Xl.prototype,{fromPoints:function(a){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(a)}}),Bb.prototype=Object.create(yl.prototype),Object.assign(Bb.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),class Fb extends eg{constructor(o=10,l=10,p=4473924,v=8947848){p=new ei(p),v=new ei(v);const y=l/2,x=o/l,E=o/2,I=[],R=[];for(let U=0,G=0,Y=-E;U<=l;U++,Y+=x){I.push(-E,0,Y,E,0,Y),I.push(Y,0,-E,Y,0,E);const re=U===y?p:v;re.toArray(R,G),G+=3,re.toArray(R,G),G+=3,re.toArray(R,G),G+=3,re.toArray(R,G),G+=3}const F=new xi;F.setAttribute("position",new zi(I,3)),F.setAttribute("color",new zi(R,3)),super(F,new jl({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class K0 extends eg{constructor(o){const l=fg(o),p=new xi,v=[],y=[],x=new ei(0,0,1),E=new ei(0,1,0);for(let R=0;R<l.length;R++){const F=l[R];F.parent&&F.parent.isBone&&(v.push(0,0,0),v.push(0,0,0),y.push(x.r,x.g,x.b),y.push(E.r,E.g,E.b))}p.setAttribute("position",new zi(v,3)),p.setAttribute("color",new zi(y,3)),super(p,new jl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=o,this.bones=l,this.matrix=o.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(o){const l=this.bones,p=this.geometry,v=p.getAttribute("position");zd.copy(this.root.matrixWorld).invert();for(let y=0,x=0;y<l.length;y++){const E=l[y];E.parent&&E.parent.isBone&&(hc.multiplyMatrices(zd,E.matrixWorld),Tl.setFromMatrixPosition(hc),v.setXYZ(x,Tl.x,Tl.y,Tl.z),hc.multiplyMatrices(zd,E.parent.matrixWorld),Tl.setFromMatrixPosition(hc),v.setXYZ(x+1,Tl.x,Tl.y,Tl.z),x+=2)}p.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(o)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Mr.prototype,{extractUrlBase:function(a){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Y0_extractUrlBase(a)}}),Mr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(class bl{constructor(o,l){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==o?o:new qe(1/0,1/0),this.max=void 0!==l?l:new qe(-1/0,-1/0)}set(o,l){return this.min.copy(o),this.max.copy(l),this}setFromPoints(o){this.makeEmpty();for(let l=0,p=o.length;l<p;l++)this.expandByPoint(o[l]);return this}setFromCenterAndSize(o,l){const p=hg.copy(l).multiplyScalar(.5);return this.min.copy(o).sub(p),this.max.copy(o).add(p),this}clone(){return(new this.constructor).copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(o){return void 0===o&&(console.warn("THREE.Box2: .getCenter() target is now required"),o=new qe),this.isEmpty()?o.set(0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return void 0===o&&(console.warn("THREE.Box2: .getSize() target is now required"),o=new qe),this.isEmpty()?o.set(0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y}getParameter(o,l){return void 0===l&&(console.warn("THREE.Box2: .getParameter() target is now required"),l=new qe),l.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y)}clampPoint(o,l){return void 0===l&&(console.warn("THREE.Box2: .clampPoint() target is now required"),l=new qe),l.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return hg.copy(o).clamp(this.min,this.max).sub(o).length()}intersect(o){return this.min.max(o.min),this.max.min(o.max),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}.prototype,{center:function(a){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(a)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(a){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},size:function(a){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(a)}}),Object.assign(js.prototype,{center:function(a){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(a)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(a){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},isIntersectionSphere:function(a){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},size:function(a){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(a)}}),Object.assign(io.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Hf.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(a)},Object.assign(pi,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(a){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),pi.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),pi.ceilPowerOfTwo(a)}}),Object.assign(la.prototype,{flattenToArrayOffset:function(a,o){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,o)},multiplyVector3:function(a){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(a){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(a){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()}}),Object.assign(Kt.prototype,{extractPosition:function(a){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)},flattenToArrayOffset:function(a,o){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,o)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new xe).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(a){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(a){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},multiplyVector4:function(a){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),a.transformDirection(this)},crossVector:function(a){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(a){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(a,o,l,p,v,y){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(a,o,p,l,v,y)},getInverse:function(a){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()}}),Pl.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)},Object.assign(ci.prototype,{multiplyVector3:function(a){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(Nl.prototype,{isIntersectionBox:function(a){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},isIntersectionPlane:function(a){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(a)},isIntersectionSphere:function(a){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)}}),Object.assign(za.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(a,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(a,o)},midpoint:function(a){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(a)},normal:function(a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(a)},plane:function(a){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(a)}}),Object.assign(za,{barycoordFromPoint:function(a,o,l,p,v){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),za.getBarycoord(a,o,l,p,v)},normal:function(a,o,l,p){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),za.getNormal(a,o,l,p)}}),Object.assign(Hd.prototype,{extractAllPoints:function(a){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(a)},extrude:function(a){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new U0(this,a)},makeGeometry:function(a){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new V0(this,a)}}),Object.assign(qe.prototype,{fromAttribute:function(a,o,l){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,o,l)},distanceToManhattan:function(a){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,o){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(o,a)},applyProjection:function(a){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(a)},fromAttribute:function(a,o,l){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,o,l)},distanceToManhattan:function(a){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Hr.prototype,{fromAttribute:function(a,o,l){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,o,l)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Jn.prototype,{getChildByName:function(a){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(a)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(a,o){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(o,a)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(a){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)}}),Object.defineProperties(Jn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Zr.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Zr.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Hc.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(M0.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),up.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(ti.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(a){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=a}}),ks.prototype.setLens=function(a,o){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==o&&(this.filmGauge=o),this.setFocalLength(a)},Object.defineProperties(as.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=a}}}),Object.defineProperties(Ii.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===lm},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(lm)}}}),Object.assign(Ii.prototype,{setDynamic:function(a){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?lm:Cr),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(xi.prototype,{addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(a)},addAttribute:function(a,o){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),o&&o.isBufferAttribute||o&&o.isInterleavedBufferAttribute?"index"===a?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(o),this):this.setAttribute(a,o):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(a,new Ii(arguments[1],arguments[2])))},addDrawCall:function(a,o,l){void 0!==l&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(a,o)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(a){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(a)},applyMatrix:function(a){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)}}),Object.defineProperties(xi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(xp.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(a){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=a}}}),Object.defineProperties(ys.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(a){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=a}}}),Object.defineProperties(vl.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===lm},set:function(a){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(a)}}}),Object.assign(vl.prototype,{setDynamic:function(a){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?lm:Cr),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(U0.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(Zu.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(Or.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(_i.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ei}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===a}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(a){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=a}}}),Object.defineProperties(Gc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(sc.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(a){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=a}}}),Object.defineProperties(Ws.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=a}}}),Object.assign(Do.prototype,{clearTarget:function(a,o,l,p){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(a),this.clear(o,l,p)},animate:function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(a)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(a)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Do.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(a){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===a?3001:Il}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Xm.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Of.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=a}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=a}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=a}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=a}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=a}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=a}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=a}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=a}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=a}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=a}}}),Object.defineProperties(class H extends Jn{constructor(o){super(),this.type="Audio",this.listener=o,this.context=o.context,this.gain=this.context.createGain(),this.gain.connect(o.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(o){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=o,this.connect(),this}setMediaElementSource(o){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(o),this.connect(),this}setMediaStreamSource(o){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(o),this.connect(),this}setBuffer(o){return this.buffer=o,this.sourceType="buffer",this.autoplay&&this.play(),this}play(o=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+o;const l=this.context.createBufferSource();return l.buffer=this.buffer,l.loop=this.loop,l.loopStart=this.loopStart,l.loopEnd=this.loopEnd,l.onended=this.onEnded.bind(this),l.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=l,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let o=1,l=this.filters.length;o<l;o++)this.filters[o-1].connect(this.filters[o]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let o=1,l=this.filters.length;o<l;o++)this.filters[o-1].disconnect(this.filters[o]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(o){return o||(o=[]),!0===this._connected?(this.disconnect(),this.filters=o.slice(),this.connect()):this.filters=o.slice(),this}setDetune(o){if(this.detune=o,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(o){return this.setFilters(o?[o]:[])}setPlaybackRate(o){if(!1!==this.hasPlaybackControl)return this.playbackRate=o,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(o){if(!1!==this.hasPlaybackControl)return this.loop=o,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(o){return this.loopStart=o,this}setLoopEnd(o){return this.loopEnd=o,this}getVolume(){return this.gain.gain.value}setVolume(o){return this.gain.gain.setTargetAtTime(o,this.context.currentTime,.01),this}}.prototype,{load:{value:function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const o=this;return(new m).load(a,function(p){o.setBuffer(p)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Ul.prototype.updateCubeMap=function(a,o){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,o)},Ul.prototype.clear=function(a,o,l,p){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,o,l,p)},lu.crossOrigin=void 0,lu.loadTexture=function(a,o,l,p){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const v=new ug;v.setCrossOrigin(this.crossOrigin);const y=v.load(a,l,void 0,p);return o&&(y.mapping=o),y},lu.loadTextureCube=function(a,o,l,p){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const v=new Bd;v.setCrossOrigin(this.crossOrigin);const y=v.load(a,l,void 0,p);return o&&(y.mapping=o),y},lu.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},lu.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"125"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="125");var pg=function(o,l){var v,y,p=this,x=new Kt,E=null;"VRFrameData"in window&&(E=new VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(function I(R){y=R,R.length>0?v=R[0]:l&&l("VR input not available.")}).catch(function(){console.warn("THREE.VRControls: Unable to get VR Displays")}),this.scale=1,this.standing=!1,this.userHeight=1.6,this.getVRDisplay=function(){return v},this.setVRDisplay=function(R){v=R},this.getVRDisplays=function(){return console.warn("THREE.VRControls: getVRDisplays() is being deprecated."),y},this.getStandingMatrix=function(){return x},this.update=function(){var R;v&&(v.getFrameData?(v.getFrameData(E),R=E.pose):v.getPose&&(R=v.getPose()),null!==R.orientation&&o.quaternion.fromArray(R.orientation),null!==R.position?o.position.fromArray(R.position):o.position.set(0,0,0),this.standing&&(v.stageParameters?(o.updateMatrix(),x.fromArray(v.stageParameters.sittingToStandingTransform),o.applyMatrix(x)):o.position.setY(o.position.y+this.userHeight)),o.position.multiplyScalar(p.scale))},this.dispose=function(){v=null}},Wd=function(o,l){var p,v,E,I,y=new xe,x=new xe,R=new Kt,F=new Kt,k=new Kt,U=null;"VRFrameData"in window&&(U=new window.VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(function G(Ce){v=Ce,Ce.length>0?p=Ce[0]:l&&l("HMD not available")}).catch(function(){console.warn("THREE.VREffect: Unable to get VR Displays")}),this.isPresenting=!1;var Y=this,re=o.getSize(),ie=!1,$=o.getPixelRatio();this.getVRDisplay=function(){return p},this.setVRDisplay=function(Ce){p=Ce},this.getVRDisplays=function(){return console.warn("THREE.VREffect: getVRDisplays() is being deprecated."),v},this.setSize=function(Ce,Fe,je){if(re={width:Ce,height:Fe},ie=je,Y.isPresenting){var at=p.getEyeParameters("left");o.setPixelRatio(1),o.setSize(2*at.renderWidth,at.renderHeight,!1)}else o.setPixelRatio($),o.setSize(Ce,Fe,je)};var q=o.domElement,Ae=[0,0,.5,1],Ie=[.5,0,.5,1];function Se(){var Ce=Y.isPresenting;if(Y.isPresenting=void 0!==p&&p.isPresenting,Y.isPresenting){var Fe=p.getEyeParameters("left"),je=Fe.renderWidth,at=Fe.renderHeight;Ce||($=o.getPixelRatio(),re=o.getSize(),o.setPixelRatio(1),o.setSize(2*je,at,!1))}else Ce&&(o.setPixelRatio($),o.setSize(re.width,re.height,ie))}window.addEventListener("vrdisplaypresentchange",Se,!1),this.setFullScreen=function(Ce){return new Promise(function(Fe,je){void 0!==p?Y.isPresenting!==Ce?Fe(Ce?p.requestPresent([{source:q}]):p.exitPresent()):Fe():je(new Error("No VR hardware found."))})},this.requestPresent=function(){return this.setFullScreen(!0)},this.exitPresent=function(){return this.setFullScreen(!1)},this.requestAnimationFrame=function(Ce){return void 0!==p?p.requestAnimationFrame(Ce):window.requestAnimationFrame(Ce)},this.cancelAnimationFrame=function(Ce){void 0!==p?p.cancelAnimationFrame(Ce):window.cancelAnimationFrame(Ce)},this.submitFrame=function(){void 0!==p&&Y.isPresenting&&p.submitFrame()},this.autoSubmitFrame=!0;var he=new ks;he.layers.enable(1);var De=new ks;De.layers.enable(2),this.render=function(Ce,Fe,je,at){if(p&&Y.isPresenting){var Pt=Ce.autoUpdate;Pt&&(Ce.updateMatrixWorld(),Ce.autoUpdate=!1),Array.isArray(Ce)&&(console.warn("THREE.VREffect.render() no longer supports arrays. Use object.layers instead."),Ce=Ce[0]);var qt,Qn,xt=o.getSize(),Ut=p.getLayers();if(Ut.length){var Un=Ut[0];qt=null!==Un.leftBounds&&4===Un.leftBounds.length?Un.leftBounds:Ae,Qn=null!==Un.rightBounds&&4===Un.rightBounds.length?Un.rightBounds:Ie}else qt=Ae,Qn=Ie;if(E={x:Math.round(xt.width*qt[0]),y:Math.round(xt.height*qt[1]),width:Math.round(xt.width*qt[2]),height:Math.round(xt.height*qt[3])},I={x:Math.round(xt.width*Qn[0]),y:Math.round(xt.height*Qn[1]),width:Math.round(xt.width*Qn[2]),height:Math.round(xt.height*Qn[3])},je?(o.setRenderTarget(je),je.scissorTest=!0):(o.setRenderTarget(null),o.setScissorTest(!0)),(o.autoClear||at)&&o.clear(),null===Fe.parent&&Fe.updateMatrixWorld(),Fe.matrixWorld.decompose(he.position,he.quaternion,he.scale),De.position.copy(he.position),De.quaternion.copy(he.quaternion),De.scale.copy(he.scale),p.getFrameData)p.depthNear=Fe.near,p.depthFar=Fe.far,p.getFrameData(U),he.projectionMatrix.elements=U.leftProjectionMatrix,De.projectionMatrix.elements=U.rightProjectionMatrix,function Qe(Ce){Ce.pose.orientation?(vt.fromArray(Ce.pose.orientation),R.makeRotationFromQuaternion(vt)):R.identity(),Ce.pose.position&&(ke.fromArray(Ce.pose.position),R.setPosition(ke)),F.fromArray(Ce.leftViewMatrix),F.multiply(R),k.fromArray(Ce.rightViewMatrix),k.multiply(R),F.getInverse(F),k.getInverse(k)}(U),he.updateMatrix(),he.matrix.multiply(F),he.matrix.decompose(he.position,he.quaternion,he.scale),De.updateMatrix(),De.matrix.multiply(k),De.matrix.decompose(De.position,De.quaternion,De.scale);else{var ki=p.getEyeParameters("left"),mt=p.getEyeParameters("right");he.projectionMatrix=Ze(ki.fieldOfView,!0,Fe.near,Fe.far),De.projectionMatrix=Ze(mt.fieldOfView,!0,Fe.near,Fe.far),y.fromArray(ki.offset),x.fromArray(mt.offset),he.translateOnAxis(y,he.scale.x),De.translateOnAxis(x,De.scale.x)}return je?(je.viewport.set(E.x,E.y,E.width,E.height),je.scissor.set(E.x,E.y,E.width,E.height)):(o.setViewport(E.x,E.y,E.width,E.height),o.setScissor(E.x,E.y,E.width,E.height)),o.render(Ce,he,je,at),je?(je.viewport.set(I.x,I.y,I.width,I.height),je.scissor.set(I.x,I.y,I.width,I.height)):(o.setViewport(I.x,I.y,I.width,I.height),o.setScissor(I.x,I.y,I.width,I.height)),o.render(Ce,De,je,at),je?(je.viewport.set(0,0,xt.width,xt.height),je.scissor.set(0,0,xt.width,xt.height),je.scissorTest=!1,o.setRenderTarget(null)):(o.setViewport(0,0,xt.width,xt.height),o.setScissorTest(!1)),Pt&&(Ce.autoUpdate=!0),void(Y.autoSubmitFrame&&Y.submitFrame())}o.render(Ce,Fe,je,at)},this.dispose=function(){window.removeEventListener("vrdisplaypresentchange",Se,!1)};var vt=new ci,ke=new xe;function Ze(Ce,Fe,je,at){var Pt=Math.PI/180;return function ut(Ce,Fe,je,at){je=void 0===je?.01:je,at=void 0===at?1e4:at;var Pt=(Fe=void 0===Fe||Fe)?-1:1,xt=new Kt,Ut=xt.elements,qt=function tt(Ce){var Fe=2/(Ce.leftTan+Ce.rightTan),at=2/(Ce.upTan+Ce.downTan);return{scale:[Fe,at],offset:[(Ce.leftTan-Ce.rightTan)*Fe*.5,(Ce.upTan-Ce.downTan)*at*.5]}}(Ce);return Ut[0]=qt.scale[0],Ut[1]=0,Ut[2]=qt.offset[0]*Pt,Ut[3]=0,Ut[4]=0,Ut[5]=qt.scale[1],Ut[6]=-qt.offset[1]*Pt,Ut[7]=0,Ut[8]=0,Ut[9]=0,Ut[10]=at/(je-at)*-Pt,Ut[11]=at*je/(je-at),Ut[12]=0,Ut[13]=0,Ut[14]=Pt,Ut[15]=0,xt.transpose(),xt}({upTan:Math.tan(Ce.upDegrees*Pt),downTan:Math.tan(Ce.downDegrees*Pt),leftTan:Math.tan(Ce.leftDegrees*Pt),rightTan:Math.tan(Ce.rightDegrees*Pt)},Fe,je,at)}},sf=function(o,l){var Ve,_e,me,Et,_t;this.object=o,this.domElement=void 0!==l?l:document,this.enabled=!0,this.target=new xe,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:zt_LEFT,ZOOM:zt_MIDDLE,PAN:zt_RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return F.phi},this.getAzimuthalAngle=function(){return F.theta},this.saveState=function(){p.target0.copy(p.target),p.position0.copy(p.object.position),p.zoom0=p.object.zoom},this.reset=function(){p.target.copy(p.target0),p.object.position.copy(p.position0),p.object.zoom=p.zoom0,p.object.updateProjectionMatrix(),p.dispatchEvent(v),p.update(),I=E.NONE},this.update=(Ve=new xe,_e=(new ci).setFromUnitVectors(o.up,new xe(0,1,0)),me=_e.clone().inverse(),Et=new xe,_t=new ci,function(){var Gt=p.object.position;return Ve.copy(Gt).sub(p.target),Ve.applyQuaternion(_e),F.setFromVector3(Ve),p.autoRotate&&I===E.NONE&&p.rotateLeft(function vt(){return 2*Math.PI/60/60*p.autoRotateSpeed}()),F.theta+=k.theta,F.phi+=k.phi,F.theta=Math.max(p.minAzimuthAngle,Math.min(p.maxAzimuthAngle,F.theta)),F.phi=Math.max(p.minPolarAngle,Math.min(p.maxPolarAngle,F.phi)),F.makeSafe(),F.radius*=U,F.radius=Math.max(p.minDistance,Math.min(p.maxDistance,F.radius)),p.target.add(G),Ve.setFromSpherical(F),Ve.applyQuaternion(me),Gt.copy(p.target).add(Ve),p.object.lookAt(p.target),!0===p.enableDamping?(k.theta*=1-p.dampingFactor,k.phi*=1-p.dampingFactor,G.multiplyScalar(1-p.dampingFactor)):(k.set(0,0,0),G.set(0,0,0)),U=1,!!(Y||Et.distanceToSquared(p.object.position)>R||8*(1-_t.dot(p.object.quaternion))>R)&&(p.dispatchEvent(v),Et.copy(p.object.position),_t.copy(p.object.quaternion),Y=!1,!0)}),this.dispose=function(){p.domElement.removeEventListener("contextmenu",On,!1),p.domElement.removeEventListener("mousedown",Kn,!1),p.domElement.removeEventListener("wheel",Hi,!1),p.domElement.removeEventListener("touchstart",Vt,!1),p.domElement.removeEventListener("touchend",un,!1),p.domElement.removeEventListener("touchmove",Zt,!1),document.removeEventListener("mousemove",Ni,!1),document.removeEventListener("mouseup",ri,!1),window.removeEventListener("keydown",si,!1)};var p=this,v={type:"change"},y={type:"start"},x={type:"end"},E={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},I=E.NONE,R=1e-6,F=new fr,k=new fr,U=1,G=new xe,Y=!1,re=new qe,ie=new qe,$=new qe,q=new qe,Ae=new qe,Ie=new qe,Se=new qe,he=new qe,De=new qe;function ke(){return Math.pow(.95,p.zoomSpeed)}p.rotateLeft=function(_e){k.theta-=_e},p.rotateUp=function(_e){k.phi-=_e};var Qe=function(){var Ve=new xe;return function(me,Et){Ve.setFromMatrixColumn(Et,0),Ve.multiplyScalar(-me),G.add(Ve)}}(),tt=function(){var Ve=new xe;return function(me,Et){!0===p.screenSpacePanning?Ve.setFromMatrixColumn(Et,1):(Ve.setFromMatrixColumn(Et,0),Ve.crossVectors(p.object.up,Ve)),Ve.multiplyScalar(me),G.add(Ve)}}(),ut=function(){var Ve=new xe;return function(me,Et){var _t=p.domElement===document?p.domElement.body:p.domElement;if(p.object.isPerspectiveCamera){Ve.copy(p.object.position).sub(p.target);var Gt=Ve.length();Gt*=Math.tan(p.object.fov/2*Math.PI/180),Qe(2*me*Gt/_t.clientHeight,p.object.matrix),tt(2*Et*Gt/_t.clientHeight,p.object.matrix)}else p.object.isOrthographicCamera?(Qe(me*(p.object.right-p.object.left)/p.object.zoom/_t.clientWidth,p.object.matrix),tt(Et*(p.object.top-p.object.bottom)/p.object.zoom/_t.clientHeight,p.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),p.enablePan=!1)}}();function Ze(Ve){p.object.isPerspectiveCamera?U/=Ve:p.object.isOrthographicCamera?(p.object.zoom=Math.max(p.minZoom,Math.min(p.maxZoom,p.object.zoom*Ve)),p.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),p.enableZoom=!1)}function Ce(Ve){p.object.isPerspectiveCamera?U*=Ve:p.object.isOrthographicCamera?(p.object.zoom=Math.max(p.minZoom,Math.min(p.maxZoom,p.object.zoom/Ve)),p.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),p.enableZoom=!1)}function Kn(Ve){if(!1!==p.enabled){switch(Ve.preventDefault(),Ve.button){case p.mouseButtons.ORBIT:if(!1===p.enableRotate)return;(function Fe(Ve){re.set(Ve.clientX,Ve.clientY)})(Ve),I=E.ROTATE;break;case p.mouseButtons.ZOOM:if(!1===p.enableZoom)return;(function je(Ve){Se.set(Ve.clientX,Ve.clientY)})(Ve),I=E.DOLLY;break;case p.mouseButtons.PAN:if(!1===p.enablePan)return;(function at(Ve){q.set(Ve.clientX,Ve.clientY)})(Ve),I=E.PAN}I!==E.NONE&&(document.addEventListener("mousemove",Ni,!1),document.addEventListener("mouseup",ri,!1),p.dispatchEvent(y))}}function Ni(Ve){if(!1!==p.enabled)switch(Ve.preventDefault(),I){case E.ROTATE:if(!1===p.enableRotate)return;!function Pt(Ve){ie.set(Ve.clientX,Ve.clientY),$.subVectors(ie,re).multiplyScalar(p.rotateSpeed);var _e=p.domElement===document?p.domElement.body:p.domElement;p.rotateLeft(2*Math.PI*$.x/_e.clientHeight),p.rotateUp(2*Math.PI*$.y/_e.clientHeight),re.copy(ie),p.update()}(Ve);break;case E.DOLLY:if(!1===p.enableZoom)return;!function xt(Ve){he.set(Ve.clientX,Ve.clientY),De.subVectors(he,Se),De.y>0?Ze(ke()):De.y<0&&Ce(ke()),Se.copy(he),p.update()}(Ve);break;case E.PAN:if(!1===p.enablePan)return;!function Ut(Ve){Ae.set(Ve.clientX,Ve.clientY),Ie.subVectors(Ae,q).multiplyScalar(p.panSpeed),ut(Ie.x,Ie.y),q.copy(Ae),p.update()}(Ve)}}function ri(Ve){!1!==p.enabled&&(document.removeEventListener("mousemove",Ni,!1),document.removeEventListener("mouseup",ri,!1),p.dispatchEvent(x),I=E.NONE)}function Hi(Ve){!1===p.enabled||!1===p.enableZoom||I!==E.NONE&&I!==E.ROTATE||(Ve.preventDefault(),Ve.stopPropagation(),p.dispatchEvent(y),function qt(Ve){Ve.deltaY<0?Ce(ke()):Ve.deltaY>0&&Ze(ke()),p.update()}(Ve),p.dispatchEvent(x))}function si(Ve){!1===p.enabled||!1===p.enableKeys||!1===p.enablePan||function Qn(Ve){switch(Ve.keyCode){case p.keys.UP:ut(0,p.keyPanSpeed),p.update();break;case p.keys.BOTTOM:ut(0,-p.keyPanSpeed),p.update();break;case p.keys.LEFT:ut(p.keyPanSpeed,0),p.update();break;case p.keys.RIGHT:ut(-p.keyPanSpeed,0),p.update()}}(Ve)}function Vt(Ve){if(!1!==p.enabled){switch(Ve.preventDefault(),Ve.touches.length){case 1:if(!1===p.enableRotate)return;(function Un(Ve){re.set(Ve.touches[0].pageX,Ve.touches[0].pageY)})(Ve),I=E.TOUCH_ROTATE;break;case 2:if(!1===p.enableZoom&&!1===p.enablePan)return;(function ki(Ve){if(p.enableZoom){var _e=Ve.touches[0].pageX-Ve.touches[1].pageX,me=Ve.touches[0].pageY-Ve.touches[1].pageY,Et=Math.sqrt(_e*_e+me*me);Se.set(0,Et)}p.enablePan&&q.set(.5*(Ve.touches[0].pageX+Ve.touches[1].pageX),.5*(Ve.touches[0].pageY+Ve.touches[1].pageY))})(Ve),I=E.TOUCH_DOLLY_PAN;break;default:I=E.NONE}I!==E.NONE&&p.dispatchEvent(y)}}function Zt(Ve){if(!1!==p.enabled)switch(Ve.preventDefault(),Ve.stopPropagation(),Ve.touches.length){case 1:if(!1===p.enableRotate||I!==E.TOUCH_ROTATE)return;!function mt(Ve){ie.set(Ve.touches[0].pageX,Ve.touches[0].pageY),$.subVectors(ie,re).multiplyScalar(p.rotateSpeed);var _e=p.domElement===document?p.domElement.body:p.domElement;p.rotateLeft(2*Math.PI*$.x/_e.clientHeight),p.rotateUp(2*Math.PI*$.y/_e.clientHeight),re.copy(ie),p.update()}(Ve);break;case 2:if(!1===p.enableZoom&&!1===p.enablePan||I!==E.TOUCH_DOLLY_PAN)return;!function is(Ve){if(p.enableZoom){var _e=Ve.touches[0].pageX-Ve.touches[1].pageX,me=Ve.touches[0].pageY-Ve.touches[1].pageY,Et=Math.sqrt(_e*_e+me*me);he.set(0,Et),De.set(0,Math.pow(he.y/Se.y,p.zoomSpeed)),Ze(De.y),Se.copy(he)}p.enablePan&&(Ae.set(.5*(Ve.touches[0].pageX+Ve.touches[1].pageX),.5*(Ve.touches[0].pageY+Ve.touches[1].pageY)),Ie.subVectors(Ae,q).multiplyScalar(p.panSpeed),ut(Ie.x,Ie.y),q.copy(Ae)),p.update()}(Ve);break;default:I=E.NONE}}function un(Ve){!1!==p.enabled&&(p.dispatchEvent(x),I=E.NONE)}function On(Ve){!1!==p.enabled&&Ve.preventDefault()}p.domElement.addEventListener("mousedown",Kn,!1),p.domElement.addEventListener("wheel",Hi,!1),p.domElement.addEventListener("touchstart",Vt,!1),p.domElement.addEventListener("touchend",un,!1),p.domElement.addEventListener("touchmove",Zt,!1),window.addEventListener("keydown",si,!1),this.update()};(sf.prototype=Object.create(Go.prototype)).constructor=sf,Object.defineProperties(sf.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(o){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!o}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(o){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!o}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(o){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!o}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(o){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!o}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(o){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!o}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(o){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=o}}});var Wr=function(o){var l=this;this.object=o,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var x,E,I,R,p=function(E){l.deviceOrientation=E},v=function(){l.screenOrientation=window.orientation||0},y=(x=new xe(0,0,1),E=new cu,I=new ci,R=new ci(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(F,k,U,G,Y){E.set(U,k,-G,"YXZ"),F.setFromEuler(E),F.multiply(R),F.multiply(I.setFromAxisAngle(x,-Y))});this.connect=function(){v(),window.addEventListener("orientationchange",v,!1),window.addEventListener("deviceorientation",p,!1),l.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",v,!1),window.removeEventListener("deviceorientation",p,!1),l.enabled=!1},this.update=function(){if(!1!==l.enabled){var x=l.deviceOrientation;if(x){var E=x.alpha?pi.degToRad(x.alpha)+l.alphaOffset:0,I=x.beta?pi.degToRad(x.beta):0,R=x.gamma?pi.degToRad(x.gamma):0,F=l.screenOrientation?pi.degToRad(l.screenOrientation):0;y(l.object.quaternion,E,I,R,F)}}},this.dispose=function(){l.disconnect()},this.connect()};var a,Z0=function(){function a(l){this.object=l.camera,this.domElement=l.canvas,this.orbit=new sf(this.object,this.domElement),this.speed=.5,this.orbit.target.set(0,0,-1),this.orbit.enableZoom=!1,this.orbit.enablePan=!1,this.orbit.rotateSpeed=-this.speed,l.orientation&&(this.orientation=new Wr(this.object)),l.halfView&&(this.orbit.minAzimuthAngle=-Math.PI/4,this.orbit.maxAzimuthAngle=Math.PI/4)}var o=a.prototype;return o.update=function(){if(this.orientation){this.orientation.update();var p=this.orientation.object.quaternion,v=function gT(a,o,l,p){var v=a*o+l*p;if(v>.499){var y=2*Math.atan2(a,p),x=Math.PI/2;return new xe(x,0,y)}if(v<-.499){var I=-2*Math.atan2(a,p),R=-Math.PI/2;return new xe(R,0,I)}var k=a*a,G=l*l,Y=Math.atan2(2*o*p-2*a*l,1-o*o*2-2*G),re=Math.asin(2*v),ie=Math.atan2(2*a*p-2*o*l,1-2*k-2*G);return new xe(re,ie,Y)}(p.x,p.y,p.z,p.w);typeof this.lastAngle_>"u"&&(this.lastAngle_=v),this.orbit.rotateLeft((this.lastAngle_.z-v.z)*(1+this.speed)),this.orbit.rotateUp((this.lastAngle_.y-v.y)*(1+this.speed)),this.lastAngle_=v}this.orbit.update()},o.dispose=function(){this.orbit.dispose(),this.orientation&&this.orientation.dispose()},a}(),vT=((a=dt.createElement("video")).crossOrigin="anonymous",a.hasAttribute("crossorigin")),Sp=["360","360_LR","360_TB","360_CUBE","EAC","EAC_LR","NONE","AUTO","Sphere","Cube","equirectangular","180","180_LR","180_MONO"],wl=function(o){if(o){if(o=o.toString().trim(),/sphere/i.test(o))return"360";if(/cube/i.test(o))return"360_CUBE";if(/equirectangular/i.test(o))return"360";for(var l=0;l<Sp.length;l++)if(new RegExp("^"+Sp[l]+"$","i").test(o))return Sp[l]}},Ep=function(a){function o(p,v,y){var x;return(x=a.call(this)||this).player=p,x.canvas=v,x.options=y,x.onMoveEnd=Oe.bind(Nt(x),x.onMoveEnd),x.onMoveStart=Oe.bind(Nt(x),x.onMoveStart),x.onMove=Oe.bind(Nt(x),x.onMove),x.onControlBarMove=Oe.bind(Nt(x),x.onControlBarMove),x.player.controlBar.on(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],x.onControlBarMove),x.oldReportUserActivity=x.player.reportUserActivity,x.player.reportUserActivity=function(){},x.canvas.addEventListener("mousedown",x.onMoveStart),x.canvas.addEventListener("touchstart",x.onMoveStart),x.canvas.addEventListener("mousemove",x.onMove),x.canvas.addEventListener("touchmove",x.onMove),x.canvas.addEventListener("mouseup",x.onMoveEnd),x.canvas.addEventListener("touchend",x.onMoveEnd),x.shouldTogglePlay=!1,x}Bt(o,a);var l=o.prototype;return l.togglePlay=function(){this.player.paused()?this.player.play():this.player.pause()},l.onMoveStart=function(v){this.options.disableTogglePlay||!this.player.controls()||"mousedown"===v.type&&!Oe.dom.isSingleLeftClick(v)?this.shouldTogglePlay=!1:(this.shouldTogglePlay=!0,this.touchMoveCount_=0)},l.onMoveEnd=function(v){if("touchend"===v.type&&this.touchMoveCount_<10)return!1===this.player.userActive()?void this.player.userActive(!0):void this.player.userActive(!1);!this.shouldTogglePlay||"mouseup"===v.type&&this.togglePlay()},l.onMove=function(v){this.touchMoveCount_++,this.shouldTogglePlay=!1},l.onControlBarMove=function(v){this.player.userActive(!0)},l.dispose=function(){this.canvas.removeEventListener("mousedown",this.onMoveStart),this.canvas.removeEventListener("touchstart",this.onMoveStart),this.canvas.removeEventListener("mousemove",this.onMove),this.canvas.removeEventListener("touchmove",this.onMove),this.canvas.removeEventListener("mouseup",this.onMoveEnd),this.canvas.removeEventListener("touchend",this.onMoveEnd),this.player.controlBar.off(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],this.onControlBarMove),this.player.reportUserActivity=this.oldReportUserActivity},o}(Oe.EventTarget),mg=function(a){function o(p,v,y,x){var E;E=a.call(this)||this;var I=Oe.mergeOptions({channelMap:Oe.browser.IS_SAFARI?[2,0,1,3]:[0,1,2,3],ambisonicOrder:1},x);return E.videoElementSource=p.createMediaElementSource(y),E.foaRenderer=v.createFOARenderer(p,I),E.foaRenderer.initialize().then(function(){"suspended"===p.state&&E.trigger({type:"audiocontext-suspended"}),E.videoElementSource.connect(E.foaRenderer.input),E.foaRenderer.output.connect(p.destination),E.initialized=!0,E.trigger({type:"omnitone-ready"})},function(R){Oe.log.warn("videojs-vr: Omnitone initializes failed with the following error: "+R+")")}),E}Bt(o,a);var l=o.prototype;return l.update=function(v){!this.initialized||this.foaRenderer.setRotationMatrixFromCamera(v.matrix)},l.dispose=function(){this.initialized=!1,this.foaRenderer.setRenderingMode("bypass"),this.foaRenderer=null},o}(Oe.EventTarget),vg=function(a){function o(p,v){var y;return(y=a.call(this,p,v)||this).handleVrDisplayActivate_=Oe.bind(Nt(y),y.handleVrDisplayActivate_),y.handleVrDisplayDeactivate_=Oe.bind(Nt(y),y.handleVrDisplayDeactivate_),y.handleVrDisplayPresentChange_=Oe.bind(Nt(y),y.handleVrDisplayPresentChange_),y.handleOrientationChange_=Oe.bind(Nt(y),y.handleOrientationChange_),se.addEventListener("orientationchange",y.handleOrientationChange_),se.addEventListener("vrdisplayactivate",y.handleVrDisplayActivate_),se.addEventListener("vrdisplaydeactivate",y.handleVrDisplayDeactivate_),se.addEventListener("vrdisplaypresentchange",y.handleVrDisplayPresentChange_),Oe.browser.IS_ANDROID&&y.on(p,"fullscreenchange",function(){p.isFullscreen()?y.hide():y.show()}),y}Bt(o,a);var l=o.prototype;return l.buildCSSClass=function(){return"vjs-button-vr "+a.prototype.buildCSSClass.call(this)},l.handleVrDisplayPresentChange_=function(){!this.player_.vr().vrDisplay.isPresenting&&this.active_&&this.handleVrDisplayDeactivate_(),this.player_.vr().vrDisplay.isPresenting&&!this.active_&&this.handleVrDisplayActivate_()},l.handleOrientationChange_=function(){this.active_&&Oe.browser.IS_IOS&&this.changeSize_()},l.changeSize_=function(){this.player_.width(se.innerWidth),this.player_.height(se.innerHeight),se.dispatchEvent(new se.Event("resize"))},l.handleVrDisplayActivate_=function(){Oe.browser.IS_IOS&&(this.oldWidth_=this.player_.currentWidth(),this.oldHeight_=this.player_.currentHeight(),this.player_.enterFullWindow(),this.changeSize_()),this.active_=!0},l.handleVrDisplayDeactivate_=function(){Oe.browser.IS_IOS&&(this.oldWidth_&&this.player_.width(this.oldWidth_),this.oldHeight_&&this.player_.height(this.oldHeight_),this.player_.exitFullWindow()),this.active_=!1},l.handleClick=function(v){this.active_?se.dispatchEvent(new se.Event("vrdisplaydeactivate")):(!this.player_.hasStarted()&&Oe.browser.IS_ANDROID&&this.player_.play(),se.dispatchEvent(new se.Event("vrdisplayactivate")))},l.dispose=function(){a.prototype.dispose.call(this),se.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_),se.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_),se.removeEventListener("vrdisplaypresentchange",this.handleVrDisplayPresentChange_)},o}(Oe.getComponent("Button"));Oe.registerComponent("CardboardButton",vg);var _g=function(a){function o(){return a.apply(this,arguments)||this}return Bt(o,a),o.prototype.buildCSSClass=function(){return"vjs-big-vr-play-button "+a.prototype.buildCSSClass.call(this)},o}(Oe.getComponent("BigPlayButton"));function pr(a,o){var l=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(l)return(l=l.call(a)).next.bind(l);if(Array.isArray(a)||(l=function $c(a,o){if(a){if("string"==typeof a)return r_(a,o);var l=Object.prototype.toString.call(a).slice(8,-1);if("Object"===l&&a.constructor&&(l=a.constructor.name),"Map"===l||"Set"===l)return Array.from(a);if("Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return r_(a,o)}}(a))||o&&a&&"number"==typeof a.length){l&&(a=l);var p=0;return function(){return p>=a.length?{done:!0}:{done:!1,value:a[p++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r_(a,o){(null==o||o>a.length)&&(o=a.length);for(var l=0,p=new Array(o);l<o;l++)p[l]=a[l];return p}Oe.registerComponent("BigVrPlayButton",_g);var Ub={debug:!1,omnitone:!1,forceCardboard:!1,omnitoneOptions:{},projection:"AUTO",sphereDetail:32,disableTogglePlay:!1},J0={"web-vr-out-of-date":{headline:"360 is out of date",type:"360_OUT_OF_DATE",message:"Your browser supports 360 but not the latest version. See <a href='http://webvr.info'>http://webvr.info</a> for more info."},"web-vr-not-supported":{headline:"360 not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser does not support 360. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."},"web-vr-hls-cors-not-supported":{headline:"360 HLS video not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser/device does not support HLS 360 video. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."}},ey=Oe.getPlugin("plugin"),Cp=Oe.getComponent("Component"),Dp=function(a){function o(p,v){var y,x=Oe.mergeOptions(Ub,v);return(y=a.call(this,p,x)||this).options_=x,y.player_=p,y.bigPlayButtonIndex_=p.children().indexOf(p.getChild("BigPlayButton"))||0,y.videojsErrorsSupport_=!!Oe.errors,y.videojsErrorsSupport_&&p.errors({errors:J0}),Oe.browser.IE_VERSION||!vT?(y.player_.on("loadstart",function(){y.triggerError_({code:"web-vr-not-supported",dismiss:!1})}),Nt(y)):(y.polyfill_=new Ir({ROTATE_INSTRUCTIONS_DISABLED:!0}),y.polyfill_=new Ir,y.handleVrDisplayActivate_=Oe.bind(Nt(y),y.handleVrDisplayActivate_),y.handleVrDisplayDeactivate_=Oe.bind(Nt(y),y.handleVrDisplayDeactivate_),y.handleResize_=Oe.bind(Nt(y),y.handleResize_),y.animate_=Oe.bind(Nt(y),y.animate_),y.setProjection(y.options_.projection),y.on(p,"adstart",function(){return p.setTimeout(function(){p.ads&&p.ads.videoElementRecycled()?(y.log("video element recycled for this ad, reseting"),y.reset(),y.one(p,"playing",y.init)):y.log("video element not recycled for this ad, no need to reset")})},1),y.on(p,"loadedmetadata",y.init),y)}Bt(o,a);var l=o.prototype;return l.changeProjection_=function(v){var y=this;(v=wl(v))||(v="NONE");var x_x=0,x_y=0,x_z=0;if(this.scene&&this.scene.remove(this.movieScreen),"AUTO"===v){if(this.player_.mediainfo&&this.player_.mediainfo.projection&&"AUTO"!==this.player_.mediainfo.projection){var E=wl(this.player_.mediainfo.projection);return this.changeProjection_(E)}return this.changeProjection_("NONE")}if("360"===v)this.movieGeometry=new Eu(256,this.options_.sphereDetail,this.options_.sphereDetail),this.movieMaterial=new Pa({map:this.videoTexture,overdraw:!0,side:1}),this.movieScreen=new Zr(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(x_x,x_y,x_z),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.scene.add(this.movieScreen);else if("360_LR"===v||"360_TB"===v){for(var I=new Eu(256,this.options_.sphereDetail,this.options_.sphereDetail),R=I.faceVertexUvs[0],F=0;F<R.length;F++)for(var k=0;k<3;k++)"360_LR"===v?R[F][k].x*=.5:(R[F][k].y*=.5,R[F][k].y+=.5);this.movieGeometry=(new xi).fromGeometry(I),this.movieMaterial=new Pa({map:this.videoTexture,overdraw:!0,side:1}),this.movieScreen=new Zr(this.movieGeometry,this.movieMaterial),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),R=(I=new Eu(256,this.options_.sphereDetail,this.options_.sphereDetail)).faceVertexUvs[0];for(var U=0;U<R.length;U++)for(var G=0;G<3;G++)"360_LR"===v?(R[U][G].x*=.5,R[U][G].x+=.5):R[U][G].y*=.5;this.movieGeometry=(new xi).fromGeometry(I),this.movieMaterial=new Pa({map:this.videoTexture,overdraw:!0,side:1}),this.movieScreen=new Zr(this.movieGeometry,this.movieMaterial),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}else if("360_CUBE"===v){this.movieGeometry=new Pc(256,256,256),this.movieMaterial=new Pa({map:this.videoTexture,overdraw:!0,side:1});var Y=[new qe(0,.5),new qe(.333,.5),new qe(.333,1),new qe(0,1)],re=[new qe(.333,.5),new qe(.666,.5),new qe(.666,1),new qe(.333,1)],ie=[new qe(.666,.5),new qe(1,.5),new qe(1,1),new qe(.666,1)],$=[new qe(0,0),new qe(.333,0),new qe(.333,.5),new qe(0,.5)],q=[new qe(.333,0),new qe(.666,0),new qe(.666,.5),new qe(.333,.5)],Ae=[new qe(.666,0),new qe(1,0),new qe(1,.5),new qe(.666,.5)];this.movieGeometry.faceVertexUvs[0]=[],this.movieGeometry.faceVertexUvs[0][0]=[re[2],re[1],re[3]],this.movieGeometry.faceVertexUvs[0][1]=[re[1],re[0],re[3]],this.movieGeometry.faceVertexUvs[0][2]=[Y[2],Y[1],Y[3]],this.movieGeometry.faceVertexUvs[0][3]=[Y[1],Y[0],Y[3]],this.movieGeometry.faceVertexUvs[0][4]=[ie[2],ie[1],ie[3]],this.movieGeometry.faceVertexUvs[0][5]=[ie[1],ie[0],ie[3]],this.movieGeometry.faceVertexUvs[0][6]=[$[2],$[1],$[3]],this.movieGeometry.faceVertexUvs[0][7]=[$[1],$[0],$[3]],this.movieGeometry.faceVertexUvs[0][8]=[q[2],q[1],q[3]],this.movieGeometry.faceVertexUvs[0][9]=[q[1],q[0],q[3]],this.movieGeometry.faceVertexUvs[0][10]=[Ae[2],Ae[1],Ae[3]],this.movieGeometry.faceVertexUvs[0][11]=[Ae[1],Ae[0],Ae[3]],this.movieScreen=new Zr(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(x_x,x_y,x_z),this.movieScreen.rotation.y=-Math.PI,this.scene.add(this.movieScreen)}else if("180"===v||"180_LR"===v||"180_MONO"===v){var Ie=new Eu(256,this.options_.sphereDetail,this.options_.sphereDetail,Math.PI,Math.PI);Ie.scale(-1,1,1);var Se=Ie.faceVertexUvs[0];if("180_MONO"!==v)for(var he=0;he<Se.length;he++)for(var De=0;De<3;De++)Se[he][De].x*=.5;this.movieGeometry=(new xi).fromGeometry(Ie),this.movieMaterial=new Pa({map:this.videoTexture,overdraw:!0}),this.movieScreen=new Zr(this.movieGeometry,this.movieMaterial),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),(Ie=new Eu(256,this.options_.sphereDetail,this.options_.sphereDetail,Math.PI,Math.PI)).scale(-1,1,1),Se=Ie.faceVertexUvs[0];for(var vt=0;vt<Se.length;vt++)for(var ke=0;ke<3;ke++)Se[vt][ke].x*=.5,Se[vt][ke].x+=.5;this.movieGeometry=(new xi).fromGeometry(Ie),this.movieMaterial=new Pa({map:this.videoTexture,overdraw:!0}),this.movieScreen=new Zr(this.movieGeometry,this.movieMaterial),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}else if("EAC"===v||"EAC_LR"===v){var Qe=function(Ze,Ce){y.movieGeometry=new Pc(256,256,256),y.movieMaterial=new Ws({overdraw:!0,side:1,uniforms:{mapped:{value:y.videoTexture},mapMatrix:{value:Ze},contCorrect:{value:2},faceWH:{value:new qe(.3333333333333333,.5).applyMatrix3(Ce)},vidWH:{value:new qe(y.videoTexture.image.videoWidth,y.videoTexture.image.videoHeight).applyMatrix3(Ce)}},vertexShader:"\nvarying vec2 vUv;\nuniform mat3 mapMatrix;\n\nvoid main() {\n  vUv = (mapMatrix * vec3(uv, 1.)).xy;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n}",fragmentShader:"\nvarying vec2 vUv;\nuniform sampler2D mapped;\nuniform vec2 faceWH;\nuniform vec2 vidWH;\nuniform float contCorrect;\n\nconst float PI = 3.1415926535897932384626433832795;\n\nvoid main() {\n  vec2 corner = vUv - mod(vUv, faceWH) + vec2(0, contCorrect / vidWH.y);\n\n  vec2 faceWHadj = faceWH - vec2(0, contCorrect * 2. / vidWH.y);\n\n  vec2 p = (vUv - corner) / faceWHadj - .5;\n  vec2 q = 2. / PI * atan(2. * p) + .5;\n\n  vec2 eUv = corner + q * faceWHadj;\n\n  gl_FragColor = texture2D(mapped, eUv);\n}"});for(var je=[new qe(0,.5),new qe(1/3,.5),new qe(1/3,1),new qe(0,1)],at=[new qe(1/3,.5),new qe(2/3,.5),new qe(2/3,1),new qe(1/3,1)],Pt=[new qe(2/3,.5),new qe(1,.5),new qe(1,1),new qe(2/3,1)],xt=[new qe(1/3,0),new qe(1/3,.5),new qe(0,.5),new qe(0,0)],Ut=[new qe(1/3,.5),new qe(1/3,0),new qe(2/3,0),new qe(2/3,.5)],qt=[new qe(1,0),new qe(1,.5),new qe(2/3,.5),new qe(2/3,0)],Qn=0,Un=[je,at,Pt,xt,Ut,qt];Qn<Un.length;Qn++){for(var ri,ki=Un[Qn],mt=y.videoTexture.image.videoHeight,is=1,Kn=0,Ni=pr(ki);!(ri=Ni()).done;){var Hi=ri.value;Hi.y<is&&(is=Hi.y),Hi.y>Kn&&(Kn=Hi.y)}for(var Vt,si=pr(ki);!(Vt=si()).done;){var Zt=Vt.value;Math.abs(Zt.y-is)<Number.EPSILON&&(Zt.y+=2/mt),Math.abs(Zt.y-Kn)<Number.EPSILON&&(Zt.y-=2/mt),Zt.x=Zt.x/mt*(mt-4)+2/mt}}return y.movieGeometry.faceVertexUvs[0]=[],y.movieGeometry.faceVertexUvs[0][0]=[je[2],je[1],je[3]],y.movieGeometry.faceVertexUvs[0][1]=[je[1],je[0],je[3]],y.movieGeometry.faceVertexUvs[0][2]=[Pt[2],Pt[1],Pt[3]],y.movieGeometry.faceVertexUvs[0][3]=[Pt[1],Pt[0],Pt[3]],y.movieGeometry.faceVertexUvs[0][4]=[qt[2],qt[1],qt[3]],y.movieGeometry.faceVertexUvs[0][5]=[qt[1],qt[0],qt[3]],y.movieGeometry.faceVertexUvs[0][6]=[xt[2],xt[1],xt[3]],y.movieGeometry.faceVertexUvs[0][7]=[xt[1],xt[0],xt[3]],y.movieGeometry.faceVertexUvs[0][8]=[at[2],at[1],at[3]],y.movieGeometry.faceVertexUvs[0][9]=[at[1],at[0],at[3]],y.movieGeometry.faceVertexUvs[0][10]=[Ut[2],Ut[1],Ut[3]],y.movieGeometry.faceVertexUvs[0][11]=[Ut[1],Ut[0],Ut[3]],y.movieScreen=new Zr(y.movieGeometry,y.movieMaterial),y.movieScreen.position.set(x_x,x_y,x_z),y.movieScreen.rotation.y=-Math.PI,y.movieScreen};if("EAC"===v)this.scene.add(Qe(new la,new la));else{var tt=(new la).set(0,.5,0,1,0,0,0,0,1);Qe((new la).set(0,-.5,.5,1,0,0,0,0,1),tt),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),Qe((new la).set(0,-.5,1,1,0,0,0,0,1),tt),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}}this.currentProjection_=v},l.triggerError_=function(v){if(this.videojsErrorsSupport_)this.player_.error(v);else{var y=dt.createElement("div");y.innerHTML=J0[v.code].message,this.player_.error({code:v.code,message:y.textContent||y.innerText||""})}},l.log=function(){if(this.options_.debug){for(var v=arguments.length,y=new Array(v),x=0;x<v;x++)y[x]=arguments[x];y.forEach(function(E){Oe.log("VR: ",E)})}},l.handleVrDisplayActivate_=function(){var v=this;!this.vrDisplay||this.vrDisplay.requestPresent([{source:this.renderedCanvas}]).then(function(){if(v.vrDisplay.cardboardUI_&&Oe.browser.IS_IOS){var y=[],x=function(R){for(var F=0;F<R.touches.length;F++)y.push(R.touches[F])},E=function(R){!y.length||(y.forEach(function(F){var k=new se.MouseEvent("click",{screenX:F.screenX,screenY:F.screenY,clientX:F.clientX,clientY:F.clientY});v.renderedCanvas.dispatchEvent(k)}),y=[])};v.renderedCanvas.addEventListener("touchstart",x),v.renderedCanvas.addEventListener("touchend",E),v.iosRevertTouchToClick_=function(){v.renderedCanvas.removeEventListener("touchstart",x),v.renderedCanvas.removeEventListener("touchend",E),v.iosRevertTouchToClick_=null}}})},l.handleVrDisplayDeactivate_=function(){!this.vrDisplay||!this.vrDisplay.isPresenting||(this.iosRevertTouchToClick_&&this.iosRevertTouchToClick_(),this.vrDisplay.exitPresent())},l.requestAnimationFrame=function(v){return this.vrDisplay?this.vrDisplay.requestAnimationFrame(v):this.player_.requestAnimationFrame(v)},l.cancelAnimationFrame=function(v){return this.vrDisplay?this.vrDisplay.cancelAnimationFrame(v):this.player_.cancelAnimationFrame(v)},l.togglePlay_=function(){this.player_.paused()?this.player_.play():this.player_.pause()},l.animate_=function(){if(this.initialized_){if(this.getVideoEl_().readyState===this.getVideoEl_().HAVE_ENOUGH_DATA&&this.videoTexture&&(this.videoTexture.needsUpdate=!0),this.controls3d.update(),this.omniController&&this.omniController.update(this.camera),this.effect.render(this.scene,this.camera),se.navigator.getGamepads)for(var v=se.navigator.getGamepads(),y=0;y<v.length;++y){var x=v[y];if(x&&x.timestamp&&x.timestamp!==this.prevTimestamps_[y])for(var E=0;E<x.buttons.length;++E)if(x.buttons[E].pressed){this.togglePlay_(),this.prevTimestamps_[y]=x.timestamp;break}}this.camera.getWorldDirection(this.cameraVector),this.animationFrameId_=this.requestAnimationFrame(this.animate_)}},l.handleResize_=function(){var v=this.player_.currentWidth(),y=this.player_.currentHeight();this.effect.setSize(v,y,!1),this.camera.aspect=v/y,this.camera.updateProjectionMatrix()},l.setProjection=function(v){wl(v)?(this.currentProjection_=v,this.defaultProjection_=v):Oe.log.error("videojs-vr: please pass a valid projection "+Sp.join(", "))},l.init=function(){var v=this;if(this.reset(),this.camera=new ks(75,this.player_.currentWidth()/this.player_.currentHeight(),1,1e3),this.cameraVector=new xe,("360_LR"===this.currentProjection_||"360_TB"===this.currentProjection_||"180"===this.currentProjection_||"180_LR"===this.currentProjection_||"180_MONO"===this.currentProjection_||"EAC_LR"===this.currentProjection_)&&this.camera.layers.enable(1),this.scene=new Zu,this.videoTexture=new zv(this.getVideoEl_()),this.videoTexture.generateMipmaps=!1,this.videoTexture.minFilter=oe,this.videoTexture.magFilter=oe,this.videoTexture.format=To,this.changeProjection_(this.currentProjection_),"NONE"===this.currentProjection_)return this.log("Projection is NONE, dont init"),void this.reset();this.player_.removeChild("BigPlayButton"),this.player_.addChild("BigVrPlayButton",{},this.bigPlayButtonIndex_),this.player_.bigPlayButton=this.player_.getChild("BigVrPlayButton"),(this.options_.forceCardboard||Oe.browser.IS_ANDROID||Oe.browser.IS_IOS)&&this.addCardboardButton_(),Oe.browser.IS_IOS&&this.player_.controlBar&&this.player_.controlBar.fullscreenToggle&&this.player_.controlBar.fullscreenToggle.hide(),this.camera.position.set(0,0,0),this.renderer=new Do({devicePixelRatio:se.devicePixelRatio,alpha:!1,clearColor:16777215,antialias:!0});var y=this.renderer.getContext("webgl"),x=y.texImage2D;y.texImage2D=function(){try{for(var R=arguments.length,F=new Array(R),k=0;k<R;k++)F[k]=arguments[k];return x.apply(y,F)}catch(U){throw v.reset(),v.player_.pause(),v.triggerError_({code:"web-vr-hls-cors-not-supported",dismiss:!1}),new Error(U)}},this.renderer.setSize(this.player_.currentWidth(),this.player_.currentHeight(),!1),this.effect=new Wd(this.renderer),this.effect.setSize(this.player_.currentWidth(),this.player_.currentHeight(),!1),this.vrDisplay=null,this.prevTimestamps_=[],this.renderedCanvas=this.renderer.domElement,this.renderedCanvas.setAttribute("style","width: 100%; height: 100%; position: absolute; top:0;");var E=this.getVideoEl_().style;if(this.player_.el().insertBefore(this.renderedCanvas,this.player_.el().firstChild),E.zIndex="-1",E.opacity="0",se.navigator.getVRDisplays?(this.log("is supported, getting vr displays"),se.navigator.getVRDisplays().then(function(R){if(R.length>0&&(v.log("Displays found",R),v.vrDisplay=R[0],v.vrDisplay.isPolyfilled||(v.log("Real HMD found using VRControls",v.vrDisplay),v.addCardboardButton_(),v.controls3d=new pg(v.camera))),!v.controls3d){v.log("no HMD found Using Orbit & Orientation Controls");var F={camera:v.camera,canvas:v.renderedCanvas,halfView:0===v.currentProjection_.indexOf("180"),orientation:Oe.browser.IS_IOS||Oe.browser.IS_ANDROID||!1};!1===v.options_.motionControls&&(F.orientation=!1),v.controls3d=new Z0(F),v.canvasPlayerControls=new Ep(v.player_,v.renderedCanvas,v.options_)}v.animationFrameId_=v.requestAnimationFrame(v.animate_)})):this.triggerError_(se.navigator.getVRDevices?{code:"web-vr-out-of-date",dismiss:!1}:{code:"web-vr-not-supported",dismiss:!1}),this.options_.omnitone){var I=u_getContext();this.omniController=new mg(I,this.options_.omnitone,this.getVideoEl_(),this.options_.omnitoneOptions),this.omniController.one("audiocontext-suspended",function(){v.player.pause(),v.player.one("playing",function(){I.resume()})})}this.on(this.player_,"fullscreenchange",this.handleResize_),se.addEventListener("vrdisplaypresentchange",this.handleResize_,!0),se.addEventListener("resize",this.handleResize_,!0),se.addEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),se.addEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.initialized_=!0,this.trigger("initialized")},l.addCardboardButton_=function(){this.player_.controlBar.getChild("CardboardButton")||this.player_.controlBar.addChild("CardboardButton",{})},l.getVideoEl_=function(){return this.player_.el().getElementsByTagName("video")[0]},l.reset=function(){if(this.initialized_){this.omniController&&(this.omniController.off("audiocontext-suspended"),this.omniController.dispose(),this.omniController=void 0),this.controls3d&&(this.controls3d.dispose(),this.controls3d=null),this.canvasPlayerControls&&(this.canvasPlayerControls.dispose(),this.canvasPlayerControls=null),this.effect&&(this.effect.dispose(),this.effect=null),se.removeEventListener("resize",this.handleResize_,!0),se.removeEventListener("vrdisplaypresentchange",this.handleResize_,!0),se.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),se.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.player_.getChild("BigPlayButton")||this.player_.addChild("BigPlayButton",{},this.bigPlayButtonIndex_),this.player_.getChild("BigVrPlayButton")&&this.player_.removeChild("BigVrPlayButton"),this.player_.getChild("CardboardButton")&&this.player_.controlBar.removeChild("CardboardButton"),Oe.browser.IS_IOS&&this.player_.controlBar&&this.player_.controlBar.fullscreenToggle&&this.player_.controlBar.fullscreenToggle.show();var v=this.getVideoEl_().style;v.zIndex="",v.opacity="",this.currentProjection_=this.defaultProjection_,this.iosRevertTouchToClick_&&this.iosRevertTouchToClick_(),this.renderedCanvas&&this.renderedCanvas.parentNode.removeChild(this.renderedCanvas),this.animationFrameId_&&this.cancelAnimationFrame(this.animationFrameId_),this.initialized_=!1}},l.dispose=function(){a.prototype.dispose.call(this),this.reset()},l.polyfillVersion=function(){return Ir.version},o}(ey);return Dp.prototype.setTimeout=Cp.prototype.setTimeout,Dp.prototype.clearTimeout=Cp.prototype.clearTimeout,Dp.VERSION="1.10.1",Oe.registerPlugin("vr",Dp),Dp}(on(226),on(421),on(17))},629:(ni,In,on)=>{var ht=on(226),se=ni.exports={WebVTT:on(318),VTTCue:on(713),VTTRegion:on(872)};ht.vttjs=se,ht.WebVTT=se.WebVTT;var dt=se.VTTCue,Oe=se.VTTRegion,Mt=ht.VTTCue,Wt=ht.VTTRegion;se.shim=function(){ht.VTTCue=dt,ht.VTTRegion=Oe},se.restore=function(){ht.VTTCue=Mt,ht.VTTRegion=Wt},ht.VTTCue||se.shim()},318:(ni,In,on)=>{var ht=on(421),se=Object.create||function(){function ge(){}return function(Te){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return ge.prototype=Te,new ge}}();function dt(ge,Te){this.name="ParsingError",this.code=ge.code,this.message=Te||ge.message}function Oe(ge){function Te(Ot,Tt,tn,Lt){return 3600*(0|Ot)+60*(0|Tt)+(0|tn)+(0|Lt)/1e3}var it=ge.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return it?it[3]?Te(it[1],it[2],it[3].replace(":",""),it[4]):it[1]>59?Te(it[1],it[2],0,it[4]):Te(0,it[1],it[2],it[4]):null}function Mt(){this.values=se(null)}function Wt(ge,Te,it,Ot){var Tt=Ot?ge.split(Ot):[ge];for(var tn in Tt)if("string"==typeof Tt[tn]){var Lt=Tt[tn].split(it);2===Lt.length&&Te(Lt[0].trim(),Lt[1].trim())}}function yt(ge,Te,it){var Ot=ge;function Tt(){var jt=Oe(ge);if(null===jt)throw new dt(dt.Errors.BadTimeStamp,"Malformed timestamp: "+Ot);return ge=ge.replace(/^[^\sa-zA-Z-]+/,""),jt}function Lt(){ge=ge.replace(/^\s+/,"")}if(Lt(),Te.startTime=Tt(),Lt(),"--\x3e"!==ge.substr(0,3))throw new dt(dt.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+Ot);ge=ge.substr(3),Lt(),Te.endTime=Tt(),Lt(),function tn(jt,kt){var Qt=new Mt;Wt(jt,function(Ht,Jt){switch(Ht){case"region":for(var Yt=it.length-1;Yt>=0;Yt--)if(it[Yt].id===Jt){Qt.set(Ht,it[Yt].region);break}break;case"vertical":Qt.alt(Ht,Jt,["rl","lr"]);break;case"line":var Ui=Jt.split(","),Oi=Ui[0];Qt.integer(Ht,Oi),Qt.percent(Ht,Oi)&&Qt.set("snapToLines",!1),Qt.alt(Ht,Oi,["auto"]),2===Ui.length&&Qt.alt("lineAlign",Ui[1],["start","center","end"]);break;case"position":Ui=Jt.split(","),Qt.percent(Ht,Ui[0]),2===Ui.length&&Qt.alt("positionAlign",Ui[1],["start","center","end"]);break;case"size":Qt.percent(Ht,Jt);break;case"align":Qt.alt(Ht,Jt,["start","center","end","left","right"])}},/:/,/\s/),kt.region=Qt.get("region",null),kt.vertical=Qt.get("vertical","");try{kt.line=Qt.get("line","auto")}catch{}kt.lineAlign=Qt.get("lineAlign","start"),kt.snapToLines=Qt.get("snapToLines",!0),kt.size=Qt.get("size",100);try{kt.align=Qt.get("align","center")}catch{kt.align=Qt.get("align","middle")}try{kt.position=Qt.get("position","auto")}catch{kt.position=Qt.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},kt.align)}kt.positionAlign=Qt.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},kt.align)}(ge,Te)}(dt.prototype=se(Error.prototype)).constructor=dt,dt.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Mt.prototype={set:function(ge,Te){!this.get(ge)&&""!==Te&&(this.values[ge]=Te)},get:function(ge,Te,it){return it?this.has(ge)?this.values[ge]:Te[it]:this.has(ge)?this.values[ge]:Te},has:function(ge){return ge in this.values},alt:function(ge,Te,it){for(var Ot=0;Ot<it.length;++Ot)if(Te===it[Ot]){this.set(ge,Te);break}},integer:function(ge,Te){/^-?\d+$/.test(Te)&&this.set(ge,parseInt(Te,10))},percent:function(ge,Te){return!!(Te.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(Te=parseFloat(Te),Te>=0&&Te<=100))&&(this.set(ge,Te),!0)}};var gt=ht.createElement&&ht.createElement("textarea"),Nt={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},ze={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},Yi={v:"title",lang:"lang"},Bt={rt:"ruby"};function ui(ge,Te){function it(){if(!Te)return null;var Dn=Te.match(/^([^<]*)(<[^>]*>?)?/);return function Oi(gn){return Te=Te.substr(gn.length),gn}(Dn[1]?Dn[1]:Dn[2])}function Ot(Oi){return gt.innerHTML=Oi,Oi=gt.textContent,gt.textContent="",Oi}function tn(Oi,Dn){var gn=Nt[Oi];if(!gn)return null;var Ra=ge.document.createElement(gn),hn=Yi[Oi];return hn&&Dn&&(Ra[hn]=Dn.trim()),Ra}for(var kt,Lt=ge.document.createElement("div"),jt=Lt,Qt=[];null!==(kt=it());)if("<"!==kt[0])jt.appendChild(ge.document.createTextNode(Ot(kt)));else{if("/"===kt[1]){Qt.length&&Qt[Qt.length-1]===kt.substr(2).replace(">","")&&(Qt.pop(),jt=jt.parentNode);continue}var Jt,Ht=Oe(kt.substr(1,kt.length-2));if(Ht){Jt=ge.document.createProcessingInstruction("timestamp",Ht),jt.appendChild(Jt);continue}var Yt=kt.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!Yt||!(Jt=tn(Yt[1],Yt[3]))||Bt[(Dn=Jt).localName]&&Bt[Dn.localName]!==jt.localName)continue;if(Yt[2]){var Ui=Yt[2].split(".");Ui.forEach(function(Oi){var Dn=/^bg_/.test(Oi),gn=Dn?Oi.slice(3):Oi;ze.hasOwnProperty(gn)&&(Jt.style[Dn?"background-color":"color"]=ze[gn])}),Jt.className=Ui.join(" ")}Qt.push(Yt[1]),jt.appendChild(Jt),jt=Jt}var Dn;return Lt}var wi=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Ir(ge){for(var Te=0;Te<wi.length;Te++){var it=wi[Te];if(ge>=it[0]&&ge<=it[1])return!0}return!1}function cs(ge){var Te=[],it="";if(!ge||!ge.childNodes)return"ltr";function Tt(jt,kt){for(var Qt=kt.childNodes.length-1;Qt>=0;Qt--)jt.push(kt.childNodes[Qt])}function tn(jt){if(!jt||!jt.length)return null;var kt=jt.pop(),Qt=kt.textContent||kt.innerText;if(Qt){var Ht=Qt.match(/^.*(\n|\r)/);return Ht?(jt.length=0,Ht[0]):Qt}return"ruby"===kt.tagName?tn(jt):kt.childNodes?(Tt(jt,kt),tn(jt)):void 0}for(Tt(Te,ge);it=tn(Te);)for(var Lt=0;Lt<it.length;Lt++)if(Ir(it.charCodeAt(Lt)))return"rtl";return"ltr"}function Xn(){}function yn(ge,Te,it){Xn.call(this),this.cue=Te,this.cueDiv=ui(ge,Te.text);var Ot={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===Te.vertical?"horizontal-tb":"lr"===Te.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(Ot,this.cueDiv),this.div=ge.document.createElement("div"),Ot={direction:cs(this.cueDiv),writingMode:""===Te.vertical?"horizontal-tb":"lr"===Te.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===Te.align?"center":Te.align,font:it.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(Ot),this.div.appendChild(this.cueDiv);var Tt=0;switch(Te.positionAlign){case"start":Tt=Te.position;break;case"center":Tt=Te.position-Te.size/2;break;case"end":Tt=Te.position-Te.size}this.applyStyles(""===Te.vertical?{left:this.formatStyle(Tt,"%"),width:this.formatStyle(Te.size,"%")}:{top:this.formatStyle(Tt,"%"),height:this.formatStyle(Te.size,"%")}),this.move=function(tn){this.applyStyles({top:this.formatStyle(tn.top,"px"),bottom:this.formatStyle(tn.bottom,"px"),left:this.formatStyle(tn.left,"px"),right:this.formatStyle(tn.right,"px"),height:this.formatStyle(tn.height,"px"),width:this.formatStyle(tn.width,"px")})}}function Hn(ge){var Te,it,Ot,Tt;if(ge.div){it=ge.div.offsetHeight,Ot=ge.div.offsetWidth,Tt=ge.div.offsetTop;var tn=(tn=ge.div.childNodes)&&(tn=tn[0])&&tn.getClientRects&&tn.getClientRects();ge=ge.div.getBoundingClientRect(),Te=tn?Math.max(tn[0]&&tn[0].height||0,ge.height/tn.length):0}this.left=ge.left,this.right=ge.right,this.top=ge.top||Tt,this.height=ge.height||it,this.bottom=ge.bottom||Tt+(ge.height||it),this.width=ge.width||Ot,this.lineHeight=void 0!==Te?Te:ge.lineHeight}function Bi(ge,Te,it,Ot){var tn=new Hn(Te),Lt=Te.cue,jt=function zt(ge){if("number"==typeof ge.line&&(ge.snapToLines||ge.line>=0&&ge.line<=100))return ge.line;if(!ge.track||!ge.track.textTrackList||!ge.track.textTrackList.mediaElement)return-1;for(var Te=ge.track,it=Te.textTrackList,Ot=0,Tt=0;Tt<it.length&&it[Tt]!==Te;Tt++)"showing"===it[Tt].mode&&Ot++;return-1*++Ot}(Lt),kt=[];if(Lt.snapToLines){var Qt;switch(Lt.vertical){case"":kt=["+y","-y"],Qt="height";break;case"rl":kt=["+x","-x"],Qt="width";break;case"lr":kt=["-x","+x"],Qt="width"}var Ht=tn.lineHeight,Jt=Ht*Math.round(jt),Yt=it[Qt]+Ht,Ui=kt[0];Math.abs(Jt)>Yt&&(Jt=Jt<0?-1:1,Jt*=Math.ceil(Yt/Ht)*Ht),jt<0&&(Jt+=""===Lt.vertical?it.height:it.width,kt=kt.reverse()),tn.move(Ui,Jt)}else{var Oi=tn.lineHeight/it.height*100;switch(Lt.lineAlign){case"center":jt-=Oi/2;break;case"end":jt-=Oi}switch(Lt.vertical){case"":Te.applyStyles({top:Te.formatStyle(jt,"%")});break;case"rl":Te.applyStyles({left:Te.formatStyle(jt,"%")});break;case"lr":Te.applyStyles({right:Te.formatStyle(jt,"%")})}kt=["+y","-x","+x","-y"],tn=new Hn(Te)}var Dn=function Tt(gn,Ra){for(var hn,Rs=new Hn(gn),eo=1,_o=0;_o<Ra.length;_o++){for(;gn.overlapsOppositeAxis(it,Ra[_o])||gn.within(it)&&gn.overlapsAny(Ot);)gn.move(Ra[_o]);if(gn.within(it))return gn;var ku=gn.intersectPercentage(it);eo>ku&&(hn=new Hn(gn),eo=ku),gn=new Hn(Rs)}return hn||Rs}(tn,kt);Te.move(Dn.toCSSCompatValues(it))}function Pn(){}Xn.prototype.applyStyles=function(ge,Te){for(var it in Te=Te||this.div,ge)ge.hasOwnProperty(it)&&(Te.style[it]=ge[it])},Xn.prototype.formatStyle=function(ge,Te){return 0===ge?0:ge+Te},(yn.prototype=se(Xn.prototype)).constructor=yn,Hn.prototype.move=function(ge,Te){switch(Te=void 0!==Te?Te:this.lineHeight,ge){case"+x":this.left+=Te,this.right+=Te;break;case"-x":this.left-=Te,this.right-=Te;break;case"+y":this.top+=Te,this.bottom+=Te;break;case"-y":this.top-=Te,this.bottom-=Te}},Hn.prototype.overlaps=function(ge){return this.left<ge.right&&this.right>ge.left&&this.top<ge.bottom&&this.bottom>ge.top},Hn.prototype.overlapsAny=function(ge){for(var Te=0;Te<ge.length;Te++)if(this.overlaps(ge[Te]))return!0;return!1},Hn.prototype.within=function(ge){return this.top>=ge.top&&this.bottom<=ge.bottom&&this.left>=ge.left&&this.right<=ge.right},Hn.prototype.overlapsOppositeAxis=function(ge,Te){switch(Te){case"+x":return this.left<ge.left;case"-x":return this.right>ge.right;case"+y":return this.top<ge.top;case"-y":return this.bottom>ge.bottom}},Hn.prototype.intersectPercentage=function(ge){return Math.max(0,Math.min(this.right,ge.right)-Math.max(this.left,ge.left))*Math.max(0,Math.min(this.bottom,ge.bottom)-Math.max(this.top,ge.top))/(this.height*this.width)},Hn.prototype.toCSSCompatValues=function(ge){return{top:this.top-ge.top,bottom:ge.bottom-this.bottom,left:this.left-ge.left,right:ge.right-this.right,height:this.height,width:this.width}},Hn.getSimpleBoxPosition=function(ge){var Te=ge.div?ge.div.offsetHeight:ge.tagName?ge.offsetHeight:0,it=ge.div?ge.div.offsetWidth:ge.tagName?ge.offsetWidth:0,Ot=ge.div?ge.div.offsetTop:ge.tagName?ge.offsetTop:0;return{left:(ge=ge.div?ge.div.getBoundingClientRect():ge.tagName?ge.getBoundingClientRect():ge).left,right:ge.right,top:ge.top||Ot,height:ge.height||Te,bottom:ge.bottom||Ot+(ge.height||Te),width:ge.width||it}},Pn.StringDecoder=function(){return{decode:function(ge){if(!ge)return"";if("string"!=typeof ge)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(ge))}}},Pn.convertCueToDOMTree=function(ge,Te){return ge&&Te?ui(ge,Te):null},Pn.processCues=function(ge,Te,it){if(!ge||!Te||!it)return null;for(;it.firstChild;)it.removeChild(it.firstChild);var Ot=ge.document.createElement("div");if(Ot.style.position="absolute",Ot.style.left="0",Ot.style.right="0",Ot.style.top="0",Ot.style.bottom="0",Ot.style.margin="1.5%",it.appendChild(Ot),function Tt(Ht){for(var Jt=0;Jt<Ht.length;Jt++)if(Ht[Jt].hasBeenReset||!Ht[Jt].displayState)return!0;return!1}(Te)){var Lt=[],jt=Hn.getSimpleBoxPosition(Ot),Qt={font:Math.round(.05*jt.height*100)/100+"px sans-serif"};!function(){for(var Ht,Jt,Yt=0;Yt<Te.length;Yt++)Ht=new yn(ge,Jt=Te[Yt],Qt),Ot.appendChild(Ht.div),Bi(0,Ht,jt,Lt),Jt.displayState=Ht.div,Lt.push(Hn.getSimpleBoxPosition(Ht))}()}else for(var tn=0;tn<Te.length;tn++)Ot.appendChild(Te[tn].displayState)},(Pn.Parser=function(ge,Te,it){it||(it=Te,Te={}),Te||(Te={}),this.window=ge,this.vttjs=Te,this.state="INITIAL",this.buffer="",this.decoder=it||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(ge){if(!(ge instanceof dt))throw ge;this.onparsingerror&&this.onparsingerror(ge)},parse:function(ge){var Ht,Te=this;function it(){for(var Ht=Te.buffer,Jt=0;Jt<Ht.length&&"\r"!==Ht[Jt]&&"\n"!==Ht[Jt];)++Jt;var Yt=Ht.substr(0,Jt);return"\r"===Ht[Jt]&&++Jt,"\n"===Ht[Jt]&&++Jt,Te.buffer=Ht.substr(Jt),Yt}ge&&(Te.buffer+=Te.decoder.decode(ge,{stream:!0}));try{var Lt;if("INITIAL"===Te.state){if(!/\r\n|\n/.test(Te.buffer))return this;var jt=(Lt=it()).match(/^WEBVTT([ \t].*)?$/);if(!jt||!jt[0])throw new dt(dt.Errors.BadSignature);Te.state="HEADER"}for(var kt=!1;Te.buffer;){if(!/\r\n|\n/.test(Te.buffer))return this;switch(kt?kt=!1:Lt=it(),Te.state){case"HEADER":/:/.test(Lt)?(Ht=Lt).match(/X-TIMESTAMP-MAP/)?Wt(Ht,function(Jt,Yt){"X-TIMESTAMP-MAP"===Jt&&function Tt(Ht){var Jt=new Mt;Wt(Ht,function(Yt,Ui){switch(Yt){case"MPEGT":Jt.integer(Yt+"S",Ui);break;case"LOCA":Jt.set(Yt+"L",Oe(Ui))}},/[^\d]:/,/,/),Te.ontimestampmap&&Te.ontimestampmap({MPEGTS:Jt.get("MPEGTS"),LOCAL:Jt.get("LOCAL")})}(Yt)},/=/):Wt(Ht,function(Jt,Yt){"Region"===Jt&&function Ot(Ht){var Jt=new Mt;if(Wt(Ht,function(Ui,Oi){switch(Ui){case"id":Jt.set(Ui,Oi);break;case"width":Jt.percent(Ui,Oi);break;case"lines":Jt.integer(Ui,Oi);break;case"regionanchor":case"viewportanchor":var Dn=Oi.split(",");if(2!==Dn.length)break;var gn=new Mt;if(gn.percent("x",Dn[0]),gn.percent("y",Dn[1]),!gn.has("x")||!gn.has("y"))break;Jt.set(Ui+"X",gn.get("x")),Jt.set(Ui+"Y",gn.get("y"));break;case"scroll":Jt.alt(Ui,Oi,["up"])}},/=/,/\s/),Jt.has("id")){var Yt=new(Te.vttjs.VTTRegion||Te.window.VTTRegion);Yt.width=Jt.get("width",100),Yt.lines=Jt.get("lines",3),Yt.regionAnchorX=Jt.get("regionanchorX",0),Yt.regionAnchorY=Jt.get("regionanchorY",100),Yt.viewportAnchorX=Jt.get("viewportanchorX",0),Yt.viewportAnchorY=Jt.get("viewportanchorY",100),Yt.scroll=Jt.get("scroll",""),Te.onregion&&Te.onregion(Yt),Te.regionList.push({id:Jt.get("id"),region:Yt})}}(Yt)},/:/):Lt||(Te.state="ID");continue;case"NOTE":Lt||(Te.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(Lt)){Te.state="NOTE";break}if(!Lt)continue;Te.cue=new(Te.vttjs.VTTCue||Te.window.VTTCue)(0,0,"");try{Te.cue.align="center"}catch{Te.cue.align="middle"}if(Te.state="CUE",-1===Lt.indexOf("--\x3e")){Te.cue.id=Lt;continue}case"CUE":try{yt(Lt,Te.cue,Te.regionList)}catch(Ht){Te.reportOrThrowError(Ht),Te.cue=null,Te.state="BADCUE";continue}Te.state="CUETEXT";continue;case"CUETEXT":var Qt=-1!==Lt.indexOf("--\x3e");if(!Lt||Qt&&(kt=!0)){Te.oncue&&Te.oncue(Te.cue),Te.cue=null,Te.state="ID";continue}Te.cue.text&&(Te.cue.text+="\n"),Te.cue.text+=Lt.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":Lt||(Te.state="ID");continue}}}catch(Ht){Te.reportOrThrowError(Ht),"CUETEXT"===Te.state&&Te.cue&&Te.oncue&&Te.oncue(Te.cue),Te.cue=null,Te.state="INITIAL"===Te.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var ge=this;try{if(ge.buffer+=ge.decoder.decode(),(ge.cue||"HEADER"===ge.state)&&(ge.buffer+="\n\n",ge.parse()),"INITIAL"===ge.state)throw new dt(dt.Errors.BadSignature)}catch(Te){ge.reportOrThrowError(Te)}return ge.onflush&&ge.onflush(),this}},ni.exports=Pn},713:ni=>{var on={"":1,lr:1,rl:1},ht={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function dt(Mt){return"string"==typeof Mt&&!!ht[Mt.toLowerCase()]&&Mt.toLowerCase()}function Oe(Mt,Wt,yt){this.hasBeenReset=!1;var gt="",Nt=!1,ze=Mt,Yi=Wt,Bt=yt,ui=null,wi="",Ir=!0,cs="auto",zt="start",Xn="auto",yn="auto",Hn=100,Bi="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return gt},set:function(Pn){gt=""+Pn}},pauseOnExit:{enumerable:!0,get:function(){return Nt},set:function(Pn){Nt=!!Pn}},startTime:{enumerable:!0,get:function(){return ze},set:function(Pn){if("number"!=typeof Pn)throw new TypeError("Start time must be set to a number.");ze=Pn,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return Yi},set:function(Pn){if("number"!=typeof Pn)throw new TypeError("End time must be set to a number.");Yi=Pn,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return Bt},set:function(Pn){Bt=""+Pn,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return ui},set:function(Pn){ui=Pn,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return wi},set:function(Pn){var Zn=function se(Mt){return"string"==typeof Mt&&!!on[Mt.toLowerCase()]&&Mt.toLowerCase()}(Pn);if(!1===Zn)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");wi=Zn,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return Ir},set:function(Pn){Ir=!!Pn,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return cs},set:function(Pn){if("number"!=typeof Pn&&"auto"!==Pn)throw new SyntaxError("Line: an invalid number or illegal string was specified.");cs=Pn,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return zt},set:function(Pn){var Zn=dt(Pn);Zn?(zt=Zn,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return Xn},set:function(Pn){if(Pn<0||Pn>100)throw new Error("Position must be between 0 and 100.");Xn=Pn,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return yn},set:function(Pn){var Zn=dt(Pn);Zn?(yn=Zn,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return Hn},set:function(Pn){if(Pn<0||Pn>100)throw new Error("Size must be between 0 and 100.");Hn=Pn,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return Bi},set:function(Pn){var Zn=dt(Pn);if(!Zn)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");Bi=Zn,this.hasBeenReset=!0}}}),this.displayState=void 0}Oe.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},ni.exports=Oe},872:ni=>{var In={"":!0,up:!0};function ht(dt){return"number"==typeof dt&&dt>=0&&dt<=100}ni.exports=function se(){var dt=100,Oe=3,Mt=0,Wt=100,yt=0,gt=100,Nt="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return dt},set:function(ze){if(!ht(ze))throw new Error("Width must be between 0 and 100.");dt=ze}},lines:{enumerable:!0,get:function(){return Oe},set:function(ze){if("number"!=typeof ze)throw new TypeError("Lines must be set to a number.");Oe=ze}},regionAnchorY:{enumerable:!0,get:function(){return Wt},set:function(ze){if(!ht(ze))throw new Error("RegionAnchorX must be between 0 and 100.");Wt=ze}},regionAnchorX:{enumerable:!0,get:function(){return Mt},set:function(ze){if(!ht(ze))throw new Error("RegionAnchorY must be between 0 and 100.");Mt=ze}},viewportAnchorY:{enumerable:!0,get:function(){return gt},set:function(ze){if(!ht(ze))throw new Error("ViewportAnchorY must be between 0 and 100.");gt=ze}},viewportAnchorX:{enumerable:!0,get:function(){return yt},set:function(ze){if(!ht(ze))throw new Error("ViewportAnchorX must be between 0 and 100.");yt=ze}},scroll:{enumerable:!0,get:function(){return Nt},set:function(ze){var Yi=function on(dt){return"string"==typeof dt&&!!In[dt.toLowerCase()]&&dt.toLowerCase()}(ze);!1===Yi?console.warn("Scroll: an invalid or illegal string was specified."):Nt=Yi}}})}},893:()=>{},156:ni=>{function In(ht,se,dt,Oe,Mt,Wt,yt){try{var gt=ht[Wt](yt),Nt=gt.value}catch(ze){return void dt(ze)}gt.done?se(Nt):Promise.resolve(Nt).then(Oe,Mt)}ni.exports=function on(ht){return function(){var se=this,dt=arguments;return new Promise(function(Oe,Mt){var Wt=ht.apply(se,dt);function yt(Nt){In(Wt,Oe,Mt,yt,gt,"next",Nt)}function gt(Nt){In(Wt,Oe,Mt,yt,gt,"throw",Nt)}yt(void 0)})}},ni.exports.__esModule=!0,ni.exports.default=ni.exports},434:ni=>{function In(){return ni.exports=In=Object.assign?Object.assign.bind():function(on){for(var ht=1;ht<arguments.length;ht++){var se=arguments[ht];for(var dt in se)Object.prototype.hasOwnProperty.call(se,dt)&&(on[dt]=se[dt])}return on},ni.exports.__esModule=!0,ni.exports.default=ni.exports,In.apply(this,arguments)}ni.exports=In,ni.exports.__esModule=!0,ni.exports.default=ni.exports}},ni=>{ni(ni.s=296)}]);